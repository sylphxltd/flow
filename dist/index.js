#!/usr/bin/env node
var cr=Object.defineProperty;var QK=(X,J)=>{for(var Z in J)cr(X,Z,{get:J[Z],enumerable:!0,configurable:!0,set:(Y)=>J[Z]=()=>Y})};var sz=(X)=>typeof X==="function",B=function(X,J){if(typeof X==="function")return function(){if(X(arguments))return J.apply(this,arguments);return(Z)=>J(Z,...arguments)};switch(X){case 0:case 1:throw RangeError(`Invalid arity ${X}`);case 2:return function(Z,Y){if(arguments.length>=2)return J(Z,Y);return function($){return J($,Z)}};case 3:return function(Z,Y,$){if(arguments.length>=3)return J(Z,Y,$);return function(Q){return J(Q,Z,Y)}};case 4:return function(Z,Y,$,Q){if(arguments.length>=4)return J(Z,Y,$,Q);return function(G){return J(G,Z,Y,$)}};case 5:return function(Z,Y,$,Q,G){if(arguments.length>=5)return J(Z,Y,$,Q,G);return function(H){return J(H,Z,Y,$,Q)}};default:return function(){if(arguments.length>=X)return J.apply(this,arguments);let Z=arguments;return function(Y){return J(Y,...Z)}}}};var g=(X)=>X;var IG=(X)=>()=>X,b4=IG(!0),W6=IG(!1);var J$=IG(void 0),Y4=J$;function U(X,J,Z,Y,$,Q,G,H,K){switch(arguments.length){case 1:return X;case 2:return J(X);case 3:return Z(J(X));case 4:return Y(Z(J(X)));case 5:return $(Y(Z(J(X))));case 6:return Q($(Y(Z(J(X)))));case 7:return G(Q($(Y(Z(J(X))))));case 8:return H(G(Q($(Y(Z(J(X)))))));case 9:return K(H(G(Q($(Y(Z(J(X))))))));default:{let V=arguments[0];for(let W=1;W<arguments.length;W++)V=arguments[W](V);return V}}}var SG=(X)=>(J,Z)=>J===Z||X(J,Z),ur=(X,J)=>X===J,pr=()=>ur;var fr=pr();var tz=B(2,(X,J)=>SG((Z,Y)=>X(J(Z),J(Y)))),NF=tz(fr,(X)=>X.getTime());var zF=(X)=>SG((J,Z)=>{if(J.length!==Z.length)return!1;for(let Y=0;Y<J.length;Y++)if(!X(J[Y],Z[Y]))return!1;return!0});var qF=(X)=>B(3,(J,Z,Y)=>X(J,($)=>({...$,[Z]:Y($)}))),OF=(X)=>B(2,(J,Z)=>X(J,(Y)=>({[Z]:Y}))),DF=(X,J)=>B(3,(Z,Y,$)=>J(Z,(Q)=>X($(Q),(G)=>({...Q,[Y]:G}))));var kG,X8=(X,J)=>{if(!kG)globalThis["effect/GlobalValue"]??=new Map,kG=globalThis["effect/GlobalValue"];if(!kG.has(X))kG.set(X,J());return kG.get(X)};var G6=(X)=>typeof X==="string",g4=(X)=>typeof X==="number",z9=(X)=>typeof X==="boolean",TJ=(X)=>typeof X==="bigint",a1=(X)=>typeof X==="symbol";var D7=sz,AF=(X)=>X===void 0;var _F=(X)=>!1;var xG=(X)=>typeof X==="object"&&X!==null,t0=(X)=>xG(X)||D7(X),v=B(2,(X,J)=>t0(X)&&(J in X)),a9=B(2,(X,J)=>v(X,"_tag")&&X._tag===J),s1=(X)=>X===null||X===void 0,wF=(X)=>X!==null&&X!==void 0;var GK=(X)=>X instanceof Date,s9=(X)=>typeof X==="string"||v(X,Symbol.iterator),ez=(X)=>xG(X)&&!Array.isArray(X);var Xq=(X)=>v(X,"then")&&D7(X.then);var t1=(X)=>`BUG: ${X} - please report an issue at https://github.com/Effect-TS/effect/issues`;class Z${self;called=!1;constructor(X){this.self=X}next(X){return this.called?{value:X,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(X){return{value:X,done:!0}}throw(X){throw X}[Symbol.iterator](){return new Z$(this.self)}}var rr=335903614,lr=4150755663,ir=1481765933,ar=1284865837,sr=9007199254740992,tr=134217728;class Zq{_state;constructor(X,J,Z,Y){if(s1(J)&&s1(X))J=Math.random()*4294967295>>>0,X=0;else if(s1(J))J=X,X=0;if(s1(Y)&&s1(Z))Y=this._state?this._state[3]:lr,Z=this._state?this._state[2]:rr;else if(s1(Y))Y=Z,Z=0;return this._state=new Int32Array([0,0,Z>>>0,((Y||0)|1)>>>0]),this._next(),LF(this._state,this._state[0],this._state[1],X>>>0,J>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(X){this._state[0]=X[0],this._state[1]=X[1],this._state[2]=X[2],this._state[3]=X[3]|1}integer(X){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%X}number(){let X=(this._next()&67108863)*1,J=(this._next()&134217727)*1;return(X*tr+J)/sr}_next(){let X=this._state[0]>>>0,J=this._state[1]>>>0;er(this._state,X,J,ir,ar),LF(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let Z=X>>>18,Y=(J>>>18|X<<14)>>>0;Z=(Z^X)>>>0,Y=(Y^J)>>>0;let $=(Y>>>27|Z<<5)>>>0,Q=X>>>27,G=(-Q>>>0&31)>>>0;return($>>>Q|$<<G)>>>0}}function er(X,J,Z,Y,$){let Q=(Z>>>16)*($&65535)>>>0,G=(Z&65535)*($>>>16)>>>0,H=(Z&65535)*($&65535)>>>0,K=(Z>>>16)*($>>>16)+((G>>>16)+(Q>>>16))>>>0;if(G=G<<16>>>0,H=H+G>>>0,H>>>0<G>>>0)K=K+1>>>0;if(Q=Q<<16>>>0,H=H+Q>>>0,H>>>0<Q>>>0)K=K+1>>>0;K=K+Math.imul(Z,Y)>>>0,K=K+Math.imul(J,$)>>>0,X[0]=K,X[1]=H}function LF(X,J,Z,Y,$){let Q=J+Y>>>0,G=Z+$>>>0;if(G>>>0<Z>>>0)Q=Q+1|0;X[0]=Q,X[1]=G}var Jq=Symbol.for("effect/Utils/YieldWrap");class BX{#X;constructor(X){this.#X=X}[Jq](){return this.#X}}function Yq(X){if(typeof X==="object"&&X!==null&&Jq in X)return X[Jq]();throw Error(t1("yieldWrapGet"))}var m4=X8("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var TF={effect_internal_function:(X)=>{return X()}},Xl={effect_internal_function:(X)=>{try{return X()}finally{}}},Jl=TF.effect_internal_function(()=>Error().stack)?.includes("effect_internal_function")===!0,S0=Jl?TF.effect_internal_function:Xl.effect_internal_function,Zl=function*(){}.constructor,PF=(X)=>t0(X)&&X.constructor===Zl;var $q=X8(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),f=Symbol.for("effect/Hash"),F=(X)=>{if(m4.enabled===!0)return 0;switch(typeof X){case"number":return KK(X);case"bigint":return N8(X.toString(10));case"boolean":return N8(String(X));case"symbol":return N8(String(X));case"string":return N8(X);case"undefined":return N8("undefined");case"function":case"object":if(X===null)return N8("null");else if(X instanceof Date)return F(X.toISOString());else if(X instanceof URL)return F(X.href);else if(Yl(X))return X[f]();else return yG(X);default:throw Error(`BUG: unhandled typeof ${typeof X} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},yG=(X)=>{if(!$q.has(X))$q.set(X,KK(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)));return $q.get(X)},b=(X)=>(J)=>J*53^X,HK=(X)=>X&3221225471|X>>>1&1073741824,Yl=(X)=>v(X,f),KK=(X)=>{if(X!==X||X===1/0)return 0;let J=X|0;if(J!==X)J^=X*4294967295;while(X>4294967295)J^=X/=4294967295;return HK(J)},N8=(X)=>{let J=5381,Z=X.length;while(Z)J=J*33^X.charCodeAt(--Z);return HK(J)},$l=(X,J)=>{let Z=12289;for(let Y=0;Y<J.length;Y++)Z^=U(N8(J[Y]),b(F(X[J[Y]])));return HK(Z)},BK=(X)=>$l(X,Object.keys(X)),q9=(X)=>{let J=6151;for(let Z=0;Z<X.length;Z++)J=U(J,b(F(X[Z])));return HK(J)},D8=function(){if(arguments.length===1){let Z=arguments[0];return function(Y){return Object.defineProperty(Z,f,{value(){return Y},enumerable:!1}),Y}}let X=arguments[0],J=arguments[1];return Object.defineProperty(X,f,{value(){return J},enumerable:!1}),J};var u=Symbol.for("effect/Equal");function S(){if(arguments.length===1)return(X)=>VK(X,arguments[0]);return VK(arguments[0],arguments[1])}function VK(X,J){if(X===J)return!0;let Z=typeof X;if(Z!==typeof J)return!1;if(Z==="object"||Z==="function"){if(X!==null&&J!==null){if(Y$(X)&&Y$(J))if(F(X)===F(J)&&X[u](J))return!0;else return m4.enabled&&m4.tester?m4.tester(X,J):!1;else if(X instanceof Date&&J instanceof Date)return X.toISOString()===J.toISOString();else if(X instanceof URL&&J instanceof URL)return X.href===J.href}if(m4.enabled){if(Array.isArray(X)&&Array.isArray(J))return X.length===J.length&&X.every((Y,$)=>VK(Y,J[$]));if(Object.getPrototypeOf(X)===Object.prototype&&Object.getPrototypeOf(X)===Object.prototype){let Y=Object.keys(X),$=Object.keys(J);if(Y.length===$.length){for(let Q of Y)if(!((Q in J)&&VK(X[Q],J[Q])))return m4.tester?m4.tester(X,J):!1;return!0}}return m4.tester?m4.tester(X,J):!1}}return m4.enabled&&m4.tester?m4.tester(X,J):!1}var Y$=(X)=>v(X,u),bG=()=>S;var T8=Symbol.for("nodejs.util.inspect.custom"),v8=(X)=>{try{if(v(X,"toJSON")&&D7(X.toJSON)&&X.toJSON.length===0)return X.toJSON();else if(Array.isArray(X))return X.map(v8)}catch{return{}}return $$(X)},S8=(X)=>JSON.stringify(X,null,2),WK={toJSON(){return v8(this)},[T8](){return this.toJSON()},toString(){return S8(this.toJSON())}};var O9=(X,J=2)=>{if(typeof X==="string")return X;try{return typeof X==="object"?UK(X,J):String(X)}catch{return String(X)}},UK=(X,J)=>{let Z=[],Y=JSON.stringify(X,($,Q)=>typeof Q==="object"&&Q!==null?Z.includes(Q)?void 0:Z.push(Q)&&(e1.fiberRefs!==void 0&&FF(Q)?Q[Qq](e1.fiberRefs):Q):Q,J);return Z=void 0,Y},Qq=Symbol.for("effect/Inspectable/Redactable"),FF=(X)=>typeof X==="object"&&X!==null&&(Qq in X),e1=X8("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),RF=(X,J)=>{let Z=e1.fiberRefs;e1.fiberRefs=X;try{return J()}finally{e1.fiberRefs=Z}},$$=(X)=>{if(FF(X)&&e1.fiberRefs!==void 0)return X[Qq](e1.fiberRefs);return X};var C=(X,J)=>{switch(J.length){case 0:return X;case 1:return J[0](X);case 2:return J[1](J[0](X));case 3:return J[2](J[1](J[0](X)));case 4:return J[3](J[2](J[1](J[0](X))));case 5:return J[4](J[3](J[2](J[1](J[0](X)))));case 6:return J[5](J[4](J[3](J[2](J[1](J[0](X))))));case 7:return J[6](J[5](J[4](J[3](J[2](J[1](J[0](X)))))));case 8:return J[7](J[6](J[5](J[4](J[3](J[2](J[1](J[0](X))))))));case 9:return J[8](J[7](J[6](J[5](J[4](J[3](J[2](J[1](J[0](X)))))))));default:{let Z=X;for(let Y=0,$=J.length;Y<$;Y++)Z=J[Y](Z);return Z}}};var XZ="Async",JZ="Commit",v0="Failure",Q$="OnFailure",G$="OnSuccess",H$="OnSuccessAndFailure",k0="Success",NK="Sync",CF="Tag",VX="UpdateRuntimeFlags",K$="While",ZZ="Iterator",zK="WithRuntime",B$="Yield",gG="RevertFlags";var Ql="3.18.4",mG=()=>Ql;var IF=Symbol.for("effect/Effect"),SF=Symbol.for("effect/Stream"),vF=Symbol.for("effect/Sink"),kF=Symbol.for("effect/Channel"),PJ={_R:(X)=>X,_E:(X)=>X,_A:(X)=>X,_V:mG()},Gl={_A:(X)=>X,_In:(X)=>X,_L:(X)=>X,_E:(X)=>X,_R:(X)=>X},Hl={_Env:(X)=>X,_InErr:(X)=>X,_InElem:(X)=>X,_InDone:(X)=>X,_OutErr:(X)=>X,_OutElem:(X)=>X,_OutDone:(X)=>X},WX={[IF]:PJ,[SF]:PJ,[vF]:Gl,[kF]:Hl,[u](X){return this===X},[f](){return D8(this,yG(this))},[Symbol.iterator](){return new Z$(new BX(this))},pipe(){return C(this,arguments)}},MJ={[f](){return D8(this,BK(this))},[u](X){let J=Object.keys(this),Z=Object.keys(X);if(J.length!==Z.length)return!1;for(let Y of J)if(!((Y in X)&&S(this[Y],X[Y])))return!1;return!0}},E5={...WX,_op:JZ},Gq={...E5,...MJ},xF=function(){function X(){}return X.prototype=E5,X}();var yF=Symbol.for("effect/Option"),bF={...WX,[yF]:{_A:(X)=>X},[T8](){return this.toJSON()},toString(){return S8(this.toJSON())}},Kl=Object.assign(Object.create(bF),{_tag:"Some",_op:"Some",[u](X){return qK(X)&&Kq(X)&&S(this.value,X.value)},[f](){return D8(this,b(F(this._tag))(F(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:v8(this.value)}}}),Bl=F("None"),Vl=Object.assign(Object.create(bF),{_tag:"None",_op:"None",[u](X){return qK(X)&&FJ(X)},[f](){return Bl},toJSON(){return{_id:"Option",_tag:this._tag}}}),qK=(X)=>v(X,yF),FJ=(X)=>X._tag==="None",Kq=(X)=>X._tag==="Some",UX=Object.create(Vl),_4=(X)=>{let J=Object.create(Kl);return J.value=X,J};var Bq=Symbol.for("effect/Either"),gF={...WX,[Bq]:{_R:(X)=>X},[T8](){return this.toJSON()},toString(){return S8(this.toJSON())}},Wl=Object.assign(Object.create(gF),{_tag:"Right",_op:"Right",[u](X){return OK(X)&&Wq(X)&&S(this.right,X.right)},[f](){return b(F(this._tag))(F(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:v8(this.right)}}}),Ul=Object.assign(Object.create(gF),{_tag:"Left",_op:"Left",[u](X){return OK(X)&&Vq(X)&&S(this.left,X.left)},[f](){return b(F(this._tag))(F(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:v8(this.left)}}}),OK=(X)=>v(X,Bq),Vq=(X)=>X._tag==="Left",Wq=(X)=>X._tag==="Right",Uq=(X)=>{let J=Object.create(Ul);return J.left=X,J},Nq=(X)=>{let J=Object.create(Wl);return J.right=X,J};var hF=B(2,(X,J)=>FJ(X)?Uq(J()):Nq(X.value));var Z8=Nq;var $8=Uq;var mF=hF;var DK=OK,z0=Vq,d4=Wq;var dF=B(2,(X,{onLeft:J,onRight:Z})=>z0(X)?$8(J(X.left)):Z8(Z(X.right))),cF=B(2,(X,J)=>z0(X)?$8(J(X.left)):Z8(X.right)),uF=B(2,(X,J)=>d4(X)?Z8(J(X.right)):$8(X.left)),U6=B(2,(X,{onLeft:J,onRight:Z})=>z0(X)?J(X.left):Z(X.right));var V$=U6({onLeft:g,onRight:g});var AK=B(2,(X,J)=>{if(d4(X))return X.right;throw J(X.left)}),pF=AK(()=>Error("getOrThrow called on a Left"));var zq=(X)=>X.length>0;var _K=(X)=>(J,Z)=>J===Z?0:X(J,Z),fF=_K((X,J)=>X<J?-1:1),nF=_K((X,J)=>X<J?-1:1),qq=_K((X,J)=>X<J?-1:1);var YZ=B(2,(X,J)=>_K((Z,Y)=>X(J(Z),J(Y))));var Oq=(X)=>B(2,(J,Z)=>X(J,Z)===1);var _=()=>UX,D=_4,U$=qK,p8=FJ,H8=Kq,n=B(2,(X,{onNone:J,onSome:Z})=>p8(X)?J():Z(X.value));var i=B(2,(X,J)=>p8(X)?J():X.value),c4=B(2,(X,J)=>p8(X)?J():X),oF=B(2,(X,J)=>p8(X)?D(J()):X);var Y0=(X)=>X==null?_():D(X);var e0=i(J$),rF=(X)=>(...J)=>{try{return D(X(...J))}catch{return _()}},Ol=B(2,(X,J)=>{if(H8(X))return X.value;throw J()}),cG=Ol(()=>Error("getOrThrow called on a None")),q0=B(2,(X,J)=>p8(X)?_():D(J(X.value)));var C6=B(2,(X,J)=>p8(X)?_():J(X.value));var lF=B(2,(X,J)=>p8(X)?_():Y0(J(X.value)));var Dl=C6,Dq=B(2,(X,J)=>Dl(X,(Z)=>J(Z)?_4(Z):UX));var Al=(X)=>B(2,(J,Z)=>p8(J)?!1:X(J.value,Z)),_l=bG(),iF=Al(_l),aF=B(2,(X,J)=>p8(X)?!1:J(X.value));var $Z=(X)=>(J,Z)=>{if(p8(J))return Z;else if(p8(Z))return J;return D(X(J.value,Z.value))};var sF=(...X)=>X;var Aq=(X)=>{let Z=X[Symbol.iterator]().next();if(Z.done)throw Error("unsafeHead: empty iterable");return Z.value};var eF=B(2,(X,J)=>{let Z=0;for(let Y of X){let $=J(Y,Z);if(z9($)){if($)return D(Y)}else if(H8($))return $;Z++}return _()});var wl={[Symbol.iterator](){return Ll}},Ll={next(){return{done:!0,value:void 0}}},XR=()=>wl;var x0=(...X)=>X,NX=(X)=>Array(X),LK=B(2,(X,J)=>{let Z=Math.max(1,Math.floor(X)),Y=Array(Z);for(let $=0;$<Z;$++)Y[$]=J($);return Y});var J8=(X)=>Array.isArray(X)?X:Array.from(X),uG=(X)=>Array.isArray(X)?X:[X];var $4=B(2,(X,{onEmpty:J,onNonEmpty:Z})=>Q8(X)?Z(X):J()),n6=B(2,(X,{onEmpty:J,onNonEmpty:Z})=>Q8(X)?Z(a8(X),N6(X)):J()),JR=B(2,(X,{onEmpty:J,onNonEmpty:Z})=>Q8(X)?Z(Fl(X),TK(X)):J()),u4=B(2,(X,J)=>[J,...X]),ZR=B(2,(X,J)=>J8(J).concat(J8(X))),y0=B(2,(X,J)=>[...X,J]),O8=B(2,(X,J)=>J8(X).concat(J8(J)));var zX=Array.isArray,Tl=(X)=>X.length===0,X6=Tl,qX=zq,Q8=zq;var YR=(X,J)=>X<0||X>=J.length,Pl=(X,J)=>Math.floor(Math.min(Math.max(0,X),J.length)),Ml=B(2,(X,J)=>{let Z=Math.floor(J);return YR(Z,X)?_():D(X[Z])}),N$=B(2,(X,J)=>{let Z=Math.floor(J);if(YR(Z,X))throw Error(`Index ${Z} out of bounds`);return X[Z]});var Q4=Ml(0),a8=N$(0),$R=(X)=>Q8(X)?D(TK(X)):_(),TK=(X)=>X[X.length-1];var N6=(X)=>X.slice(1);var Fl=(X)=>X.slice(0,-1);var Rl=(X,J)=>{let Z=0;for(let Y of X){if(!J(Y,Z))break;Z++}return Z},QZ=B(2,(X,J)=>pG(X,Rl(X,J))),A7=B(2,(X,J)=>{let Z=J8(X);return Z.slice(Pl(J,Z),Z.length)});var PK=B(2,(X,J)=>{let Z=0;for(let Y of X){if(J(Y,Z))return D(Z);Z++}return _()});var z$=eF,_q=B(2,(X,J)=>{let Z=J8(X);for(let Y=Z.length-1;Y>=0;Y--){let $=Z[Y],Q=J($,Y);if(z9(Q)){if(Q)return D($)}else if(H8(Q))return Q}return _()});var wq=(X)=>Array.from(X).reverse(),p4=B(2,(X,J)=>{let Z=Array.from(X);return Z.sort(J),Z});var Lq=B(2,(X,J)=>Tq(X,J,sF)),Tq=B(3,(X,J,Z)=>{let Y=J8(X),$=J8(J);if(Q8(Y)&&Q8($)){let Q=[Z(a8(Y),a8($))],G=Math.min(Y.length,$.length);for(let H=1;H<G;H++)Q[H]=Z(Y[H],$[H]);return Q}return[]});var QR=(X)=>B(2,(J,Z)=>{for(let Y of J)if(X(Z,Y))return!0;return!1}),GR=bG(),I5=QR(GR);var pG=B(2,(X,J)=>{let Z=Array.from(X),Y=Math.floor(J);if(Q8(Z)){if(Y>=1)return jl(Z,Y);return[[],Z]}return[Z,[]]}),jl=B(2,(X,J)=>{let Z=Math.max(1,Math.floor(J));return Z>=X.length?[q$(X),[]]:[u4(X.slice(1,Z),a8(X)),X.slice(Z)]});var q$=(X)=>X.slice();var Cl=B(3,(X,J,Z)=>{let Y=J8(X),$=J8(J);if(Q8(Y)){if(Q8($))return BR(Z)(O8(Y,$));return Y}return $}),S5=B(2,(X,J)=>Cl(X,J,GR));var t=()=>[],a=(X)=>[X],r=B(2,(X,J)=>X.map(J)),J6=B(2,(X,J)=>{if(X6(X))return[];let Z=[];for(let Y=0;Y<X.length;Y++){let $=J(X[Y],Y);for(let Q=0;Q<$.length;Q++)Z.push($[Q])}return Z}),fG=J6(g),v5=B(2,(X,J)=>{let Z=J8(X),Y=[];for(let $=0;$<Z.length;$++){let Q=J(Z[$],$);if(H8(Q))Y.push(Q.value)}return Y});var Pq=B(2,(X,J)=>{let Z=[],Y=[],$=J8(X);for(let Q=0;Q<$.length;Q++){let G=J($[Q],Q);if(z0(G))Z.push(G.left);else Y.push(G.right)}return[Z,Y]}),RJ=v5(g);var GZ=B(2,(X,J)=>{let Z=J8(X),Y=[];for(let $=0;$<Z.length;$++)if(J(Z[$],$))Y.push(Z[$]);return Y});var o6=B(3,(X,J,Z)=>J8(X).reduce((Y,$,Q)=>Z(Y,$,Q),J)),t9=B(3,(X,J,Z)=>J8(X).reduceRight((Y,$,Q)=>Z(Y,$,Q),J));var HR=B(2,(X,J)=>X.every(J)),KR=B(2,(X,J)=>X.some(J));var Mq=(X,J)=>{let Z=[],Y=X,$;while(H8($=J(Y))){let[Q,G]=$.value;Z.push(Q),Y=G}return Z};var jJ=zF;var BR=B(2,(X,J)=>{let Z=J8(X);if(Q8(Z)){let Y=[a8(Z)],$=N6(Z);for(let Q of $)if(Y.every((G)=>!J(Q,G)))Y.push(Q);return Y}return[]}),Fq=(X)=>BR(X,bG());var F8=B(2,(X,J)=>J8(X).join(J));var MK="And",FK="Or",RK="InvalidData",jK="MissingData",CK="SourceUnavailable",EK="Unsupported";var Il="effect/ConfigError",IK=Symbol.for(Il),O$={_tag:"ConfigError",[IK]:IK},SK=(X,J)=>{let Z=Object.create(O$);return Z._op=MK,Z.left=X,Z.right=J,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(Z,"message",{enumerable:!1,get(){return this.toString()}}),Z},vK=(X,J)=>{let Z=Object.create(O$);return Z._op=FK,Z.left=X,Z.right=J,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(Z,"message",{enumerable:!1,get(){return this.toString()}}),Z},VR=(X,J,Z={pathDelim:"."})=>{let Y=Object.create(O$);return Y._op=RK,Y.path=X,Y.message=J,Object.defineProperty(Y,"toString",{enumerable:!1,value(){return`(Invalid data at ${U(this.path,F8(Z.pathDelim))}: "${this.message}")`}}),Y},_7=(X,J,Z={pathDelim:"."})=>{let Y=Object.create(O$);return Y._op=jK,Y.path=X,Y.message=J,Object.defineProperty(Y,"toString",{enumerable:!1,value(){return`(Missing data at ${U(this.path,F8(Z.pathDelim))}: "${this.message}")`}}),Y},WR=(X,J,Z,Y={pathDelim:"."})=>{let $=Object.create(O$);return $._op=CK,$.path=X,$.message=J,$.cause=Z,Object.defineProperty($,"toString",{enumerable:!1,value(){return`(Source unavailable at ${U(this.path,F8(Y.pathDelim))}: "${this.message}")`}}),$},UR=(X,J,Z={pathDelim:"."})=>{let Y=Object.create(O$);return Y._op=EK,Y.path=X,Y.message=J,Object.defineProperty(Y,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${U(this.path,F8(Z.pathDelim))}: "${this.message}")`}}),Y},NR=(X)=>v(X,IK);var OX=B(2,(X,J)=>{switch(X._op){case MK:return SK(OX(X.left,J),OX(X.right,J));case FK:return vK(OX(X.left,J),OX(X.right,J));case RK:return VR([...J,...X.path],X.message);case jK:return _7([...J,...X.path],X.message);case CK:return WR([...J,...X.path],X.message,X.cause);case EK:return UR([...J,...X.path],X.message)}}),Sl={andCase:(X,J,Z)=>J&&Z,orCase:(X,J,Z)=>J&&Z,invalidDataCase:W6,missingDataCase:b4,sourceUnavailableCase:W6,unsupportedCase:W6},zR=B(3,(X,J,Z)=>{let Y=[X],$=[];while(Y.length>0){let G=Y.pop();switch(G._op){case MK:{Y.push(G.right),Y.push(G.left),$.push($8({_op:"AndCase"}));break}case FK:{Y.push(G.right),Y.push(G.left),$.push($8({_op:"OrCase"}));break}case RK:{$.push(Z8(Z.invalidDataCase(J,G.path,G.message)));break}case jK:{$.push(Z8(Z.missingDataCase(J,G.path,G.message)));break}case CK:{$.push(Z8(Z.sourceUnavailableCase(J,G.path,G.message,G.cause)));break}case EK:{$.push(Z8(Z.unsupportedCase(J,G.path,G.message)));break}}}let Q=[];while($.length>0){let G=$.pop();switch(G._op){case"Left":{switch(G.left._op){case"AndCase":{let H=Q.pop(),K=Q.pop(),V=Z.andCase(J,H,K);Q.push(V);break}case"OrCase":{let H=Q.pop(),K=Q.pop(),V=Z.orCase(J,H,K);Q.push(V);break}}break}case"Right":{Q.push(G.right);break}}}if(Q.length===0)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return Q.pop()}),qR=(X)=>zR(X,void 0,Sl);var OR=NR;var kK=qR;var Eq=Symbol.for("effect/Context/Tag"),nG=Symbol.for("effect/Context/Reference"),vl="effect/STM",kl=Symbol.for(vl),D$={...WX,_op:"Tag",[kl]:PJ,[Eq]:{_Service:(X)=>X,_Identifier:(X)=>X},toString(){return S8(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[T8](){return this.toJSON()},of(X){return X},context(X){return vq(this,X)}},xl={...D$,[nG]:nG},DR=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();Error.stackTraceLimit=J;let Y=Object.create(D$);return Object.defineProperty(Y,"stack",{get(){return Z.stack}}),Y.key=X,Y},AR=(X)=>()=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();Error.stackTraceLimit=J;function Y(){}return Object.setPrototypeOf(Y,D$),Y.key=X,Object.defineProperty(Y,"stack",{get(){return Z.stack}}),Y},_R=()=>(X,J)=>{let Z=Error.stackTraceLimit;Error.stackTraceLimit=2;let Y=Error();Error.stackTraceLimit=Z;function $(){}return Object.setPrototypeOf($,xl),$.key=X,$.defaultValue=J.defaultValue,Object.defineProperty($,"stack",{get(){return Y.stack}}),$},Iq=Symbol.for("effect/Context"),yl={[Iq]:{_Services:(X)=>X},[u](X){if(Sq(X)){if(this.unsafeMap.size===X.unsafeMap.size){for(let J of this.unsafeMap.keys())if(!X.unsafeMap.has(J)||!S(this.unsafeMap.get(J),X.unsafeMap.get(J)))return!1;return!0}}return!1},[f](){return D8(this,KK(this.unsafeMap.size))},pipe(){return C(this,arguments)},toString(){return S8(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(v8)}},[T8](){return this.toJSON()}},DX=(X)=>{let J=Object.create(yl);return J.unsafeMap=X,J},bl=(X)=>{let J=Error(`Service not found${X.key?`: ${String(X.key)}`:""}`);if(X.stack){let Z=X.stack.split(`
`);if(Z.length>2){let Y=Z[2].match(/at (.*)/);if(Y)J.message=J.message+` (defined at ${Y[1]})`}}if(J.stack){let Z=J.stack.split(`
`);Z.splice(1,3),J.stack=Z.join(`
`)}return J},Sq=(X)=>v(X,Iq),wR=(X)=>v(X,Eq),LR=(X)=>v(X,nG),gl=DX(new Map),TR=()=>gl,vq=(X,J)=>DX(new Map([[X.key,J]])),PR=B(3,(X,J,Z)=>{let Y=new Map(X.unsafeMap);return Y.set(J.key,Z),DX(Y)}),Cq=X8("effect/Context/defaultValueCache",()=>new Map),kq=(X)=>{if(Cq.has(X.key))return Cq.get(X.key);let J=X.defaultValue();return Cq.set(X.key,J),J},MR=(X,J)=>{return X.unsafeMap.has(J.key)?X.unsafeMap.get(J.key):kq(J)},xq=B(2,(X,J)=>{if(!X.unsafeMap.has(J.key)){if(nG in J)return kq(J);throw bl(J)}return X.unsafeMap.get(J.key)}),FR=xq;var RR=B(2,(X,J)=>{if(!X.unsafeMap.has(J.key))return LR(J)?_4(kq(J)):UX;return _4(X.unsafeMap.get(J.key))}),jR=B(2,(X,J)=>{let Z=new Map(X.unsafeMap);for(let[Y,$]of J.unsafeMap)Z.set(Y,$);return DX(Z)});var CR=(...X)=>(J)=>{let Z=new Map(J.unsafeMap);for(let Y of X)Z.delete(Y.key);return DX(Z)};var o8=DR;var IR=Sq,oG=wR;var D9=TR,HZ=vq,$0=PR,z6=FR;var CJ=xq,w4=RR,k5=jR;var SR=CR,xK=AR,AX=_R;var vR=Symbol.for("effect/Chunk");function ml(X,J,Z,Y,$){for(let Q=J;Q<Math.min(X.length,J+$);Q++)Z[Y+Q-J]=X[Q];return Z}var kR=[],dl=(X)=>SG((J,Z)=>J.length===Z.length&&G4(J).every((Y,$)=>X(Y,y5(Z,$)))),cl=dl(S),ul={[vR]:{_A:(X)=>X},toString(){return S8(this.toJSON())},toJSON(){return{_id:"Chunk",values:G4(this).map(v8)}},[T8](){return this.toJSON()},[u](X){return rG(X)&&cl(this,X)},[f](){return D8(this,q9(G4(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return kR[Symbol.iterator]();default:return G4(this)[Symbol.iterator]()}},pipe(){return C(this,arguments)}},o0=(X)=>{let J=Object.create(ul);switch(J.backing=X,X._tag){case"IEmpty":{J.length=0,J.depth=0,J.left=J,J.right=J;break}case"IConcat":{J.length=X.left.length+X.right.length,J.depth=1+Math.max(X.left.depth,X.right.depth),J.left=X.left,J.right=X.right;break}case"IArray":{J.length=X.array.length,J.depth=0,J.left=x5,J.right=x5;break}case"ISingleton":{J.length=1,J.depth=0,J.left=x5,J.right=x5;break}case"ISlice":{J.length=X.length,J.depth=X.chunk.depth+1,J.left=x5,J.right=x5;break}}return J},rG=(X)=>v(X,vR),x5=o0({_tag:"IEmpty"}),e8=()=>x5,_$=(...X)=>rl(X),I8=(X)=>o0({_tag:"ISingleton",a:X}),H4=(X)=>rG(X)?X:b0(J8(X)),yq=(X,J,Z)=>{switch(X.backing._tag){case"IArray":{ml(X.backing.array,0,J,Z,X.length);break}case"IConcat":{yq(X.left,J,Z),yq(X.right,J,Z+X.left.length);break}case"ISingleton":{J[Z]=X.backing.a;break}case"ISlice":{let Y=0,$=Z;while(Y<X.length)J[$]=y5(X,Y),Y+=1,$+=1;break}}},pl=(X)=>G4(X).slice(),xR=pl,fl=(X)=>{switch(X.backing._tag){case"IEmpty":return kR;case"IArray":return X.backing.array;default:{let J=Array(X.length);return yq(X,J,0),X.backing={_tag:"IArray",array:J},X.left=x5,X.right=x5,X.depth=0,J}}},G4=fl,nl=(X)=>{switch(X.backing._tag){case"IEmpty":case"ISingleton":return X;case"IArray":return o0({_tag:"IArray",array:wq(X.backing.array)});case"IConcat":return o0({_tag:"IConcat",left:A9(X.backing.right),right:A9(X.backing.left)});case"ISlice":return b0(wq(G4(X)))}},A9=nl,ol=B(2,(X,J)=>J<0||J>=X.length?_():D(y5(X,J))),b0=(X)=>X.length===0?e8():X.length===1?I8(X[0]):o0({_tag:"IArray",array:X}),rl=(X)=>b0(X),y5=B(2,(X,J)=>{switch(X.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":{if(J!==0)throw Error("Index out of bounds");return X.backing.a}case"IArray":{if(J>=X.length||J<0)throw Error("Index out of bounds");return X.backing.array[J]}case"IConcat":return J<X.left.length?y5(X.left,J):y5(X.right,J-X.left.length);case"ISlice":return y5(X.backing.chunk,J+X.backing.offset)}}),_X=B(2,(X,J)=>t8(X,I8(J))),O0=B(2,(X,J)=>t8(I8(J),X)),A$=B(2,(X,J)=>{if(J<=0)return x5;else if(J>=X.length)return X;else switch(X.backing._tag){case"ISlice":return o0({_tag:"ISlice",chunk:X.backing.chunk,length:J,offset:X.backing.offset});case"IConcat":{if(J>X.left.length)return o0({_tag:"IConcat",left:X.left,right:A$(X.right,J-X.left.length)});return A$(X.left,J)}default:return o0({_tag:"ISlice",chunk:X,offset:0,length:J})}}),b5=B(2,(X,J)=>{if(J<=0)return X;else if(J>=X.length)return x5;else switch(X.backing._tag){case"ISlice":return o0({_tag:"ISlice",chunk:X.backing.chunk,offset:X.backing.offset+J,length:X.backing.length-J});case"IConcat":{if(J>X.left.length)return b5(X.right,J-X.left.length);return o0({_tag:"IConcat",left:b5(X.left,J),right:X.right})}default:return o0({_tag:"ISlice",chunk:X,offset:J,length:X.length-J})}});var t8=B(2,(X,J)=>{if(X.backing._tag==="IEmpty")return J;if(J.backing._tag==="IEmpty")return X;let Z=J.depth-X.depth;if(Math.abs(Z)<=1)return o0({_tag:"IConcat",left:X,right:J});else if(Z<-1)if(X.left.depth>=X.right.depth){let Y=t8(X.right,J);return o0({_tag:"IConcat",left:X.left,right:Y})}else{let Y=t8(X.right.right,J);if(Y.depth===X.depth-3){let $=o0({_tag:"IConcat",left:X.right.left,right:Y});return o0({_tag:"IConcat",left:X.left,right:$})}else{let $=o0({_tag:"IConcat",left:X.left,right:X.right.left});return o0({_tag:"IConcat",left:$,right:Y})}}else if(J.right.depth>=J.left.depth){let Y=t8(X,J.left);return o0({_tag:"IConcat",left:Y,right:J.right})}else{let Y=t8(X,J.left.left);if(Y.depth===J.depth-3){let $=o0({_tag:"IConcat",left:Y,right:J.left.right});return o0({_tag:"IConcat",left:$,right:J.right})}else{let $=o0({_tag:"IConcat",left:J.left.right,right:J.right});return o0({_tag:"IConcat",left:Y,right:$})}}});var w$=B(2,(X,J)=>b0(GZ(X,J)));var g5=(X)=>X.length===0,q6=(X)=>X.length>0,KZ=ol(0),lG=(X)=>y5(X,0),E6=lG;var BZ=B(2,(X,J)=>X.backing._tag==="ISingleton"?I8(J(X.backing.a,0)):b0(U(G4(X),r((Z,Y)=>J(Z,Y)))));var K4=(X)=>b5(X,1),bq=B(2,(X,J)=>b5(X,X.length-J));var iG=o6;var gq=Symbol.for("effect/Duration"),mR=BigInt(0),yR=BigInt(24),yK=BigInt(60),hq=BigInt(1000),bR=BigInt(1e6),gR=BigInt(1e9),ll=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,g0=(X)=>{if(dR(X))return X;else if(g4(X))return w7(X);else if(TJ(X))return aG(X);else if(Array.isArray(X)&&X.length===2&&X.every(g4)){if(X[0]===-1/0||X[1]===-1/0||Number.isNaN(X[0])||Number.isNaN(X[1]))return EJ;if(X[0]===1/0||X[1]===1/0)return tl;return aG(BigInt(Math.round(X[0]*1e9))+BigInt(Math.round(X[1])))}else if(G6(X)){let J=ll.exec(X);if(J){let[Z,Y,$]=J,Q=Number(Y);switch($){case"nano":case"nanos":return aG(BigInt(Y));case"micro":case"micros":return el(BigInt(Y));case"milli":case"millis":return w7(Q);case"second":case"seconds":return mq(Q);case"minute":case"minutes":return Xi(Q);case"hour":case"hours":return Ji(Q);case"day":case"days":return Zi(Q);case"week":case"weeks":return Yi(Q)}}}throw Error("Invalid DurationInput")};var hR={_tag:"Millis",millis:0},il={_tag:"Infinity"},al={[gq]:gq,[f](){return D8(this,BK(this.value))},[u](X){return dR(X)&&Ki(this,X)},toString(){return`Duration(${cq(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Qi(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},e9=(X)=>{let J=Object.create(al);if(g4(X))if(isNaN(X)||X<=0)J.value=hR;else if(!Number.isFinite(X))J.value=il;else if(!Number.isInteger(X))J.value={_tag:"Nanos",nanos:BigInt(Math.round(X*1e6))};else J.value={_tag:"Millis",millis:X};else if(X<=mR)J.value=hR;else J.value={_tag:"Nanos",nanos:X};return J},dR=(X)=>v(X,gq);var sl=(X)=>{switch(X.value._tag){case"Millis":return X.value.millis===0;case"Nanos":return X.value.nanos===mR;case"Infinity":return!1}},EJ=e9(0),tl=e9(1/0),aG=(X)=>e9(X),el=(X)=>e9(X*hq),w7=(X)=>e9(X),mq=(X)=>e9(X*1000),Xi=(X)=>e9(X*60000),Ji=(X)=>e9(X*3600000),Zi=(X)=>e9(X*86400000),Yi=(X)=>e9(X*604800000),h5=(X)=>Gi(X,{onMillis:(J)=>J,onNanos:(J)=>Number(J)/1e6});var $i=(X)=>{let J=g0(X);switch(J.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return J.value.nanos;case"Millis":return BigInt(Math.round(J.value.millis*1e6))}},Qi=(X)=>{let J=g0(X);switch(J.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(J.value.nanos/gR),Number(J.value.nanos%gR)];case"Millis":return[Math.floor(J.value.millis/1000),Math.round(J.value.millis%1000*1e6)]}},Gi=B(2,(X,J)=>{let Z=g0(X);switch(Z.value._tag){case"Nanos":return J.onNanos(Z.value.nanos);case"Infinity":return J.onMillis(1/0);case"Millis":return J.onMillis(Z.value.millis)}}),bK=B(3,(X,J,Z)=>{let Y=g0(X),$=g0(J);if(Y.value._tag==="Infinity"||$.value._tag==="Infinity")return Z.onMillis(h5(Y),h5($));else if(Y.value._tag==="Nanos"||$.value._tag==="Nanos"){let Q=Y.value._tag==="Nanos"?Y.value.nanos:BigInt(Math.round(Y.value.millis*1e6)),G=$.value._tag==="Nanos"?$.value.nanos:BigInt(Math.round($.value.millis*1e6));return Z.onNanos(Q,G)}return Z.onMillis(Y.value.millis,$.value.millis)});var Hi=(X,J)=>bK(X,J,{onMillis:(Z,Y)=>Z===Y,onNanos:(Z,Y)=>Z===Y});var cR=B(2,(X,J)=>bK(X,J,{onMillis:(Z,Y)=>e9(Z+Y),onNanos:(Z,Y)=>e9(Z+Y)}));var uR=B(2,(X,J)=>bK(X,J,{onMillis:(Z,Y)=>Z<=Y,onNanos:(Z,Y)=>Z<=Y}));var dq=B(2,(X,J)=>bK(X,J,{onMillis:(Z,Y)=>Z>=Y,onNanos:(Z,Y)=>Z>=Y})),Ki=B(2,(X,J)=>Hi(g0(X),g0(J))),Bi=(X)=>{let J=g0(X);if(J.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let Z=$i(J),Y=Z/bR,$=Y/hq,Q=$/yK,G=Q/yK,H=G/yR;return{days:Number(H),hours:Number(G%yR),minutes:Number(Q%yK),seconds:Number($%yK),millis:Number(Y%hq),nanos:Number(Z%bR)}},cq=(X)=>{let J=g0(X);if(J.value._tag==="Infinity")return"Infinity";if(sl(J))return"0";let Z=Bi(J),Y=[];if(Z.days!==0)Y.push(`${Z.days}d`);if(Z.hours!==0)Y.push(`${Z.hours}h`);if(Z.minutes!==0)Y.push(`${Z.minutes}m`);if(Z.seconds!==0)Y.push(`${Z.seconds}s`);if(Z.millis!==0)Y.push(`${Z.millis}ms`);if(Z.nanos!==0)Y.push(`${Z.nanos}ns`);return Y.join(" ")};var IJ=5,uq=Math.pow(2,5),pR=uq-1,fR=uq/2,nR=uq/4;function Vi(X){return X-=X>>1&1431655765,X=(X&858993459)+(X>>2&858993459),X=X+(X>>4)&252645135,X+=X>>8,X+=X>>16,X&127}function SJ(X,J){return J>>>X&pR}function vJ(X){return 1<<X}function gK(X,J){return Vi(X&J-1)}var oR=(X,J)=>({value:X,previous:J});function VZ(X,J,Z,Y){let $=Y;if(!X){let Q=Y.length;$=Array(Q);for(let G=0;G<Q;++G)$[G]=Y[G]}return $[J]=Z,$}function pq(X,J,Z){let Y=Z.length-1,$=0,Q=0,G=Z;if(X)$=Q=J;else{G=Array(Y);while($<J)G[Q++]=Z[$++]}++$;while($<=Y)G[Q++]=Z[$++];if(X)G.length=Y;return G}function rR(X,J,Z,Y){let $=Y.length;if(X){let K=$;while(K>=J)Y[K--]=Y[K];return Y[J]=Z,Y}let Q=0,G=0,H=Array($+1);while(Q<J)H[G++]=Y[Q++];H[J]=Z;while(Q<$)H[++G]=Y[Q++];return H}class wX{_tag="EmptyNode";modify(X,J,Z,Y,$,Q){let G=Z(_());if(p8(G))return new wX;return++Q.value,new WZ(X,Y,$,G)}}function X5(X){return a9(X,"EmptyNode")}function Ui(X){return X5(X)||X._tag==="LeafNode"||X._tag==="CollisionNode"}function hK(X,J){return X5(X)?!1:J===X.edit}class WZ{edit;hash;key;value;_tag="LeafNode";constructor(X,J,Z,Y){this.edit=X,this.hash=J,this.key=Z,this.value=Y}modify(X,J,Z,Y,$,Q){if(S($,this.key)){let H=Z(this.value);if(H===this.value)return this;else if(p8(H))return--Q.value,new wX;if(hK(this,X))return this.value=H,this;return new WZ(X,Y,$,H)}let G=Z(_());if(p8(G))return this;return++Q.value,lR(X,J,this.hash,this,Y,new WZ(X,Y,$,G))}}class fq{edit;hash;children;_tag="CollisionNode";constructor(X,J,Z){this.edit=X,this.hash=J,this.children=Z}modify(X,J,Z,Y,$,Q){if(Y===this.hash){let H=hK(this,X),K=this.updateCollisionList(H,X,this.hash,this.children,Z,$,Q);if(K===this.children)return this;return K.length>1?new fq(X,this.hash,K):K[0]}let G=Z(_());if(p8(G))return this;return++Q.value,lR(X,J,this.hash,this,Y,new WZ(X,Y,$,G))}updateCollisionList(X,J,Z,Y,$,Q,G){let H=Y.length;for(let V=0;V<H;++V){let W=Y[V];if("key"in W&&S(Q,W.key)){let N=W.value,z=$(N);if(z===N)return Y;if(p8(z))return--G.value,pq(X,V,Y);return VZ(X,V,new WZ(J,Z,Q,z),Y)}}let K=$(_());if(p8(K))return Y;return++G.value,VZ(X,H,new WZ(J,Z,Q,K),Y)}}class L${edit;mask;children;_tag="IndexedNode";constructor(X,J,Z){this.edit=X,this.mask=J,this.children=Z}modify(X,J,Z,Y,$,Q){let G=this.mask,H=this.children,K=SJ(J,Y),V=vJ(K),W=gK(G,V),N=G&V,z=hK(this,X);if(!N){let M=new wX().modify(X,J+IJ,Z,Y,$,Q);if(!M)return this;return H.length>=fR?zi(X,K,M,G,H):new L$(X,G|V,rR(z,W,M,H))}let q=H[W],A=q.modify(X,J+IJ,Z,Y,$,Q);if(q===A)return this;let E=G,P;if(X5(A)){if(E&=~V,!E)return new wX;if(H.length<=2&&Ui(H[W^1]))return H[W^1];P=pq(z,W,H)}else P=VZ(z,W,A,H);if(z)return this.mask=E,this.children=P,this;return new L$(X,E,P)}}class nq{edit;size;children;_tag="ArrayNode";constructor(X,J,Z){this.edit=X,this.size=J,this.children=Z}modify(X,J,Z,Y,$,Q){let G=this.size,H=this.children,K=SJ(J,Y),V=H[K],W=(V||new wX).modify(X,J+IJ,Z,Y,$,Q);if(V===W)return this;let N=hK(this,X),z;if(X5(V)&&!X5(W))++G,z=VZ(N,K,W,H);else if(!X5(V)&&X5(W)){if(--G,G<=nR)return Ni(X,G,K,H);z=VZ(N,K,new wX,H)}else z=VZ(N,K,W,H);if(N)return this.size=G,this.children=z,this;return new nq(X,G,z)}}function Ni(X,J,Z,Y){let $=Array(J-1),Q=0,G=0;for(let H=0,K=Y.length;H<K;++H)if(H!==Z){let V=Y[H];if(V&&!X5(V))$[Q++]=V,G|=1<<H}return new L$(X,G,$)}function zi(X,J,Z,Y,$){let Q=[],G=Y,H=0;for(let K=0;G;++K){if(G&1)Q[K]=$[H++];G>>>=1}return Q[J]=Z,new nq(X,H+1,Q)}function qi(X,J,Z,Y,$,Q){if(Z===$)return new fq(X,Z,[Q,Y]);let G=SJ(J,Z),H=SJ(J,$);if(G===H)return(K)=>new L$(X,vJ(G)|vJ(H),[K]);else{let K=G<H?[Y,Q]:[Q,Y];return new L$(X,vJ(G)|vJ(H),K)}}function lR(X,J,Z,Y,$,Q){let G=void 0,H=J;while(!0){let K=qi(X,H,Z,Y,$,Q);if(typeof K==="function")G=oR(K,G),H=H+IJ;else{let V=K;while(G!=null)V=G.value(V),G=G.previous;return V}}}var iR="effect/HashMap",mK=Symbol.for(iR),Di={[mK]:mK,[Symbol.iterator](){return new cK(this,(X,J)=>[X,J])},[f](){let X=F(iR);for(let J of this)X^=U(F(J[0]),b(F(J[1])));return D8(this,X)},[u](X){if(eR(X)){if(X._size!==this._size)return!1;for(let J of this){let Z=U(X,uK(J[0],F(J[0])));if(p8(Z))return!1;else if(!S(J[1],Z.value))return!1}return!0}return!1},toString(){return S8(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(v8)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},oq=(X,J,Z,Y)=>{let $=Object.create(Di);return $._editable=X,$._edit=J,$._root=Z,$._size=Y,$};class cK{map;f;v;constructor(X,J){this.map=X,this.f=J,this.v=aR(this.map._root,this.f,void 0)}next(){if(p8(this.v))return{done:!0,value:void 0};let X=this.v.value;return this.v=dK(X.cont),{done:!1,value:X.value}}[Symbol.iterator](){return new cK(this.map,this.f)}}var dK=(X)=>X?sR(X[0],X[1],X[2],X[3],X[4]):_(),aR=(X,J,Z=void 0)=>{switch(X._tag){case"LeafNode":{if(H8(X.value))return D({value:J(X.key,X.value.value),cont:Z});return dK(Z)}case"CollisionNode":case"ArrayNode":case"IndexedNode":{let Y=X.children;return sR(Y.length,Y,0,J,Z)}default:return dK(Z)}},sR=(X,J,Z,Y,$)=>{while(Z<X){let Q=J[Z++];if(Q&&!X5(Q))return aR(Q,Y,[X,J,Z,Y,$])}return dK($)},Ai=oq(!1,0,new wX,0),T$=()=>Ai,tR=(...X)=>rq(X),rq=(X)=>{let J=sG(T$());for(let Z of X)UZ(J,Z[0],Z[1]);return lq(J)},eR=(X)=>v(X,mK),Xj=(X)=>X&&X5(X._root),Jj=B(2,(X,J)=>uK(X,J,F(J))),uK=B(3,(X,J,Z)=>{let Y=X._root,$=0;while(!0)switch(Y._tag){case"LeafNode":return S(J,Y.key)?Y.value:_();case"CollisionNode":{if(Z===Y.hash){let Q=Y.children;for(let G=0,H=Q.length;G<H;++G){let K=Q[G];if("key"in K&&S(J,K.key))return K.value}}return _()}case"IndexedNode":{let Q=SJ($,Z),G=vJ(Q);if(Y.mask&G){Y=Y.children[gK(Y.mask,G)],$+=IJ;break}return _()}case"ArrayNode":{if(Y=Y.children[SJ($,Z)],Y){$+=IJ;break}return _()}default:return _()}});var pK=B(2,(X,J)=>H8(uK(X,J,F(J))));var UZ=B(3,(X,J,Z)=>nK(X,J,()=>D(Z))),_i=B(3,(X,J,Z)=>{if(X._editable)return X._root=J,X._size=Z,X;return J===X._root?X:oq(X._editable,X._edit,J,Z)}),fK=(X)=>new cK(X,(J)=>J);var P$=(X)=>X._size;var sG=(X)=>oq(!0,X._edit+1,X._root,X._size),lq=(X)=>{return X._editable=!1,X},Zj=B(2,(X,J)=>{let Z=sG(X);return J(Z),lq(Z)}),nK=B(3,(X,J,Z)=>Yj(X,J,F(J),Z)),Yj=B(4,(X,J,Z,Y)=>{let $={value:X._size},Q=X._root.modify(X._editable?X._edit:NaN,0,Y,Z,J,$);return U(X,_i(Q,$.value))});var oK=B(2,(X,J)=>nK(X,J,_));var $j=B(2,(X,J)=>M$(X,T$(),(Z,Y,$)=>UZ(Z,$,J(Y,$))));var rK=B(2,(X,J)=>M$(X,void 0,(Z,Y,$)=>J(Y,$))),M$=B(3,(X,J,Z)=>{let Y=X._root;if(Y._tag==="LeafNode")return H8(Y.value)?Z(J,Y.value.value,Y.key):J;if(Y._tag==="EmptyNode")return J;let $=[Y.children],Q;while(Q=$.pop())for(let G=0,H=Q.length;G<H;){let K=Q[G++];if(K&&!X5(K))if(K._tag==="LeafNode"){if(H8(K.value))J=Z(J,K.value.value,K.key)}else $.push(K.children)}return J});var Gj="effect/HashSet",lK=Symbol.for(Gj),wi={[lK]:lK,[Symbol.iterator](){return fK(this._keyMap)},[f](){return D8(this,b(F(this._keyMap))(F(Gj)))},[u](X){if(Hj(X))return P$(this._keyMap)===P$(X._keyMap)&&S(this._keyMap,X._keyMap);return!1},toString(){return S8(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(v8)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},iK=(X)=>{let J=Object.create(wi);return J._keyMap=X,J},Hj=(X)=>v(X,lK),Li=iK(T$()),tG=()=>Li,Kj=(X)=>{let J=aK(tG());for(let Z of X)F$(J,Z);return sK(J)},Bj=(...X)=>{let J=aK(tG());for(let Z of X)F$(J,Z);return sK(J)},Vj=B(2,(X,J)=>pK(X._keyMap,J));var Wj=(X)=>P$(X._keyMap),aK=(X)=>iK(sG(X._keyMap)),sK=(X)=>{return X._keyMap._editable=!1,X},iq=B(2,(X,J)=>{let Z=aK(X);return J(Z),sK(Z)}),F$=B(2,(X,J)=>X._keyMap._editable?(UZ(J,!0)(X._keyMap),X):iK(UZ(J,!0)(X._keyMap))),aq=B(2,(X,J)=>X._keyMap._editable?(oK(J)(X._keyMap),X):iK(oK(J)(X._keyMap))),Uj=B(2,(X,J)=>iq(X,(Z)=>{for(let Y of J)aq(Z,Y)}));var Nj=B(2,(X,J)=>iq(tG(),(Z)=>{zj(X,(Y)=>F$(Z,Y));for(let Y of J)F$(Z,Y)}));var zj=B(2,(X,J)=>rK(X._keyMap,(Z,Y)=>J(Y))),qj=B(3,(X,J,Z)=>M$(X._keyMap,J,(Y,$,Q)=>Z(Y,Q)));var L7=tG,R$=Kj,NZ=Bj,j$=Vj;var LX=Wj;var TX=F$,eG=aq,sq=Uj;var PX=Nj;var kJ=qj;var Oj=Symbol.for("effect/MutableRef"),Pi={[Oj]:Oj,toString(){return S8(this.toJSON())},toJSON(){return{_id:"MutableRef",current:v8(this.current)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},f4=(X)=>{let J=Object.create(Pi);return J.current=X,J},tK=B(3,(X,J,Z)=>{if(S(J,X.current))return X.current=Z,!0;return!1});var h0=(X)=>X.current;var J5=B(2,(X,J)=>{return X.current=J,X});var eK="effect/FiberId",yJ=Symbol.for(eK),C$="None",tq="Runtime",eq="Composite",Mi=N8(`${eK}-${C$}`);class Aj{[yJ]=yJ;_tag=C$;id=-1;startTimeMillis=-1;[f](){return Mi}[u](X){return JB(X)&&X._tag===C$}toString(){return S8(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[T8](){return this.toJSON()}}class XB{id;startTimeMillis;[yJ]=yJ;_tag=tq;constructor(X,J){this.id=X,this.startTimeMillis=J}[f](){return D8(this,N8(`${eK}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[u](X){return JB(X)&&X._tag===tq&&this.id===X.id&&this.startTimeMillis===X.startTimeMillis}toString(){return S8(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[T8](){return this.toJSON()}}class XO{left;right;[yJ]=yJ;_tag=eq;constructor(X,J){this.left=X,this.right=J}_hash;[f](){return U(N8(`${eK}-${this._tag}`),b(F(this.left)),b(F(this.right)),D8(this))}[u](X){return JB(X)&&X._tag===eq&&S(this.left,X.left)&&S(this.right,X.right)}toString(){return S8(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:v8(this.left),right:v8(this.right)}}[T8](){return this.toJSON()}}var J2=new Aj,_j=(X,J)=>{return new XB(X,J)},wj=(X,J)=>{return new XO(X,J)},JB=(X)=>v(X,yJ);var JO=B(2,(X,J)=>{if(X._tag===C$)return J;if(J._tag===C$)return X;return new XO(X,J)}),Lj=(X)=>{return U(X,kJ(J2,(J,Z)=>JO(Z)(J)))};var X2=(X)=>{switch(X._tag){case C$:return L7();case tq:return NZ(X.id);case eq:return U(X2(X.left),PX(X2(X.right)))}},Dj=X8(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>f4(0)),Tj=(X,J)=>{return new XB(X,J)},E$=(X)=>{return Array.from(X2(X)).map((Z)=>`#${Z}`).join(",")};var Pj=()=>{let X=h0(Dj);return U(Dj,J5(X+1)),new XB(X,Date.now())};var I6=J2,Fj=_j,Rj=wj;var I$=JO,jj=Lj;var Z2=X2,Cj=Tj,Ej=E$;var ZB=Pj;var w9=T$,Y2=tR,S$=rq,v$=Xj,zZ=Jj;var Ij=pK;var n4=UZ,ZO=fK;var YO=P$;var Sj=Zj,vj=nK;var kj=$j;var xj=rK,$O=M$;var $2=Symbol.for("effect/List"),QO=(X)=>J8(X),Fi=(X)=>tz(jJ(X),QO),Ri=Fi(S),ji={[$2]:$2,_tag:"Cons",toString(){return S8(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:QO(this).map(v8)}},[T8](){return this.toJSON()},[u](X){return bj(X)&&this._tag===X._tag&&Ri(this,X)},[f](){return D8(this,q9(QO(this)))},[Symbol.iterator](){let X=!1,J=this;return{next(){if(X)return this.return();if(J._tag==="Nil")return X=!0,this.return();let Z=J.head;return J=J.tail,{done:X,value:Z}},return(Z){if(!X)X=!0;return{done:!0,value:Z}}}},pipe(){return C(this,arguments)}},YB=(X,J)=>{let Z=Object.create(ji);return Z.head=X,Z.tail=J,Z},Ci=N8("Nil"),Ei={[$2]:$2,_tag:"Nil",toString(){return S8(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[T8](){return this.toJSON()},[f](){return Ci},[u](X){return bj(X)&&this._tag===X._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return C(this,arguments)}},yj=Object.create(Ei),bj=(X)=>v(X,$2),L4=(X)=>X._tag==="Nil",k$=(X)=>X._tag==="Cons";var Ii=()=>yj,Z6=(X,J)=>YB(X,J),P7=Ii,FX=(X)=>YB(X,yj);var gj=B(2,(X,J)=>Si(J,X)),$B=B(2,(X,J)=>Z6(J,X)),Si=B(2,(X,J)=>{if(L4(X))return J;else if(L4(J))return X;else{let Z=YB(J.head,X),Y=Z,$=J.tail;while(!L4($)){let Q=YB($.head,X);Y.tail=Q,Y=Q,$=$.tail}return Z}});var hj=B(3,(X,J,Z)=>{let Y=J,$=X;while(!L4($))Y=Z(Y,$.head),$=$.tail;return Y});var mj=(X)=>{let J=P7(),Z=X;while(!L4(Z))J=$B(J,Z.head),Z=Z.tail;return J};var vi=Object.assign(Object.create(Array.prototype),{[f](){return D8(this,q9(this))},[u](X){if(Array.isArray(X)&&this.length===X.length)return this.every((J,Z)=>S(J,X[Z]));else return!1}}),qZ=function(){function X(J){if(J)Object.assign(this,J)}return X.prototype=MJ,X}(),x$=(X)=>Object.assign(Object.create(MJ),X);var ki=Symbol.for("effect/DifferContextPatch");function dj(X){return X}var G2={...qZ.prototype,[ki]:{_Value:dj,_Patch:dj}},xi=Object.assign(Object.create(G2),{_tag:"Empty"}),yi=Object.create(xi),HO=()=>yi,bi=Object.assign(Object.create(G2),{_tag:"AndThen"}),gi=(X,J)=>{let Z=Object.create(bi);return Z.first=X,Z.second=J,Z},hi=Object.assign(Object.create(G2),{_tag:"AddService"}),mi=(X,J)=>{let Z=Object.create(hi);return Z.key=X,Z.service=J,Z},di=Object.assign(Object.create(G2),{_tag:"RemoveService"}),ci=(X)=>{let J=Object.create(di);return J.key=X,J},ui=Object.assign(Object.create(G2),{_tag:"UpdateService"}),pi=(X,J)=>{let Z=Object.create(ui);return Z.key=X,Z.update=J,Z},cj=(X,J)=>{let Z=new Map(X.unsafeMap),Y=HO();for(let[$,Q]of J.unsafeMap.entries())if(Z.has($)){let G=Z.get($);if(Z.delete($),!S(G,Q))Y=Q2(pi($,()=>Q))(Y)}else Z.delete($),Y=Q2(mi($,Q))(Y);for(let[$]of Z.entries())Y=Q2(ci($))(Y);return Y},Q2=B(2,(X,J)=>gi(X,J)),uj=B(2,(X,J)=>{if(X._tag==="Empty")return J;let Z=!1,Y=I8(X),$=new Map(J.unsafeMap);while(q6(Y)){let G=E6(Y),H=K4(Y);switch(G._tag){case"Empty":{Y=H;break}case"AddService":{$.set(G.key,G.service),Y=H;break}case"AndThen":{Y=O0(O0(H,G.second),G.first);break}case"RemoveService":{$.delete(G.key),Y=H;break}case"UpdateService":{$.set(G.key,G.update($.get(G.key))),Z=!0,Y=H;break}}}if(!Z)return DX($);let Q=new Map;for(let[G]of J.unsafeMap)if($.has(G))Q.set(G,$.get(G)),$.delete(G);for(let[G,H]of $)Q.set(G,H);return DX(Q)});var ni=Symbol.for("effect/DifferHashSetPatch");function KO(X){return X}var GB={...qZ.prototype,[ni]:{_Value:KO,_Key:KO,_Patch:KO}},oi=Object.assign(Object.create(GB),{_tag:"Empty"}),ri=Object.create(oi),BO=()=>ri,li=Object.assign(Object.create(GB),{_tag:"AndThen"}),ii=(X,J)=>{let Z=Object.create(li);return Z.first=X,Z.second=J,Z},ai=Object.assign(Object.create(GB),{_tag:"Add"}),si=(X)=>{let J=Object.create(ai);return J.value=X,J},ti=Object.assign(Object.create(GB),{_tag:"Remove"}),ei=(X)=>{let J=Object.create(ti);return J.value=X,J},pj=(X,J)=>{let[Z,Y]=kJ([X,BO()],([$,Q],G)=>{if(j$(G)($))return[eG(G)($),Q];return[$,QB(si(G))(Q)]})(J);return kJ(Y,($,Q)=>QB(ei(Q))($))(Z)},QB=B(2,(X,J)=>ii(X,J)),fj=B(2,(X,J)=>{if(X._tag==="Empty")return J;let Z=J,Y=I8(X);while(q6(Y)){let $=E6(Y),Q=K4(Y);switch($._tag){case"Empty":{Y=Q;break}case"AndThen":{Y=O0($.first)(O0($.second)(Q));break}case"Add":{Z=TX($.value)(Z),Y=Q;break}case"Remove":Z=eG($.value)(Z),Y=Q}}return Z});var Ja=Symbol.for("effect/DifferReadonlyArrayPatch");function nj(X){return X}var K2={...qZ.prototype,[Ja]:{_Value:nj,_Patch:nj}},Za=Object.assign(Object.create(K2),{_tag:"Empty"}),Ya=Object.create(Za),VO=()=>Ya,$a=Object.assign(Object.create(K2),{_tag:"AndThen"}),Qa=(X,J)=>{let Z=Object.create($a);return Z.first=X,Z.second=J,Z},Ga=Object.assign(Object.create(K2),{_tag:"Append"}),Ha=(X)=>{let J=Object.create(Ga);return J.values=X,J},Ka=Object.assign(Object.create(K2),{_tag:"Slice"}),Ba=(X,J)=>{let Z=Object.create(Ka);return Z.from=X,Z.until=J,Z},Va=Object.assign(Object.create(K2),{_tag:"Update"}),Wa=(X,J)=>{let Z=Object.create(Va);return Z.index=X,Z.patch=J,Z},oj=(X)=>{let J=0,Z=VO();while(J<X.oldValue.length&&J<X.newValue.length){let Y=X.oldValue[J],$=X.newValue[J],Q=X.differ.diff(Y,$);if(!S(Q,X.differ.empty))Z=H2(Z,Wa(J,Q));J=J+1}if(J<X.oldValue.length)Z=H2(Z,Ba(0,J));if(J<X.newValue.length)Z=H2(Z,Ha(A7(J)(X.newValue)));return Z},H2=B(2,(X,J)=>Qa(X,J)),rj=B(3,(X,J,Z)=>{if(X._tag==="Empty")return J;let Y=J.slice(),$=a(X);while(qX($)){let Q=a8($),G=N6($);switch(Q._tag){case"Empty":{$=G;break}case"AndThen":{G.unshift(Q.first,Q.second),$=G;break}case"Append":{for(let H of Q.values)Y.push(H);$=G;break}case"Slice":{Y=Y.slice(Q.from,Q.until),$=G;break}case"Update":{Y[Q.index]=Z.patch(Q.patch,Y[Q.index]),$=G;break}}}return Y});var lj=Symbol.for("effect/Differ"),Na={[lj]:{_P:g,_V:g},pipe(){return C(this,arguments)}},gJ=(X)=>{let J=Object.create(Na);return J.empty=X.empty,J.diff=X.diff,J.combine=X.combine,J.patch=X.patch,J},WO=()=>gJ({empty:HO(),combine:(X,J)=>Q2(J)(X),diff:(X,J)=>cj(X,J),patch:(X,J)=>uj(J)(X)});var UO=()=>gJ({empty:BO(),combine:(X,J)=>QB(J)(X),diff:(X,J)=>pj(X,J),patch:(X,J)=>fj(J)(X)});var NO=(X)=>gJ({empty:VO(),combine:(J,Z)=>H2(J,Z),diff:(J,Z)=>oj({oldValue:J,newValue:Z,differ:X}),patch:(J,Z)=>rj(J,Z,X)});var HB=()=>ij((X,J)=>J),ij=(X)=>gJ({empty:g,combine:(J,Z)=>{if(J===g)return Z;if(Z===g)return J;return(Y)=>Z(J(Y))},diff:(J,Z)=>{if(S(J,Z))return g;return IG(Z)},patch:(J,Z)=>X(Z,J(Z))});var B2=255,aj=8,KB=(X)=>X&B2,BB=(X)=>X>>aj&B2,OZ=(X,J)=>(X&B2)+((J&X&B2)<<aj),VB=OZ(0,0),sj=(X)=>OZ(X,X),tj=(X)=>OZ(X,0);var ej=B(2,(X,J)=>OZ(KB(X)&~J,BB(X)));var qO=B(2,(X,J)=>X|J);var XC=(X)=>~X>>>0&B2;var za=0,d5=1,ZC=2,OO=4,WB=16,DO=32;var YC=(X)=>UB(X,DO),AO=B(2,(X,J)=>X&~J);var _O=B(2,(X,J)=>X|J);var RX=(X)=>V2(X)&&!qa(X),V2=(X)=>UB(X,d5);var UB=B(2,(X,J)=>(X&J)!==0),wO=(...X)=>X.reduce((J,Z)=>J|Z,0),$C=wO(za);var LO=(X)=>UB(X,OO);var qa=(X)=>UB(X,WB);var Z5=B(2,(X,J)=>OZ(X^J,J)),jX=B(2,(X,J)=>X&(XC(KB(J))|BB(J))|KB(J)&BB(J));var TO=gJ({empty:VB,diff:(X,J)=>Z5(X,J),combine:(X,J)=>qO(J)(X),patch:(X,J)=>jX(J,X)});var QC=VB;var PO=sj,MO=tj;var FO=ej;var GC={_tag:"Empty"},CO=(X,J)=>({_tag:"Par",left:X,right:J}),NB=(X,J)=>({_tag:"Seq",left:X,right:J}),EO=(X,J)=>({_tag:"Single",dataSource:X,blockedRequest:J});var HC=(X)=>{let J=FX(X),Z=P7();while(!0){let[Y,$]=hj(J,[BC(),P7()],([Q,G],H)=>{let[K,V]=Oa(H);return[Pa(Q,K),gj(G,V)]});if(Z=Da(Z,Y),L4($))return mj(Z);J=$}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Oa=(X)=>{let J=X,Z=BC(),Y=P7(),$=P7();while(!0)switch(J._tag){case"Empty":{if(L4(Y))return[Z,$];J=Y.head,Y=Y.tail;break}case"Par":{Y=Z6(J.right,Y),J=J.left;break}case"Seq":{let{left:Q,right:G}=J;switch(Q._tag){case"Empty":{J=G;break}case"Par":{let{left:H,right:K}=Q;J=CO(NB(H,G),NB(K,G));break}case"Seq":{let{left:H,right:K}=Q;J=NB(H,NB(K,G));break}case"Single":{J=Q,$=Z6(G,$);break}}break}case"Single":{if(Z=Ta(Z,J),L4(Y))return[Z,$];J=Y.head,Y=Y.tail;break}}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},Da=(X,J)=>{if(L4(X))return FX(jO(J));if(Ma(J))return X;let Z=Ia(X.head),Y=Fa(J);if(Z.length===1&&Y.length===1&&S(Z[0],Y[0]))return Z6(Ea(X.head,jO(J)),X.tail);return Z6(jO(J),X)},Aa=Symbol.for("effect/RequestBlock/Entry");class KC{request;result;listeners;ownerId;state;[Aa]=_a;constructor(X,J,Z,Y,$){this.request=X,this.result=J,this.listeners=Z,this.ownerId=Y,this.state=$}}var _a={_R:(X)=>X};var IO=(X)=>new KC(X.request,X.result,X.listeners,X.ownerId,X.state),wa=Symbol.for("effect/RequestBlock/RequestBlockParallel"),La={_R:(X)=>X};class zB{map;[wa]=La;constructor(X){this.map=X}}var BC=()=>new zB(w9());var Ta=(X,J)=>new zB(vj(X.map,J.dataSource,(Z)=>oF(q0(Z,_X(J.blockedRequest)),()=>I8(J.blockedRequest)))),Pa=(X,J)=>new zB($O(X.map,J.map,(Z,Y,$)=>n4(Z,$,n(zZ(Z,$),{onNone:()=>Y,onSome:(Q)=>t8(Y,Q)})))),Ma=(X)=>v$(X.map),Fa=(X)=>Array.from(ZO(X.map)),jO=(X)=>Ca(kj(X.map,(J)=>I8(J))),Ra=Symbol.for("effect/RequestBlock/RequestBlockSequential"),ja={_R:(X)=>X};class SO{map;[Ra]=ja;constructor(X){this.map=X}}var Ca=(X)=>new SO(X),Ea=(X,J)=>new SO($O(J.map,X.map,(Z,Y,$)=>n4(Z,$,n(zZ(Z,$),{onNone:()=>e8(),onSome:(Q)=>t8(Q,Y)}))));var Ia=(X)=>Array.from(ZO(X.map)),VC=(X)=>Array.from(X.map);var DZ="Die",hJ="Empty",mJ="Fail",AZ="Interrupt",_Z="Parallel",wZ="Sequential";var zC="effect/Cause",kO=Symbol.for(zC),va={_E:(X)=>X},y$={[kO]:va,[f](){return U(F(zC),b(F(xa(this))),D8(this))},[u](X){return U2(X)&&ka(this,X)},pipe(){return C(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:v8(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:v8(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:v8(this.left),right:v8(this.right)}}},toString(){return L9(this)},[T8](){return this.toJSON()}},r6=(()=>{let X=Object.create(y$);return X._tag=hJ,X})(),c5=(X)=>{let J=Object.create(y$);return J._tag=mJ,J.error=X,J},r0=(X)=>{let J=Object.create(y$);return J._tag=DZ,J.defect=X,J},T4=(X)=>{let J=Object.create(y$);return J._tag=AZ,J.fiberId=X,J},l6=(X,J)=>{let Z=Object.create(y$);return Z._tag=_Z,Z.left=X,Z.right=J,Z},Q0=(X,J)=>{let Z=Object.create(y$);return Z._tag=wZ,Z.left=X,Z.right=J,Z},U2=(X)=>v(X,kO),xO=(X)=>X._tag===hJ,qC=(X)=>X._tag===mJ,PZ=(X)=>X._tag===DZ;var b$=(X)=>{if(X._tag===hJ)return!0;return LZ(X,!0,(J,Z)=>{switch(Z._tag){case hJ:return D(J);case DZ:case mJ:case AZ:return D(!1);default:return _()}})};var N2=(X)=>H8(DC(X)),MZ=(X)=>O2(void 0,ba)(X),z2=(X)=>A9(LZ(X,e8(),(J,Z)=>Z._tag===mJ?D(U(J,O0(Z.error))):_())),q2=(X)=>A9(LZ(X,e8(),(J,Z)=>Z._tag===DZ?D(U(J,O0(Z.defect))):_())),FZ=(X)=>LZ(X,L7(),(J,Z)=>Z._tag===AZ?D(U(J,TX(Z.fiberId))):_()),OB=(X)=>dJ(X,(J)=>J._tag===mJ?D(J.error):_()),u5=(X)=>{let J=OB(X);switch(J._tag){case"None":return Z8(X);case"Some":return $8(J.value)}};var OC=(X)=>RZ(X,{onEmpty:D(r6),onFail:q0(c5),onDie:(J)=>D(r0(J)),onInterrupt:(J)=>D(T4(J)),onSequential:$Z(Q0),onParallel:$Z(l6)}),DC=(X)=>dJ(X,(J)=>J._tag===AZ?D(J.fiberId):_()),yO=(X)=>RZ(X,{onEmpty:_(),onFail:()=>_(),onDie:(J)=>D(r0(J)),onInterrupt:()=>_(),onSequential:$Z(Q0),onParallel:$Z(l6)}),AC=(X)=>RZ(X,{onEmpty:_(),onFail:(J)=>D(r0(J)),onDie:(J)=>D(r0(J)),onInterrupt:()=>_(),onSequential:$Z(Q0),onParallel:$Z(l6)});var DB=(X)=>RZ(X,{onEmpty:r6,onFail:()=>r6,onDie:r0,onInterrupt:T4,onSequential:Q0,onParallel:l6}),_C=(X)=>RZ(X,{onEmpty:r6,onFail:r0,onDie:r0,onInterrupt:T4,onSequential:Q0,onParallel:l6});var AB=B(2,(X,J)=>bO(X,(Z)=>c5(J(Z)))),bO=B(2,(X,J)=>RZ(X,{onEmpty:r6,onFail:(Z)=>J(Z),onDie:(Z)=>r0(Z),onInterrupt:(Z)=>T4(Z),onSequential:(Z,Y)=>Q0(Z,Y),onParallel:(Z,Y)=>l6(Z,Y)})),gO=(X)=>bO(X,g);var ka=(X,J)=>{let Z=I8(X),Y=I8(J);while(q6(Z)&&q6(Y)){let[$,Q]=U(E6(Z),LZ([L7(),e8()],([K,V],W)=>{let[N,z]=vO(W);return D([U(K,PX(N)),U(V,t8(z))])})),[G,H]=U(E6(Y),LZ([L7(),e8()],([K,V],W)=>{let[N,z]=vO(W);return D([U(K,PX(N)),U(V,t8(z))])}));if(!S($,G))return!1;Z=Q,Y=H}return!0},xa=(X)=>{return ya(I8(X),e8())},ya=(X,J)=>{while(!0){let[Z,Y]=U(X,o6([L7(),e8()],([Q,G],H)=>{let[K,V]=vO(H);return[U(Q,PX(K)),U(G,t8(V))]})),$=LX(Z)>0?U(J,O0(Z)):J;if(g5(Y))return A9($);X=Y,J=$}throw Error(t1("Cause.flattenCauseLoop"))},dJ=B(2,(X,J)=>{let Z=[X];while(Z.length>0){let Y=Z.pop(),$=J(Y);switch($._tag){case"None":{switch(Y._tag){case wZ:case _Z:{Z.push(Y.right),Z.push(Y.left);break}}break}case"Some":return $}}return _()});var vO=(X)=>{let J=X,Z=[],Y=L7(),$=e8();while(J!==void 0)switch(J._tag){case hJ:{if(Z.length===0)return[Y,$];J=Z.pop();break}case mJ:{if(Y=TX(Y,_$(J._tag,J.error)),Z.length===0)return[Y,$];J=Z.pop();break}case DZ:{if(Y=TX(Y,_$(J._tag,J.defect)),Z.length===0)return[Y,$];J=Z.pop();break}case AZ:{if(Y=TX(Y,_$(J._tag,J.fiberId)),Z.length===0)return[Y,$];J=Z.pop();break}case wZ:{switch(J.left._tag){case hJ:{J=J.right;break}case wZ:{J=Q0(J.left.left,Q0(J.left.right,J.right));break}case _Z:{J=l6(Q0(J.left.left,J.right),Q0(J.left.right,J.right));break}default:{$=O0($,J.right),J=J.left;break}}break}case _Z:{Z.push(J.right),J=J.left;break}}throw Error(t1("Cause.evaluateCauseLoop"))};var ba={emptyCase:b4,failCase:W6,dieCase:W6,interruptCase:b4,sequentialCase:(X,J,Z)=>J&&Z,parallelCase:(X,J,Z)=>J&&Z};var UC="SequentialCase",NC="ParallelCase",RZ=B(2,(X,{onDie:J,onEmpty:Z,onFail:Y,onInterrupt:$,onParallel:Q,onSequential:G})=>{return O2(X,void 0,{emptyCase:()=>Z,failCase:(H,K)=>Y(K),dieCase:(H,K)=>J(K),interruptCase:(H,K)=>$(K),sequentialCase:(H,K,V)=>G(K,V),parallelCase:(H,K,V)=>Q(K,V)})}),LZ=B(3,(X,J,Z)=>{let Y=J,$=X,Q=[];while($!==void 0){let G=Z(Y,$);switch(Y=H8(G)?G.value:Y,$._tag){case wZ:{Q.push($.right),$=$.left;break}case _Z:{Q.push($.right),$=$.left;break}default:{$=void 0;break}}if($===void 0&&Q.length>0)$=Q.pop()}return Y}),O2=B(3,(X,J,Z)=>{let Y=[X],$=[];while(Y.length>0){let G=Y.pop();switch(G._tag){case hJ:{$.push(Z8(Z.emptyCase(J)));break}case mJ:{$.push(Z8(Z.failCase(J,G.error)));break}case DZ:{$.push(Z8(Z.dieCase(J,G.defect)));break}case AZ:{$.push(Z8(Z.interruptCase(J,G.fiberId)));break}case wZ:{Y.push(G.right),Y.push(G.left),$.push($8({_tag:UC}));break}case _Z:{Y.push(G.right),Y.push(G.left),$.push($8({_tag:NC}));break}}}let Q=[];while($.length>0){let G=$.pop();switch(G._tag){case"Left":{switch(G.left._tag){case UC:{let H=Q.pop(),K=Q.pop(),V=Z.sequentialCase(J,H,K);Q.push(V);break}case NC:{let H=Q.pop(),K=Q.pop(),V=Z.parallelCase(J,H,K);Q.push(V);break}}break}case"Right":{Q.push(G.right);break}}}if(Q.length===0)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return Q.pop()}),L9=(X,J)=>{if(MZ(X))return"All fibers interrupted without errors.";return wB(X).map(function(Z){if(J?.renderErrorCause!==!0||Z.cause===void 0)return Z.stack;return`${Z.stack} {
${wC(Z.cause,"  ")}
}`}).join(`
`)},wC=(X,J)=>{let Z=X.stack.split(`
`),Y=`${J}[cause]: ${Z[0]}`;for(let $=1,Q=Z.length;$<Q;$++)Y+=`
${J}${Z[$]}`;if(X.cause)Y+=` {
${wC(X.cause,`${J}  `)}
${J}}`;return Y};class qB extends globalThis.Error{span=void 0;constructor(X){let J=typeof X==="object"&&X!==null,Z=Error.stackTraceLimit;Error.stackTraceLimit=1;super(_B(X),J&&"cause"in X&&typeof X.cause<"u"?{cause:new qB(X.cause)}:void 0);if(this.message==="")this.message="An error has occurred";if(Error.stackTraceLimit=Z,this.name=X instanceof Error?X.name:"Error",J){if(TZ in X)this.span=X[TZ];Object.keys(X).forEach((Y)=>{if(!(Y in this))this[Y]=X[Y]})}this.stack=ha(`${this.name}: ${this.message}`,X instanceof Error&&X.stack?X.stack:"",this.span)}}var _B=(X)=>{if(typeof X==="string")return X;if(typeof X==="object"&&X!==null&&X instanceof Error)return X.message;try{if(v(X,"toString")&&D7(X.toString)&&X.toString!==Object.prototype.toString&&X.toString!==globalThis.Array.prototype.toString)return X.toString()}catch{}return UK(X)},ga=/\((.*)\)/g,D2=X8("effect/Tracer/spanToTrace",()=>new WeakMap),ha=(X,J,Z)=>{let Y=[X],$=J.startsWith(X)?J.slice(X.length).split(`
`):J.split(`
`);for(let Q=1;Q<$.length;Q++){if($[Q].includes(" at new BaseEffectError")||$[Q].includes(" at new YieldableError")){Q++;continue}if($[Q].includes("Generator.next"))break;if($[Q].includes("effect_internal_function"))break;Y.push($[Q].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(Z){let Q=Z,G=0;while(Q&&Q._tag==="Span"&&G<10){let H=D2.get(Q);if(typeof H==="function"){let K=H();if(typeof K==="string"){let V=K.matchAll(ga),W=!1;for(let[,N]of V)W=!0,Y.push(`    at ${Q.name} (${N})`);if(!W)Y.push(`    at ${Q.name} (${K.replace(/^at /,"")})`)}else Y.push(`    at ${Q.name}`)}else Y.push(`    at ${Q.name}`);Q=e0(Q.parent),G++}}return Y.join(`
`)},TZ=Symbol.for("effect/SpanAnnotation"),wB=(X)=>O2(X,void 0,{emptyCase:()=>[],dieCase:(J,Z)=>{return[new qB(Z)]},failCase:(J,Z)=>{return[new qB(Z)]},interruptCase:()=>[],parallelCase:(J,Z,Y)=>[...Z,...Y],sequentialCase:(J,Z,Y)=>[...Z,...Y]});var jZ="Pending",g$="Done";var ma="effect/Deferred",LB=Symbol.for(ma),TC={_E:(X)=>X,_A:(X)=>X},PC=(X)=>{return{_tag:jZ,joiners:X}},hO=(X)=>{return{_tag:g$,effect:X}};class h${self;called=!1;constructor(X){this.self=X}next(X){return this.called?{value:X,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(X){return{value:X,done:!0}}throw(X){throw X}[Symbol.iterator](){return new h$(this.self)}}var EX=(X,J)=>{let Z=new l0("Blocked");return Z.effect_instruction_i0=X,Z.effect_instruction_i1=J,Z},MB=(X)=>{let J=new l0("RunBlocked");return J.effect_instruction_i0=X,J},IX=Symbol.for("effect/Effect");class nO{patch;op;_op=gG;constructor(X,J){this.patch=X,this.op=J}}class l0{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[IX]=PJ;constructor(X){this._op=X}[u](X){return this===X}[f](){return D8(this,yG(this))}pipe(){return C(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:v8(this.effect_instruction_i0),effect_instruction_i1:v8(this.effect_instruction_i1),effect_instruction_i2:v8(this.effect_instruction_i2)}}toString(){return S8(this.toJSON())}[T8](){return this.toJSON()}[Symbol.iterator](){return new h$(new BX(this))}}class oO{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[IX]=PJ;constructor(X){this._op=X,this._tag=X}[u](X){return k2(X)&&X._op==="Failure"&&S(this.effect_instruction_i0,X.effect_instruction_i0)}[f](){return U(N8(this._tag),b(F(this.effect_instruction_i0)),D8(this))}get cause(){return this.effect_instruction_i0}pipe(){return C(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return S8(this.toJSON())}[T8](){return this.toJSON()}[Symbol.iterator](){return new h$(new BX(this))}}class rO{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[IX]=PJ;constructor(X){this._op=X,this._tag=X}[u](X){return k2(X)&&X._op==="Success"&&S(this.effect_instruction_i0,X.effect_instruction_i0)}[f](){return U(N8(this._tag),b(F(this.effect_instruction_i0)),D8(this))}get value(){return this.effect_instruction_i0}pipe(){return C(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:v8(this.value)}}toString(){return S8(this.toJSON())}[T8](){return this.toJSON()}[Symbol.iterator](){return new h$(new BX(this))}}var f8=(X)=>v(X,IX),A8=(X)=>{let J=new l0(zK);return J.effect_instruction_i0=X,J},FB=B(3,(X,J,Z)=>U0((Y)=>O(X,($)=>O(P0(h(()=>Y(J($)))),(Q)=>{return h(()=>Z($,Q)).pipe(H0({onFailure:(G)=>{switch(Q._tag){case v0:return E8(Q0(Q.effect_instruction_i0,G));case k0:return E8(G)}},onSuccess:()=>Q}))})))),s8=B(2,(X,J)=>O(X,()=>w(J))),W0=(X)=>s8(X,void 0),L2=function(){let X=new l0(JZ);switch(arguments.length){case 2:{X.effect_instruction_i0=arguments[0],X.commit=arguments[1];break}case 3:{X.effect_instruction_i0=arguments[0],X.effect_instruction_i1=arguments[1],X.commit=arguments[2];break}case 4:{X.effect_instruction_i0=arguments[0],X.effect_instruction_i1=arguments[1],X.effect_instruction_i2=arguments[2],X.commit=arguments[3];break}default:throw Error(t1("you're not supposed to end up here"))}return X},m$=(X,J=I6)=>{let Z=new l0(XZ),Y=void 0;return Z.effect_instruction_i0=($)=>{Y=X($)},Z.effect_instruction_i1=J,M9(Z,($)=>f8(Y)?Y:K8)},M7=(X,J=I6)=>h(()=>m$(X,J)),B4=(X,J=I6)=>{return L2(X,function(){let Z=void 0,Y=void 0;function $(K){if(Z)Z(K);else if(Y===void 0)Y=K}let Q=new l0(XZ);Q.effect_instruction_i0=(K)=>{if(Z=K,Y)K(Y)},Q.effect_instruction_i1=J;let G=void 0,H=void 0;if(this.effect_instruction_i0.length!==1)H=new AbortController,G=S0(()=>this.effect_instruction_i0($,H.signal));else G=S0(()=>this.effect_instruction_i0($));return G||H?M9(Q,(K)=>{if(H)H.abort();return G??K8}):Q})};var F7=B(2,(X,J)=>{let Z=new l0(Q$);return Z.effect_instruction_i0=X,Z.effect_instruction_i1=J,Z}),T9=B(2,(X,J)=>H6(X,{onFailure:J,onSuccess:w})),T2=B(3,(X,J,Z)=>F7(X,(Y)=>{let $=u5(Y);switch($._tag){case"Left":return J($.left)?Z($.left):E8(Y);case"Right":return E8($.right)}})),RC=B(2,(X,J)=>F7(X,(Z)=>{let Y=u5(Z);switch(Y._tag){case"Left":return U(J(Y.left),i(()=>E8(Z)));case"Right":return E8(Y.right)}})),jC=(X)=>A8((J,Z)=>X(V2(Z.runtimeFlags))),FC=Symbol.for("effect/OriginalAnnotation");var RB=(X,J)=>{if(H8(J))return new Proxy(X,{has(Z,Y){return Y===TZ||Y===FC||Y in Z},get(Z,Y){if(Y===TZ)return J.value;if(Y===FC)return X;return Z[Y]}});return X},P4=(X)=>t0(X)&&!(TZ in X)?A8((J)=>E8(r0(RB(X,iB(J))))):E8(r0(X)),uJ=(X)=>fJ(()=>r0(new fC(X))),pJ=(X)=>O(T(X),P4),Y5=(X)=>H6(X,{onFailure:(J)=>w($8(J)),onSuccess:(J)=>w(Z8(J))}),P0=(X)=>P2(X,{onFailure:g8,onSuccess:m8}),R8=(X)=>t0(X)&&!(TZ in X)?A8((J)=>E8(c5(RB(X,iB(J))))):E8(c5(X)),$5=(X)=>O(T(X),R8),E8=(X)=>{let J=new oO(v0);return J.effect_instruction_i0=X,J},fJ=(X)=>O(T(X),E8),R7=A8((X)=>w(X.id())),o4=(X)=>A8((J)=>X(J.id())),O=B(2,(X,J)=>{let Z=new l0(G$);return Z.effect_instruction_i0=X,Z.effect_instruction_i1=J,Z}),nJ=B(2,(X,J)=>O(X,(Z)=>{let Y=typeof J==="function"?J(Z):J;if(f8(Y))return Y;else if(Xq(Y))return m$(($)=>{Y.then((Q)=>$(w(Q)),(Q)=>$(R8(new p$(Q,"An unknown error occurred in Effect.andThen"))))});return w(Y)})),jB=(X)=>{let J=new l0("OnStep");return J.effect_instruction_i0=X,J},r4=(X)=>O(X,g),oJ=(X)=>H6(X,{onFailure:w,onSuccess:R8}),P2=B(2,(X,J)=>H0(X,{onFailure:(Z)=>w(J.onFailure(Z)),onSuccess:(Z)=>w(J.onSuccess(Z))})),H0=B(2,(X,J)=>{let Z=new l0(H$);return Z.effect_instruction_i0=X,Z.effect_instruction_i1=J.onFailure,Z.effect_instruction_i2=J.onSuccess,Z}),H6=B(2,(X,J)=>H0(X,{onFailure:(Z)=>{if(q2(Z).length>0)return E8(_C(Z));let $=z2(Z);if($.length>0)return J.onFailure(lG($));return E8(Z)},onSuccess:J.onSuccess})),i6=B(2,(X,J)=>h(()=>{let Z=J8(X),Y=NX(Z.length),$=0;return s8(aJ({while:()=>$<Z.length,body:()=>J(Z[$],$),step:(Q)=>{Y[$++]=Q}}),Y)})),P9=B(2,(X,J)=>h(()=>{let Z=J8(X),Y=0;return aJ({while:()=>Y<Z.length,body:()=>J(Z[Y],Y),step:()=>{Y++}})})),CB=B((X)=>typeof X[0]==="boolean"||f8(X[0]),(X,J)=>f8(X)?O(X,(Z)=>Z?J.onTrue():J.onFalse()):X?J.onTrue():J.onFalse()),M4=O(R7,(X)=>M2(X)),M2=(X)=>E8(T4(X)),p5=(X)=>{let J=new l0(VX);return J.effect_instruction_i0=PO(d5),J.effect_instruction_i1=()=>X,J},CC=(X)=>L2(X,function(){let J=new l0(VX);return J.effect_instruction_i0=PO(d5),J.effect_instruction_i1=(Z)=>V2(Z)?S0(()=>this.effect_instruction_i0(p5)):S0(()=>this.effect_instruction_i0(f5)),J}),j7=B(2,(X,J)=>U0((Z)=>O(P0(Z(X)),(Y)=>QD(J,Y)))),I=B(2,(X,J)=>O(X,(Z)=>T(()=>J(Z)))),F2=B(2,(X,J)=>H6(X,{onFailure:(Z)=>$5(()=>J.onFailure(Z)),onSuccess:(Z)=>T(()=>J.onSuccess(Z))})),rJ=B(2,(X,J)=>H0(X,{onFailure:(Z)=>{let Y=u5(Z);switch(Y._tag){case"Left":return $5(()=>J(Y.left));case"Right":return E8(Y.right)}},onSuccess:w})),EB=B(2,(X,J)=>F4(X,(Z)=>x2(Z)?K8:J(Z.effect_instruction_i0))),F4=B(2,(X,J)=>U0((Z)=>H0(Z(X),{onFailure:(Y)=>{let $=g8(Y);return H0(J($),{onFailure:(Q)=>g8(Q0(Y,Q)),onSuccess:()=>$})},onSuccess:(Y)=>{let $=m8(Y);return j8(J($),$)}}))),M9=B(2,(X,J)=>F4(X,bZ({onFailure:(Z)=>MZ(Z)?W0(J(FZ(Z))):K8,onSuccess:()=>K8}))),CZ=B(2,(X,J)=>da(X,J,w)),EZ=(X)=>lO(X,g),lO=B(2,(X,J)=>H6(X,{onFailure:(Z)=>P4(J(Z)),onSuccess:w})),EC=Pq,d$=A8((X,J)=>w(J.runtimeFlags)),w=(X)=>{let J=new rO(k0);return J.effect_instruction_i0=X,J},h=(X)=>{let J=new l0(JZ);return J.commit=X,J},T=(X)=>{let J=new l0(NK);return J.effect_instruction_i0=X,J},V4=B((X)=>X.length===3||X.length===2&&!(t0(X[1])&&("onlyEffect"in X[1])),(X,J)=>O(X,(Z)=>{let Y=typeof J==="function"?J(Z):J;if(f8(Y))return s8(Y,Z);else if(Xq(Y))return m$(($)=>{Y.then((Q)=>$(w(Z)),(Q)=>$(R8(new p$(Q,"An unknown error occurred in Effect.tap"))))});return w(Z)})),IB=(X)=>A8((J)=>{let Z=J.getFiberRef(w2),Y=U(Z,i(()=>J.scope()));return X(N0(w2,D(Y)))}),da=B(3,(X,J,Z)=>H0(X,{onFailure:(Y)=>{if(q2(Y).length>0)return E8(cG(AC(Y)));return J()},onSuccess:Z})),f5=(X)=>{let J=new l0(VX);return J.effect_instruction_i0=MO(d5),J.effect_instruction_i1=()=>X,J},U0=(X)=>L2(X,function(){let J=new l0(VX);return J.effect_instruction_i0=MO(d5),J.effect_instruction_i1=(Z)=>V2(Z)?S0(()=>this.effect_instruction_i0(p5)):S0(()=>this.effect_instruction_i0(f5)),J}),K8=w(void 0);var lJ=(X)=>{let J=new l0(VX);return J.effect_instruction_i0=X,J.effect_instruction_i1=void 0,J},iJ=B(2,(X,J)=>O(J,(Z)=>{if(Z)return U(X,I(D));return w(_())})),aJ=(X)=>{let J=new l0(K$);return J.effect_instruction_i0=X.while,J.effect_instruction_i1=X.body,J.effect_instruction_i2=X.step,J},_2=(X)=>h(()=>{let J=new l0(ZZ);return J.effect_instruction_i0=X(),J}),IC=function(){let X=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return _2(()=>X(U))},SB=(X,...J)=>Object.defineProperty(J.length===0?function(...Z){return _2(()=>X.apply(this,Z))}:function(...Z){let Y=_2(()=>X.apply(this,Z));for(let $ of J)Y=$(Y,...Z);return Y},"length",{value:X.length,configurable:!0}),SC=B(2,(X,J)=>N0(X,E2,J)),vC=B(2,(X,J)=>N0(X,gB,J)),vB=B(2,(X,J)=>{let Z=new l0(VX);return Z.effect_instruction_i0=J,Z.effect_instruction_i1=()=>X,Z}),kC=B(2,(X,J)=>N0(X,mB,J)),xC=B(2,(X,J)=>N0(X,kZ,J)),C7=(X)=>{let J=new l0(B$);return typeof X?.priority<"u"?JD(J,X.priority):J},IZ=B(2,(X,J)=>O(X,(Z)=>I(J,(Y)=>[Z,Y])));var SZ=B(2,(X,J)=>O(X,(Z)=>s8(J,Z))),j8=B(2,(X,J)=>O(X,()=>J)),E7=B(3,(X,J,Z)=>O(X,(Y)=>I(J,($)=>Z(Y,$)))),vZ=M7(()=>{let X=setInterval(()=>{},2147483647);return T(()=>clearInterval(X))}),sJ=(X)=>O(R7,(J)=>U(X,l4(J))),l4=B(2,(X,J)=>O(X.interruptAsFork(J),()=>X.await)),iO={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return C(this,arguments)}},aO={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:50000,pipe(){return C(this,arguments)}},sO={_tag:"Error",syslog:3,label:"ERROR",ordinal:40000,pipe(){return C(this,arguments)}},kB={_tag:"Warning",syslog:4,label:"WARN",ordinal:30000,pipe(){return C(this,arguments)}},xB={_tag:"Info",syslog:6,label:"INFO",ordinal:20000,pipe(){return C(this,arguments)}},yB={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return C(this,arguments)}},tO={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return C(this,arguments)}},eO={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return C(this,arguments)}},yC=[iO,tO,yB,xB,kB,sO,aO,eO],ca="effect/FiberRef",bC=Symbol.for(ca),ua={_A:(X)=>X},i4=(X)=>A8((J)=>m8(J.getFiberRef(X)));var S6=B(2,(X,J)=>O(i4(X),J)),cJ=B(2,(X,J)=>gC(X,()=>[void 0,J]));var gC=B(2,(X,J)=>A8((Z)=>{let[Y,$]=J(Z.getFiberRef(X));return Z.setFiberRef(X,$),w(Y)}));var N0=B(3,(X,J,Z)=>FB(SZ(i4(J),cJ(J,Z)),()=>X,(Y)=>cJ(J,Y))),O6=B(3,(X,J,Z)=>S6(J,(Y)=>N0(X,J,Z(Y)))),A0=(X,J)=>tJ(X,{differ:HB(),fork:J?.fork??g,join:J?.join}),XD=(X)=>{let J=UO();return tJ(X,{differ:J,fork:J.empty})},pa=(X)=>{let J=NO(HB());return tJ(X,{differ:J,fork:J.empty})},R2=(X)=>{let J=WO();return tJ(X,{differ:J,fork:J.empty})},tJ=(X,J)=>{return{...E5,[bC]:ua,initial:X,commit(){return i4(this)},diff:(Y,$)=>J.differ.diff(Y,$),combine:(Y,$)=>J.differ.combine(Y,$),patch:(Y)=>($)=>J.differ.patch(Y,$),fork:J.fork,join:J.join??((Y,$)=>$)}},hC=(X)=>tJ(X,{differ:TO,fork:TO.empty}),D6=X8(Symbol.for("effect/FiberRef/currentContext"),()=>R2(D9())),I7=X8(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>A0(0)),j2=X8(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>A0(2048)),SX=X8(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>A0(w9())),bB=X8(Symbol.for("effect/FiberRef/currentLogLevel"),()=>A0(xB)),C2=X8(Symbol.for("effect/FiberRef/currentLogSpan"),()=>A0(P7())),JD=B(2,(X,J)=>N0(X,I7,J)),mC=B(2,(X,J)=>N0(X,j2,J)),E2=X8(Symbol.for("effect/FiberRef/currentConcurrency"),()=>A0("unbounded")),gB=X8(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>A0(!0)),hB=X8(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>A0(D(yB))),ZD=X8(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>A0(D(kB))),dC=B(2,(X,J)=>N0(X,hB,J)),S7=X8(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>pa(t())),cC=i4(S7),w2=X8(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>A0(_(),{fork:()=>_(),join:(X,J)=>X})),eJ=X8(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>A0(r6,{fork:()=>r6,join:(X,J)=>X})),mB=X8(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>A0(!0)),kZ=X8(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>A0(!0)),c$=X8(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>A0(w9())),I2=X8(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>A0(e8())),dB=Symbol.for("effect/Scope"),cB=Symbol.for("effect/CloseableScope"),S2=(X,J)=>X.addFinalizer(()=>W0(J)),X1=(X,J)=>X.addFinalizer(J),n5=(X,J)=>X.close(J),xZ=(X,J)=>X.fork(J),uC=(X)=>{return pC(g)(X)},pC=B(2,(X,J)=>{let Z=U(X,OB,q0(J));switch(Z._tag){case"None":return U(q2(X),KZ,n({onNone:()=>{let Y=J8(FZ(X)).flatMap(($)=>J8(Z2($)).map((Q)=>`#${Q}`));return new nC(Y?`Interrupted by fibers: ${Y.join(", ")}`:void 0)},onSome:g}));case"Some":return Z.value}}),v2=function(){class X extends globalThis.Error{commit(){return R8(this)}toJSON(){let J={...this};if(this.message)J.message=this.message;if(this.cause)J.cause=this.cause;return J}[T8](){if(this.toString!==globalThis.Error.prototype.toString)return this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString();else if("Bun"in globalThis)return L9(c5(this),{renderErrorCause:!0});return this}}return Object.assign(X.prototype,Gq),X}(),yZ=(X,J)=>{class Z extends v2{_tag=J}return Object.assign(Z.prototype,X),Z.prototype.name=J,Z},mO=Symbol.for("effect/Cause/errors/RuntimeException"),fC=yZ({[mO]:mO},"RuntimeException");var TB=Symbol.for("effect/Cause/errors/InterruptedException"),nC=yZ({[TB]:TB},"InterruptedException"),YD=(X)=>v(X,TB),dO=Symbol.for("effect/Cause/errors/IllegalArgument"),u$=yZ({[dO]:dO},"IllegalArgumentException");var PB=Symbol.for("effect/Cause/errors/NoSuchElement"),R4=yZ({[PB]:PB},"NoSuchElementException"),$D=(X)=>v(X,PB),cO=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),g38=yZ({[cO]:cO},"InvalidPubSubCapacityException"),uO=Symbol.for("effect/Cause/errors/ExceededCapacityException"),fa=yZ({[uO]:uO},"ExceededCapacityException");var pO=Symbol.for("effect/Cause/errors/Timeout"),oC=yZ({[pO]:pO},"TimeoutException"),rC=(X)=>new oC(`Operation timed out after '${cq(X)}'`);var fO=Symbol.for("effect/Cause/errors/UnknownException"),p$=function(){class X extends v2{_tag="UnknownException";error;constructor(J,Z){super(Z??"An unknown error occurred",{cause:J});this.error=J}}return Object.assign(X.prototype,{[fO]:fO,name:"UnknownException"}),X}();var k2=(X)=>f8(X)&&("_tag"in X)&&(X._tag==="Success"||X._tag==="Failure"),uB=(X)=>X._tag==="Failure",x2=(X)=>X._tag==="Success";var f$=B(2,(X,J)=>{switch(X._tag){case v0:return g8(X.effect_instruction_i0);case k0:return m8(J)}}),y2=(X)=>f$(X,void 0);var J1=(X,J)=>na(X,J?.parallel?l6:Q0),pB=(X)=>g8(r0(X));var vX=(X)=>g8(c5(X)),g8=(X)=>{let J=new oO(v0);return J.effect_instruction_i0=X,J},lC=B(2,(X,J)=>{switch(X._tag){case v0:return g8(X.effect_instruction_i0);case k0:return J(X.effect_instruction_i0)}});var iC=(X)=>U(X,lC(g));var fB=(X)=>g8(T4(X)),A2=B(2,(X,J)=>{switch(X._tag){case v0:return g8(X.effect_instruction_i0);case k0:return m8(J(X.effect_instruction_i0))}}),aC=B(2,(X,{onFailure:J,onSuccess:Z})=>{switch(X._tag){case v0:return g8(U(X.effect_instruction_i0,AB(J)));case k0:return m8(Z(X.effect_instruction_i0))}});var bZ=B(2,(X,{onFailure:J,onSuccess:Z})=>{switch(X._tag){case v0:return J(X.effect_instruction_i0);case k0:return Z(X.effect_instruction_i0)}}),n$=B(2,(X,{onFailure:J,onSuccess:Z})=>{switch(X._tag){case v0:return J(X.effect_instruction_i0);case k0:return Z(X.effect_instruction_i0)}}),m8=(X)=>{let J=new rO(k0);return J.effect_instruction_i0=X,J},M0=m8(void 0),sC=B(2,(X,J)=>gZ(X,J,{onSuccess:(Z,Y)=>[Z,Y],onFailure:Q0}));var nB=B(2,(X,J)=>gZ(X,J,{onSuccess:(Z,Y)=>Y,onFailure:Q0}));var gZ=B(3,(X,J,{onFailure:Z,onSuccess:Y})=>{switch(X._tag){case v0:switch(J._tag){case k0:return g8(X.effect_instruction_i0);case v0:return g8(Z(X.effect_instruction_i0,J.effect_instruction_i0))}case k0:switch(J._tag){case k0:return m8(Y(X.effect_instruction_i0,J.effect_instruction_i0));case v0:return g8(J.effect_instruction_i0)}}}),na=(X,J)=>{let Z=H4(X);if(!q6(Z))return _();return U(K4(Z),o6(U(E6(Z),A2(I8)),(Y,$)=>U(Y,gZ($,{onSuccess:(Q,G)=>U(Q,O0(G)),onFailure:J}))),A2(A9),A2((Y)=>G4(Y)),D)},Z1=(X)=>{return{...E5,[LB]:TC,state:f4(PC([])),commit(){return m0(this)},blockingOn:X}},W4=()=>O(R7,(X)=>tC(X)),tC=(X)=>T(()=>Z1(X)),m0=(X)=>M7((J)=>{let Z=h0(X.state);switch(Z._tag){case g$:return J(Z.effect);case jZ:return Z.joiners.push(J),oa(X,J)}},X.blockingOn),oB=B(2,(X,J)=>j7(J,X)),hZ=B(2,(X,J)=>T(()=>{let Z=h0(X.state);switch(Z._tag){case g$:return!1;case jZ:{J5(X.state,hO(J));for(let Y=0,$=Z.joiners.length;Y<$;Y++)Z.joiners[Y](J);return!0}}})),QD=B(2,(X,J)=>hZ(X,J)),eC=B(2,(X,J)=>hZ(X,R8(J)));var o$=B(2,(X,J)=>hZ(X,E8(J)));var XE=(X)=>O(R7,(J)=>hZ(X,M2(J))),rB=B(2,(X,J)=>hZ(X,M2(J))),JE=(X)=>T(()=>h0(X.state)._tag===g$);var r$=B(2,(X,J)=>hZ(X,w(J)));var Y1=(X,J)=>{let Z=h0(X.state);if(Z._tag===jZ){J5(X.state,hO(J));for(let Y=0,$=Z.joiners.length;Y<$;Y++)Z.joiners[Y](J)}},oa=(X,J)=>T(()=>{let Z=h0(X.state);if(Z._tag===jZ){let Y=Z.joiners.indexOf(J);if(Y>=0)Z.joiners.splice(Y,1)}}),ra=A8((X)=>m8(X.currentContext)),F9=()=>ra;var Q5=(X)=>O(F9(),X),o5=B(2,(X,J)=>N0(D6,J)(X)),lB=B(2,(X,J)=>O6(D6,(Z)=>k5(Z,J))(X)),mZ=B(2,(X,J)=>Q5((Z)=>o5(X,J(Z)))),GD=B(2,(X,J)=>O(X,(Z)=>O(J.predicate(Z),(Y)=>Y?w(Z):J.orElse(Z)))),ZE=B(2,(X,J)=>GD(X,{predicate:J.predicate,orElse:(Z)=>R8(J.orFailWith(Z))})),iB=(X)=>{let J=X.currentSpan;return J!==void 0&&J._tag==="Span"?D(J):_()},la={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:M0},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},YE=(X)=>Object.assign(Object.create(la),X);var ia="effect/Clock",HD=Symbol.for(ia),R9=o8("effect/Clock"),aa=2147483647,$E={unsafeSchedule(X,J){let Z=h5(J);if(Z>aa)return W6;let Y=!1,$=setTimeout(()=>{Y=!0,X()},Z);return()=>{return clearTimeout($),!Y}}},QE=function(){let X=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*X;let J;return()=>{if(J===void 0)J=BigInt(Date.now())*X-BigInt(Math.round(performance.now()*1e6));return J+BigInt(Math.round(performance.now()*1e6))}}(),sa=function(){let X=typeof process==="object"&&"hrtime"in process&&typeof process.hrtime.bigint==="function"?process.hrtime:void 0;if(!X)return QE;let J=QE()-X.bigint();return()=>J+X.bigint()}();class GE{[HD]=HD;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return sa()}currentTimeMillis=T(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=T(()=>this.unsafeCurrentTimeNanos());scheduler(){return w($E)}sleep(X){return B4((J)=>{let Z=$E.unsafeSchedule(()=>J(K8),X);return W0(T(Z))})}}var KD=()=>new GE;var v7=nF;var HE=(X)=>{if(X==="NaN")return _4(NaN);if(X==="Infinity")return _4(1/0);if(X==="-Infinity")return _4(-1/0);if(X.trim()==="")return UX;let J=Number(X);return Number.isNaN(J)?UX:_4(J)},KE=B(2,(X,J)=>{let Z=Math.pow(10,J);return Math.round(X*Z)/Z});var l$=(X)=>X.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");var BE={_tag:"Empty"};var aB=B(2,(X,J)=>{let Z=FX(J),Y=X;while(k$(Z)){let $=Z.head;switch($._tag){case"Empty":{Z=Z.tail;break}case"AndThen":{Z=Z6($.first,Z6($.second,Z.tail));break}case"MapName":{Y=r(Y,$.f),Z=Z.tail;break}case"Nested":{Y=u4(Y,$.name),Z=Z.tail;break}case"Unnested":{if(U(Q4(Y),iF($.name)))Y=N6(Y),Z=Z.tail;else return $8(_7(Y,`Expected ${$.name} to be in path in ConfigProvider#unnested`));break}}}return Z8(Y)});var VE="Constant",WE="Fail",UE="Fallback",NE="Described",zE="Lazy",qE="MapOrFail",OE="Nested",DE="Primitive",AE="Sequence",_E="HashMap",wE="ZipWith";var sB=(X,J)=>[...X,...J],Ys="effect/ConfigProvider",LE=Symbol.for(Ys),i$=o8("effect/ConfigProvider"),$s="effect/ConfigProviderFlat",TE=Symbol.for($s),Qs=(X)=>({[LE]:LE,pipe(){return C(this,arguments)},...X}),Gs=(X)=>({[TE]:TE,patch:X.patch,load:(J,Z,Y=!0)=>X.load(J,Z,Y),enumerateChildren:X.enumerateChildren}),Hs=(X)=>Qs({load:(J)=>O(G5(X,t(),J,!1),(Z)=>n(Q4(Z),{onNone:()=>R8(_7(t(),`Expected a single value having structure: ${J}`)),onSome:w})),flattened:X}),PE=(X)=>{let{pathDelim:J,seqDelim:Z}=Object.assign({},{pathDelim:"_",seqDelim:","},X),Y=(K)=>U(K,F8(J)),$=(K)=>K.split(J),Q=()=>typeof process<"u"&&("env"in process)&&typeof process.env==="object"?process.env:{};return Hs(Gs({load:(K,V,W=!0)=>{let N=Y(K),z=Q(),q=N in z?D(z[N]):_();return U(q,rJ(()=>_7(K,`Expected ${N} to exist in the process context`)),O((A)=>Us(A,K,V,Z,W)))},enumerateChildren:(K)=>T(()=>{let V=Q(),z=Object.keys(V).map((q)=>$(q.toUpperCase())).filter((q)=>{for(let A=0;A<K.length;A++){let E=U(K,N$(A)),P=q[A];if(P===void 0||E!==P)return!1}return!0}).flatMap((q)=>q.slice(K.length,K.length+1));return R$(z)}),patch:BE}))};var Ks=(X,J,Z,Y)=>{let $=Mq(Z.length,(K)=>K>=Y.length?_():D([X(K),K+1])),Q=Mq(Y.length,(K)=>K>=Z.length?_():D([J(K),K+1])),G=sB(Z,$),H=sB(Y,Q);return[G,H]},Bs=(X,J)=>{let Z=J;if(Z._tag==="Nested"){let Y=X.slice();while(Z._tag==="Nested")Y.push(Z.name),Z=Z.config;return Y}return X},G5=(X,J,Z,Y)=>{let $=Z;switch($._tag){case VE:return w(a($.value));case NE:return h(()=>G5(X,J,$.config,Y));case WE:return R8(_7(J,$.message));case UE:return U(h(()=>G5(X,J,$.first,Y)),T9((Q)=>{if($.condition(Q))return U(G5(X,J,$.second,Y),T9((G)=>R8(vK(Q,G))));return R8(Q)}));case zE:return h(()=>G5(X,J,$.config(),Y));case qE:return h(()=>U(G5(X,J,$.original,Y),O(i6((Q)=>U($.mapOrFail(Q),rJ(OX(Bs(J,$.original))))))));case OE:return h(()=>G5(X,sB(J,a($.name)),$.config,Y));case DE:return U(aB(J,X.patch),O((Q)=>U(X.load(Q,$,Y),O((G)=>{if(G.length===0){let H=U($R(Q),i(()=>"<n/a>"));return R8(_7([],`Expected ${$.description} with name ${H}`))}return w(G)}))));case AE:return U(aB(J,X.patch),O((Q)=>U(X.enumerateChildren(Q),O(zs),O((G)=>{if(G.length===0)return h(()=>I(G5(X,J,$.config,!0),a));return U(i6(G,(H)=>G5(X,y0(J,`[${H}]`),$.config,!0)),I((H)=>{let K=fG(H);if(K.length===0)return a(t());return a(K)}))}))));case _E:return h(()=>U(aB(J,X.patch),O((Q)=>U(X.enumerateChildren(Q),O((G)=>{return U(G,i6((H)=>G5(X,sB(Q,a(H)),$.valueConfig,Y)),I((H)=>{if(H.length===0)return a(w9());return U(Ns(H),r((K)=>S$(Lq(J8(G),K))))}))})))));case wE:return h(()=>U(G5(X,J,$.left,Y),Y5,O((Q)=>U(G5(X,J,$.right,Y),Y5,O((G)=>{if(z0(Q)&&z0(G))return R8(SK(Q.left,G.left));if(z0(Q)&&d4(G))return R8(Q.left);if(d4(Q)&&z0(G))return R8(G.left);if(d4(Q)&&d4(G)){let H=U(J,F8(".")),K=Vs(J,H),[V,W]=Ks(K,K,U(Q.right,r(Z8)),U(G.right,r(Z8)));return U(V,Lq(W),i6(([N,z])=>U(IZ(N,z),I(([q,A])=>$.zip(q,A)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},Vs=(X,J)=>(Z)=>$8(_7(X,`The element at index ${Z} in a sequence at path "${J}" was missing`));var Ws=(X,J)=>{return X.split(new RegExp(`\\s*${l$(J)}\\s*`))},Us=(X,J,Z,Y,$)=>{if(!$)return U(Z.parse(X),F2({onFailure:OX(J),onSuccess:a}));return U(Ws(X,Y),i6((Q)=>Z.parse(Q.trim())),rJ(OX(J)))},Ns=(X)=>{return Object.keys(X[0]).map((J)=>X.map((Z)=>Z[J]))},zs=(X)=>U(i6(X,Os),F2({onFailure:()=>t(),onSuccess:p4(v7)}),Y5,I(V$));var qs=/^(\[(\d+)\])$/,Os=(X)=>{let J=X.match(qs);if(J!==null){let Z=J[2];return U(Z!==void 0&&Z.length>0?D(Z):_(),C6(Ds))}return _()};var Ds=(X)=>{let J=Number.parseInt(X);return Number.isNaN(J)?_():D(J)};var ME=Symbol.for("effect/Console"),H5=o8("effect/Console"),FE={[ME]:ME,assert(X,...J){return T(()=>{console.assert(X,...J)})},clear:T(()=>{console.clear()}),count(X){return T(()=>{console.count(X)})},countReset(X){return T(()=>{console.countReset(X)})},debug(...X){return T(()=>{console.debug(...X)})},dir(X,J){return T(()=>{console.dir(X,J)})},dirxml(...X){return T(()=>{console.dirxml(...X)})},error(...X){return T(()=>{console.error(...X)})},group(X){return X?.collapsed?T(()=>console.groupCollapsed(X?.label)):T(()=>console.group(X?.label))},groupEnd:T(()=>{console.groupEnd()}),info(...X){return T(()=>{console.info(...X)})},log(...X){return T(()=>{console.log(...X)})},table(X,J){return T(()=>{console.table(X,J)})},time(X){return T(()=>console.time(X))},timeEnd(X){return T(()=>console.timeEnd(X))},timeLog(X,...J){return T(()=>{console.timeLog(X,...J)})},trace(...X){return T(()=>{console.trace(...X)})},warn(...X){return T(()=>{console.warn(...X)})},unsafe:console};var _s="effect/Random",b2=Symbol.for(_s),cZ=o8("effect/Random");class jE{seed;[b2]=b2;PRNG;constructor(X){this.seed=X,this.PRNG=new Zq(X)}get next(){return T(()=>this.PRNG.number())}get nextBoolean(){return I(this.next,(X)=>X>0.5)}get nextInt(){return T(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(X,J){return I(this.next,(Z)=>(J-X)*Z+X)}nextIntBetween(X,J){return T(()=>this.PRNG.integer(J-X)+X)}shuffle(X){return CE(X,(J)=>this.nextIntBetween(0,J))}}var CE=(X,J)=>{return h(()=>U(T(()=>Array.from(X)),O((Z)=>{let Y=[];for(let $=Z.length;$>=2;$=$-1)Y.push($);return U(Y,P9(($)=>U(J($),I((Q)=>ws(Z,$-1,Q)))),s8(H4(Z)))})))},ws=(X,J,Z)=>{let Y=X[J];return X[J]=X[Z],X[Z]=Y,X},WD=(X)=>new jE(F(X));class EE{values;[b2]=b2;index=0;constructor(X){if(this.values=X,X.length===0)throw Error("Requires at least one value")}getNextValue(){let X=this.values[this.index];return this.index=(this.index+1)%this.values.length,X}get next(){return T(()=>{let X=this.getNextValue();if(typeof X==="number")return Math.max(0,Math.min(1,X));return F(X)/2147483647})}get nextBoolean(){return T(()=>{let X=this.getNextValue();if(typeof X==="boolean")return X;return F(X)%2===0})}get nextInt(){return T(()=>{let X=this.getNextValue();if(typeof X==="number"&&Number.isFinite(X))return Math.round(X);return Math.abs(F(X))})}nextRange(X,J){return I(this.next,(Z)=>(J-X)*Z+X)}nextIntBetween(X,J){return T(()=>{let Z=this.getNextValue();if(typeof Z==="number"&&Number.isFinite(Z))return Math.max(X,Math.min(J-1,Math.round(Z)));let Y=Math.abs(F(Z));return X+Y%(J-X)})}shuffle(X){return CE(X,(J)=>this.nextIntBetween(0,J))}}var IE=(X)=>new EE(X);var UD=Symbol.for("effect/Tracer"),kE=(X)=>({[UD]:UD,...X}),k7=o8("effect/Tracer"),K5=o8("effect/ParentSpan"),vE=function(){return function(Z){let Y="";for(let $=0;$<Z;$++)Y+="abcdef0123456789".charAt(Math.floor(Math.random()*16));return Y}}();class xE{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(X,J,Z,Y,$,Q){this.name=X,this.parent=J,this.context=Z,this.startTime=$,this.kind=Q,this.status={_tag:"Started",startTime:$},this.attributes=new Map,this.traceId=J._tag==="Some"?J.value.traceId:vE(32),this.spanId=vE(16),this.links=Array.from(Y)}end(X,J){this.status={_tag:"Ended",endTime:X,exit:J,startTime:this.status.startTime}}attribute(X,J){this.attributes.set(X,J)}event(X,J,Z){this.events.push([X,J,Z??{}])}addLinks(X){this.links.push(...X)}}var yE=kE({span:(X,J,Z,Y,$,Q)=>new xE(X,J,Z,Y,$,Q),context:(X)=>X()});var kX=(X)=>{if(X?.captureStackTrace===!1)return X;else if(X?.captureStackTrace!==void 0&&typeof X.captureStackTrace!=="boolean")return X;let J=Error.stackTraceLimit;Error.stackTraceLimit=3;let Z=Error();Error.stackTraceLimit=J;let Y=!1;return{...X,captureStackTrace:()=>{if(Y!==!1)return Y;if(Z.stack!==void 0){let $=Z.stack.split(`
`);if($[3]!==void 0)return Y=$[3].trim(),Y}}}},uZ=AX()("effect/Tracer/DisablePropagation",{defaultValue:W6});var Ls=U(D9(),$0(R9,KD()),$0(H5,FE),$0(cZ,WD(Math.random())),$0(i$,PE()),$0(k7,yE)),_0=X8(Symbol.for("effect/DefaultServices/currentServices"),()=>R2(Ls)),bE=(X)=>{let J=g0(X);return h2((Z)=>Z.sleep(J))},tB=(X)=>A8((J)=>X(J.currentDefaultServices)),h2=(X)=>tB((J)=>X(J.unsafeMap.get(R9.key))),gE=h2((X)=>X.currentTimeMillis),hE=h2((X)=>X.currentTimeNanos),mE=B(2,(X,J)=>O6(_0,$0(R9,J))(X)),dE=B(2,(X,J)=>O6(_0,$0(i$,J))(X)),ND=(X)=>tB((J)=>X(J.unsafeMap.get(i$.key))),cE=(X)=>ND((J)=>J.load(X));var eB=(X)=>tB((J)=>X(J.unsafeMap.get(cZ.key))),uE=B(2,(X,J)=>O6(_0,$0(cZ,J))(X));var XV=(X)=>tB((J)=>X(J.unsafeMap.get(k7.key))),pE=B(2,(X,J)=>O6(_0,$0(k7,J))(X));var fE=(X)=>!X;var oE=WX,pZ=E5;var Ts=xF;class a4 extends Ts{}var rE="Sequential",lE="Parallel",Ps="ParallelN",Q1={_tag:rE},iE={_tag:lE},aE=(X)=>({_tag:Ps,parallelism:X}),zD=(X)=>X._tag===rE,qD=(X)=>X._tag===lE;var a$=Q1,JV=iE,ZV=aE;function sE(X){return new xX(X)}function tE(){return sE(new Map)}var AD=Symbol.for("effect/FiberRefs");class xX{locals;[AD]=AD;constructor(X){this.locals=X}pipe(){return C(this,arguments)}}var Ms=(X,J,Z,Y=!1)=>{let $=X,Q=J,G=Z,H=Y,K=void 0;while(K===void 0)if(Q8(Q)&&Q8(G)){let V=a8(Q)[0],W=N6(Q),N=a8(G)[0],z=a8(G)[1],q=N6(G);if(V.startTimeMillis<N.startTimeMillis)G=q,H=!0;else if(V.startTimeMillis>N.startTimeMillis)Q=W;else if(V.id<N.id)G=q,H=!0;else if(V.id>N.id)Q=W;else K=[z,H]}else K=[$.initial,!0];return K},YV=B(3,(X,J,Z)=>{let Y=new Map(X.locals);return Z.locals.forEach(($,Q)=>{let G=$[0][1];if(!$[0][0][u](J)){if(!Y.has(Q)){if(S(G,Q.initial))return;Y.set(Q,[[J,Q.join(Q.initial,G)]]);return}let H=Y.get(Q),[K,V]=Ms(Q,H,$);if(V){let W=Q.diff(K,G),N=H[0][1],z=Q.join(N,Q.patch(W)(N));if(!S(N,z)){let q,A=H[0][0];if(A[u](J))q=[[A,z],...H.slice(1)];else q=[[J,z],...H];Y.set(Q,q)}}}}),new xX(Y)}),wD=B(2,(X,J)=>{let Z=new Map;return eE(X,Z,J),new xX(Z)}),eE=(X,J,Z)=>{X.locals.forEach((Y,$)=>{let Q=Y[0][1],G=$.patch($.fork)(Q);if(S(Q,G))J.set($,Y);else J.set($,[[Z,G],...Y])})},XI=(X)=>R$(X.locals.keys()),JI=(X)=>P9(XI(X),(J)=>cJ(J,yX(X,J))),m2=B(2,(X,J)=>{let Z=new Map(X.locals);return Z.delete(J),new xX(Z)}),$V=B(2,(X,J)=>{if(!X.locals.has(J))return _();return D(a8(X.locals.get(J))[1])}),yX=B(2,(X,J)=>U($V(X,J),i(()=>J.initial))),fZ=B(2,(X,{fiberId:J,fiberRef:Z,value:Y})=>{if(X.locals.size===0)return new xX(new Map([[Z,[[J,Y]]]]));let $=new Map(X.locals);return _D($,J,Z,Y),new xX($)}),_D=(X,J,Z,Y)=>{let $=X.get(Z)??[],Q;if(Q8($)){let[G,H]=a8($);if(G[u](J))if(S(H,Y))return;else Q=[[J,Y],...$.slice(1)];else Q=[[J,Y],...$]}else Q=[[J,Y]];X.set(Z,Q)},ZI=B(2,(X,{entries:J,forkAs:Z})=>{if(X.locals.size===0)return new xX(new Map(J));let Y=new Map(X.locals);if(Z!==void 0)eE(X,Y,Z);return J.forEach(([$,Q])=>{if(Q.length===1)_D(Y,Q[0][0],$,Q[0][1]);else Q.forEach(([G,H])=>{_D(Y,G,$,H)})}),new xX(Y)});var TD=$V,nZ=yX,YI=YV,$I=JI,PD=fZ,QI=ZI;var GI=tE;var HI="Empty",KI="Add",BI="Remove",VI="Update",WI="AndThen",UI={_tag:HI},d2=(X,J)=>{let Z=new Map(X.locals),Y=UI;for(let[$,Q]of J.locals.entries()){let G=a8(Q)[1],H=Z.get($);if(H!==void 0){let K=a8(H)[1];if(!S(K,G))Y=QV({_tag:VI,fiberRef:$,patch:$.diff(K,G)})(Y)}else Y=QV({_tag:KI,fiberRef:$,value:G})(Y);Z.delete($)}for(let[$]of Z.entries())Y=QV({_tag:BI,fiberRef:$})(Y);return Y},QV=B(2,(X,J)=>({_tag:WI,first:X,second:J})),GV=B(3,(X,J,Z)=>{let Y=Z,$=a(X);while(Q8($)){let Q=a8($),G=N6($);switch(Q._tag){case HI:{$=G;break}case KI:{Y=fZ(Y,{fiberId:J,fiberRef:Q.fiberRef,value:Q.value}),$=G;break}case BI:{Y=m2(Y,Q.fiberRef),$=G;break}case VI:{let H=yX(Y,Q.fiberRef);Y=fZ(Y,{fiberId:J,fiberRef:Q.fiberRef,value:Q.fiberRef.patch(Q.patch)(H)}),$=G;break}case WI:{$=u4(Q.first)(u4(Q.second)(G));break}}}return Y});var oZ=d2;var rZ=GV;var KV="effect/FiberStatus",G1=Symbol.for(KV),HV="Done",zI="Running",qI="Suspended",Fs=N8(`${KV}-${HV}`);class OI{[G1]=G1;_tag=HV;[f](){return Fs}[u](X){return BV(X)&&X._tag===HV}}class DI{runtimeFlags;[G1]=G1;_tag=zI;constructor(X){this.runtimeFlags=X}[f](){return U(F(KV),b(F(this._tag)),b(F(this.runtimeFlags)),D8(this))}[u](X){return BV(X)&&X._tag===zI&&this.runtimeFlags===X.runtimeFlags}}class AI{runtimeFlags;blockingOn;[G1]=G1;_tag=qI;constructor(X,J){this.runtimeFlags=X,this.blockingOn=J}[f](){return U(F(KV),b(F(this._tag)),b(F(this.runtimeFlags)),b(F(this.blockingOn)),D8(this))}[u](X){return BV(X)&&X._tag===qI&&this.runtimeFlags===X.runtimeFlags&&S(this.blockingOn,X.blockingOn)}}var _I=new OI,wI=(X)=>new DI(X),LI=(X,J)=>new AI(X,J),BV=(X)=>v(X,G1),TI=(X)=>X._tag===HV;var PI=_I,FD=wI,MI=LI;var FI=TI;var js=iO,RD=aO,jD=sO,CD=kB,ED=xB,ID=yB,SD=tO,Cs=eO,jI=yC;var Es=U(v7,YZ((X)=>X.ordinal));var vD=Oq(Es);var kD=(X)=>{switch(X){case"All":return js;case"Debug":return ID;case"Error":return jD;case"Fatal":return RD;case"Info":return ED;case"Trace":return SD;case"None":return Cs;case"Warning":return CD}};var Is=Symbol.for("effect/Micro"),UV=Symbol.for("effect/Micro/MicroExit");var CI=Symbol.for("effect/Micro/MicroCause");var Ss={_E:g};class bD extends globalThis.Error{_tag;traces;[CI];constructor(X,J,Z){let Y=`MicroCause.${X}`,$,Q,G;if(J instanceof globalThis.Error){$=`(${Y}) ${J.name}`,Q=J.message;let H=Q.split(`
`).length;G=J.stack?`(${Y}) ${J.stack.split(`
`).slice(0,H+3).join(`
`)}`:`${$}: ${Q}`}else $=Y,Q=O9(J,0),G=`${$}: ${Q}`;if(Z.length>0)G+=`
    ${Z.join(`
    `)}`;super(Q);this._tag=X,this.traces=Z,this[CI]=Ss,this.name=$,this.stack=G}pipe(){return C(this,arguments)}toString(){return this.stack}[T8](){return this.stack}}class SI extends bD{defect;constructor(X,J=[]){super("Die",X,J);this.defect=X}}var vs=(X,J=[])=>new SI(X,J);class vI extends bD{constructor(X=[]){super("Interrupt","interrupted",X)}}var ks=(X=[])=>new vI(X);var xs=(X)=>X._tag==="Interrupt";var EI=Symbol.for("effect/Micro/MicroFiber"),ys={_A:g,_E:g};class kI{context;interruptible;[EI];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(X,J=!0){this.context=X,this.interruptible=J,this[EI]=ys}getRef(X){return MR(this.context,X)}addObserver(X){if(this._exit)return X(this._exit),Y4;return this._observers.push(X),()=>{let J=this._observers.indexOf(X);if(J>=0)this._observers.splice(J,1)}}_interrupted=!1;unsafeInterrupt(){if(this._exit)return;if(this._interrupted=!0,this.interruptible)this.evaluate(cD)}unsafePoll(){return this._exit}evaluate(X){if(this._exit)return;else if(this._yielded!==void 0){let Y=this._yielded;this._yielded=void 0,Y()}let J=this.runLoop(X);if(J===WV)return;let Z=II.interruptChildren&&II.interruptChildren(this);if(Z!==void 0)return this.evaluate(zV(Z,()=>J));this._exit=J;for(let Y=0;Y<this._observers.length;Y++)this._observers[Y](J);this._observers.length=0}runLoop(X){let J=!1,Z=X;this.currentOpCount=0;try{while(!0){if(this.currentOpCount++,!J&&this.getRef(OV).shouldYield(this)){J=!0;let Y=Z;Z=zV(ds,()=>Y)}if(Z=Z[xD](this),Z===WV){let Y=this._yielded;if(UV in Y)return this._yielded=void 0,Y;return WV}}}catch(Y){if(!v(Z,xD))return yD(`MicroFiber.runLoop: Not a valid effect: ${String(Z)}`);return yD(Y)}}getCont(X){while(!0){let J=this._stack.pop();if(!J)return;let Z=J[NV]&&J[NV](this);if(Z)return{[X]:Z};if(J[X])return J}}_yielded=void 0;yieldWith(X){return this._yielded=X,WV}children(){return this._children??=new Set}}var II=X8("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0}));var xI=Symbol.for("effect/Micro/identifier"),A6=Symbol.for("effect/Micro/args"),xD=Symbol.for("effect/Micro/evaluate"),e$=Symbol.for("effect/Micro/successCont"),t$=Symbol.for("effect/Micro/failureCont"),NV=Symbol.for("effect/Micro/ensureCont"),WV=Symbol.for("effect/Micro/Yield"),bs={_A:g,_E:g,_R:g},gs={...oE,_op:"Micro",[Is]:bs,pipe(){return C(this,arguments)},[Symbol.iterator](){return new Z$(new BX(this))},toJSON(){return{_id:"Micro",op:this[xI],...A6 in this?{args:this[A6]}:void 0}},toString(){return S8(this)},[T8](){return S8(this)}};function hs(X){return yD("Micro.evaluate: Not implemented")}var qV=(X)=>({...gs,[xI]:X.op,[xD]:X.eval??hs,[e$]:X.contA,[t$]:X.contE,[NV]:X.ensure}),gD=(X)=>{let J=qV(X);return function(){let Z=Object.create(J);return Z[A6]=X.single===!1?arguments:arguments[0],Z}},yI=(X)=>{let J={...qV(X),[UV]:UV,_tag:X.op,get[X.prop](){return this[A6]},toJSON(){return{_id:"MicroExit",_tag:X.op,[X.prop]:this[A6]}},[u](Z){return ps(Z)&&Z._tag===X.op&&S(this[A6],Z[A6])},[f](){return D8(this,b(N8(X.op))(F(this[A6])))}};return function(Z){let Y=Object.create(J);return Y[A6]=Z,Y[e$]=void 0,Y[t$]=void 0,Y[NV]=void 0,Y}},hD=yI({op:"Success",prop:"value",eval(X){let J=X.getCont(e$);return J?J[e$](this[A6],X):X.yieldWith(this)}}),bI=yI({op:"Failure",prop:"cause",eval(X){let J=X.getCont(t$);while(xs(this[A6])&&J&&X.interruptible)J=X.getCont(t$);return J?J[t$](this[A6],X):X.yieldWith(this)}});var ms=gD({op:"Yield",eval(X){let J=!1;return X.getRef(OV).scheduleTask(()=>{if(J)return;X.evaluate(fs)},this[A6]??0),X.yieldWith(()=>{J=!0})}}),ds=ms(0);var cs=hD(void 0);var mD=gD({op:"WithMicroFiber",eval(X){return this[A6](X)}});var zV=B(2,(X,J)=>{let Z=Object.create(us);return Z[A6]=X,Z[e$]=J,Z}),us=qV({op:"OnSuccess",eval(X){return X._stack.push(this),this[A6]}});var ps=(X)=>v(X,UV),gI=hD,dD=bI,cD=dD(ks());var yD=(X)=>dD(vs(X));var fs=gI(void 0);var ns="setImmediate"in globalThis?globalThis.setImmediate:(X)=>setTimeout(X,0);class uD{tasks=[];running=!1;scheduleTask(X,J){if(this.tasks.push(X),!this.running)this.running=!0,ns(this.afterScheduled)}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let X=this.tasks;this.tasks=[];for(let J=0,Z=X.length;J<Z;J++)X[J]()}shouldYield(X){return X.currentOpCount>=X.getRef(mI)}flush(){while(this.tasks.length>0)this.runTasks()}}var os=B(2,(X,J)=>mD((Z)=>{let Y=Z.context;return Z.context=J(Y),is(X,()=>{return Z.context=Y,cs})}));var hI=B(2,(X,J)=>os(X,k5(J)));class mI extends AX()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class OV extends AX()("effect/Micro/currentScheduler",{defaultValue:()=>new uD}){}var rs=B(2,(X,J)=>{let Z=Object.create(ls);return Z[A6]=X,Z[e$]=J.onSuccess,Z[t$]=J.onFailure,Z}),ls=qV({op:"OnSuccessAndFailure",eval(X){return X._stack.push(this),this[A6]}});var is=B(2,(X,J)=>ss((Z)=>rs(Z(X),{onFailure:(Y)=>zV(J(dD(Y)),()=>bI(Y)),onSuccess:(Y)=>zV(J(gI(Y)),()=>hD(Y))})));var dI=gD({op:"SetInterruptible",ensure(X){if(X.interruptible=this[A6],X._interrupted&&X.interruptible)return()=>cD}}),as=(X)=>mD((J)=>{if(J.interruptible)return X;if(J.interruptible=!0,J._stack.push(dI(!1)),J._interrupted)return cD;return X}),ss=(X)=>mD((J)=>{if(!J.interruptible)return X(g);return J.interruptible=!1,J._stack.push(dI(!0)),X(as)});var cI=(X,J)=>{let Z=new kI(OV.context(J?.scheduler??new uD));if(Z.evaluate(X),J?.signal)if(J.signal.aborted)Z.unsafeInterrupt();else{let Y=()=>Z.unsafeInterrupt();J.signal.addEventListener("abort",Y,{once:!0}),Z.addObserver(()=>J.signal.removeEventListener("abort",Y))}return Z};var r5=Symbol.for("effect/Readable");var wH8={[r5]:r5,pipe(){return C(this,arguments)}};var AV=Symbol.for("effect/Ref"),pD={_A:(X)=>X};class pI extends a4{ref;commit(){return this.get}[AV]=pD;[r5]=r5;constructor(X){super();this.ref=X,this.get=T(()=>h0(this.ref))}get;modify(X){return T(()=>{let J=h0(this.ref),[Z,Y]=X(J);if(J!==Y)J5(Y)(this.ref);return Z})}}var XQ=(X)=>new pI(f4(X)),lZ=(X)=>T(()=>XQ(X)),_6=(X)=>X.get,B5=B(2,(X,J)=>X.modify(()=>[void 0,J])),fD=B(2,(X,J)=>X.modify((Z)=>[Z,J]));var _V=B(2,(X,J)=>X.modify(J));var H1=B(2,(X,J)=>X.modify((Z)=>[void 0,J(Z)])),nD=B(2,(X,J)=>X.modify((Z)=>{let Y=J(Z);return[Y,Y]}));var v6=lZ,k6=_6,oD=fD;var K1=_V;var JQ=B5;var l5=H1,rD=nD;class lD{buckets=[];scheduleTask(X,J){let Z=this.buckets.length,Y=void 0,$=0;for(;$<Z;$++)if(this.buckets[$][0]<=J)Y=this.buckets[$];else break;if(Y&&Y[0]===J)Y[1].push(X);else if($===Z)this.buckets.push([J,[X]]);else this.buckets.splice($,0,[J,[X]])}}class fI{maxNextTickBeforeTimer;running=!1;tasks=new lD;constructor(X){this.maxNextTickBeforeTimer=X}starveInternal(X){let J=this.tasks.buckets;this.tasks.buckets=[];for(let[Z,Y]of J)for(let $=0;$<Y.length;$++)Y[$]();if(this.tasks.buckets.length===0)this.running=!1;else this.starve(X)}starve(X=0){if(X>=this.maxNextTickBeforeTimer)setTimeout(()=>this.starveInternal(0),0);else Promise.resolve(void 0).then(()=>this.starveInternal(X+1))}shouldYield(X){return X.currentOpCount>X.getFiberRef(j2)?X.getFiberRef(I7):!1}scheduleTask(X,J){if(this.tasks.scheduleTask(X,J),!this.running)this.running=!0,this.starve()}}var nI=X8(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new fI(2048));class u2{tasks=new lD;deferred=!1;scheduleTask(X,J){if(this.deferred)nI.scheduleTask(X,J);else this.tasks.scheduleTask(X,J)}shouldYield(X){return X.currentOpCount>X.getFiberRef(j2)?X.getFiberRef(I7):!1}flush(){while(this.tasks.buckets.length>0){let X=this.tasks.buckets;this.tasks.buckets=[];for(let[J,Z]of X)for(let Y=0;Y<Z.length;Y++)Z[Y]()}this.deferred=!0}}var iZ=X8(Symbol.for("effect/FiberRef/currentScheduler"),()=>A0(nI)),oI=B(2,(X,J)=>N0(X,iZ,J));var LV=X8(Symbol.for("effect/FiberRef/currentRequestMap"),()=>A0(new Map));var iD=(X,J,Z,Y)=>{switch(X){case void 0:return J();case"unbounded":return Z();case"inherit":return S6(E2,($)=>$==="unbounded"?Z():$>1?Y($):J());default:return X>1?Y(X):J()}},p2=(X,J,Z)=>{switch(X){case void 0:return J();case"unbounded":return Z();case"inherit":return S6(E2,(Y)=>Y==="unbounded"||Y>1?Z():J());default:return X>1?Z():J()}};var aD=bE,TV=gE,rI=hE,lI=h2,iI=R9;var aI=(X,J)=>({label:X,startTime:J}),tD=(X)=>X.replace(/[\s="]/g,"_"),f2=(X)=>(J)=>{return`${tD(J.label)}=${X-J.startTime}ms`};var tI=aI;var XS=K5;var JS=XV;var ZS="effect/MetricLabel",XA=Symbol.for(ZS);class YS{key;value;[XA]=XA;_hash;constructor(X,J){this.key=X,this.value=J,this._hash=N8(ZS+this.key+this.value)}[f](){return this._hash}[u](X){return Gt(X)&&this.key===X.key&&this.value===X.value}pipe(){return C(this,arguments)}}var aZ=(X,J)=>{return new YS(X,J)},Gt=(X)=>v(X,XA);var $S=B((X)=>f8(X[0]),function(){let X=arguments;return O6(X[0],SX,typeof X[1]==="string"?n4(X[1],X[2]):(J)=>Object.entries(X[1]).reduce((Z,[Y,$])=>n4(Z,Y,$),J))}),ZQ=(X)=>I(X,D),QS=(X)=>rJ(X,D),ZA=(X)=>{let J,Z=void 0;if(typeof X==="function")J=X;else J=X.try,Z=X.catch;return h(()=>{try{return w(S0(J))}catch(Y){return R8(Z?S0(()=>Z(Y)):new p$(Y,"An unknown error occurred in Effect.try"))}})},GS=B(3,(X,J,Z)=>T9(X,(Y)=>{if(v(Y,J)&&Y[J]===Z.failure)return Z.onFailure(Y);return R8(Y)})),HS=B(2,(X,J)=>F7(X,(Z)=>{let Y=dJ(Z,($)=>PZ($)?D($):_());switch(Y._tag){case"None":return E8(Z);case"Some":return J(Y.value.defect)}})),KS=B(2,(X,J)=>H0(X,{onFailure:(Z)=>{let Y=J(Z);switch(Y._tag){case"None":return E8(Z);case"Some":return Y.value}},onSuccess:w})),BS=B(2,(X,J)=>F7(X,(Z)=>{let Y=dJ(Z,($)=>PZ($)?D($):_());switch(Y._tag){case"None":return E8(Z);case"Some":{let $=J(Y.value.defect);return $._tag==="Some"?$.value:E8(Z)}}})),VS=B((X)=>f8(X[0]),(X,...J)=>{let Z=J[J.length-1],Y;if(J.length===2)Y=a9(J[0]);else Y=($)=>{let Q=v($,"_tag")?$._tag:void 0;if(!Q)return!1;for(let G=0;G<J.length-1;G++)if(J[G]===Q)return!0;return!1};return T2(X,Y,Z)}),WS=B(2,(X,J)=>{let Z;return T2(X,(Y)=>{return Z??=Object.keys(J),v(Y,"_tag")&&G6(Y._tag)&&Z.includes(Y._tag)},(Y)=>J[Y._tag](Y))}),US=(X)=>P2(X,{onFailure:g,onSuccess:()=>r6}),y7=lI,NS=y7(w),zS=B(2,(X,J)=>j8(aD(J),X)),FV=(X)=>A8((J,Z)=>X({id:J.id(),status:Z,interruptors:FZ(J.getFiberRef(eJ))})),qS=FV((X)=>LX(X.interruptors)>0?M4:K8),OS=FV(w),YQ=(X)=>i2(X,RV,d2),Ht=(X)=>i2(X,IZ(RV,d$),([J,Z],[Y,$])=>[d2(J,Y),Z5(Z,$)]),DS=w({}),n2=DF(I,O),o2=OF(I),AS=qF(I),_S=B(2,(X,J)=>h(()=>{let Z=X[Symbol.iterator](),Y=[],$,Q=w(!1),G=0;while(($=Z.next())&&!$.done){let H=$.value,K=G++;Q=O(Q,(V)=>{if(V)return Y.push(H),w(!0);return J(H,K)})}return I(Q,()=>Y)})),wS=B(2,(X,J)=>h(()=>{let Z=X[Symbol.iterator](),Y=[],$,Q=w(!0),G=0;while(($=Z.next())&&!$.done){let H=$.value,K=G++;Q=O(Q,(V)=>I(V?J(H,K):w(!1),(W)=>{if(!W)Y.push(H);return W}))}return I(Q,()=>Y)})),LS=(X)=>I(F9(),X),YA=(X)=>CZ(X,()=>O(C7(),()=>YA(X))),TS=B(2,(X,J)=>I(i6(X,g),v5(J))),PS=B(3,(X,J,Z)=>r2(X,J,(Y)=>pJ(()=>Z(Y)))),MS=B(3,(X,J,Z)=>r2(X,J,()=>uJ(Z))),r2=B(3,(X,J,Z)=>O(X,(Y)=>J(Y)?w(Y):Z(Y))),FS=B(3,(X,J,Z)=>h(()=>J(X)?w(X):R8(Z(X)))),RS=B((X)=>f8(X[0]),(X,J,Z)=>r2(X,J,(Y)=>Z===void 0?R8(new R4):$5(()=>Z(Y)))),jS=B(2,(X,J)=>h(()=>{let Z=X[Symbol.iterator](),Y=Z.next();if(!Y.done)return CS(Z,0,J,Y.value);return w(_())})),CS=(X,J,Z,Y)=>O(Z(Y,J),($)=>{if($)return w(D(Y));let Q=X.next();if(!Q.done)return CS(X,J+1,Z,Q.value);return w(_())}),ES=(X)=>h(()=>{let J=H4(X);if(!q6(J))return pJ(()=>new u$("Received an empty collection of effects"));return U(K4(J),o6(E6(J),(Z,Y)=>CZ(Z,()=>Y)))}),IS=B(2,(X,J)=>oJ(J(oJ(X)))),l2=B(2,(X,J)=>H6(X,{onFailure:(Z)=>w(J.onFailure(Z)),onSuccess:(Z)=>w(J.onSuccess(Z))})),SS=B(2,(X,J)=>h(()=>vS(X[Symbol.iterator](),0,J))),vS=(X,J,Z)=>{let Y=X.next();return Y.done?w(!0):O(Z(Y.value,J),($)=>$?vS(X,J+1,Z):w($))},$A=(X)=>{let J=O(O(X,()=>C7()),()=>J);return J},RV=A8((X)=>w(X.getFiberRefs())),kS=(X)=>O(X,(J)=>{let Y=J[Symbol.iterator]().next();if(Y.done)return R8(new R4);return w(Y.value)}),jV=(X)=>l2(X,{onFailure:Y4,onSuccess:Y4}),xS=(X)=>H0(X,{onFailure:(J)=>GA(J,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>K8}),yS=(X)=>EV((J,Z)=>YI(Z,J,X)),bS=(X)=>l2(X,{onFailure:b4,onSuccess:W6}),gS=(X)=>l2(X,{onFailure:W6,onSuccess:b4}),QA=(X,J)=>h(()=>{if(J.while(X))return O(J.body(X),(Z)=>QA(Z,J));return w(X)}),gX=(X)=>(...J)=>{let Z=Y0(X),Y=void 0;for(let $=0,Q=J.length;$<Q;$++){let G=J[$];if(U2(G)){if(Y!==void 0)Y=Q0(Y,G);else Y=G;J=[...J.slice(0,$),...J.slice($+1)],$--}}if(Y===void 0)Y=r6;return A8(($)=>{return $.log(J,Y,Z),K8})},hS=gX(),mS=gX(SD),GA=gX(ID),dS=gX(ED),cS=gX(CD),uS=gX(jD),pS=gX(RD),fS=B(2,(X,J)=>O(TV,(Z)=>O6(X,C2,$B(tI(J,Z))))),nS=i4(SX),oS=(X,J)=>J.discard?lS(X,J.while,J.step,J.body):I(rS(X,J.while,J.step,J.body),J8),rS=(X,J,Z,Y)=>h(()=>J(X)?O(Y(X),($)=>I(rS(Z(X),J,Z,Y),$B($))):T(()=>P7())),lS=(X,J,Z,Y)=>h(()=>J(X)?O(Y(X),()=>lS(Z(X),J,Z,Y)):K8),iS=B(3,(X,J,Z)=>h(()=>{let Y=X[Symbol.iterator](),$=[],Q=w(J),G,H=0;while(!(G=Y.next()).done){let K=H++,V=G.value;Q=O(Q,(W)=>I(Z(W,V,K),([N,z])=>{return $.push(z),N}))}return I(Q,(K)=>[K,$])})),$Q=B(2,(X,J)=>H0(X,{onFailure:(Z)=>fJ(()=>J(Z)),onSuccess:w})),HA=(X)=>U(W4(),O((J)=>U(Ht(X),j7(J),KA,I((Z)=>j8(Z,U(m0(J),O(([Y,$])=>s8(IZ(sZ(Y[0]),lJ(Y[1])),$)))))))),aS=(X)=>H6(X,{onFailure:(J)=>w(J),onSuccess:w}),CV=(X)=>I(X,(J)=>!J),sS=(X)=>O(X,(J)=>{switch(J._tag){case"None":return K8;case"Some":return R8(new R4)}}),KA=(X)=>I(v6(!0),(J)=>W0(iJ(X,oD(J,!1)))),tS=(X)=>H6(X,{onFailure:()=>w(_()),onSuccess:(J)=>w(D(J))}),eS=B(2,(X,J)=>CZ(X,()=>$5(J))),Xv=B(2,(X,J)=>CZ(X,()=>T(J))),Jv=(X)=>H0(X,{onFailure:(J)=>{let Z=J8(z2(J));return Z.length===0?E8(J):R8(Z)},onSuccess:w}),sZ=(X)=>EV((J,Z)=>U(X,GV(J,Z))),Zv=(X)=>X.length>=1?B4((J,Z)=>{try{X(Z).then((Y)=>J(w(Y)),(Y)=>J(P4(Y)))}catch(Y){J(P4(Y))}}):B4((J)=>{try{X().then((Z)=>J(w(Z)),(Z)=>J(P4(Z)))}catch(Z){J(P4(Z))}}),B1=B(3,(X,J,Z)=>Q5((Y)=>o5(X,$0(Y,J,Z)))),V1=B(3,(X,J,Z)=>Q5((Y)=>O(Z,($)=>o5(X,U(Y,$0(J,$)))))),Yv=eB(w),$v=B(3,(X,J,Z)=>J8(X).reduce((Y,$,Q)=>O(Y,(G)=>Z(G,$,Q)),w(J))),Qv=B(3,(X,J,Z)=>J8(X).reduceRight((Y,$,Q)=>O(Y,(G)=>Z($,G,Q)),w(J))),Gv=B(3,(X,J,Z)=>O(T(()=>X[Symbol.iterator]()),(Y)=>Hv(Y,0,J,Z.while,Z.body))),Hv=(X,J,Z,Y,$)=>{let Q=X.next();if(!Q.done&&Y(Z))return O($(Z,Q.value,J),(G)=>Hv(X,J+1,G,Y,$));return w(Z)},Kv=B(2,(X,J)=>h(()=>Bv(X,J))),Bv=(X,J)=>O(X,(Z)=>J<=0?w(Z):j8(C7(),Bv(X,J-1))),Vv=(X)=>H0(X,{onFailure:R8,onSuccess:w}),Wv=(X)=>h(()=>$I(X)),hX=aD,tZ=w(_()),Uv=(X)=>w(D(X)),i2=B(3,(X,J,Z)=>O(J,(Y)=>O(X,($)=>I(J,(Q)=>[Z(Y,Q),$])))),Nv=B((X)=>f8(X[0]),function(){return BA(arguments[0],typeof arguments[1]==="string"?[aZ(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([X,J])=>aZ(X,J)))}),BA=B(2,(X,J)=>O6(X,S7,(Z)=>S5(Z,J))),zv=B(2,(X,J)=>h(()=>{let Z=X[Symbol.iterator](),Y=[],$,Q=w(!1),G=0;while(($=Z.next())&&!$.done){let H=$.value,K=G++;Q=O(Q,(V)=>{if(V)return w(!0);return Y.push(H),J(H,K)})}return I(Q,()=>Y)})),qv=B(2,(X,J)=>h(()=>{let Z=X[Symbol.iterator](),Y=[],$,Q=w(!0),G=0;while(($=Z.next())&&!$.done){let H=$.value,K=G++;Q=O(Q,(V)=>U(V?J(H,K):w(!1),I((W)=>{if(W)Y.push(H);return W})))}return I(Q,()=>Y)})),Ov=B(2,(X,{onFailure:J,onSuccess:Z})=>H0(X,{onFailure:(Y)=>{let $=u5(Y);switch($._tag){case"Left":return j8(J($.left),E8(Y));case"Right":return E8(Y)}},onSuccess:(Y)=>s8(Z(Y),Y)})),Dv=B(2,(X,J)=>F7(X,(Z)=>n(yO(Z),{onNone:()=>E8(Z),onSome:(Y)=>j8(J(Y),E8(Z))}))),VA=B(2,(X,J)=>H0(X,{onFailure:(Z)=>{let Y=u5(Z);switch(Y._tag){case"Left":return j8(J(Y.left),E8(Z));case"Right":return E8(Z)}},onSuccess:w})),Av=B(3,(X,J,Z)=>VA(X,(Y)=>{if(a9(Y,J))return Z(Y);return K8})),_v=B(2,(X,J)=>H0(X,{onFailure:(Z)=>j8(J(Z),E8(Z)),onSuccess:w})),wv=(X)=>WA(X,rI),WA=B(2,(X,J)=>i2(X,J,(Z,Y)=>aG(Y-Z))),Kt=JS,Lv=Kt(w),UA=(X)=>{let J,Z=void 0;if(typeof X==="function")J=X;else J=X.try,Z=X.catch;let Y=($)=>Z?$5(()=>Z($)):R8(new p$($,"An unknown error occurred in Effect.tryPromise"));if(J.length>=1)return B4(($,Q)=>{try{J(Q).then((G)=>$(w(G)),(G)=>$(Y(G)))}catch(G){$(Y(G))}});return B4(($)=>{try{J().then((Q)=>$(w(Q)),(Q)=>$(Y(Q)))}catch(Q){$(Y(Q))}})},Tv=B(2,(X,J)=>O(X,(Z)=>ZA({try:()=>J.try(Z),catch:J.catch}))),Pv=B(2,(X,J)=>O(X,(Z)=>UA({try:J.try.length>=1?(Y)=>J.try(Z,Y):()=>J.try(Z),catch:J.catch}))),Mv=B(2,(X,J)=>h(()=>J()?tZ:ZQ(X))),Fv=B(2,(X,J)=>O(J,(Z)=>Z?tZ:ZQ(X))),Rv=(X)=>$Q(X,gO),EV=(X)=>A8((J)=>{return J.setFiberRefs(X(J.id(),J.getFiberRefs())),K8}),jv=B(3,(X,J,Z)=>mZ(X,(Y)=>$0(Y,J,Z(CJ(Y,J))))),IV=B(2,(X,J)=>h(()=>J()?I(X,D):w(_()))),Cv=B(3,(X,J,Z)=>O(i4(J),(Y)=>Z(Y)?I(X,($)=>[Y,D($)]):w([Y,_()]))),Ev=B(3,(X,J,Z)=>O(k6(J),(Y)=>Z(Y)?I(X,($)=>[Y,D($)]):w([Y,_()]))),Iv=B(2,(X,J)=>J(X)),Sv=(X,J)=>(...Z)=>O(X,(Y)=>J(Y)(...Z)),vv=(X,J)=>(...Z)=>I(X,(Y)=>J(Y)(...Z)),NA=(X)=>new Proxy({},{get(J,Z,Y){return(...$)=>O(X,(Q)=>Q[Z](...$))}}),zA=(X)=>new Proxy({},{get(J,Z,Y){return O(X,($)=>f8($[Z])?$[Z]:w($[Z]))}}),kv=(X)=>({functions:NA(X),constants:zA(X)}),xv=(X)=>I(F9(),w4(X)),qA=(X)=>O(F9(),w4(X)),yv=function(){let X=arguments;return jV(O(SV,(J)=>T(()=>{if(typeof X[0]==="string")J.attribute(X[0],X[1]);else for(let Z in X[0])J.attribute(Z,X[0][Z])})))},bv=function(){let X=arguments,J=Array.isArray(X[0])?X[0]:[{_tag:"SpanLink",span:X[0],attributes:X[1]??{}}];return jV(O(SV,(Z)=>T(()=>Z.addLinks(J))))},gv=B((X)=>f8(X[0]),function(){let X=arguments;return O6(X[0],c$,typeof X[1]==="string"?n4(X[1],X[2]):(J)=>Object.entries(X[1]).reduce((Z,[Y,$])=>n4(Z,Y,$),J))}),hv=qA(K5),SV=O(F9(),(X)=>{let J=X.unsafeMap.get(K5.key);return J!==void 0&&J._tag==="Span"?w(J):R8(new R4)}),mv=B((X)=>f8(X[0]),(X,J,Z)=>O6(X,I2,_X({_tag:"SpanLink",span:J,attributes:Z??{}}))),dv=BigInt(0),cv=C6((X)=>z6(X.context,uZ)?X._tag==="Span"?cv(X.parent):_():D(X)),vV=(X,J,Z)=>{let Y=!X.getFiberRef(mB)||Z.context&&z6(Z.context,uZ),$=X.getFiberRef(D6),Q=Z.parent?D(Z.parent):Z.root?_():cv(w4($,K5)),G;if(Y)G=YE({name:J,parent:Q,context:$0(Z.context??D9(),uZ,!0)});else{let H=X.getFiberRef(_0),K=z6(H,k7),V=z6(H,iI),W=X.getFiberRef(kZ),N=X.getFiberRefs(),z=TD(N,c$),q=TD(N,I2),A=q._tag==="Some"?Z.links!==void 0?[...G4(q.value),...Z.links??[]]:G4(q.value):Z.links??t();if(G=K.span(J,Q,Z.context??D9(),A,W?V.unsafeCurrentTimeNanos():dv,Z.kind??"internal",Z),z._tag==="Some")xj(z.value,(E,P)=>G.attribute(P,E));if(Z.attributes!==void 0)Object.entries(Z.attributes).forEach(([E,P])=>G.attribute(E,P))}if(typeof Z.captureStackTrace==="function")D2.set(G,Z.captureStackTrace);return G},uv=(X,J)=>{return J=kX(J),A8((Z)=>w(vV(Z,X,J)))},pv=i4(c$),fv=i4(I2),OA=(X,J,Z,Y)=>T(()=>{if(X.status._tag==="Ended")return;if(uB(J)&&D2.has(X))X.attribute("code.stacktrace",D2.get(X)());X.end(Y?Z.unsafeCurrentTimeNanos():dv,J)}),PV=(X,...J)=>{let Z=kX(J.length===1?void 0:J[0]),Y=J[J.length-1];return A8(($)=>{let Q=vV($,X,Z),G=$.getFiberRef(kZ),H=z6($.getFiberRef(_0),R9);return F4(Y(Q),(K)=>OA(Q,K,H,G))})},MV=B(2,(X,J)=>B1(X,K5,J)),DA=function(){let X=typeof arguments[0]!=="string",J=X?arguments[1]:arguments[0],Z=kX(X?arguments[2]:arguments[1]);if(X){let Y=arguments[0];return PV(J,Z,($)=>MV(Y,$))}return(Y)=>PV(J,Z,($)=>MV(Y,$))},nv=(X)=>function(){let J=X.captureStackTrace??!1;if(X.captureStackTrace!==!1){let Z=Error.stackTraceLimit;Error.stackTraceLimit=2;let Y=Error();Error.stackTraceLimit=Z;let $=!1;J=()=>{if($!==!1)return $;if(Y.stack)return $=Y.stack.trim().split(`
`).slice(2).join(`
`).trim(),$}}return h(()=>{let Z=typeof X.options==="function"?X.options.apply(null,arguments):X.options;return DA(h(()=>S0(()=>X.body.apply(this,arguments))),Z.name,{...Z,captureStackTrace:J})})},ov=(X)=>X==null?R8(new R4):w(X),rv=(X)=>T9(I(X,D),(J)=>$D(J)?tZ:R8(J));var V5=uB,a2=x2;var lv=J1,kV=pB;var W1=vX,w6=g8;var iv=iC;var AA=A2,_A=aC;var s4=bZ;var x6=m8,b7=M0;var wA=sC;var XY=nB;var LA="InterruptSignal",TA="Stateful",PA="Resume",MA="YieldNow",xV=(X)=>({_tag:"InterruptSignal",cause:X}),QQ=(X)=>({_tag:"Stateful",onFiber:X}),JY=(X)=>({_tag:"Resume",effect:X}),av=()=>({_tag:"YieldNow"});var Bt="effect/FiberScope",yV=Symbol.for(Bt);class tv{[yV]=yV;fiberId=I6;roots=new Set;add(X,J){this.roots.add(J),J.addObserver(()=>{this.roots.delete(J)})}}class ev{fiberId;parent;[yV]=yV;constructor(X,J){this.fiberId=X,this.parent=J}add(X,J){this.parent.tell(QQ((Z)=>{Z.addChild(J),J.addObserver(()=>{Z.removeChild(J)})}))}}var Xk=(X)=>{return new ev(X.id(),X)},mX=X8(Symbol.for("effect/FiberScope/Global"),()=>new tv);var Vt="effect/Fiber",GQ=Symbol.for(Vt),s2={_E:(X)=>X,_A:(X)=>X},Wt={[GQ]:s2,pipe(){return C(this,arguments)}},Ut="effect/Fiber",bV=Symbol.for(Ut);var FA=(X)=>(bV in X),gV=(X)=>X.await;var hV=(X)=>X.inheritAll;var mV=B(2,SB(function*(X,J){for(let Z of X){if(FA(Z)){Z.unsafeInterruptAsFork(J);continue}yield*Z.interruptAsFork(J)}for(let Z of X){if(FA(Z)&&Z.unsafePoll())continue;yield*Z.await}})),RA=B(2,(X,J)=>X.interruptAsFork(J)),j9=(X)=>SZ(r4(X.await),X.inheritAll);var aH8={...E5,commit(){return j9(this)},...Wt,id:()=>I6,await:vZ,children:w([]),inheritAll:vZ,poll:w(_()),interruptAsFork:()=>vZ};var U1="effect/FiberCurrent";var Nt="effect/Logger",CA=Symbol.for(Nt),Zk={_Message:(X)=>X,_Output:(X)=>X},ZY=(X)=>({[CA]:Zk,log:X,pipe(){return C(this,arguments)}});var zt={[CA]:Zk,log:Y4,pipe(){return C(this,arguments)}};var qt=/^[^\s"=]*$/,Ot=(X,J)=>({annotations:Z,cause:Y,date:$,fiberId:Q,logLevel:G,message:H,spans:K})=>{let V=(A)=>A.match(qt)?A:X(A),W=(A,E)=>`${tD(A)}=${V(E)}`,N=(A,E)=>" "+W(A,E),z=W("timestamp",$.toISOString());z+=N("level",G.label),z+=N("fiber",E$(Q));let q=uG(H);for(let A=0;A<q.length;A++)z+=N("message",O9(q[A],J));if(!xO(Y))z+=N("cause",L9(Y,{renderErrorCause:!0}));for(let A of K)z+=" "+f2($.getTime())(A);for(let[A,E]of Z)z+=N(A,O9(E,J));return z},Dt=(X)=>`"${X.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,EA=ZY(Ot(Dt));var Yk=(X)=>{switch(typeof X){case"bigint":case"function":case"symbol":return String(X);default:return v8(X)}};var At=(X,...J)=>{let Z="";for(let Y=0;Y<J.length;Y++)Z+=`\x1B[${J[Y]}m`;return Z+X+"\x1B[0m"},_t=(X,...J)=>X,W5={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},wt={None:[],All:[],Trace:[W5.gray],Debug:[W5.blue],Info:[W5.green],Warning:[W5.yellow],Error:[W5.red],Fatal:[W5.bgBrightRed,W5.black]},Lt={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},Tt=(X)=>`${X.getHours().toString().padStart(2,"0")}:${X.getMinutes().toString().padStart(2,"0")}:${X.getSeconds().toString().padStart(2,"0")}.${X.getMilliseconds().toString().padStart(3,"0")}`,$k=typeof process==="object"&&process!==null&&typeof process.stdout==="object"&&process.stdout!==null,Pt=$k&&process.stdout.isTTY===!0,Mt=$k||"Deno"in globalThis,Qk=(X)=>{let J=X?.mode??"auto",Y=(J==="auto"?Mt?"tty":"browser":J)==="browser",$=typeof X?.colors==="boolean"?X.colors:Pt||Y,Q=X?.formatDate??Tt;return Y?Rt({colors:$,formatDate:Q}):Ft({colors:$,formatDate:Q,stderr:X?.stderr===!0})},Ft=(X)=>{let J=X.colors?At:_t;return ZY(({annotations:Z,cause:Y,context:$,date:Q,fiberId:G,logLevel:H,message:K,spans:V})=>{let W=nZ($,_0),N=z6(W,H5).unsafe,z=X.stderr===!0?N.error:N.log,q=uG(K),A=J(`[${X.formatDate(Q)}]`,W5.white)+` ${J(H.label,...wt[H._tag])} (${E$(G)})`;if(k$(V)){let P=Q.getTime(),M=f2(P);for(let c of V)A+=" "+M(c)}A+=":";let E=0;if(q.length>0){let P=Yk(q[0]);if(typeof P==="string")A+=" "+J(P,W5.bold,W5.cyan),E++}if(z(A),N.group(),!b$(Y))z(L9(Y,{renderErrorCause:!0}));if(E<q.length)for(;E<q.length;E++)z($$(q[E]));if(YO(Z)>0)for(let[P,M]of Z)z(J(`${P}:`,W5.bold,W5.white),$$(M));N.groupEnd()})},Rt=(X)=>{let J=X.colors?"%c":"";return ZY(({annotations:Z,cause:Y,context:$,date:Q,fiberId:G,logLevel:H,message:K,spans:V})=>{let W=nZ($,_0),N=z6(W,H5).unsafe,z=uG(K),q=`${J}[${X.formatDate(Q)}]`,A=[];if(X.colors)A.push("color:gray");if(q+=` ${J}${H.label}${J} (${E$(G)})`,X.colors)A.push(Lt[H._tag],"");if(k$(V)){let P=Q.getTime(),M=f2(P);for(let c of V)q+=" "+M(c)}q+=":";let E=0;if(z.length>0){let P=Yk(z[0]);if(typeof P==="string"){if(q+=` ${J}${P}`,X.colors)A.push("color:deepskyblue");E++}}if(N.groupCollapsed(q,...A),!b$(Y))N.error(L9(Y,{renderErrorCause:!0}));if(E<z.length)for(;E<z.length;E++)N.log($$(z[E]));if(YO(Z)>0)for(let[P,M]of Z){let c=$$(M);if(X.colors)N.log(`%c${P}:`,"color:gray",c);else N.log(`${P}:`,c)}N.groupEnd()})},IA=X8("effect/Logger/prettyLoggerDefault",()=>Qk());var Hk="effect/MetricBoundaries",SA=Symbol.for(Hk);class Kk{values;[SA]=SA;constructor(X){this.values=X,this._hash=U(N8(Hk),b(q9(this.values)))}_hash;[f](){return this._hash}[u](X){return jt(X)&&S(this.values,X.values)}pipe(){return C(this,arguments)}}var jt=(X)=>v(X,SA),Ct=(X)=>{let J=U(X,O8(I8(Number.POSITIVE_INFINITY)),Fq);return new Kk(J)};var Bk=(X)=>U(LK(X.count-1,(J)=>X.start*Math.pow(X.factor,J)),b0,Ct);var It="effect/MetricKeyType",Vk=Symbol.for(It),Wk="effect/MetricKeyType/Counter",vA=Symbol.for(Wk),St="effect/MetricKeyType/Frequency",vt=Symbol.for(St),kt="effect/MetricKeyType/Gauge",xt=Symbol.for(kt),Uk="effect/MetricKeyType/Histogram",kA=Symbol.for(Uk),yt="effect/MetricKeyType/Summary",bt=Symbol.for(yt),Nk={_In:(X)=>X,_Out:(X)=>X};class zk{incremental;bigint;[Vk]=Nk;[vA]=vA;constructor(X,J){this.incremental=X,this.bigint=J,this._hash=N8(Wk)}_hash;[f](){return this._hash}[u](X){return xA(X)}pipe(){return C(this,arguments)}}class qk{boundaries;[Vk]=Nk;[kA]=kA;constructor(X){this.boundaries=X,this._hash=U(N8(Uk),b(F(this.boundaries)))}_hash;[f](){return this._hash}[u](X){return yA(X)&&S(this.boundaries,X.boundaries)}pipe(){return C(this,arguments)}}var Ok=(X)=>new zk(X?.incremental??!1,X?.bigint??!1);var Dk=(X)=>{return new qk(X)};var xA=(X)=>v(X,vA),Ak=(X)=>v(X,vt),_k=(X)=>v(X,xt),yA=(X)=>v(X,kA),wk=(X)=>v(X,bt);var gt="effect/MetricKey",Tk=Symbol.for(gt),ht={_Type:(X)=>X},mt=jJ(S);class dV{name;keyType;description;tags;[Tk]=ht;constructor(X,J,Z,Y=[]){this.name=X,this.keyType=J,this.description=Z,this.tags=Y,this._hash=U(N8(this.name+this.description),b(F(this.keyType)),b(q9(this.tags)))}_hash;[f](){return this._hash}[u](X){return dt(X)&&this.name===X.name&&S(this.keyType,X.keyType)&&S(this.description,X.description)&&mt(this.tags,X.tags)}pipe(){return C(this,arguments)}}var dt=(X)=>v(X,Tk),Pk=(X,J)=>new dV(X,Ok(J),Y0(J?.description));var Mk=(X,J,Z)=>new dV(X,Dk(J),Y0(Z));var Fk=B(2,(X,J)=>J.length===0?X:new dV(X.name,X.keyType,X.description,S5(X.tags,J)));var Rk=Symbol.for("effect/MutableHashMap"),ut={[Rk]:Rk,[Symbol.iterator](){return new bA(this)},toString(){return S8(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(v8)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}};class bA{self;referentialIterator;bucketIterator;constructor(X){this.self=X,this.referentialIterator=X.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let X=this.referentialIterator.next();if(X.done)return this.bucketIterator=new jk(this.self.buckets.values()),this.next();return X}[Symbol.iterator](){return new bA(this.self)}}class jk{backing;constructor(X){this.backing=X}currentBucket;next(){if(this.currentBucket===void 0){let J=this.backing.next();if(J.done)return J;this.currentBucket=J.value[Symbol.iterator]()}let X=this.currentBucket.next();if(X.done)return this.currentBucket=void 0,this.next();return X}}var YY=()=>{let X=Object.create(ut);return X.referential=new Map,X.buckets=new Map,X.bucketsSize=0,X};var Y6=B(2,(X,J)=>{if(Y$(J)===!1)return X.referential.has(J)?D(X.referential.get(J)):_();let Z=J[f](),Y=X.buckets.get(Z);if(Y===void 0)return _();return pt(X,Y,J)});var pt=(X,J,Z,Y=!1)=>{for(let $=0,Q=J.length;$<Q;$++)if(Z[u](J[$][0])){let G=J[$][1];if(Y)J.splice($,1),X.bucketsSize--;return D(G)}return _()},i5=B(2,(X,J)=>H8(Y6(X,J))),t4=B(3,(X,J,Z)=>{if(Y$(J)===!1)return X.referential.set(J,Z),X;let Y=J[f](),$=X.buckets.get(Y);if($===void 0)return X.buckets.set(Y,[[J,Z]]),X.bucketsSize++,X;return Ck(X,$,J),$.push([J,Z]),X.bucketsSize++,X}),Ck=(X,J,Z)=>{for(let Y=0,$=J.length;Y<$;Y++)if(Z[u](J[Y][0])){J.splice(Y,1),X.bucketsSize--;return}};var $Y=B(2,(X,J)=>{if(Y$(J)===!1)return X.referential.delete(J),X;let Z=J[f](),Y=X.buckets.get(Z);if(Y===void 0)return X;if(Ck(X,Y,J),Y.length===0)X.buckets.delete(Z);return X});var cV=(X)=>{return X.referential.size+X.bucketsSize};var ft="effect/MetricState",t2=Symbol.for(ft),Ek="effect/MetricState/Counter",gA=Symbol.for(Ek),Ik="effect/MetricState/Frequency",hA=Symbol.for(Ik),Sk="effect/MetricState/Gauge",mA=Symbol.for(Sk),vk="effect/MetricState/Histogram",dA=Symbol.for(vk),kk="effect/MetricState/Summary",cA=Symbol.for(kk),e2={_A:(X)=>X};class xk{count;[t2]=e2;[gA]=gA;constructor(X){this.count=X}[f](){return U(F(Ek),b(F(this.count)),D8(this))}[u](X){return ot(X)&&this.count===X.count}pipe(){return C(this,arguments)}}var nt=jJ(S);class yk{occurrences;[t2]=e2;[hA]=hA;constructor(X){this.occurrences=X}_hash;[f](){return U(N8(Ik),b(q9(J8(this.occurrences.entries()))),D8(this))}[u](X){return rt(X)&&nt(J8(this.occurrences.entries()),J8(X.occurrences.entries()))}pipe(){return C(this,arguments)}}class bk{value;[t2]=e2;[mA]=mA;constructor(X){this.value=X}[f](){return U(F(Sk),b(F(this.value)),D8(this))}[u](X){return lt(X)&&this.value===X.value}pipe(){return C(this,arguments)}}class gk{buckets;count;min;max;sum;[t2]=e2;[dA]=dA;constructor(X,J,Z,Y,$){this.buckets=X,this.count=J,this.min=Z,this.max=Y,this.sum=$}[f](){return U(F(vk),b(F(this.buckets)),b(F(this.count)),b(F(this.min)),b(F(this.max)),b(F(this.sum)),D8(this))}[u](X){return it(X)&&S(this.buckets,X.buckets)&&this.count===X.count&&this.min===X.min&&this.max===X.max&&this.sum===X.sum}pipe(){return C(this,arguments)}}class hk{error;quantiles;count;min;max;sum;[t2]=e2;[cA]=cA;constructor(X,J,Z,Y,$,Q){this.error=X,this.quantiles=J,this.count=Z,this.min=Y,this.max=$,this.sum=Q}[f](){return U(F(kk),b(F(this.error)),b(F(this.quantiles)),b(F(this.count)),b(F(this.min)),b(F(this.max)),b(F(this.sum)),D8(this))}[u](X){return at(X)&&this.error===X.error&&S(this.quantiles,X.quantiles)&&this.count===X.count&&this.min===X.min&&this.max===X.max&&this.sum===X.sum}pipe(){return C(this,arguments)}}var mk=(X)=>new xk(X),dk=(X)=>{return new yk(X)},ck=(X)=>new bk(X),uk=(X)=>new gk(X.buckets,X.count,X.min,X.max,X.sum),pk=(X)=>new hk(X.error,X.quantiles,X.count,X.min,X.max,X.sum);var ot=(X)=>v(X,gA),rt=(X)=>v(X,hA),lt=(X)=>v(X,mA),it=(X)=>v(X,dA),at=(X)=>v(X,cA);var tt="effect/MetricHook",et=Symbol.for(tt),Xe={_In:(X)=>X,_Out:(X)=>X},X3=(X)=>({[et]:Xe,pipe(){return C(this,arguments)},...X});var fk=BigInt(0),ok=(X)=>{let J=X.keyType.bigint?fk:0,Z=X.keyType.incremental?X.keyType.bigint?($)=>$>=fk:($)=>$>=0:($)=>!0,Y=($)=>{if(Z($))J=J+$};return X3({get:()=>mk(J),update:Y,modify:Y})},rk=(X)=>{let J=new Map;for(let Y of X.keyType.preregisteredWords)J.set(Y,0);let Z=(Y)=>{let $=J.get(Y)??0;J.set(Y,$+1)};return X3({get:()=>dk(J),update:Z,modify:Z})},lk=(X,J)=>{let Z=J;return X3({get:()=>ck(Z),update:(Y)=>{Z=Y},modify:(Y)=>{Z=Z+Y}})},ik=(X)=>{let J=X.keyType.boundaries.values,Z=J.length,Y=new Uint32Array(Z+1),$=new Float64Array(Z),Q=0,G=0,H=Number.MAX_VALUE,K=Number.MIN_VALUE;U(J,p4(v7),r((N,z)=>{$[z]=N}));let V=(N)=>{let z=0,q=Z;while(z!==q){let A=Math.floor(z+(q-z)/2),E=$[A];if(N<=E)q=A;else z=A;if(q===z+1)if(N<=$[z])q=z;else z=q}if(Y[z]=Y[z]+1,Q=Q+1,G=G+N,N<H)H=N;if(N>K)K=N},W=()=>{let N=NX(Z),z=0;for(let q=0;q<Z;q++){let A=$[q],E=Y[q];z=z+E,N[q]=[A,z]}return N};return X3({get:()=>uk({buckets:W(),count:Q,min:H,max:K,sum:G}),update:V,modify:V})},ak=(X)=>{let{error:J,maxAge:Z,maxSize:Y,quantiles:$}=X.keyType,Q=U($,p4(v7)),G=NX(Y),H=0,K=0,V=0,W=0,N=0,z=(A)=>{let E=[],P=0;while(P!==Y-1){let M=G[P];if(M!=null){let[c,y]=M,s=w7(A-c);if(dq(s,EJ)&&uR(s,Z))E.push(y)}P=P+1}return Je(J,Q,p4(E,v7))},q=(A,E)=>{if(Y>0){H=H+1;let P=H%Y;G[P]=[E,A]}W=K===0?A:Math.min(W,A),N=K===0?A:Math.max(N,A),K=K+1,V=V+A};return X3({get:()=>pk({error:J,quantiles:z(Date.now()),count:K,min:W,max:N,sum:V}),update:([A,E])=>q(A,E),modify:([A,E])=>q(A,E)})},Je=(X,J,Z)=>{let Y=Z.length;if(!Q8(J))return t();let $=J[0],Q=J.slice(1),G=nk(X,Y,_(),0,$,Z),H=a(G);return Q.forEach((K)=>{H.push(nk(X,Y,G.value,G.consumed,K,G.rest))}),r(H,(K)=>[K.quantile,K.value])},nk=(X,J,Z,Y,$,Q)=>{let G=X,H=J,K=Z,V=Y,W=$,N=Q,z=X,q=J,A=Z,E=Y,P=$,M=Q;while(!0){if(!Q8(N))return{quantile:W,value:_(),consumed:V,rest:[]};if(W===1)return{quantile:W,value:D(TK(N)),consumed:V+N.length,rest:[]};let c=a8(N),y=QZ(N,(P8)=>P8===c),s=W*H,Y8=G/2*s,l=V+y[0].length,G8=Math.abs(l-s);if(l<s-Y8){z=G,q=H,A=Q4(N),E=l,P=W,M=y[1],G=z,H=q,K=A,V=E,W=P,N=M;continue}if(l>s+Y8){let P8=p8(K)?D(c):K;return{quantile:W,value:P8,consumed:V,rest:N}}switch(K._tag){case"None":{z=G,q=H,A=Q4(N),E=l,P=W,M=y[1],G=z,H=q,K=A,V=E,W=P,N=M;continue}case"Some":{let P8=Math.abs(s-K.value);if(G8<P8){z=G,q=H,A=Q4(N),E=l,P=W,M=y[1],G=z,H=q,K=A,V=E,W=P,N=M;continue}return{quantile:W,value:D(K.value),consumed:V,rest:N}}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var Ye="effect/MetricPair",$e=Symbol.for(Ye),Qe={_Type:(X)=>X};var sk=(X,J)=>{return{[$e]:Qe,metricKey:X,metricState:J,pipe(){return C(this,arguments)}}};var He="effect/MetricRegistry",tk=Symbol.for(He);class ek{[tk]=tk;map=YY();snapshot(){let X=[];for(let[J,Z]of this.map)X.push(sk(J,Z.get()));return X}get(X){let J=U(this.map,Y6(X),e0);if(J==null){if(xA(X.keyType))return this.getCounter(X);if(_k(X.keyType))return this.getGauge(X);if(Ak(X.keyType))return this.getFrequency(X);if(yA(X.keyType))return this.getHistogram(X);if(wk(X.keyType))return this.getSummary(X);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return J}getCounter(X){let J=U(this.map,Y6(X),e0);if(J==null){let Z=ok(X);if(!U(this.map,i5(X)))U(this.map,t4(X,Z));J=Z}return J}getFrequency(X){let J=U(this.map,Y6(X),e0);if(J==null){let Z=rk(X);if(!U(this.map,i5(X)))U(this.map,t4(X,Z));J=Z}return J}getGauge(X){let J=U(this.map,Y6(X),e0);if(J==null){let Z=lk(X,X.keyType.bigint?BigInt(0):0);if(!U(this.map,i5(X)))U(this.map,t4(X,Z));J=Z}return J}getHistogram(X){let J=U(this.map,Y6(X),e0);if(J==null){let Z=ik(X);if(!U(this.map,i5(X)))U(this.map,t4(X,Z));J=Z}return J}getSummary(X){let J=U(this.map,Y6(X),e0);if(J==null){let Z=ak(X);if(!U(this.map,i5(X)))U(this.map,t4(X,Z));J=Z}return J}}var Xx=()=>{return new ek};var Be="effect/Metric",Ve=Symbol.for(Be),We={_Type:(X)=>X,_In:(X)=>X,_Out:(X)=>X},Jx=X8(Symbol.for("effect/Metric/globalMetricRegistry"),()=>Xx()),Zx=function(X,J,Z,Y){let $=Object.assign((Q)=>V4(Q,(G)=>Ne($,G)),{[Ve]:We,keyType:X,unsafeUpdate:J,unsafeValue:Z,unsafeModify:Y,register(){return this.unsafeValue([]),this},pipe(){return C(this,arguments)}});return $};var J3=(X,J)=>Yx(Pk(X,J));var Yx=(X)=>{let J,Z=new WeakMap,Y=($)=>{if($.length===0){if(J!==void 0)return J;return J=Jx.get(X),J}let Q=Z.get($);if(Q!==void 0)return Q;return Q=Jx.get(Fk(X,$)),Z.set($,Q),Q};return Zx(X.keyType,($,Q)=>Y(Q).update($),($)=>Y($).get(),($,Q)=>Y(Q).modify($))};var $x=(X,J,Z)=>Yx(Mk(X,J,Z));var Qx=B(3,(X,J,Z)=>Ue(X,[aZ(J,Z)]));var Ue=B(2,(X,J)=>{return Zx(X.keyType,(Z,Y)=>X.unsafeUpdate(Z,S5(J,Y)),(Z)=>X.unsafeValue(S5(J,Z)),(Z,Y)=>X.unsafeModify(Z,S5(J,Y)))});var Ne=B(2,(X,J)=>S6(S7,(Z)=>T(()=>X.unsafeUpdate(J,Z))));var qe="effect/Request",uA=Symbol.for(qe),Oe={_E:(X)=>X,_A:(X)=>X},vK8={...MJ,[uA]:Oe},Gx=(X)=>v(X,uA);var pA=B(2,(X,J)=>S6(LV,(Z)=>T(()=>{if(Z.has(X)){let Y=Z.get(X);if(!Y.state.completed)Y.state.completed=!0,Y1(Y.result,J)}})));class Z3{count=0;observers=new Set;interrupted=!1;addObserver(X){this.observers.add(X)}removeObserver(X){this.observers.delete(X)}increment(){this.count++,this.observers.forEach((X)=>X(this.count))}decrement(){this.count--,this.observers.forEach((X)=>X(this.count))}}var Ae="effect/Supervisor",Y3=Symbol.for(Ae),pV={_T:(X)=>X};class $3{underlying;value0;[Y3]=pV;constructor(X,J){this.underlying=X,this.value0=J}get value(){return this.value0}onStart(X,J,Z,Y){this.underlying.onStart(X,J,Z,Y)}onEnd(X,J){this.underlying.onEnd(X,J)}onEffect(X,J){this.underlying.onEffect(X,J)}onSuspend(X){this.underlying.onSuspend(X)}onResume(X){this.underlying.onResume(X)}map(X){return new $3(this,U(this.value,I(X)))}zip(X){return new Q3(this,X)}}class Q3{left;right;_tag="Zip";[Y3]=pV;constructor(X,J){this.left=X,this.right=J}get value(){return IZ(this.left.value,this.right.value)}onStart(X,J,Z,Y){this.left.onStart(X,J,Z,Y),this.right.onStart(X,J,Z,Y)}onEnd(X,J){this.left.onEnd(X,J),this.right.onEnd(X,J)}onEffect(X,J){this.left.onEffect(X,J),this.right.onEffect(X,J)}onSuspend(X){this.left.onSuspend(X),this.right.onSuspend(X)}onResume(X){this.left.onResume(X),this.right.onResume(X)}map(X){return new $3(this,U(this.value,I(X)))}zip(X){return new Q3(this,X)}}var fA=(X)=>v(X,Y3)&&a9(X,"Zip");class Hx{[Y3]=pV;fibers=new Set;get value(){return T(()=>Array.from(this.fibers))}onStart(X,J,Z,Y){this.fibers.add(Y)}onEnd(X,J){this.fibers.delete(J)}onEffect(X,J){}onSuspend(X){}onResume(X){}map(X){return new $3(this,U(this.value,I(X)))}zip(X){return new Q3(this,X)}onRun(X,J){return X()}}class Kx{effect;[Y3]=pV;constructor(X){this.effect=X}get value(){return this.effect}onStart(X,J,Z,Y){}onEnd(X,J){}onEffect(X,J){}onSuspend(X){}onResume(X){}map(X){return new $3(this,U(this.value,I(X)))}zip(X){return new Q3(this,X)}onRun(X,J){return X()}}var _e=()=>{return new Hx},Bx=T(_e),we=(X)=>{return new Kx(X)},QY=X8("effect/Supervisor/none",()=>we(K8));var Vx=gJ;var Ux="Empty",Nx="AddSupervisor",zx="RemoveSupervisor",qx="AndThen",HQ={_tag:Ux},nV=(X,J)=>{return{_tag:qx,first:X,second:J}},Le=(X,J)=>{return Te(J,I8(X))},Te=(X,J)=>{let Z=X,Y=J;while(q6(Y)){let $=E6(Y);switch($._tag){case Ux:{Y=K4(Y);break}case Nx:{Z=Z.zip($.supervisor),Y=K4(Y);break}case zx:{Z=nA(Z,$.supervisor),Y=K4(Y);break}case qx:{Y=O0($.first)(O0($.second)(K4(Y)));break}}}return Z},nA=(X,J)=>{if(S(X,J))return QY;else if(fA(X))return nA(X.left,J).zip(nA(X.right,J));else return X},oV=(X)=>{if(S(X,QY))return L7();else if(fA(X))return U(oV(X.left),PX(oV(X.right)));else return NZ(X)},Pe=(X,J)=>{if(S(X,J))return HQ;let Z=oV(X),Y=oV(J),$=U(Y,sq(Z),kJ(HQ,(G,H)=>nV(G,{_tag:Nx,supervisor:H}))),Q=U(Z,sq(Y),kJ(HQ,(G,H)=>nV(G,{_tag:zx,supervisor:H})));return nV($,Q)},Ox=Vx({empty:HQ,patch:Le,combine:nV,diff:Pe});var Se=J3("effect_fiber_started",{incremental:!0}),Dx=J3("effect_fiber_active"),ve=J3("effect_fiber_successes",{incremental:!0}),ke=J3("effect_fiber_failures",{incremental:!0}),xe=Qx($x("effect_fiber_lifetimes",Bk({start:0.5,factor:2,count:35})),"time_unit","milliseconds"),G3="Continue",ye="Done",Ax="Yield",be={_E:(X)=>X,_A:(X)=>X},rV=(X)=>{throw Error(`BUG: FiberRuntime - ${O9(X)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},dX=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),cX=X8("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),H3={[G$]:(X,J,Z)=>{return S0(()=>J.effect_instruction_i1(Z))},["OnStep"]:(X,J,Z)=>{return m8(m8(Z))},[H$]:(X,J,Z)=>{return S0(()=>J.effect_instruction_i2(Z))},[gG]:(X,J,Z)=>{if(X.patchRuntimeFlags(X.currentRuntimeFlags,J.patch),RX(X.currentRuntimeFlags)&&X.isInterrupted())return g8(X.getInterruptedCause());else return m8(Z)},[K$]:(X,J,Z)=>{if(S0(()=>J.effect_instruction_i2(Z)),S0(()=>J.effect_instruction_i0()))return X.pushStack(J),S0(()=>J.effect_instruction_i1());else return K8},[ZZ]:(X,J,Z)=>{let Y=S0(()=>J.effect_instruction_i0.next(Z));if(Y.done)return m8(Y.value);return X.pushStack(J),Yq(Y.value)}},ge={[LA]:(X,J,Z,Y)=>{return X.processNewInterruptSignal(Y.cause),RX(J)?g8(Y.cause):Z},[PA]:(X,J,Z,Y)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[TA]:(X,J,Z,Y)=>{return Y.onFiber(X,FD(J)),Z},[MA]:(X,J,Z,Y)=>{return O(C7(),()=>Z)}},he=(X)=>P9(HC(X),(J)=>g7(VC(J),([Z,Y])=>{let $=new Map,Q=[];for(let H of Y){Q.push(G4(H));for(let K of H)$.set(K.request,K)}let G=Q.flat();return N0(re(Z.runAll(Q),G,()=>G.forEach((H)=>{H.listeners.interrupted=!0})),LV,$)},!1,!1)),me=mG();class tV extends a4{[GQ]=s2;[bV]=be;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(X,J,Z){super();if(this.currentRuntimeFlags=Z,this._fiberId=X,this._fiberRefs=J,LO(Z)){let Y=this.getFiberRef(S7);Se.unsafeUpdate(1,Y),Dx.unsafeUpdate(1,Y)}this.refreshRefCache()}commit(){return j9(this)}id(){return this._fiberId}resume(X){this.tell(JY(X))}get status(){return this.ask((X,J)=>J)}get runtimeFlags(){return this.ask((X,J)=>{if(FI(J))return X.currentRuntimeFlags;return J.runtimeFlags})}scope(){return Xk(this)}get children(){return this.ask((X)=>Array.from(X.getChildren()))}getChildren(){if(this._children===null)this._children=new Set;return this._children}getInterruptedCause(){return this.getFiberRef(eJ)}fiberRefs(){return this.ask((X)=>X.getFiberRefs())}ask(X){return h(()=>{let J=Z1(this._fiberId);return this.tell(QQ((Z,Y)=>{Y1(J,T(()=>X(Z,Y)))})),m0(J)})}tell(X){if(this._queue.push(X),!this._running)this._running=!0,this.drainQueueLaterOnExecutor()}get await(){return B4((X)=>{let J=(Z)=>X(w(Z));return this.tell(QQ((Z,Y)=>{if(Z._exitValue!==null)J(this._exitValue);else Z.addObserver(J)})),T(()=>this.tell(QQ((Z,Y)=>{Z.removeObserver(J)})))},this.id())}get inheritAll(){return A8((X,J)=>{let Z=X.id(),Y=X.getFiberRefs(),$=J.runtimeFlags,Q=this.getFiberRefs(),G=YV(Y,Z,Q);X.setFiberRefs(G);let H=X.getFiberRef(rA),K=U(Z5($,H),FO(d5),FO(WB));return lJ(K)})}get poll(){return T(()=>Y0(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(X){return T(()=>this.tell(xV(T4(X))))}unsafeInterruptAsFork(X){this.tell(xV(T4(X)))}addObserver(X){if(this._exitValue!==null)X(this._exitValue);else this._observers.push(X)}removeObserver(X){this._observers=this._observers.filter((J)=>J!==X)}getFiberRefs(){return this.setFiberRef(rA,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(X){this._fiberRefs=m2(this._fiberRefs,X)}getFiberRef(X){if(this._fiberRefs.locals.has(X))return this._fiberRefs.locals.get(X)[0][1];return X.initial}setFiberRef(X,J){this._fiberRefs=fZ(this._fiberRefs,{fiberId:this._fiberId,fiberRef:X,value:J}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(_0),this.currentTracer=this.currentDefaultServices.unsafeMap.get(k7.key),this.currentSupervisor=this.getFiberRef(z3),this.currentScheduler=this.getFiberRef(iZ),this.currentContext=this.getFiberRef(D6),this.currentSpan=this.currentContext.unsafeMap.get(K5.key)}setFiberRefs(X){this._fiberRefs=X,this.refreshRefCache()}addChild(X){this.getChildren().add(X)}removeChild(X){this.getChildren().delete(X)}transferChildren(X){let J=this._children;if(this._children=null,J!==null&&J.size>0){for(let Z of J)if(Z._exitValue===null)X.add(this.currentRuntimeFlags,Z)}}drainQueueOnCurrentThread(){let X=!0;while(X){let J=G3,Z=globalThis[U1];globalThis[U1]=this;try{while(J===G3)J=this._queue.length===0?ye:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[U1]=Z}if(this._queue.length>0&&!this._running)if(this._running=!0,J===Ax)this.drainQueueLaterOnExecutor(),X=!1;else X=!0;else X=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(I7))}drainQueueWhileRunning(X,J){let Z=J;while(this._queue.length>0){let Y=this._queue.splice(0,1)[0];Z=ge[Y._tag](this,X,Z,Y)}return Z}isInterrupted(){return!b$(this.getFiberRef(eJ))}addInterruptedCause(X){let J=this.getFiberRef(eJ);this.setFiberRef(eJ,Q0(J,X))}processNewInterruptSignal(X){this.addInterruptedCause(X),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let X=!1;for(let J of this._children)J.tell(xV(T4(this.id()))),X=!0;return X}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let X=this._children.values();this._children=null;let J=!1;return aJ({while:()=>!J,body:()=>{let Y=X.next();if(!Y.done)return W0(Y.value.await);else return T(()=>{J=!0})},step:()=>{}})}return null}reportExitValue(X){if(LO(this.currentRuntimeFlags)){let J=this.getFiberRef(S7),Z=this.id().startTimeMillis,Y=Date.now();switch(xe.unsafeUpdate(Y-Z,J),Dx.unsafeUpdate(-1,J),X._tag){case k0:{ve.unsafeUpdate(1,J);break}case v0:{ke.unsafeUpdate(1,J);break}}}if(X._tag==="Failure"){let J=this.getFiberRef(hB);if(!MZ(X.cause)&&J._tag==="Some")this.log("Fiber terminated with an unhandled error",X.cause,J)}}setExitValue(X){this._exitValue=X,this.reportExitValue(X);for(let J=this._observers.length-1;J>=0;J--)this._observers[J](X);this._observers=[]}getLoggers(){return this.getFiberRef(eV)}log(X,J,Z){let Y=H8(Z)?Z.value:this.getFiberRef(bB),$=this.getFiberRef(K3);if(vD($,Y))return;let Q=this.getFiberRef(C2),G=this.getFiberRef(SX),H=this.getLoggers(),K=this.getFiberRefs();if(LX(H)>0){let V=z6(this.getFiberRef(_0),R9),W=new Date(V.unsafeCurrentTimeMillis());RF(K,()=>{for(let N of H)N.log({fiberId:this.id(),logLevel:Y,message:X,cause:J,context:K,spans:Q,annotations:G,date:W})})}}evaluateMessageWhileSuspended(X){switch(X._tag){case MA:return Ax;case LA:{if(this.processNewInterruptSignal(X.cause),this._asyncInterruptor!==null)this._asyncInterruptor(g8(X.cause)),this._asyncInterruptor=null;return G3}case PA:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(X.effect),G3;case TA:return X.onFiber(this,this._exitValue!==null?PI:MI(this.currentRuntimeFlags,this._asyncBlockingOn)),G3;default:return rV(X)}}evaluateEffect(X){this.currentSupervisor.onResume(this);try{let J=RX(this.currentRuntimeFlags)&&this.isInterrupted()?g8(this.getInterruptedCause()):X;while(J!==null){let Z=J,Y=this.runLoop(Z);if(Y===dX){let $=cX.currentOp;if(cX.currentOp=null,$._op===B$)if(YC(this.currentRuntimeFlags))this.tell(av()),this.tell(JY(M0)),J=null;else J=M0;else if($._op===XZ)J=null}else{this.currentRuntimeFlags=U(this.currentRuntimeFlags,_O(WB));let $=this.interruptAllChildren();if($!==null)J=O($,()=>Y);else{if(this._queue.length===0)this.setExitValue(Y);else this.tell(JY(Y));J=null}}}}finally{this.currentSupervisor.onSuspend(this)}}start(X){if(!this._running){this._running=!0;let J=globalThis[U1];globalThis[U1]=this;try{this.evaluateEffect(X)}finally{if(this._running=!1,globalThis[U1]=J,this._queue.length>0)this.drainQueueLaterOnExecutor()}}else this.tell(JY(X))}startFork(X){this.tell(JY(X))}patchRuntimeFlags(X,J){let Z=jX(X,J);return globalThis[U1]=this,this.currentRuntimeFlags=Z,Z}initiateAsync(X,J){let Z=!1,Y=($)=>{if(!Z)Z=!0,this.tell(JY($))};if(RX(X))this._asyncInterruptor=Y;try{J(Y)}catch($){Y(E8(r0($)))}}pushStack(X){if(this._stack.push(X),X._op==="OnStep")this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let X=this._stack.pop();if(X){if(X._op==="OnStep")this._steps.pop();return X}return}getNextSuccessCont(){let X=this.popStack();while(X){if(X._op!==Q$)return X;X=this.popStack()}}getNextFailCont(){let X=this.popStack();while(X){if(X._op!==G$&&X._op!==K$&&X._op!==ZZ)return X;X=this.popStack()}}[CF](X){return T(()=>CJ(this.currentContext,X))}["Left"](X){return R8(X.left)}["None"](X){return R8(new R4)}["Right"](X){return m8(X.right)}["Some"](X){return m8(X.value)}["Micro"](X){return m$((J)=>{let Z=J,Y=cI(hI(X,this.currentContext));return Y.addObserver(($)=>{if($._tag==="Success")return Z(m8($.value));switch($.cause._tag){case"Interrupt":return Z(g8(T4(I6)));case"Fail":return Z(R8($.cause.error));case"Die":return Z(P4($.cause.defect))}}),m$(($)=>{Z=(Q)=>{$(K8)},Y.unsafeInterrupt()})})}[NK](X){let J=S0(()=>X.effect_instruction_i0()),Z=this.getNextSuccessCont();if(Z!==void 0){if(!(Z._op in H3))rV(Z);return H3[Z._op](this,Z,J)}else return cX.currentOp=m8(J),dX}[k0](X){let J=X,Z=this.getNextSuccessCont();if(Z!==void 0){if(!(Z._op in H3))rV(Z);return H3[Z._op](this,Z,J.effect_instruction_i0)}else return cX.currentOp=J,dX}[v0](X){let J=X.effect_instruction_i0,Z=this.getNextFailCont();if(Z!==void 0)switch(Z._op){case Q$:case H$:if(!(RX(this.currentRuntimeFlags)&&this.isInterrupted()))return S0(()=>Z.effect_instruction_i1(J));else return g8(DB(J));case"OnStep":if(!(RX(this.currentRuntimeFlags)&&this.isInterrupted()))return m8(g8(J));else return g8(DB(J));case gG:if(this.patchRuntimeFlags(this.currentRuntimeFlags,Z.patch),RX(this.currentRuntimeFlags)&&this.isInterrupted())return g8(Q0(J,this.getInterruptedCause()));else return g8(J);default:rV(Z)}else return cX.currentOp=g8(J),dX}[zK](X){return S0(()=>X.effect_instruction_i0(this,FD(this.currentRuntimeFlags)))}["Blocked"](X){let J=this.getFiberRefs(),Z=this.currentRuntimeFlags;if(this._steps.length>0){let Y=[],$=this._steps[this._steps.length-1],Q=this.popStack();while(Q&&Q._op!=="OnStep")Y.push(Q),Q=this.popStack();this.setFiberRefs($.refs),this.currentRuntimeFlags=$.flags;let G=oZ($.refs,J),H=Z5($.flags,Z);return m8(EX(X.effect_instruction_i0,A8((K)=>{while(Y.length>0)K.pushStack(Y.pop());return K.setFiberRefs(rZ(K.id(),K.getFiberRefs())(G)),K.currentRuntimeFlags=jX(H)(K.currentRuntimeFlags),X.effect_instruction_i1})))}return U0((Y)=>O(V3(MB(X.effect_instruction_i0)),()=>Y(X.effect_instruction_i1)))}["RunBlocked"](X){return he(X.effect_instruction_i0)}[VX](X){let J=X.effect_instruction_i0,Z=this.currentRuntimeFlags,Y=jX(Z,J);if(RX(Y)&&this.isInterrupted())return g8(this.getInterruptedCause());else if(this.patchRuntimeFlags(this.currentRuntimeFlags,J),X.effect_instruction_i1){let $=Z5(Y,Z);return this.pushStack(new nO($,X)),S0(()=>X.effect_instruction_i1(Z))}else return M0}[G$](X){return this.pushStack(X),X.effect_instruction_i0}["OnStep"](X){return this.pushStack(X),X.effect_instruction_i0}[Q$](X){return this.pushStack(X),X.effect_instruction_i0}[H$](X){return this.pushStack(X),X.effect_instruction_i0}[XZ](X){return this._asyncBlockingOn=X.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,X.effect_instruction_i0),cX.currentOp=X,dX}[B$](X){return this._isYielding=!1,cX.currentOp=X,dX}[K$](X){let{effect_instruction_i0:J,effect_instruction_i1:Z}=X;if(J())return this.pushStack(X),Z();else return M0}[ZZ](X){return H3[ZZ](this,X,void 0)}[JZ](X){return S0(()=>X.commit())}runLoop(X){let J=X;this.currentOpCount=0;while(!0){if((this.currentRuntimeFlags&ZC)!==0)this.currentSupervisor.onEffect(this,J);if(this._queue.length>0)J=this.drainQueueWhileRunning(this.currentRuntimeFlags,J);if(!this._isYielding){this.currentOpCount+=1;let Z=this.currentScheduler.shouldYield(this);if(Z!==!1){this._isYielding=!0,this.currentOpCount=0;let Y=J;J=O(C7({priority:Z}),()=>Y)}}try{if(J=this.currentTracer.context(()=>{if(me!==J[IX]._V){let Z=this.getFiberRef(ZD);if(Z._tag==="Some"){let Y=J[IX]._V;this.log(`Executing an Effect versioned ${Y} with a Runtime of version ${mG()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,r6,Z)}}return this[J._op](J)},this),J===dX){let Z=cX.currentOp;if(Z._op===B$||Z._op===XZ)return dX;return cX.currentOp=null,Z._op===k0||Z._op===v0?Z:g8(r0(Z))}}catch(Z){if(J!==dX&&!v(J,"_op")||!(J._op in this))J=uJ(`Not a valid effect: ${O9(J)}`);else if(YD(Z))J=g8(Q0(r0(Z),T4(I6)));else J=P4(Z)}}}run=()=>{this.drainQueueOnCurrentThread()}}var K3=X8("effect/FiberRef/currentMinimumLogLevel",()=>A0(kD("Info"))),Tx=(X)=>ZY((J)=>{let Z=nZ(J.context,_0);z6(Z,H5).unsafe.log(X.log(J))});var lA=X8(Symbol.for("effect/Logger/defaultLogger"),()=>Tx(EA));var Px=X8(Symbol.for("effect/Logger/tracerLogger"),()=>ZY(({annotations:X,cause:J,context:Z,fiberId:Y,logLevel:$,message:Q})=>{let G=w4(yX(Z,D6),K5);if(G._tag==="None"||G.value._tag==="ExternalSpan")return;let H=CJ(yX(Z,_0),R9),K={};for(let[V,W]of X)K[V]=W;if(K["effect.fiberId"]=Ej(Y),K["effect.logLevel"]=$.label,J!==null&&J._tag!=="Empty")K["effect.cause"]=L9(J,{renderErrorCause:!0});G.value.event(O9(Array.isArray(Q)&&Q.length===1?Q[0]:Q),H.unsafeCurrentTimeNanos(),K)}));var eV=X8(Symbol.for("effect/FiberRef/currentLoggers"),()=>XD(NZ(lA,Px)));var Mx=function(){if(typeof arguments[0]==="string")return E9(SX,n4(arguments[0],arguments[1]));let X=Object.entries(arguments[0]);return E9(SX,Sj((J)=>{for(let Z=0;Z<X.length;Z++){let[Y,$]=X[Z];n4(J,Y,$)}return J}))},Fx=B(2,(X,J)=>{let Z=typeof J==="string"?kD(J):J;return A8((Y)=>{let $=Y.getFiberRef(K3);if(vD($,Z))return w(_());return I(X,D)})}),B3=B((X)=>f8(X[0]),(X,J)=>f5(V4(X,(Z)=>HY((Y)=>J(Z,Y))))),Rx=B((X)=>f8(X[0]),(X,J)=>X9(X,HY((Z)=>J(Z)))),HY=(X)=>A8((J)=>{let Z=J.getFiberRefs(),Y=AO(J.currentRuntimeFlags,d5);return O(Y_,($)=>X1($,(Q)=>A8((G)=>{let H=G.getFiberRefs(),K=G.currentRuntimeFlags,V=oZ(H,Z),W=Z5(K,Y),N=oZ(Z,H);return G.setFiberRefs(rZ(V,G.id(),Z)),X9(vB(X(Q),W),T(()=>{G.setFiberRefs(rZ(N,G.id(),G.getFiberRefs()))}))})))}),jx=(X)=>{return N0(w2,D(mX))(X)},_x=Symbol.for("effect/Effect/existsPar/found"),Cx=B((X)=>s9(X[0])&&!f8(X[0]),(X,J,Z)=>p2(Z?.concurrency,()=>h(()=>Ex(X[Symbol.iterator](),0,J)),()=>H6(C9(X,(Y,$)=>CB(J(Y,$),{onTrue:()=>R8(_x),onFalse:()=>K8}),Z),{onFailure:(Y)=>Y===_x?w(!0):R8(Y),onSuccess:()=>w(!1)}))),Ex=(X,J,Z)=>{let Y=X.next();if(Y.done)return w(!1);return O(Z(Y.value,J),($)=>$?w($):Ex(X,J+1,Z))},Ix=B((X)=>s9(X[0])&&!f8(X[0]),(X,J,Z)=>{let Y=Z?.negate?($,Q)=>I(J($,Q),fE):J;return p2(Z?.concurrency,()=>h(()=>J8(X).reduceRight(($,Q,G)=>E7($,h(()=>Y(Q,G)),(H,K)=>K?[Q,...H]:H),T(()=>[]))),()=>I(C9(X,($,Q)=>I(Y($,Q),(G)=>G?D($):_()),Z),RJ))}),de=(X)=>{if(Array.isArray(X)||s9(X))return[X,_()];let J=Object.keys(X),Z=J.length;return[J.map((Y)=>X[Y]),D((Y)=>{let $={};for(let Q=0;Q<Z;Q++)$[J[Q]]=Y[Q];return $})]},ce=(X,J,Z)=>{let Y=[];for(let $ of X)Y.push(Y5($));return O(C9(Y,g,{concurrency:Z?.concurrency,batching:Z?.batching,concurrentFinalizers:Z?.concurrentFinalizers}),($)=>{let Q=_(),G=$.length,H=Array(G),K=Array(G),V=!1;for(let W=0;W<G;W++){let N=$[W];if(N._tag==="Left")H[W]=D(N.left),V=!0;else K[W]=N.right,H[W]=Q}if(V)return J._tag==="Some"?R8(J.value(H)):R8(H);else if(Z?.discard)return K8;return J._tag==="Some"?w(J.value(K)):w(K)})},ue=(X,J,Z)=>{let Y=[];for(let $ of X)Y.push(Y5($));if(Z?.discard)return C9(Y,g,{concurrency:Z?.concurrency,batching:Z?.batching,discard:!0,concurrentFinalizers:Z?.concurrentFinalizers});return I(C9(Y,g,{concurrency:Z?.concurrency,batching:Z?.batching,concurrentFinalizers:Z?.concurrentFinalizers}),($)=>J._tag==="Some"?J.value($):$)},N1=(X,J)=>{let[Z,Y]=de(X);if(J?.mode==="validate")return ce(Z,Y,J);else if(J?.mode==="either")return ue(Z,Y,J);return J?.discard!==!0&&Y._tag==="Some"?I(C9(Z,g,J),Y.value):C9(Z,g,J)},Sx=(X)=>(J)=>N1(J,X),vx=(X,J)=>I(N1(J8(X).map(P0),J),v5((Z)=>x2(Z)?D(Z.effect_instruction_i0):_())),iA=B(2,(X,J)=>Array.from({length:J},()=>X)),kx=B((X)=>f8(X[0]),(X,J,Z)=>N1(iA(X,J),Z)),C9=B((X)=>s9(X[0]),(X,J,Z)=>A8((Y)=>{let $=Z?.batching===!0||Z?.batching==="inherit"&&Y.getFiberRef(gB);if(Z?.discard)return iD(Z.concurrency,()=>GY(a$,Z?.concurrentFinalizers)((Q)=>$?g7(X,(G,H)=>Q(J(G,H)),!0,!1,1):P9(X,(G,H)=>Q(J(G,H)))),()=>GY(JV,Z?.concurrentFinalizers)((Q)=>g7(X,(G,H)=>Q(J(G,H)),$,!1)),(Q)=>GY(ZV(Q),Z?.concurrentFinalizers)((G)=>g7(X,(H,K)=>G(J(H,K)),$,!1,Q)));return iD(Z?.concurrency,()=>GY(a$,Z?.concurrentFinalizers)((Q)=>$?oA(X,1,(G,H)=>Q(J(G,H)),!0):i6(X,(G,H)=>Q(J(G,H)))),()=>GY(JV,Z?.concurrentFinalizers)((Q)=>lV(X,(G,H)=>Q(J(G,H)),$)),(Q)=>GY(ZV(Q),Z?.concurrentFinalizers)((G)=>oA(X,Q,(H,K)=>G(J(H,K)),$)))})),lV=(X,J,Z)=>h(()=>{let Y=J8(X),$=Array(Y.length);return j8(g7(Y,(G,H)=>O(J(G,H),(K)=>T(()=>$[H]=K)),Z,!1),w($))}),g7=(X,J,Z,Y,$)=>U0((Q)=>IB((G)=>A8((H)=>{let K=Array.from(X).reverse(),V=K.length;if(V===0)return K8;let W=0,N=!1,z=$?Math.min(K.length,$):K.length,q=new Set,A=[],E=()=>q.forEach((P8)=>{P8.currentScheduler.scheduleTask(()=>{P8.unsafeInterruptAsFork(H.id())},0)}),P=[],M=[],c=[],y=()=>{let P8=A.filter(({exit:r8})=>r8._tag==="Failure").sort((r8,l8)=>r8.index<l8.index?-1:r8.index===l8.index?0:1).map(({exit:r8})=>r8);if(P8.length===0)P8.push(M0);return P8},s=(P8,r8=!1)=>{let l8=f5(G(P8)),y8=pe(l8,H,H.currentRuntimeFlags,mX);return H.currentScheduler.scheduleTask(()=>{if(r8)y8.unsafeInterruptAsFork(H.id());y8.resume(l8)},0),y8},Y8=()=>{if(!Y)V-=K.length,K=[];N=!0,E()},l=Z?jB:P0,G8=s(B4((P8)=>{let r8=(y8,I0)=>{if(y8._op==="Blocked")c.push(y8);else if(A.push({index:I0,exit:y8}),y8._op==="Failure"&&!N)Y8()},l8=()=>{if(K.length>0){let y8=K.pop(),I0=W++,r9=()=>{let p6=K.pop();return I0=W++,O(C7(),()=>O(l(Q(J(p6,I0))),l9))},l9=(p6)=>{if(K.length>0){if(r8(p6,I0),K.length>0)return r9()}return w(p6)},j5=O(l(Q(J(y8,I0))),l9),Z4=s(j5);if(P.push(Z4),q.add(Z4),N)Z4.currentScheduler.scheduleTask(()=>{Z4.unsafeInterruptAsFork(H.id())},0);Z4.addObserver((p6)=>{let i9;if(p6._op==="Failure")i9=p6;else i9=p6.effect_instruction_i0;if(M.push(Z4),q.delete(Z4),r8(i9,I0),A.length===V)P8(w(i(J1(y(),{parallel:!0}),()=>M0)));else if(c.length+A.length===V){let X$=y(),az=c.map((EG)=>EG.effect_instruction_i0).reduce(CO);P8(w(EX(az,g7([i(J1(X$,{parallel:!0}),()=>M0),...c.map((EG)=>EG.effect_instruction_i1)],(EG)=>EG,Z,!0,$))))}else l8()})}};for(let y8=0;y8<z;y8++)l8()}));return W0(F4(r4(Q(j9(G8))),bZ({onFailure:(P8)=>{Y8();let r8=c.length+1,l8=Math.min(typeof $==="number"?$:c.length,c.length),y8=Array.from(c);return B4((I0)=>{let r9=[],l9=0,j5=0,Z4=(i9,X$)=>(az)=>{if(r9[i9]=az,l9++,l9===r8)I0(m8(g8(P8)));if(y8.length>0&&X$)p6()},p6=()=>{s(y8.pop(),!0).addObserver(Z4(j5,!0)),j5++};G8.addObserver(Z4(j5,!1)),j5++;for(let i9=0;i9<l8;i9++)p6()})},onSuccess:()=>i6(M,(P8)=>P8.inheritAll)})))}))),oA=(X,J,Z,Y)=>h(()=>{let $=J8(X),Q=Array($.length);return j8(g7($,(H,K)=>I(Z(H,K),(V)=>Q[K]=V),Y,!1,J),w(Q))}),uX=(X)=>A8((J,Z)=>w(W3(X,J,Z.runtimeFlags))),V3=(X)=>fe(X,mX),xx=B(2,(X,J)=>uX(EB(X,(Z)=>{let Y=u5(Z);switch(Y._tag){case"Left":return J(Y.left);case"Right":return E8(Y.right)}}))),W3=(X,J,Z,Y=null)=>{let $=iV(X,J,Z,Y);return $.resume(X),$},pe=(X,J,Z,Y=null)=>{return iV(X,J,Z,Y)},iV=(X,J,Z,Y=null)=>{let $=ZB(),Q=J.getFiberRefs(),G=wD(Q,$),H=new tV($,G,Z),K=yX(G,D6),V=H.currentSupervisor;return V.onStart(K,X,D(J),H),H.addObserver((N)=>V.onEnd(N,H)),(Y!==null?Y:U(J.getFiberRef(w2),i(()=>J.scope()))).add(Z,H),H},fe=(X,J)=>A8((Z,Y)=>w(W3(X,Z,Y.runtimeFlags,J))),aA=B((X)=>D7(X[2]),(X,J,Z,Y)=>p2(Y?.concurrency,()=>J8(X).reduce(($,Q,G)=>E7($,Q,(H,K)=>Z(H,K,G)),w(J)),()=>O(v6(J),($)=>O(C9(X,(Q,G)=>O(Q,(H)=>l5($,(K)=>Z(K,H,G))),Y),()=>k6($))))),sA=B((X)=>s9(X[0]),(X,J,Z)=>U(C9(X,(Y,$)=>Y5(J(Y,$)),Z),I((Y)=>EC(Y,g)))),yx=B((X)=>s9(X[0]),(X,J,Z)=>O(sA(X,J,{concurrency:Z?.concurrency,batching:Z?.batching,concurrentFinalizers:Z?.concurrentFinalizers}),([Y,$])=>qX(Y)?R8(Y):Z?.discard?K8:w($))),bx=(X)=>A8((J,Z)=>B4((Y)=>{let $=new Set,Q,G=r6,H=()=>{for(let W of $)W.unsafeInterruptAsFork(J.id())},K=!1,V=!0;for(let W of X){V=!1;let N=W3(p5(W),J,Z.runtimeFlags);if($.add(N),N.addObserver((z)=>{if($.delete(N),!Q)if(z._tag==="Success")K=!0,Q=N,G=r6,H();else G=l6(z.cause,G);if(K&&$.size===0)Y(Q?j8(hV(Q),Q.unsafePoll()):E8(G))}),Q)break}if(V)return Y(pJ(()=>new u$("Received an empty collection of effects")));return K=!0,mV($,J.id())})),gx=B((X)=>s9(X[0])&&!f8(X[0]),(X,J,Z,Y)=>p2(Y?.concurrency,()=>J8(X).reduce(($,Q,G)=>E7($,Q,(H,K)=>Z(H,K,G)),J),()=>h(()=>U(aA([J,...X],_(),($,Q,G)=>{switch($._tag){case"None":return D(Q);case"Some":return D(Z($.value,Q,G))}},Y),I(($)=>{switch($._tag){case"None":throw Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return $.value}}))))),aV=(X)=>Q5((J)=>n(w4(J,e4),{onNone:()=>X,onSome:(Z)=>{switch(Z.strategy._tag){case"Parallel":return X;case"Sequential":case"ParallelN":return O(xZ(Z,JV),(Y)=>h7(X,Y))}}})),wx=(X)=>(J)=>Q5((Z)=>n(w4(Z,e4),{onNone:()=>J,onSome:(Y)=>{if(Y.strategy._tag==="ParallelN"&&Y.strategy.parallelism===X)return J;return O(xZ(Y,ZV(X)),($)=>h7(J,$))}})),hx=(X)=>(J)=>GY(X,!0)(J),GY=(X,J)=>(Z)=>Q5((Y)=>n(w4(Y,e4),{onNone:()=>Z(g),onSome:($)=>{if(J===!0){let Q=X._tag==="Parallel"?aV:X._tag==="Sequential"?sV:wx(X.parallelism);switch($.strategy._tag){case"Parallel":return Q(Z(aV));case"Sequential":return Q(Z(sV));case"ParallelN":return Q(Z(wx($.strategy.parallelism)))}}else return Z(g)}})),KY=(X)=>O(e4,X),U3=(X)=>O(z1(),(J)=>F4(X(J),(Z)=>J.close(Z))),tA=(X)=>O(z1(),(J)=>ax(X,J)),sV=(X)=>Q5((J)=>n(w4(J,e4),{onNone:()=>X,onSome:(Z)=>{switch(Z.strategy._tag){case"Sequential":return X;case"Parallel":case"ParallelN":return O(xZ(Z,a$),(Y)=>h7(X,Y))}}})),mx=(X,J)=>eA([aZ(X,J)]),eA=(X)=>E9(S7,(J)=>S5(J,X)),dx=B(2,(X,J)=>U3((Z)=>O(h7(X,Z),J))),cx=B((X)=>f8(X[1]),(X,J,Z)=>X_(X,J,(Y,$)=>[Y,$],Z)),X_=B((X)=>f8(X[1]),(X,J,Z,Y)=>r4(pX(P0(X),P0(J),($,Q)=>gZ($,Q,{onSuccess:Z,onFailure:(G,H)=>Y?.concurrent?l6(G,H):Q0(G,H)}),Y)));var ux=B((X)=>s9(X[0]),(X,J,Z)=>oJ(C9(X,(Y,$)=>oJ(J(Y,$)),Z))),px=(X)=>E9(_0,$0(R9,X)),fx=(X)=>E9(_0,$0(cZ,X)),J_=(X)=>E9(_0,$0(i$,X)),nx=(X)=>KY((J)=>O(xZ(J,Q1),(Z)=>U(X,h7(Z),I((Y)=>[o4(($)=>n5(Z,fB($))),Y])))),ox=B((X)=>f8(X[1]),(X,J,Z)=>pX(X,J,(Y,$)=>[Y,$],Z)),rx=B((X)=>f8(X[1]),(X,J,Z)=>{if(Z?.concurrent!==!0&&(Z?.batching===void 0||Z.batching===!1))return SZ(X,J);return pX(X,J,(Y,$)=>Y,Z)}),lx=B((X)=>f8(X[1]),(X,J,Z)=>{if(Z?.concurrent!==!0&&(Z?.batching===void 0||Z.batching===!1))return j8(X,J);return pX(X,J,(Y,$)=>$,Z)}),pX=B((X)=>f8(X[1]),(X,J,Z,Y)=>I(N1([X,J],{concurrency:Y?.concurrent?2:1,batching:Y?.batching,concurrentFinalizers:Y?.concurrentFinalizers}),([$,Q])=>Z($,Q))),Z_=(X)=>{if(X===QC)return K8;return U(d$,O((J)=>{let Z=jX(J,X),Y=Z5(Z,J);return U(lJ(X),j8(HY(()=>lJ(Y))),W0)}),f5)},e4=o8("effect/Scope"),Y_=e4,ne=(X,J)=>{if(X.state._tag==="Open")X.state.finalizers.set({},J)},oe={[dB]:dB,[cB]:cB,pipe(){return C(this,arguments)},fork(X){return T(()=>{let J=ix(X);if(this.state._tag==="Closed")return J.state=this.state,J;let Z={},Y=($)=>J.close($);return this.state.finalizers.set(Z,Y),ne(J,($)=>T(()=>{if(this.state._tag==="Open")this.state.finalizers.delete(Z)})),J})},close(X){return h(()=>{if(this.state._tag==="Closed")return K8;let J=Array.from(this.state.finalizers.values()).reverse();if(this.state={_tag:"Closed",exit:X},J.length===0)return K8;return zD(this.strategy)?U(i6(J,(Z)=>P0(Z(X))),O((Z)=>U(J1(Z),q0(y2),i(()=>M0)))):qD(this.strategy)?U(lV(J,(Z)=>P0(Z(X)),!1),O((Z)=>U(J1(Z,{parallel:!0}),q0(y2),i(()=>M0)))):U(oA(J,this.strategy.parallelism,(Z)=>P0(Z(X)),!1),O((Z)=>U(J1(Z,{parallel:!0}),q0(y2),i(()=>M0))))})},addFinalizer(X){return h(()=>{if(this.state._tag==="Closed")return X(this.state.exit);return this.state.finalizers.set({},X),K8})}},ix=(X=Q1)=>{let J=Object.create(oe);return J.strategy=X,J.state={_tag:"Open",finalizers:new Map},J},z1=(X=Q1)=>T(()=>ix(X)),h7=B(2,(X,J)=>mZ(X,k5(HZ(e4,J)))),ax=B(2,(X,J)=>U(X,h7(J),F4((Z)=>J.close(Z)))),sx=(X)=>tJ(X,{differ:Ox,fork:HQ}),N3=B(2,(X,J)=>W0(B3(O(i4(X),(Z)=>s8(cJ(X,J),Z)),(Z)=>cJ(X,Z)))),E9=B(2,(X,J)=>S6(X,(Z)=>N3(X,J(Z))));var rA=hC($C),z3=sx(QY),tx=(X)=>C9(X,gV),$_=(X)=>{return{...pZ,commit(){return j9(this)},[GQ]:s2,id:()=>J8(X).reduce((Z,Y)=>I$(Z,Y.id()),I6),await:P0(lV(X,(Z)=>r4(Z.await),!1)),children:I(lV(X,(Z)=>Z.children,!1),fG),inheritAll:P9(X,(Z)=>Z.inheritAll),poll:I(i6(X,(Z)=>Z.poll),t9(D(m8([])),(Z,Y)=>{switch(Y._tag){case"None":return _();case"Some":switch(Z._tag){case"None":return _();case"Some":return D(gZ(Y.value,Z.value,{onSuccess:($,Q)=>[$,...Q],onFailure:l6}))}}})),interruptAsFork:(Z)=>P9(X,(Y)=>Y.interruptAsFork(Z))}};var Q_=B(3,(X,J,Z)=>G_(X,J,{onSelfWin:(Y,$)=>O(Y.await,(Q)=>{switch(Q._tag){case k0:return O(Y.inheritAll,()=>Z.onSelfDone(Q,$));case v0:return Z.onSelfDone(Q,$)}}),onOtherWin:(Y,$)=>O(Y.await,(Q)=>{switch(Q._tag){case k0:return O(Y.inheritAll,()=>Z.onOtherDone(Q,$));case v0:return Z.onOtherDone(Q,$)}})})),ex=(X)=>U0((J)=>o4((Z)=>O(V3(J(X)),(Y)=>U(J(j9(Y)),M9(()=>U(Y,RA(Z))))))),XW=B(2,(X,J)=>o4((Z)=>Q_(X,J,{onSelfDone:(Y,$)=>n$(Y,{onFailure:(Q)=>U(j9($),$Q((G)=>l6(Q,G))),onSuccess:(Q)=>U($,l4(Z),s8(Q))}),onOtherDone:(Y,$)=>n$(Y,{onFailure:(Q)=>U(j9($),$Q((G)=>l6(G,Q))),onSuccess:(Q)=>U($,l4(Z),s8(Q))})}))),G_=B(3,(X,J,Z)=>A8((Y,$)=>{let Q=$.runtimeFlags,G=f4(!0),H=iV(X,Y,Q,Z.selfScope),K=iV(J,Y,Q,Z.otherScope);return B4((V)=>{H.addObserver(()=>Lx(H,K,Z.onSelfWin,G,V)),K.addObserver(()=>Lx(K,H,Z.onOtherWin,G,V)),H.startFork(X),K.startFork(J)},I$(H.id(),K.id()))})),Lx=(X,J,Z,Y,$)=>{if(tK(!0,!1)(Y))$(Z(X,J))},X9=B(2,(X,J)=>U0((Z)=>H0(Z(X),{onFailure:(Y)=>H0(J,{onFailure:($)=>E8(Q0(Y,$)),onSuccess:()=>E8(Y)}),onSuccess:(Y)=>s8(J,Y)}))),re=(X,J,Z)=>o4((Y)=>O(O(V3(p5(X)),($)=>B4((Q)=>{let G=J.map((V)=>V.listeners.count),H=()=>{if(G.every((V)=>V===0)){if(J.every((V)=>{if(V.result.state.current._tag==="Pending")return!0;else if(V.result.state.current._tag==="Done"&&k2(V.result.state.current.effect)&&V.result.state.current.effect._tag==="Failure"&&N2(V.result.state.current.effect.cause))return!0;else return!1}))K.forEach((V)=>V()),Z?.(),Q(sJ($))}};$.addObserver((V)=>{K.forEach((W)=>W()),Q(V)});let K=J.map((V,W)=>{let N=(z)=>{G[W]=z,H()};return V.listeners.addObserver(N),()=>V.listeners.removeObserver(N)});return H(),T(()=>{K.forEach((V)=>V())})})),()=>h(()=>{let $=J.flatMap((Q)=>{if(!Q.state.completed)return[Q];return[]});return P9($,(Q)=>pA(Q.request,fB(Y)))})));var KQ=(X,J)=>{return J=kX(J),f5(A8((Z)=>{let Y=CJ(Z.getFiberRef(D6),e4),$=vV(Z,X,J),Q=Z.getFiberRef(kZ),G=z6(Z.getFiberRef(_0),R9);return s8(X1(Y,(H)=>OA($,H,G,Q)),$)}))},H_=(X)=>E9(_0,$0(k7,X)),Xy=function(){let X=typeof arguments[0]!=="string",J=X?arguments[1]:arguments[0],Z=kX(X?arguments[2]:arguments[1]);if(X){let Y=arguments[0];return O(KQ(J,kX(Z)),($)=>B1(Y,K5,$))}return(Y)=>O(KQ(J,kX(Z)),($)=>B1(Y,K5,$))};var Jy=r6,JW=c5,q1=r0,ZW=T4,Zy=l6,Yy=Q0,$y=U2;var Qy=qC,K_=PZ;var YW=N2,q3=MZ;var Gy=FZ;var $W=u5,QW=OC;var O1=AB;var B_=uC;var Hy=O2;var Ky=R4;var GW=L9;var le="effect/ScheduleInterval",O3=Symbol.for(le),V_={[O3]:O3,startMillis:0,endMillis:0},HW=(X,J)=>{if(X>J)return V_;return{[O3]:O3,startMillis:X,endMillis:J}},By=B(2,(X,J)=>Vy(X,J)===X),Vy=B(2,(X,J)=>{if(X.endMillis<=J.startMillis)return X;if(J.endMillis<=X.startMillis)return J;if(X.startMillis<J.startMillis)return X;if(J.startMillis<X.startMillis)return J;if(X.endMillis<=J.endMillis)return X;return J});var Wy=(X)=>{return X.startMillis>=X.endMillis};var Uy=B(2,(X,J)=>{let Z=Math.max(X.startMillis,J.startMillis),Y=Math.min(X.endMillis,J.endMillis);return HW(Z,Y)}),Ny=(X)=>{return w7(X.endMillis-X.startMillis)};var zy=(X)=>{return HW(X,Number.POSITIVE_INFINITY)};var KW=HW,W_=V_,qy=By;var Oy=Wy;var Dy=Uy,Ay=Ny;var _y=zy;var ae="effect/ScheduleIntervals",N_=Symbol.for(ae),z_=(X)=>{return{[N_]:N_,intervals:X}};var wy=B(2,(X,J)=>se(X.intervals,J.intervals,e8())),se=(X,J,Z)=>{let Y=X,$=J,Q=Z;while(q6(Y)&&q6($)){let G=U(E6(Y),Dy(E6($))),H=Oy(G)?Q:U(Q,O0(G));if(U(E6(Y),qy(E6($))))Y=K4(Y);else $=K4($);Q=H}return z_(A9(Q))},BW=(X)=>{return U(X.intervals,KZ,i(()=>W_)).startMillis},Ly=(X)=>{return U(X.intervals,KZ,i(()=>W_)).endMillis},Ty=B(2,(X,J)=>BW(X)<BW(J)),Py=(X)=>{return q6(X.intervals)};var My=z_;var Fy=wy,VW=BW,WW=Ly,Ry=Ty,jy=Py;var O_="Continue",Cy="Done",Ey=(X)=>{return{_tag:O_,intervals:X}},Iy=(X)=>{return{_tag:O_,intervals:My(I8(X))}},Sy={_tag:Cy},vy=(X)=>{return X._tag===O_},ky=(X)=>{return X._tag===Cy};var xy=Ey;var D_=Iy,BQ=Sy,A_=vy,VQ=ky;var by=e4,fX=S2,gy=X1,D3=n5,hy=h7,UW=xZ;var my=z1;class cy{permits;waiters=new Set;taken=0;constructor(X){this.permits=X}get free(){return this.permits-this.taken}take=(X)=>M7((J)=>{if(this.free<X){let Z=()=>{if(this.free<X)return;this.waiters.delete(Z),this.taken+=X,J(w(X))};return this.waiters.add(Z),T(()=>{this.waiters.delete(Z)})}return this.taken+=X,J(w(X))});updateTakenUnsafe(X,J){if(this.taken=J(this.taken),this.waiters.size>0)X.getFiberRef(iZ).scheduleTask(()=>{let Z=this.waiters.values(),Y=Z.next();while(Y.done===!1&&this.free>0)Y.value(),Y=Z.next()},X.getFiberRef(I7));return w(this.free)}updateTaken(X){return A8((J)=>this.updateTakenUnsafe(J,X))}resize=(X)=>W0(A8((J)=>{if(this.permits=X,this.free<0)return K8;return this.updateTakenUnsafe(J,(Z)=>Z)}));release=(X)=>this.updateTaken((J)=>J-X);releaseAll=this.updateTaken((X)=>0);withPermits=(X)=>(J)=>U0((Z)=>O(Z(this.take(X)),(Y)=>X9(Z(J),this.release(Y))));withPermitsIfAvailable=(X)=>(J)=>U0((Z)=>h(()=>{if(this.free<X)return tZ;return this.taken+=X,X9(Z(ZQ(J)),this.release(X))}))}var UQ=(X)=>new cy(X),uy=(X)=>T(()=>UQ(X));class py extends a4{isOpen;waiters=[];scheduled=!1;constructor(X){super();this.isOpen=X}commit(){return this.await}unsafeSchedule(X){if(this.scheduled||this.waiters.length===0)return K8;return this.scheduled=!0,X.currentScheduler.scheduleTask(this.flushWaiters,X.getFiberRef(I7)),K8}flushWaiters=()=>{this.scheduled=!1;let X=this.waiters;this.waiters=[];for(let J=0;J<X.length;J++)X[J](M0)};open=A8((X)=>{if(this.isOpen)return K8;return this.isOpen=!0,this.unsafeSchedule(X)});unsafeOpen(){if(this.isOpen)return;this.isOpen=!0,this.flushWaiters()}release=A8((X)=>{if(this.isOpen)return K8;return this.unsafeSchedule(X)});await=M7((X)=>{if(this.isOpen)return X(K8);return this.waiters.push(X),T(()=>{let J=this.waiters.indexOf(X);if(J!==-1)this.waiters.splice(J,1)})});unsafeClose(){this.isOpen=!1}close=T(()=>{this.isOpen=!1});whenOpen=(X)=>{return j8(this.await,X)}}var L_=(X)=>new py(X??!1),fy=(X)=>T(()=>L_(X)),ny=(X)=>NW(X,tx),oy=B(2,(X,J)=>I(T_(X,J),(Z)=>Z[0])),T_=B(2,(X,J)=>{let Z=g0(J);return O(F9(),(Y)=>I(NQ(_()),($)=>[o5(X88(X,Z,$),Y),J88($)]))}),dy=(X,J,Z)=>{let Y=h5(g0(J));return U(W4(),V4(($)=>j7(X,$)),I(($)=>D([Z+Y,$])))},X88=(X,J,Z)=>U0((Y)=>U(y7(($)=>$.currentTimeMillis),O(($)=>$b(Z,(Q)=>{switch(Q._tag){case"None":return D(dy(X,J,$));case"Some":{let[G]=Q.value;return G-$<=0?D(dy(X,J,$)):_()}}})),O(($)=>p8($)?uJ("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):Y(m0($.value[1]))))),J88=(X)=>B5(X,_()),ry=B(2,(X,J)=>NW(X,(Z)=>J($_(Z)))),NW=B(2,(X,J)=>O(Bx,(Z)=>U(P_(X,Z),X9(O(Z.value,J))))),ly=B((X)=>s9(X[0]),(X,J)=>J?.discard?P9(X,uX):I(i6(X,uX),$_)),A3=B(2,(X,J)=>A8((Z,Y)=>{let $=J,Q=W3(X,Z,Y.runtimeFlags,mX);if($.state._tag==="Open"){let G=()=>o4((K)=>S(K,Q.id())?K8:W0(sJ(Q))),H={};$.state.finalizers.set(H,G),Q.addObserver(()=>{if($.state._tag==="Closed")return;$.state.finalizers.delete(H)})}else Q.unsafeInterruptAsFork(Z.id());return w(Q)})),zW=(X)=>KY((J)=>A3(X,J)),iy=(X)=>j9(X),ay=(X)=>h(()=>O(X,j9)),__=Symbol.for("effect/Effect/memoizeFunction.key");class w_{a;eq;[__]=__;constructor(X,J){this.a=X,this.eq=J}[u](X){if(v(X,__))if(this.eq)return this.eq(this.a,X.a);else return S(this.a,X.a);return!1}[f](){return this.eq?0:D8(this,F(this.a))}}var sy=(X,J)=>{return U(T(()=>YY()),O(NQ),I((Z)=>(Y)=>U(Z.modifyEffect(($)=>{let Q=U($,Y6(new w_(Y,J)));if(p8(Q))return U(W4(),V4((G)=>U(YQ(X(Y)),j7(G),uX)),I((G)=>[G,U($,t4(new w_(Y,J),G))]));return w([Q.value,$])}),O(m0),O(([$,Q])=>U(sZ($),s8(Q))))))},ty=B(2,(X,J)=>U(P0(X),XW(P0(J)),(Z)=>r4(Z))),P_=B(2,(X,J)=>{return O6(z3,(Y)=>Y.zip(J))(X)}),ey=B(2,(X,J)=>M_(X,{onTimeout:()=>rC(J),duration:J})),M_=B(2,(X,{duration:J,onTimeout:Z})=>r4(_3(X,{onTimeout:()=>$5(Z),onSuccess:w,duration:J}))),Xb=B(2,(X,{duration:J,onTimeout:Z})=>r4(_3(X,{onTimeout:()=>fJ(Z),onSuccess:w,duration:J}))),Jb=B(2,(X,J)=>_3(X,{duration:J,onSuccess:D,onTimeout:_})),_3=B(2,(X,{duration:J,onSuccess:Z,onTimeout:Y})=>o4(($)=>U0((Q)=>G_(Q(X),p5(hX(J)),{onSelfWin:(G,H)=>O(G.await,(K)=>{if(K._tag==="Success")return O(G.inheritAll,()=>s8(l4(H,$),Z(K.value)));else return O(l4(H,$),()=>g8(K.cause))}),onOtherWin:(G,H)=>O(G.await,(K)=>{if(K._tag==="Success")return O(G.inheritAll,()=>s8(l4(H,$),Y()));else return O(l4(H,$),()=>g8(K.cause))}),otherScope:mX})))),Z88="effect/Ref/SynchronizedRef",Zb=Symbol.for(Z88),Y88={_A:(X)=>X};class Yb extends a4{ref;withLock;[Zb]=Y88;[AV]=pD;[r5]=r5;constructor(X,J){super();this.ref=X,this.withLock=J,this.get=_6(this.ref)}get;commit(){return this.get}modify(X){return this.modifyEffect((J)=>w(X(J)))}modifyEffect(X){return this.withLock(U(O(_6(this.ref),X),O(([J,Z])=>s8(B5(this.ref,Z),J))))}}var NQ=(X)=>T(()=>qW(X)),qW=(X)=>{let J=XQ(X),Z=UQ(1);return new Yb(J,Z.withPermits(1))},$b=B(2,(X,J)=>X.modifyEffect((Z)=>{let Y=J(Z);switch(Y._tag){case"None":return w([Z,Z]);case"Some":return I(Y.value,($)=>[$,$])}}));var Qb=B((X)=>f8(X[0]),(X,J,Z)=>O(X,(Y)=>N1(J(Y),Z).pipe(I(($)=>Object.assign({},Y,$)))));var Gb=Symbol.for("effect/ManagedRuntime");var Hb="Fresh",Kb="FromEffect",Bb="Scoped",Vb="Suspend",Wb="Provide",F_="ProvideMerge",Ub="ZipWith";var w3=gV;var R_=hV,nX=sJ;var L3=l4;var Nb=mV;var j_=j9;var zQ=(X)=>function(){if(arguments.length===1){let J=arguments[0];return(Z,...Y)=>X(J,Z,...Y)}return X.apply(this,arguments)},qQ=zQ((X,J,Z)=>{let Y=ZB(),$=[[D6,[[Y,X.context]]]];if(Z?.scheduler)$.push([iZ,[[Y,Z.scheduler]]]);let Q=QI(X.fiberRefs,{entries:$,forkAs:Y});if(Z?.updateRefs)Q=Z.updateRefs(Q,Y);let G=new tV(Y,Q,X.runtimeFlags),H=J;if(Z?.scope)H=O(UW(Z.scope,Q1),(V)=>j8(S2(V,o4((W)=>S(W,G.id())?K8:l4(G,W))),F4(J,(W)=>D3(V,W))));let K=G.currentSupervisor;if(K!==QY)K.onStart(X.context,H,_(),G),G.addObserver((V)=>K.onEnd(V,G));if(mX.add(X.runtimeFlags,G),Z?.immediate===!1)G.resume(H);else G.start(H);return G}),DW=zQ((X,J,Z={})=>{let Y=qQ(X,J,Z);if(Z.onExit)Y.addObserver(($)=>{Z.onExit($)});return($,Q)=>DW(X)(U(Y,L3($??I6)),{...Q,onExit:Q?.onExit?(G)=>Q.onExit(iv(G)):void 0})}),zb=zQ((X,J)=>{let Z=I_(X)(J);if(Z._tag==="Failure")throw E_(Z.effect_instruction_i0);return Z.effect_instruction_i0});class qb extends Error{fiber;_tag="AsyncFiberException";constructor(X){super(`Fiber #${X.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`);this.fiber=X,this.name=this._tag,this.stack=this.message}}var G88=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=0;let Z=new qb(X);return Error.stackTraceLimit=J,Z};var C_=Symbol.for("effect/Runtime/FiberFailure"),P3=Symbol.for("effect/Runtime/FiberFailure/Cause");class Ob extends Error{[C_];[P3];constructor(X){let J=wB(X)[0];super(J?.message||"An error has occurred");if(this[C_]=C_,this[P3]=X,this.name=J?`(FiberFailure) ${J.name}`:"FiberFailure",J?.stack)this.stack=J.stack}toJSON(){return{_id:"FiberFailure",cause:this[P3].toJSON()}}toString(){return"(FiberFailure) "+L9(this[P3],{renderErrorCause:!0})}[T8](){return this.toString()}}var E_=(X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=0;let Z=new Ob(X);return Error.stackTraceLimit=J,Z};var Db=(X)=>{let J=X;switch(J._op){case"Failure":case"Success":return J;case"Left":return vX(J.left);case"Right":return m8(J.right);case"Some":return m8(J.value);case"None":return vX(R4())}},I_=zQ((X,J)=>{let Z=Db(J);if(Z)return Z;let Y=new u2,$=qQ(X)(J,{scheduler:Y});Y.flush();let Q=$.unsafePoll();if(Q)return Q;return pB(RB(G88($),iB($)))}),Ab=zQ((X,J,Z)=>AW(X,J,Z).then((Y)=>{switch(Y._tag){case k0:return Y.effect_instruction_i0;case v0:throw E_(Y.effect_instruction_i0)}})),AW=zQ((X,J,Z)=>new Promise((Y)=>{let $=Db(J);if($)Y($);let Q=qQ(X)(J);if(Q.addObserver((G)=>{Y(G)}),Z?.signal!==void 0)if(Z.signal.aborted)Q.unsafeInterruptAsFork(Q.id());else Z.signal.addEventListener("abort",()=>{Q.unsafeInterruptAsFork(Q.id())},{once:!0})}));class S_{context;runtimeFlags;fiberRefs;constructor(X,J,Z){this.context=X,this.runtimeFlags=J,this.fiberRefs=Z}pipe(){return C(this,arguments)}}var v_=(X)=>new S_(X.context,X.runtimeFlags,X.fiberRefs),_W=()=>A8((X,J)=>w(new S_(X.getFiberRef(D6),J.runtimeFlags,X.getFiberRefs()))),_b=wO(d5,DO,OO),m7=v_({context:D9(),runtimeFlags:_b,fiberRefs:GI()});var wb=B(2,(X,J)=>v_({context:J(X.context),runtimeFlags:X.runtimeFlags,fiberRefs:X.fiberRefs}));var Lb=DW(m7),Tb=qQ(m7),Pb=Ab(m7),Mb=AW(m7),Fb=zb(m7),Rb=I_(m7),jb=(X)=>h(()=>{let J=void 0;return O(W4(),(Z)=>O(_W(),(Y)=>U0(($)=>j8(uX($(H0(X((Q)=>DW(Y)(j7(Q,Z))),{onFailure:(Q)=>o$(Z,Q),onSuccess:(Q)=>{return J=Q,K8}}))),$(M9(m0(Z),()=>J??K8))))))});var x_=B(2,(X,J)=>X.modifyEffect(J));var Cb=B(2,(X,J)=>X.modifyEffect((Z)=>I(J(Z),(Y)=>[void 0,Y])));var H88="effect/Layer",y_=Symbol.for(H88),K88={_RIn:(X)=>X,_E:(X)=>X,_ROut:(X)=>X},BY={[y_]:K88,pipe(){return C(this,arguments)}},B88="effect/Layer/MemoMap",wW=Symbol.for(B88),vb=AX()("effect/Layer/CurrentMemoMap",{defaultValue:()=>V88()}),kb=(X)=>v(X,y_),xb=(X)=>{return X._op_layer===Hb};class b_{ref;[wW];constructor(X){this.ref=X,this[wW]=wW}getOrElseMemoize(X,J){return U(x_(this.ref,(Z)=>{let Y=Z.get(X);if(Y!==void 0){let[$,Q]=Y,G=U($,O(([H,K])=>U(sZ(H),s8(K))),F4(bZ({onFailure:()=>K8,onSuccess:()=>X1(J,Q)})));return w([G,Z])}return U(lZ(0),O(($)=>U(W4(),O((Q)=>U(lZ(()=>K8),I((G)=>{let H=U0((V)=>U(z1(),O((W)=>U(V(O(gb(X,W,!0),(N)=>YQ(N(this)))),P0,O((N)=>{switch(N._tag){case v0:return U(o$(Q,N.effect_instruction_i0),j8(n5(W,N)),j8(E8(N.effect_instruction_i0)));case k0:return U(B5(G,(z)=>U(n5(W,z),iJ(_V($,(q)=>[q===1,q-1])),W0)),j8(H1($,(z)=>z+1)),j8(X1(J,(z)=>U(T(()=>Z.delete(X)),j8(_6(G)),O((q)=>q(z))))),j8(r$(Q,N.effect_instruction_i0)),s8(N.effect_instruction_i0[1]))}}))))),K=[U(m0(Q),F4(n$({onFailure:()=>K8,onSuccess:()=>H1($,(V)=>V+1)}))),(V)=>U(_6(G),O((W)=>W(V)))];return[H,xb(X)?Z:Z.set(X,K)]}))))))}),r4)}}var yb=h(()=>I(NQ(new Map),(X)=>new b_(X))),V88=()=>new b_(qW(new Map));var g_=B(2,(X,J)=>O(yb,(Z)=>bb(X,Z,J))),bb=B(3,(X,J,Z)=>O(gb(X,Z),(Y)=>B1(Y(J),vb,J))),gb=(X,J,Z=!1)=>{let Y=X;switch(Y._op_layer){case"Locally":return T(()=>($)=>Y.f($.getOrElseMemoize(Y.self,J)));case"ExtendScope":return T(()=>($)=>KY((Q)=>$.getOrElseMemoize(Y.layer,Q)));case"Fold":return T(()=>($)=>U($.getOrElseMemoize(Y.layer,J),H0({onFailure:(Q)=>$.getOrElseMemoize(Y.failureK(Q),J),onSuccess:(Q)=>$.getOrElseMemoize(Y.successK(Q),J)})));case"Fresh":return T(()=>($)=>U(Y.layer,g_(J)));case"FromEffect":return Z?T(()=>($)=>Y.effect):T(()=>($)=>$.getOrElseMemoize(X,J));case"Provide":return T(()=>($)=>U($.getOrElseMemoize(Y.first,J),O((Q)=>U($.getOrElseMemoize(Y.second,J),o5(Q)))));case"Scoped":return Z?T(()=>($)=>h7(Y.effect,J)):T(()=>($)=>$.getOrElseMemoize(X,J));case"Suspend":return T(()=>($)=>$.getOrElseMemoize(Y.evaluate(),J));case"ProvideMerge":return T(()=>($)=>U($.getOrElseMemoize(Y.first,J),E7($.getOrElseMemoize(Y.second,J),Y.zipK)));case"ZipWith":return T(()=>($)=>U($.getOrElseMemoize(Y.first,J),pX($.getOrElseMemoize(Y.second,J),Y.zipK,{concurrent:!0})))}};var hb=()=>F3(F9());var M3=B(2,(X,J)=>{let Z=oG(X),Y=Z?X:J;return F3(I(Z?J:X,(Q)=>HZ(Y,Q)))});function F3(X){let J=Object.create(BY);return J._op_layer=Kb,J.effect=X,J}var mb=B(2,(X,J)=>ub(X,J,(Z,Y)=>k5(Z,Y))),LW=(...X)=>{let J=X[0];for(let Z=1;Z<X.length;Z++)J=mb(J,X[Z]);return J};var R3=B(2,(X,J)=>{let Z=oG(X),Y=Z?X:J;return db(I(Z?J:X,(Q)=>HZ(Y,Q)))});var db=(X)=>{let J=Object.create(BY);return J._op_layer=Bb,J.effect=X,J};var TW=B(2,(X,J)=>{let Z=oG(X);return F3(w(HZ(Z?X:J,Z?J:X)))});var h_=(X)=>{let J=Object.create(BY);return J._op_layer=Vb,J.evaluate=X,J},m_=B(2,(X,J)=>{let Z=oG(X),Y=Z?X:J,$=Z?J:X;return F3(T(()=>HZ(Y,$())))});var OQ=B(2,(X,J)=>h_(()=>{let Z=Object.create(BY);return Z._op_layer=Wb,Z.first=Object.create(BY,{_op_layer:{value:F_,enumerable:!0},first:{value:hb(),enumerable:!0},second:{value:Array.isArray(J)?LW(...J):J},zipK:{value:(Y,$)=>U(Y,k5($))}}),Z.second=X,Z})),cb=B(2,(X,J)=>{let Z=Object.create(BY);return Z._op_layer=F_,Z.first=J,Z.second=OQ(X,J),Z.zipK=(Y,$)=>{return U(Y,k5($))},Z}),ub=B(3,(X,J,Z)=>h_(()=>{let Y=Object.create(BY);return Y._op_layer=Ub,Y.first=X,Y.second=J,Y.zipK=Z,Y}));var Ib=B(2,(X,J)=>U3((Z)=>O(g_(J,Z),(Y)=>lB(X,Y)))),Sb=B(2,(X,J)=>{let Z=oZ(m7.fiberRefs,J.fiberRefs),Y=Z5(m7.runtimeFlags,J.runtimeFlags);return U0(($)=>A8((Q)=>{let G=Q.getFiberRef(D6),H=Q.getFiberRefs(),K=rZ(Q.id(),H)(Z),V=Q.currentRuntimeFlags,W=jX(Y)(V),N=oZ(K,H),z=Z5(W,V);return Q.setFiberRefs(K),Q.currentRuntimeFlags=W,X9(lB($(X),k5(G,J.context)),A8((q)=>{return q.setFiberRefs(rZ(q.id(),q.getFiberRefs())(N)),q.currentRuntimeFlags=jX(z)(q.currentRuntimeFlags),K8}))}))}),PW=B(2,(X,J)=>{if(Array.isArray(J))return Ib(X,LW(...J));else if(kb(J))return Ib(X,J);else if(IR(J))return lB(X,J);else if(Gb in J)return O(J.runtimeEffect,(Z)=>Sb(X,Z));else return Sb(X,J)});var pb=I(i4(_0),z6(H5)),j3=(X)=>S6(_0,(J)=>X(z6(J,H5))),c_=B(2,(X,J)=>O6(X,_0,$0(H5,J))),fb=(X)=>E9(_0,$0(H5,X));var nb=(...X)=>j3((J)=>J.error(...X));var ob=(...X)=>j3((J)=>J.log(...X));var lb=nb;var w0=ob;var w8={};QK(w8,{zipWith:()=>z4,zipRight:()=>B8,zipLeft:()=>N4,zip:()=>Y9,yieldNow:()=>K08,withUnhandledErrorLogLevel:()=>F48,withTracerTiming:()=>V98,withTracerScoped:()=>K98,withTracerEnabled:()=>B98,withTracer:()=>H98,withSpanScoped:()=>T98,withSpan:()=>Bh,withSchedulingPriority:()=>$68,withScheduler:()=>Y68,withRuntimeFlagsPatchScoped:()=>g48,withRuntimeFlagsPatch:()=>b48,withRequestCaching:()=>Y98,withRequestCache:()=>$98,withRequestBatching:()=>Z98,withRandomScoped:()=>k48,withRandomFixed:()=>v48,withRandom:()=>Hh,withParentSpan:()=>P98,withMetric:()=>p48,withMaxOpsBeforeYield:()=>Q68,withLogSpan:()=>T48,withFiberRuntime:()=>w1,withExecutionPlan:()=>D08,withEarlyRelease:()=>d08,withConsoleScoped:()=>W68,withConsole:()=>U68,withConfigProviderScoped:()=>L68,withConfigProvider:()=>w68,withConcurrency:()=>Z68,withClockScoped:()=>H68,withClock:()=>K68,whileLoop:()=>Gh,whenRef:()=>n68,whenLogLevel:()=>R48,whenFiberRef:()=>f68,whenEffect:()=>p68,when:()=>J7,void:()=>o,validateWith:()=>i48,validateFirst:()=>Y08,validateAll:()=>Z08,validate:()=>l48,using:()=>m08,useSpan:()=>w98,updateService:()=>E68,updateFiberRefs:()=>N48,unsandbox:()=>w08,unsafeMakeSemaphore:()=>Fw,unsafeMakeLatch:()=>sW,unlessEffect:()=>lW,unless:()=>u68,uninterruptibleMask:()=>WY,uninterruptible:()=>e5,tryPromise:()=>pW,tryMapPromise:()=>_08,tryMap:()=>Ow,try:()=>p7,transposeOption:()=>R98,transposeMapOption:()=>j98,transplant:()=>J68,tracerWith:()=>G98,tracer:()=>Q98,timeoutTo:()=>A68,timeoutOption:()=>D68,timeoutFailCause:()=>Zh,timeoutFail:()=>Jh,timeout:()=>_w,timedWith:()=>O68,timed:()=>q68,tapErrorTag:()=>t68,tapErrorCause:()=>lX,tapError:()=>s68,tapDefect:()=>a68,tapBoth:()=>i68,tap:()=>X0,takeWhile:()=>og,takeUntil:()=>f88,tagMetricsScoped:()=>d48,tagMetrics:()=>h48,sync:()=>V8,suspend:()=>z8,supervised:()=>X68,summarized:()=>l68,succeedSome:()=>H08,succeedNone:()=>uW,succeed:()=>L,step:()=>e48,spanLinks:()=>O98,spanAnnotations:()=>q98,sleep:()=>z68,setFiberRefs:()=>U48,serviceOptional:()=>C68,serviceOption:()=>rW,serviceMembers:()=>j68,serviceFunctions:()=>F68,serviceFunctionEffect:()=>M68,serviceFunction:()=>P68,serviceConstants:()=>R68,sequentialFinalizers:()=>g08,scopedWith:()=>m3,scoped:()=>k9,scopeWith:()=>Aw,scope:()=>h3,scheduleFrom:()=>$48,scheduleForked:()=>Y48,schedule:()=>Z48,sandbox:()=>O08,runtime:()=>aX,runSyncExit:()=>r48,runSync:()=>c0,runRequestBlock:()=>t48,runPromiseExit:()=>o48,runPromise:()=>Rw,runFork:()=>sX,runCallback:()=>n48,retryOrElse:()=>A08,retry:()=>qw,request:()=>X98,replicateEffect:()=>J08,replicate:()=>X08,repeatOrElse:()=>J48,repeatN:()=>u3,repeat:()=>iW,reduceWhile:()=>s88,reduceRight:()=>t88,reduceEffect:()=>e88,reduce:()=>lg,randomWith:()=>S48,random:()=>I48,raceWith:()=>c3,raceFirst:()=>$h,raceAll:()=>r68,race:()=>d3,provideServiceEffect:()=>oW,provideService:()=>PQ,provide:()=>L1,promise:()=>sg,patchRuntimeFlags:()=>y48,patchFiberRefs:()=>W48,partition:()=>a88,parallelFinalizers:()=>b08,parallelErrors:()=>q08,orElseSucceed:()=>C48,orElseFail:()=>NY,orElse:()=>iX,orDieWith:()=>j48,orDie:()=>d0,optionFromOptional:()=>F98,option:()=>y68,once:()=>c88,onInterrupt:()=>R08,onExit:()=>y08,onError:()=>g3,none:()=>G08,never:()=>cW,negate:()=>Dw,metricLabels:()=>u48,mergeAll:()=>i88,merge:()=>k08,matchEffect:()=>M6,matchCauseEffect:()=>x9,matchCause:()=>P1,match:()=>q5,mapInputContext:()=>T68,mapErrorCause:()=>v08,mapError:()=>s6,mapBoth:()=>v9,mapAccum:()=>S08,map:()=>k,makeSpanScoped:()=>_98,makeSpan:()=>Kh,makeSemaphore:()=>aW,makeLatch:()=>f48,loop:()=>X48,logWithLevel:()=>D48,logWarning:()=>Tw,logTrace:()=>A48,logInfo:()=>w48,logFatal:()=>L48,logError:()=>Pw,logDebug:()=>_48,logAnnotations:()=>M48,log:()=>O48,locallyWith:()=>K48,locallyScopedWith:()=>V48,locallyScoped:()=>B48,locally:()=>H48,linkSpans:()=>D98,linkSpanCurrent:()=>A98,liftPredicate:()=>j08,let:()=>x68,labelMetricsScoped:()=>c48,labelMetrics:()=>m48,iterate:()=>e68,isSuccess:()=>q48,isFailure:()=>z48,isEffect:()=>T6,intoDeferred:()=>MQ,interruptibleMask:()=>F08,interruptible:()=>g6,interruptWith:()=>M08,interrupt:()=>rX,inheritFiberRefs:()=>G48,ignoreLogged:()=>z08,ignore:()=>wQ,if:()=>b68,head:()=>l88,getRuntimeFlags:()=>x48,getFiberRefs:()=>Q48,gen:()=>_8,functionWithSpan:()=>L98,fromNullable:()=>M98,fromFiberEffect:()=>e08,fromFiber:()=>t08,forkWithErrorHandler:()=>s08,forkScoped:()=>TQ,forkIn:()=>X7,forkDaemon:()=>UY,forkAll:()=>a08,fork:()=>i08,forever:()=>Qh,forEach:()=>F0,fnUntraced:()=>FQ,fn:()=>I98,flipWith:()=>I08,flip:()=>E08,flatten:()=>z5,flatMap:()=>R,firstSuccessOf:()=>E48,findFirst:()=>rg,finalizersMask:()=>h08,filterOrFail:()=>m68,filterOrElse:()=>h68,filterOrDieMessage:()=>Lw,filterOrDie:()=>g68,filterMap:()=>r88,filterEffectOrFail:()=>c68,filterEffectOrElse:()=>d68,filter:()=>mW,fiberIdWith:()=>fW,fiberId:()=>l08,failSync:()=>dW,failCauseSync:()=>ig,failCause:()=>U4,fail:()=>x,exit:()=>$6,exists:()=>o88,every:()=>n88,eventually:()=>N08,ensuringChildren:()=>r08,ensuringChild:()=>o08,ensuring:()=>Z9,ensureSuccessType:()=>S98,ensureRequirementsType:()=>k98,ensureErrorType:()=>v98,either:()=>T1,dropWhile:()=>Uw,dropUntil:()=>Ww,disconnect:()=>P08,diffFiberRefs:()=>n08,dieSync:()=>ag,dieMessage:()=>oX,die:()=>I9,descriptorWith:()=>f08,descriptor:()=>p08,delay:()=>N68,daemonChildren:()=>u08,custom:()=>Q08,currentSpan:()=>N98,currentParentSpan:()=>z98,contextWithEffect:()=>ww,contextWith:()=>Yh,context:()=>nW,consoleWith:()=>V68,console:()=>B68,configProviderWith:()=>_68,clockWith:()=>G68,clock:()=>Xh,checkInterruptible:()=>T08,cause:()=>U08,catchTags:()=>zw,catchTag:()=>S9,catchSomeDefect:()=>W08,catchSomeCause:()=>tg,catchSome:()=>u7,catchIf:()=>Nw,catchAllDefect:()=>V08,catchAllCause:()=>c7,catchAll:()=>a6,catch:()=>B08,cachedWithTTL:()=>g88,cachedInvalidateWithTTL:()=>h88,cachedFunction:()=>d88,cached:()=>m88,cacheRequestResult:()=>J98,blocked:()=>s48,bindTo:()=>k68,bindAll:()=>v68,bind:()=>S68,awaitAllChildren:()=>c08,asyncEffect:()=>$08,async:()=>j4,asVoid:()=>J9,asSomeError:()=>C08,asSome:()=>eg,as:()=>K6,ap:()=>a48,annotateSpans:()=>W98,annotateLogsScoped:()=>P48,annotateLogs:()=>Mw,annotateCurrentSpan:()=>U98,andThen:()=>o68,allowInterrupt:()=>L08,allWith:()=>u88,allSuccesses:()=>p88,all:()=>y3,addFinalizer:()=>b3,acquireUseRelease:()=>LQ,acquireReleaseInterruptible:()=>x08,acquireRelease:()=>P6,Tag:()=>C98,Service:()=>E98,EffectTypeId:()=>b88,Do:()=>I68});var ib=x$;var E3=(X)=>(J)=>{let Z=J===void 0?Object.create(MJ):ib(J);return Z._tag=X,Z};var MW=()=>new Proxy({},{get(X,J,Z){if(J==="$is")return a9;else if(J==="$match")return W88;return E3(J)}});function W88(){if(arguments.length===1){let Z=arguments[0];return function(Y){return Z[Y._tag](Y)}}let X=arguments[0];return arguments[1][X._tag](X)}var u_=function(){let X=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends v2{constructor(Z){super(Z?.message,Z?.cause?{cause:Z.cause}:void 0);if(Z)Object.assign(this,Z),Object.defineProperty(this,X,{value:Z,enumerable:!1})}toJSON(){return{...this[X],...this}}}}.BaseEffectError}(),FW=(X)=>{let J={BaseEffectError:class extends u_{_tag=X}};return J.BaseEffectError.prototype.name=X,J.BaseEffectError};var ab=IE;var U88="effect/Schedule",n_=Symbol.for(U88),o_=(X)=>v(X,n_),N88="effect/ScheduleDriver",Xg=Symbol.for(N88),p_={start:0,now:0,input:void 0,output:void 0,elapsed:EJ,elapsedSincePrevious:EJ,recurrence:0},DQ=AX()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>p_}),z88={_Out:(X)=>X,_In:(X)=>X,_R:(X)=>X},q88={_Out:(X)=>X,_In:(X)=>X,_R:(X)=>X};class Jg{initial;step;[n_]=z88;constructor(X,J){this.initial=X,this.step=J}pipe(){return C(this,arguments)}}var tb=(X,J,Z,Y)=>H1(X,($)=>$.recurrence===0?{now:J,input:Z,output:Y,recurrence:$.recurrence+1,elapsed:EJ,elapsedSincePrevious:EJ,start:J}:{now:J,input:Z,output:Y,recurrence:$.recurrence+1,elapsed:w7(J-$.start),elapsedSincePrevious:w7(J-$.now),start:$.start});class Zg{schedule;ref;[Xg]=q88;constructor(X,J){this.schedule=X,this.ref=J}get state(){return I(_6(this.ref),(X)=>X[1])}get last(){return O(_6(this.ref),([X,J])=>{switch(X._tag){case"None":return $5(()=>new R4);case"Some":return w(X.value)}})}iterationMeta=XQ(p_);get reset(){return B5(this.ref,[_(),this.schedule.initial]).pipe(SZ(B5(this.iterationMeta,p_)))}next(X){return U(I(_6(this.ref),(J)=>J[1]),O((J)=>U(TV,O((Z)=>U(h(()=>this.schedule.step(Z,X,J)),O(([Y,$,Q])=>{let G=B5(this.ref,[D($),Y]);if(VQ(Q))return G.pipe(j8(R8(_())));let H=VW(Q.intervals)-Z;if(H<=0)return G.pipe(j8(tb(this.iterationMeta,Z,X,$)),s8($));let K=w7(H);return U(G,j8(tb(this.iterationMeta,Z,X,$)),j8(hX(K)),s8($))}))))))}}var VY=(X,J)=>new Jg(X,J),Yg=B(2,(X,J)=>$g(X,(Z)=>T(()=>J(Z)))),$g=B(2,(X,J)=>Bg(X,(Z,Y)=>I(J(Z),($)=>cR(Y,g0($)))));var Qg=(X)=>l_(X,Y4);var Gg=B(2,(X,J)=>CW(X,(Z,Y)=>T(()=>J(Z,Y)))),CW=B(2,(X,J)=>VY(X.initial,(Z,Y,$)=>O(X.step(Z,Y,$),([Q,G,H])=>{if(VQ(H))return w([Q,G,BQ]);return I(J(Y,G),(K)=>K?[Q,G,H]:[Q,G,BQ])})));var EW=(X)=>U(lZ([_(),X.initial]),I((J)=>new Zg(X,J)));var r_=B(2,(X,J)=>Hg(X,J,Fy)),Hg=B(3,(X,J,Z)=>VY([X.initial,J.initial],(Y,$,Q)=>U(E7(X.step(Y,$,Q[0]),J.step(Y,$,Q[1]),(G,H)=>[G,H]),O(([[G,H,K],[V,W,N]])=>{if(A_(K)&&A_(N))return f_(X,J,$,G,H,K.intervals,V,W,N.intervals,Z);return w([[G,V],[H,W],BQ])})))),f_=(X,J,Z,Y,$,Q,G,H,K,V)=>{let W=V(Q,K);if(jy(W))return w([[Y,G],[$,H],xy(W)]);if(U(Q,Ry(K)))return O(X.step(WW(Q),Z,Y),([N,z,q])=>{if(VQ(q))return w([[N,G],[z,H],BQ]);return f_(X,J,Z,N,z,q.intervals,G,H,K,V)});return O(J.step(WW(K),Z,G),([N,z,q])=>{if(VQ(q))return w([[Y,N],[$,z],BQ]);return f_(X,J,Z,Y,$,Q,N,z,q.intervals,V)})};var l_=B(2,(X,J)=>Kg(X,(Z)=>T(()=>J(Z)))),Kg=B(2,(X,J)=>VY(X.initial,(Z,Y,$)=>O(X.step(Z,Y,$),([Q,G,H])=>I(J(G),(K)=>[Q,K,H]))));var Bg=B(2,(X,J)=>VY(X.initial,(Z,Y,$)=>O(X.step(Z,Y,$),([Q,G,H])=>{if(VQ(H))return w([Q,G,H]);let K=H.intervals,V=Ay(KW(Z,VW(K)));return I(J(G,V),(W)=>{let N=g0(W),z=VW(K),q=Z+h5(N),A=q-z,E=Math.max(0,WW(K)+A),P=KW(q,E);return[Q,G,D_(P)]})})));var Vg=(X)=>VY(X.initial,(J,Z,Y)=>U(X.step(J,Z,Y),I(([$,Q,G])=>[$,Z,G])));var IW=(X)=>Ng(k3,(J)=>J<X);var Wg=(X)=>Yg(k3,()=>X);var Ug=(X,J)=>VY(X,(Z,Y,$)=>T(()=>[J($),$,D_(_y(Z))]));var i_=B(2,(X,J)=>CW(X,(Z,Y)=>CV(J(Z))));var a_=B(2,(X,J)=>CW(X,(Z,Y)=>J(Z))),Ng=B(2,(X,J)=>Gg(X,(Z,Y)=>J(Y)));var RW=Symbol.for("effect/Schedule/ScheduleDefect");class zg{error;[RW];constructor(X){this.error=X,this[RW]=RW}}var O88=(X)=>v(X,RW),jW=(X)=>T9(X,(J)=>P4(new zg(J))),D88=(X)=>n(dJ(X,(J)=>PZ(J)&&O88(J.defect)?D(J.defect):_()),{onNone:()=>X,onSome:(J)=>c5(J.error)}),v3=(X)=>F7(X,(J)=>E8(D88(J))),eb=B(2,(X,J)=>s_(X,J,(Z,Y)=>R8(Z))),qg=B(2,(X,J)=>{if(o_(J))return eb(X,J);let Z=J.schedule??Vg(k3),Y=J.while?a_(Z,(G)=>{let H=J.while(G);if(typeof H==="boolean")return w(H);return jW(H)}):Z,$=J.until?i_(Y,(G)=>{let H=J.until(G);if(typeof H==="boolean")return w(H);return jW(H)}):Y,Q=J.times?r_($,IW(J.times)).pipe(l_((G)=>G[0])):$;return v3(eb(X,Q))}),s_=B(3,(X,J,Z)=>O(EW(J),(Y)=>H6(X,{onFailure:($)=>Z($,_()),onSuccess:($)=>Og(V1(X,DQ,_6(Y.iterationMeta)),Y,(Q,G)=>V1(Z(Q,G),DQ,_6(Y.iterationMeta)),$)}))),Og=(X,J,Z,Y)=>H6(J.next(Y),{onFailure:()=>EZ(J.last),onSuccess:($)=>H6(X,{onFailure:(Q)=>Z(Q,D($)),onSuccess:(Q)=>Og(X,J,Z,Q)})}),S3=B(2,(X,J)=>t_(X,J,(Z,Y)=>R8(Z))),Dg=B(2,(X,J)=>{if(o_(J))return S3(X,J);return v3(S3(X,SW(J)))}),SW=(X)=>{let J=X.schedule??k3,Z=X.while?a_(J,($)=>{let Q=X.while($);if(typeof Q==="boolean")return w(Q);return jW(Q)}):J,Y=X.until?i_(Z,($)=>{let Q=X.until($);if(typeof Q==="boolean")return w(Q);return jW(Q)}):Z;return X.times?r_(Y,IW(X.times)):Y},t_=B(3,(X,J,Z)=>O(EW(J),(Y)=>Ag(V1(X,DQ,_6(Y.iterationMeta)),Y,($,Q)=>V1(Z($,Q),DQ,_6(Y.iterationMeta))))),Ag=(X,J,Z)=>{return T9(X,(Y)=>H6(J.next(Y),{onFailure:()=>U(J.last,EZ,O(($)=>Z(Y,$))),onSuccess:()=>Ag(X,J,Z)}))},e_=B(2,(X,J)=>Xw(X,void 0,J)),Xw=B(3,(X,J,Z)=>O(EW(Z),(Y)=>_g(V1(X,DQ,_6(Y.iterationMeta)),J,Y))),_g=(X,J,Z)=>H6(Z.next(J),{onFailure:()=>EZ(Z.last),onSuccess:()=>O(X,(Y)=>_g(X,Y,Z))});var k3=Ug(0,(X)=>X+1),Jw=Qg(IW(1));var wg=B(2,(X,J)=>zW(e_(X,J)));var Tg=B(2,(X,J)=>h(()=>{let Z=0,Y;return O(aJ({while:()=>Z<J.steps.length&&(Y===void 0||z0(Y)),body:()=>{let $=J.steps[Z],Q=PW(X,$.provide);if(Y){let G=!1,H=Q;Q=h(()=>{if(G)return H;return G=!0,Y}),Q=v3(S3(Q,Lg($,!1)))}else{let G=Lg($,!0);Q=G?v3(S3(Q,G)):Q}return Y5(Q)},step:($)=>{Y=$,Z++}}),()=>Y)})),Lg=(X,J)=>{if(!J)return SW({schedule:X.schedule?X.schedule:X.attempts?void 0:Jw,times:X.attempts,while:X.while});else if(X.attempts===1||!(X.schedule||X.attempts))return;return SW({schedule:X.schedule,while:X.while,times:X.attempts?X.attempts-1:void 0})};var D1=LB,K0=W4;var k8=m0;var vW=oB;var Pg=QD,Yw=eC;var d7=o$;var x3=XE;var A1=JE;var b6=r$;var $w=Z1,N5=Y1;var Mg=Symbol.for("effect/MutableList"),_88={[Mg]:Mg,[Symbol.iterator](){let X=!1,J=this.head;return{next(){if(X)return this.return();if(J==null)return X=!0,this.return();let Z=J.value;return J=J.next,{done:X,value:Z}},return(Z){if(!X)X=!0;return{done:!0,value:Z}}}},toString(){return S8(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(v8)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},w88=(X)=>({value:X,removed:!1,prev:void 0,next:void 0}),Fg=()=>{let X=Object.create(_88);return X.head=void 0,X.tail=void 0,X._length=0,X};var Qw=(X)=>kW(X)===0,kW=(X)=>X._length;var Rg=B(2,(X,J)=>{let Z=w88(J);if(X.head===void 0)X.head=Z;if(X.tail===void 0)X.tail=Z;else X.tail.next=Z,Z.prev=X.tail,X.tail=Z;return X._length+=1,X}),jg=(X)=>{let J=X.head;if(J!==void 0)return L88(X,J),J.value;return};var L88=(X,J)=>{if(J.removed)return;if(J.removed=!0,J.prev!==void 0&&J.next!==void 0)J.prev.next=J.next,J.next.prev=J.prev;else if(J.prev!==void 0)X.tail=J.prev,J.prev.next=void 0;else if(J.next!==void 0)X.head=J.next,J.next.prev=void 0;else X.tail=void 0,X.head=void 0;if(X._length>0)X._length-=1};var Eg=Symbol.for("effect/MutableQueue"),L6=Symbol.for("effect/mutable/MutableQueue/Empty"),T88={[Eg]:Eg,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return S8(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(v8)}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},Ig=(X)=>{let J=Object.create(T88);return J.queue=Fg(),J.capacity=X,J},xW=(X)=>Ig(X),AQ=()=>Ig(void 0),yW=(X)=>kW(X.queue),bW=(X)=>Qw(X.queue);var Sg=(X)=>X.capacity===void 0?1/0:X.capacity,_1=B(2,(X,J)=>{let Z=kW(X.queue);if(X.capacity!==void 0&&Z===X.capacity)return!1;return Rg(J)(X.queue),!0}),Gw=B(2,(X,J)=>{let Z=J[Symbol.iterator](),Y,$=e8(),Q=!0;while(Q&&(Y=Z.next())&&!Y.done)Q=_1(Y.value)(X);while(Y!=null&&!Y.done)$=O0(Y.value)($),Y=Z.next();return A9($)}),t5=B(2,(X,J)=>{if(Qw(X.queue))return J;return jg(X.queue)}),gW=B(2,(X,J)=>{let Z=e8(),Y=0;while(Y<J){let $=t5(L6)(X);if($===L6)break;Z=O0($)(Z),Y+=1}return A9(Z)});var vg=(X,J,Z,Y)=>x$({_tag:"Complete",key:X,exit:J,entryStats:Z,timeToLiveMillis:Y}),kg=(X,J)=>x$({_tag:"Pending",key:X,deferred:J}),P88=(X,J)=>x$({_tag:"Refreshing",deferred:X,complete:J}),Kw=Symbol.for("effect/Cache/MapKey");class xg{current;[Kw]=Kw;previous=void 0;next=void 0;constructor(X){this.current=X}[f](){return U(F(this.current),b(F(this.previous)),b(F(this.next)),D8(this))}[u](X){if(this===X)return!0;return M88(X)&&S(this.current,X.current)&&S(this.previous,X.previous)&&S(this.next,X.next)}}var _Q=(X)=>new xg(X),M88=(X)=>v(X,Kw);class yg{head=void 0;tail=void 0;add(X){if(X!==this.tail)if(this.tail===void 0)this.head=X,this.tail=X;else{let{previous:J,next:Z}=X;if(Z!==void 0)if(X.next=void 0,J!==void 0)J.next=Z,Z.previous=J;else this.head=Z,this.head.previous=void 0;this.tail.next=X,X.previous=this.tail,this.tail=X}}remove(){let X=this.head;if(X!==void 0){let J=X.next;if(J!==void 0)X.next=void 0,this.head=J,this.head.previous=void 0;else this.head=void 0,this.tail=void 0}return X}}var F88=()=>new yg,R88=(X,J,Z,Y,$,Q)=>({map:X,keys:J,accesses:Z,updating:Y,hits:$,misses:Q}),j88=()=>R88(YY(),F88(),AQ(),f4(!1),0,0),C88="effect/Cache",E88=Symbol.for(C88),I88={_Key:(X)=>X,_Error:(X)=>X,_Value:(X)=>X},S88="effect/ConsumerCache",v88=Symbol.for(S88),k88={_Key:(X)=>X,_Error:(X)=>X,_Value:(X)=>X},x88=(X)=>X,hW=(X)=>({loadedMillis:X});class bg{capacity;context;fiberId;lookup;timeToLive;[E88]=I88;[v88]=k88;cacheState;constructor(X,J,Z,Y,$){this.capacity=X,this.context=J,this.fiberId=Z,this.lookup=Y,this.timeToLive=$,this.cacheState=j88()}get(X){return I(this.getEither(X),V$)}get cacheStats(){return T(()=>x88({hits:this.cacheState.hits,misses:this.cacheState.misses,size:cV(this.cacheState.map)}))}getOption(X){return h(()=>n(Y6(this.cacheState.map,X),{onNone:()=>{let J=_Q(X);return this.trackAccess(J),this.trackMiss(),w(_())},onSome:(J)=>this.resolveMapValue(J)}))}getOptionComplete(X){return h(()=>n(Y6(this.cacheState.map,X),{onNone:()=>{let J=_Q(X);return this.trackAccess(J),this.trackMiss(),w(_())},onSome:(J)=>this.resolveMapValue(J,!0)}))}contains(X){return T(()=>i5(this.cacheState.map,X))}entryStats(X){return T(()=>{let J=Y6(this.cacheState.map,X);if(H8(J))switch(J.value._tag){case"Complete":{let Z=J.value.entryStats.loadedMillis;return D(hW(Z))}case"Pending":return _();case"Refreshing":{let Z=J.value.complete.entryStats.loadedMillis;return D(hW(Z))}}return _()})}getEither(X){return h(()=>{let J=X,Z=void 0,Y=void 0,$=e0(Y6(this.cacheState.map,J));if($===void 0)if(Y=$w(this.fiberId),Z=_Q(J),i5(this.cacheState.map,J))$=e0(Y6(this.cacheState.map,J));else t4(this.cacheState.map,J,kg(Z,Y));if($===void 0)return this.trackAccess(Z),this.trackMiss(),I(this.lookupValueOf(X,Y),Z8);else return O(this.resolveMapValue($),n({onNone:()=>this.getEither(X),onSome:(Q)=>w($8(Q))}))})}invalidate(X){return T(()=>{$Y(this.cacheState.map,X)})}invalidateWhen(X,J){return T(()=>{let Z=Y6(this.cacheState.map,X);if(H8(Z)&&Z.value._tag==="Complete"){if(Z.value.exit._tag==="Success"){if(J(Z.value.exit.value))$Y(this.cacheState.map,X)}}})}get invalidateAll(){return T(()=>{this.cacheState.map=YY()})}refresh(X){return y7((J)=>h(()=>{let Z=X,Y=$w(this.fiberId),$=e0(Y6(this.cacheState.map,Z));if($===void 0)if(i5(this.cacheState.map,Z))$=e0(Y6(this.cacheState.map,Z));else t4(this.cacheState.map,Z,kg(_Q(Z),Y));if($===void 0)return W0(this.lookupValueOf(X,Y));else switch($._tag){case"Complete":{if(this.hasExpired(J,$.timeToLiveMillis)){let Q=e0(Y6(this.cacheState.map,Z));if(S(Q,$))$Y(this.cacheState.map,Z);return W0(this.get(X))}return U(this.lookupValueOf(X,Y),IV(()=>{let Q=e0(Y6(this.cacheState.map,Z));if(S(Q,$)){let G=P88(Y,$);return t4(this.cacheState.map,Z,G),!0}return!1}),W0)}case"Pending":return k8($.deferred);case"Refreshing":return k8($.deferred)}}))}set(X,J){return y7((Z)=>T(()=>{let Y=Z.unsafeCurrentTimeMillis(),$=X,Q=x6(J),G=vg(_Q($),Q,hW(Y),Y+h5(g0(this.timeToLive(Q))));t4(this.cacheState.map,$,G)}))}get size(){return T(()=>{return cV(this.cacheState.map)})}get values(){return T(()=>{let X=[];for(let J of this.cacheState.map)if(J[1]._tag==="Complete"&&J[1].exit._tag==="Success")X.push(J[1].exit.value);return X})}get entries(){return T(()=>{let X=[];for(let J of this.cacheState.map)if(J[1]._tag==="Complete"&&J[1].exit._tag==="Success")X.push([J[0],J[1].exit.value]);return X})}get keys(){return T(()=>{let X=[];for(let J of this.cacheState.map)if(J[1]._tag==="Complete"&&J[1].exit._tag==="Success")X.push(J[0]);return X})}resolveMapValue(X,J=!1){return y7((Z)=>{switch(X._tag){case"Complete":{if(this.trackAccess(X.key),this.hasExpired(Z,X.timeToLiveMillis))return $Y(this.cacheState.map,X.key.current),w(_());return this.trackHit(),I(X.exit,D)}case"Pending":{if(this.trackAccess(X.key),this.trackHit(),J)return w(_());return I(k8(X.deferred),D)}case"Refreshing":{if(this.trackAccess(X.complete.key),this.trackHit(),this.hasExpired(Z,X.complete.timeToLiveMillis)){if(J)return w(_());return I(k8(X.deferred),D)}return I(X.complete.exit,D)}}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(X){if(_1(this.cacheState.accesses,X),tK(this.cacheState.updating,!1,!0)){let J=!0;while(J){let Y=t5(this.cacheState.accesses,L6);if(Y===L6)J=!1;else this.cacheState.keys.add(Y)}let Z=cV(this.cacheState.map);J=Z>this.capacity;while(J){let Y=this.cacheState.keys.remove();if(Y!==void 0){if(i5(this.cacheState.map,Y.current))$Y(this.cacheState.map,Y.current),Z=Z-1,J=Z>this.capacity}else J=!1}J5(this.cacheState.updating,!1)}}hasExpired(X,J){return X.unsafeCurrentTimeMillis()>J}lookupValueOf(X,J){return y7((Z)=>h(()=>{let Y=X;return U(this.lookup(X),o5(this.context),P0,O(($)=>{let Q=Z.unsafeCurrentTimeMillis(),G=hW(Q),H=vg(_Q(Y),$,G,Q+h5(g0(this.timeToLive($))));return t4(this.cacheState.map,Y,H),j8(Pg(J,$),$)}),M9(()=>j8(x3(J),T(()=>{$Y(this.cacheState.map,Y)}))))}))}}var gg=(X,J,Z)=>new bg(X,D9(),J2,J,(Y)=>g0(Z(Y)));var Bw=X8(Symbol.for("effect/FiberRef/currentCache"),()=>A0(gg(65536,()=>I(W4(),(X)=>({listeners:new Z3,handle:X})),()=>mq(60)))),Vw=X8(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>A0(!1)),hg=(X,J)=>O(f8(J)?J:w(J),(Z)=>o4((Y)=>{let $=new Proxy(X,{});return S6(Vw,(Q)=>{if(Q){let H=S6(Bw,(K)=>O(K.getEither($),(V)=>{switch(V._tag){case"Left":{if(V.left.listeners.interrupted)return O(K.invalidateWhen($,(W)=>W.handle===V.left.handle),()=>H);return V.left.listeners.increment(),U0((W)=>O(P0(EX(GC,W(m0(V.left.handle)))),(N)=>{return V.left.listeners.decrement(),N}))}case"Right":return V.right.listeners.increment(),U0((W)=>O(P0(EX(EO(Z,IO({request:$,result:V.right.handle,listeners:V.right.listeners,ownerId:Y,state:{completed:!1}})),W(m0(V.right.handle)))),()=>{return V.right.listeners.decrement(),m0(V.right.handle)}))}}));return H}let G=new Z3;return G.increment(),O(W4(),(H)=>X9(EX(EO(Z,IO({request:$,result:H,listeners:G,ownerId:Y,state:{completed:!1}})),m0(H)),T(()=>G.decrement())))})})),mg=(X,J)=>{return S6(Vw,(Z)=>{if(Z)return S6(Bw,(Y)=>O(Y.getEither(X),($)=>{switch($._tag){case"Left":return K8;case"Right":return oB($.right.handle,J)}}));return K8})},dg=B(2,(X,J)=>N0(X,Vw,J)),cg=B(2,(X,J)=>N0(X,Bw,J));var ug=Gx;var b88=IX,T6=f8,g88=oy,h88=T_,m88=HA,d88=sy,c88=KA,y3=N1,u88=Sx,p88=vx,Ww=_S,Uw=wS,f88=zv,og=qv,n88=SS,o88=Cx,mW=Ix,r88=TS,rg=jS,F0=C9,l88=kS,i88=aA,a88=sA,lg=$v,s88=Gv,t88=Qv,e88=gx,X08=iA,J08=kx,Z08=yx,Y08=ux,j4=B4,$08=jb,Q08=L2,w1=A8,x=R8,dW=$5,U4=E8,ig=fJ,I9=P4,oX=uJ,ag=pJ,_8=IC,cW=vZ,G08=sS,sg=Zv,L=w,uW=tZ,H08=Uv,z8=h,V8=T,o=K8;var K08=C7,B08=GS;var a6=T9,c7=F7,V08=HS,Nw=T2,u7=RC,tg=KS,W08=BS,S9=VS,zw=WS,U08=US,N08=YA,wQ=jV,z08=xS,q08=Jv,O08=Vv,qw=Dg,D08=Tg,A08=t_,p7=ZA;var Ow=Tv,_08=Pv,pW=UA,w08=Rv,L08=qS,T08=jC,P08=ex,rX=M4,M08=M2,g6=p5,F08=CC,R08=M9,e5=f5,WY=U0,j08=FS,K6=s8,eg=ZQ,C08=QS,J9=W0,E08=oJ,I08=IS,k=I,S08=iS,v9=F2,s6=rJ,v08=$Q,k08=aS,Dw=CV,P6=B3,x08=Rx,LQ=FB,b3=HY,Z9=X9,g3=EB,y08=F4,b08=aV,g08=sV,h08=hx,h3=Y_,Aw=KY,m3=U3,k9=tA,m08=dx,d08=nx,c08=ny,u08=jx,p08=OS,f08=FV,n08=YQ,o08=ry,r08=NW,l08=R7,fW=o4,i08=uX,UY=V3,a08=ly,X7=A3,TQ=zW,s08=xx,t08=iy,e08=ay,X68=P_,J68=IB,Z68=SC,Y68=oI,$68=JD,Q68=mC,Xh=NS,G68=y7,H68=px,K68=mE,B68=pb,V68=j3,W68=fb,U68=c_,N68=zS,z68=hX,q68=wv,O68=WA,_w=ey,D68=Jb,Jh=M_,Zh=Xb,A68=_3,_68=ND,w68=dE,L68=J_,nW=F9,Yh=LS,ww=Q5,T68=mZ,L1=PW,PQ=B1,oW=V1,P68=vv,M68=Sv,F68=NA,R68=zA,j68=kv,rW=xv,C68=qA,E68=jv,I68=DS,S68=n2,v68=Qb,k68=o2,x68=AS;var y68=tS,T1=Y5,$6=P0,MQ=j7,b68=CB;var g68=PS,Lw=MS,h68=r2,m68=RS,d68=GD,c68=ZE,u68=Mv,lW=Fv,J7=IV,p68=iJ,f68=Cv,n68=Ev,R=O,o68=nJ,z5=r4,d3=XW,r68=bx,$h=ty,c3=Q_,l68=i2,X0=V4,i68=Ov,a68=Dv,s68=VA,t68=Av,lX=_v,Qh=$A,e68=QA,X48=oS,iW=qg,u3=Kv,J48=s_,Z48=e_,Y48=wg,$48=Xw,Gh=aJ,Q48=RV,G48=yS,H48=N0,K48=O6,B48=N3,V48=E9,W48=sZ,U48=Wv,N48=EV,z48=bS,q48=gS,q5=l2,P1=P2,x9=H0,M6=H6,O48=hS,D48=(X,...J)=>gX(X)(...J),A48=mS,_48=GA,w48=dS,Tw=cS,Pw=uS,L48=pS,T48=fS,Mw=$S,P48=Mx,M48=nS,F48=dC,R48=Fx,d0=EZ,j48=lO,iX=CZ,NY=eS,C48=Xv,E48=ES,I48=Yv,S48=eB,Hh=uE,v48=B(2,(X,J)=>Hh(X,ab(J))),k48=fx,aX=_W,x48=d$,y48=lJ,b48=vB,g48=Z_,h48=Nv,m48=BA,d48=mx,c48=eA,u48=cC,p48=Iv,Fw=UQ,aW=uy,sW=L_,f48=fy,sX=Tb,n48=Lb,Rw=Pb,o48=Mb,c0=Fb,r48=Rb,l48=cx,i48=X_,Y9=ox,N4=rx,B8=lx,z4=pX,a48=B(2,(X,J)=>z4(X,J,(Z,Y)=>Z(Y))),s48=EX,t48=MB,e48=jB,X98=B((X)=>ug(X[0]),hg),J98=mg,Z98=vC,Y98=dg,$98=cg,Q98=Lv,G98=XV,H98=pE,K98=H_,B98=kC,V98=xC,W98=gv,U98=yv,N98=SV,z98=hv,q98=pv,O98=fv,D98=mv,A98=bv,Kh=uv,_98=KQ,w98=PV,Bh=DA,L98=nv,T98=Xy,P98=MV,M98=ov,F98=rv,R98=(X)=>{return FJ(X)?uW:k(X.value,_4)},j98=B(2,(X,J)=>FJ(X)?uW:k(J(X.value),_4)),Vh=(X)=>{let J=new Map;return new Proxy(X,{get(Z,Y,$){if(Y in Z)return Reflect.get(Z,Y,$);if(J.has(Y))return J.get(Y);let Q=(...N)=>nJ(Z,(z)=>{if(typeof z[Y]==="function")return J.set(Y,(...q)=>nJ(Z,(A)=>A[Y](...q))),z[Y](...N);return J.set(Y,nJ(Z,(q)=>q[Y])),z[Y]}),G=nJ(Z,(N)=>N[Y]);Object.assign(Q,G);let{apply:H,bind:K,call:V}=Q,W=Object.setPrototypeOf({},Object.getPrototypeOf(G));return W.apply=H,W.bind=K,W.call=V,Object.setPrototypeOf(Q,W),J.set(Y,Q),Q}})},C98=(X)=>()=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();Error.stackTraceLimit=J;function Y(){}return Object.setPrototypeOf(Y,D$),Y.key=X,Object.defineProperty(Y,"use",{get(){return($)=>nJ(this,$)}}),Object.defineProperty(Y,"stack",{get(){return Z.stack}}),Vh(Y)},E98=function(){return function(){let[X,J]=arguments,Z="accessors"in J?J.accessors:!1,Y=Error.stackTraceLimit;Error.stackTraceLimit=2;let $=Error();Error.stackTraceLimit=Y;let Q="unchecked",G=function(N){if(Q==="unchecked"){let z=Object.getPrototypeOf(N);if(z===Object.prototype||z===null)Q="plain";else{let q=Object.getPrototypeOf(this);Object.setPrototypeOf(q,z),Q="patched"}}if(Q==="plain")Object.assign(this,N);else if(Q==="patched")return Object.setPrototypeOf(N,Object.getPrototypeOf(this)),N};G.prototype._tag=X,Object.defineProperty(G,"make",{get(){return(N)=>new this(N)}}),Object.defineProperty(G,"use",{get(){return(N)=>nJ(this,N)}}),G.key=X,Object.assign(G,D$),Object.defineProperty(G,"stack",{get(){return $.stack}});let H="dependencies"in J&&J.dependencies.length>0,K=H?"DefaultWithoutDependencies":"Default",V,W=!1;if("effect"in J)W=typeof J.effect==="function",Object.defineProperty(G,K,{get(){if(W)return function(){return M3(G,k(J.effect.apply(null,arguments),(N)=>new this(N)))}.bind(this);return V??=M3(G,k(J.effect,(N)=>new this(N)))}});else if("scoped"in J)W=typeof J.scoped==="function",Object.defineProperty(G,K,{get(){if(W)return function(){return R3(G,k(J.scoped.apply(null,arguments),(N)=>new this(N)))}.bind(this);return V??=R3(G,k(J.scoped,(N)=>new this(N)))}});else if("sync"in J)Object.defineProperty(G,K,{get(){return V??=m_(G,()=>new this(J.sync()))}});else Object.defineProperty(G,K,{get(){return V??=TW(G,new this(J.succeed))}});if(H){let N;Object.defineProperty(G,"Default",{get(){if(W)return function(){return OQ(this.DefaultWithoutDependencies.apply(null,arguments),J.dependencies)};return N??=OQ(this.DefaultWithoutDependencies,J.dependencies)}})}return Z===!0?Vh(G):G}},I98=function(X,...J){let Z=Error.stackTraceLimit;Error.stackTraceLimit=2;let Y=Error();if(Error.stackTraceLimit=Z,typeof X!=="string")return fg(X.length,function(...G){let H=Error.stackTraceLimit;Error.stackTraceLimit=2;let K=Error();return Error.stackTraceLimit=H,ng({self:this,body:X,args:G,pipeables:J,spanName:"<anonymous>",spanOptions:{context:uZ.context(!0)},errorDef:Y,errorCall:K})});let $=X,Q=J[0];return(G,...H)=>fg(G.length,{[$](...K){let V=Error.stackTraceLimit;Error.stackTraceLimit=2;let W=Error();return Error.stackTraceLimit=V,ng({self:this,body:G,args:K,pipeables:H,spanName:$,spanOptions:Q,errorDef:Y,errorCall:W})}}[$])};function fg(X,J){return Object.defineProperty(J,"length",{value:X,configurable:!0})}function ng(X){let J,Z=void 0;if(PF(X.body))J=_2(()=>X.body.apply(X.self,X.args));else try{J=X.body.apply(X.self,X.args)}catch(G){Z=G,J=I9(G)}if(X.pipeables.length>0)try{for(let G of X.pipeables)J=G(J,...X.args)}catch(G){J=Z?U4(Q0(r0(Z),r0(G))):I9(G)}let Y=!1,$=()=>{if(Y!==!1)return Y;if(X.errorCall.stack){let G=X.errorDef.stack.trim().split(`
`),H=X.errorCall.stack.trim().split(`
`),K=G.slice(2).join(`
`).trim();if(!K.includes("("))K=K.replace(/at (.*)/,"at ($1)");let V=H.slice(2).join(`
`).trim();if(!V.includes("("))V=V.replace(/at (.*)/,"at ($1)");return Y=`${K}
${V}`,Y}},Q=X.spanOptions&&"captureStackTrace"in X.spanOptions?X.spanOptions:{captureStackTrace:$,...X.spanOptions};return Bh(J,X.spanName,Q)}var FQ=SB,S98=()=>(X)=>X,v98=()=>(X)=>X,k98=()=>(X)=>X;var Cw=(X,J)=>{switch(J._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(X);case"SymbolKeyword":return Object.getOwnPropertySymbols(X);case"Refinement":return Cw(X,J.from)}},p3=(X)=>{let J=!1,Z;return()=>{if(J)return Z;return Z=X(),J=!0,Z}},Ew=(X)=>{try{return X.toISOString()}catch{return String(X)}},jw="[Circular]";function y9(X,J=0){let Z=new WeakSet,Y=!J?"":typeof J==="number"?" ".repeat(J):J,$=(V)=>Y.repeat(V),Q=(V)=>{try{let W=V.toString();return typeof W==="string"?W:String(W)}catch{return"[toString threw]"}},G=(V,W)=>{let N=V?.constructor;return N&&N!==Object.prototype.constructor&&N.name?`${N.name}(${W})`:W},H=(V)=>{try{return Reflect.ownKeys(V)}catch{return["[ownKeys threw]"]}};function K(V,W=0){if(Array.isArray(V)){if(Z.has(V))return jw;if(Z.add(V),!Y||V.length<=1)return`[${V.map((z)=>K(z,W)).join(",")}]`;let N=V.map((z)=>K(z,W+1)).join(`,
`+$(W+1));return`[
${$(W+1)}${N}
${$(W)}]`}if(GK(V))return Ew(V);if(v(V,"toString")&&D7(V.toString)&&V.toString!==Object.prototype.toString)return Q(V);if(G6(V))return JSON.stringify(V);if(g4(V)||V==null||z9(V)||a1(V))return String(V);if(TJ(V))return String(V)+"n";if(V instanceof Set||V instanceof Map){if(Z.has(V))return jw;return Z.add(V),`${V.constructor.name}(${K(Array.from(V),W)})`}if(t0(V)){if(Z.has(V))return jw;Z.add(V);let N=H(V);if(!Y||N.length<=1){let q=`{${N.map((A)=>`${zY(A)}:${K(V[A],W)}`).join(",")}}`;return G(V,q)}let z=`{
${N.map((q)=>`${$(W+1)}${zY(q)}: ${K(V[q],W+1)}`).join(`,
`)}
${$(W)}}`;return G(V,z)}return String(V)}return K(X,0)}function zY(X){return G6(X)?JSON.stringify(X):String(X)}var Iw=(X)=>Array.isArray(X),Uh=(X)=>!Array.isArray(X),Wh=(X)=>`[${zY(X)}]`,tW=(X)=>Iw(X)?X.map(Wh).join(""):Wh(X);var M1=(X,J,Z,Y)=>{let $=X;if(Z&&Q8(Z))$+=`
at path: ${tW(Z)}`;if(J!==void 0)$+=`
details: ${J}`;if(Y)$+=`
schema (${Y._tag}): ${Y}`;return $};var Sw=(X,J,Z)=>M1("Unsupported schema or overlapping types",`cannot extend ${X} with ${J}`,Z);var Nh=(X)=>M1("Unsupported key schema",void 0,void 0,X),zh=(X)=>M1("Unsupported literal",`literal value: ${y9(X)}`),vw=(X)=>M1("Duplicate index signature",`${X} index signature`),qh=M1("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),Oh=M1("Invalid element","A required element cannot follow an optional element. ts(1257)"),kw=(X)=>M1("Duplicate property signature transformation",`Duplicate key ${y9(X)}`);var XU=(X)=>M1("Duplicate property signature",`Duplicate key ${y9(X)}`);var _h=Symbol.for("effect/annotation/Brand"),wh=Symbol.for("effect/annotation/SchemaId"),bw=Symbol.for("effect/annotation/Message"),JU=Symbol.for("effect/annotation/MissingMessage"),f3=Symbol.for("effect/annotation/Identifier"),$9=Symbol.for("effect/annotation/Title"),qY=Symbol.for("effect/annotation/AutoTitle"),tX=Symbol.for("effect/annotation/Description"),gw=Symbol.for("effect/annotation/Examples"),hw=Symbol.for("effect/annotation/Default"),mw=Symbol.for("effect/annotation/JSONSchema"),dw=Symbol.for("effect/annotation/Arbitrary"),cw=Symbol.for("effect/annotation/Pretty"),uw=Symbol.for("effect/annotation/Equivalence"),Lh=Symbol.for("effect/annotation/Documentation"),pw=Symbol.for("effect/annotation/Concurrency"),fw=Symbol.for("effect/annotation/Batching"),nw=Symbol.for("effect/annotation/ParseIssueTitle"),ow=Symbol.for("effect/annotation/ParseOptions"),rw=Symbol.for("effect/annotation/DecodingFallback"),n3=Symbol.for("effect/annotation/Surrogate"),Th=Symbol.for("effect/annotation/StableFilter"),O4=B(2,(X,J)=>Object.prototype.hasOwnProperty.call(X.annotations,J)?D(X.annotations[J]):_()),Ph=O4(_h);var Mh=O4(bw),Fh=O4(JU),lw=O4($9),iw=O4(qY),o3=O4(f3),aw=O4(tX);var Rh=O4(pw),jh=O4(fw),Ch=O4(nw),Eh=O4(ow),Ih=O4(rw),sw=O4(n3),x98=O4(Th),tw=(X)=>aF(x98(X),(J)=>J===!0),ZU=Symbol.for("effect/annotation/JSONIdentifier"),y98=O4(ZU),b98=(X)=>c4(y98(X),()=>o3(X));class RQ{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(X,J,Z,Y={}){this.typeParameters=X,this.decodeUnknown=J,this.encodeUnknown=Z,this.annotations=Y}toString(){return i(n7(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map((X)=>X.toJSON()),annotations:u0(this.annotations)}}}var eX=(X)=>(J)=>J._tag===X;class jQ{literal;annotations;_tag="Literal";constructor(X,J={}){this.literal=X,this.annotations=J}toString(){return i(n7(this),()=>y9(this.literal))}toJSON(){return{_tag:this._tag,literal:TJ(this.literal)?String(this.literal):this.literal,annotations:u0(this.annotations)}}}var OY=eX("Literal");class YU{symbol;annotations;_tag="UniqueSymbol";constructor(X,J={}){this.symbol=X,this.annotations=J}toString(){return i(n7(this),()=>y9(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:u0(this.annotations)}}}class Sh{annotations;_tag="UndefinedKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var $U=new Sh({[$9]:"undefined"});class vh{annotations;_tag="VoidKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var g98=new vh({[$9]:"void"});class kh{annotations;_tag="NeverKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var QU=new kh({[$9]:"never"});class xh{annotations;_tag="UnknownKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var ew=new xh({[$9]:"unknown"});class yh{annotations;_tag="AnyKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var bh=new yh({[$9]:"any"});class gh{annotations;_tag="StringKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var GU=new gh({[$9]:"string",[tX]:"a string"}),HU=eX("StringKeyword");class hh{annotations;_tag="NumberKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var KU=new hh({[$9]:"number",[tX]:"a number"}),XL=eX("NumberKeyword");class mh{annotations;_tag="BooleanKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var JL=new mh({[$9]:"boolean",[tX]:"a boolean"}),ZL=eX("BooleanKeyword");class dh{annotations;_tag="BigIntKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var h98=new dh({[$9]:"bigint",[tX]:"a bigint"});class ch{annotations;_tag="SymbolKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var m98=new ch({[$9]:"symbol",[tX]:"a symbol"}),uh=eX("SymbolKeyword");class ph{annotations;_tag="ObjectKeyword";constructor(X={}){this.annotations=X}toString(){return Y7(this)}toJSON(){return{_tag:this._tag,annotations:u0(this.annotations)}}}var d98=new ph({[$9]:"object",[tX]:"an object in the TypeScript meaning, i.e. the `object` type"});class r3{type;annotations;constructor(X,J={}){this.type=X,this.annotations=J}toJSON(){return{type:this.type.toJSON(),annotations:u0(this.annotations)}}toString(){return String(this.type)}}class DY extends r3{isOptional;constructor(X,J,Z={}){super(X,Z);this.isOptional=J}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:u0(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}var fh=(X)=>X.map((J)=>J.type);class BU{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(X,J,Z,Y={}){this.elements=X,this.rest=J,this.isReadonly=Z,this.annotations=Y;let $=!1,Q=!1;for(let G of X)if(G.isOptional)$=!0;else if($){Q=!0;break}if(Q||$&&J.length>1)throw Error(Oh)}toString(){return i(n7(this),()=>c98(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map((X)=>X.toJSON()),rest:this.rest.map((X)=>X.toJSON()),isReadonly:this.isReadonly,annotations:u0(this.annotations)}}}var c98=(X)=>{let J=X.elements.map(String).join(", ");return n6(X.rest,{onEmpty:()=>`readonly [${J}]`,onNonEmpty:(Z,Y)=>{let $=String(Z),Q=$.includes(" | ")?`(${$})`:$;if(Y.length>0){let G=Y.map(String).join(", ");if(X.elements.length>0)return`readonly [${J}, ...${Q}[], ${G}]`;else return`readonly [...${Q}[], ${G}]`}else if(X.elements.length>0)return`readonly [${J}, ...${Q}[]]`;else return`ReadonlyArray<${$}>`}})};class B6 extends DY{name;isReadonly;constructor(X,J,Z,Y,$){super(J,Z,$);this.name=X,this.isReadonly=Y}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:u0(this.annotations)}}}var nh=(X)=>{switch(X._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return nh(X.from)}return!1};class CQ{type;isReadonly;parameter;constructor(X,J,Z){if(this.type=J,this.isReadonly=Z,nh(X))this.parameter=X;else throw Error(qh)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Z7{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(X,J,Z={}){this.annotations=Z;let Y={};for(let Q=0;Q<X.length;Q++){let G=X[Q].name;if(Object.prototype.hasOwnProperty.call(Y,G))throw Error(XU(G));Y[G]=null}let $={string:!1,symbol:!1};for(let Q=0;Q<J.length;Q++){let G=BL(J[Q].parameter);if(HU(G)){if($.string)throw Error(vw("string"));$.string=!0}else if(uh(G)){if($.symbol)throw Error(vw("symbol"));$.symbol=!0}}this.propertySignatures=X,this.indexSignatures=J}toString(){return i(n7(this),()=>u98(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map((X)=>X.toJSON()),indexSignatures:this.indexSignatures.map((X)=>X.toJSON()),annotations:u0(this.annotations)}}}var Ah=(X)=>X.map(String).join("; "),u98=(X)=>{if(X.propertySignatures.length>0){let J=X.propertySignatures.map(String).join("; ");if(X.indexSignatures.length>0)return`{ ${J}; ${Ah(X.indexSignatures)} }`;else return`{ ${J} }`}else if(X.indexSignatures.length>0)return`{ ${Ah(X.indexSignatures)} }`;else return"{}"},YL=eX("TypeLiteral"),p98=p4(YZ(v7,(X)=>{switch(X._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),f98={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},oh=(X)=>J6(X,(J)=>WU(J)?oh(J.types):[J]),n98=(X)=>{let J=p98(X),Z=[],Y={},$=[];for(let Q of J)switch(Q._tag){case"NeverKeyword":break;case"AnyKeyword":return[bh];case"UnknownKeyword":return[ew];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{if(!Y[Q._tag])Y[Q._tag]=Q,Z.push(Q);break}case"Literal":{let G=typeof Q.literal;switch(G){case"string":case"number":case"bigint":case"boolean":{let H=f98[G];if(!Y[H]&&!$.includes(Q.literal))$.push(Q.literal),Z.push(Q);break}case"object":{if(!$.includes(Q.literal))$.push(Q.literal),Z.push(Q);break}}break}case"UniqueSymbol":{if(!Y.SymbolKeyword&&!$.includes(Q.symbol))$.push(Q.symbol),Z.push(Q);break}case"TupleType":{if(!Y.ObjectKeyword)Z.push(Q);break}case"TypeLiteral":{if(Q.propertySignatures.length===0&&Q.indexSignatures.length===0){if(!Y["{}"])Y["{}"]=Q,Z.push(Q)}else if(!Y.ObjectKeyword)Z.push(Q);break}default:Z.push(Q)}return Z};class q4{types;annotations;static make=(X,J)=>{return VU(X)?new q4(X,J):X.length===1?X[0]:QU};static unify=(X,J)=>{return q4.make(n98(oh(X)),J)};_tag="Union";constructor(X,J={}){this.types=X,this.annotations=J}toString(){return i(n7(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map((X)=>X.toJSON()),annotations:u0(this.annotations)}}}var rh=(X,J)=>X.map(J),VU=(X)=>X.length>1,WU=eX("Union"),xw=X8(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class AY{f;annotations;_tag="Suspend";constructor(X,J={}){this.f=X,this.annotations=J,this.f=p3(X)}toString(){return n7(this).pipe(c4(()=>C6(rF(this.f)(),(X)=>n7(X))),i(()=>"<suspended schema>"))}toJSON(){let X=this.f(),J=xw.get(X);if(J)return J;return xw.set(X,{_tag:this._tag}),J={_tag:this._tag,ast:X.toJSON(),annotations:u0(this.annotations)},xw.set(X,J),J}}class EQ{from;filter;annotations;_tag="Refinement";constructor(X,J,Z={}){this.from=X,this.filter=J,this.annotations=Z}toString(){return o3(this).pipe(i(()=>n(Jm(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:(X)=>F1(this.from)?String(this.from)+" & "+X:X})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:u0(this.annotations)}}}var F1=eX("Refinement"),UU={};class XJ{from;to;transformation;annotations;_tag="Transformation";constructor(X,J,Z,Y={}){this.from=X,this.to=J,this.transformation=Z,this.annotations=Y}toString(){return i(n7(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:u0(this.annotations)}}}var lh=eX("Transformation");class NU{decode;encode;_tag="FinalTransformation";constructor(X,J){this.decode=X,this.encode=J}}var o98=(X)=>(J)=>J._tag===X;class ih{_tag="ComposeTransformation"}var $L=new ih;class QL{from;to;decode;encode;constructor(X,J,Z,Y){this.from=X,this.to=J,this.decode=Z,this.encode=Y}}class l3{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(X){this.propertySignatureTransformations=X;let J={},Z={};for(let Y of X){let $=Y.from;if(J[$])throw Error(kw($));J[$]=!0;let Q=Y.to;if(Z[Q])throw Error(kw(Q));Z[Q]=!0}}}var GL=o98("TypeLiteralTransformation"),zU=(X,J)=>{let Z=Object.getOwnPropertyDescriptors(X),Y={...X.annotations};delete Y[f3];let $={...Y,...J},Q=sw(X);if(H8(Q))$[n3]=zU(Q.value,J);return Z.annotations.value=$,Object.create(Object.getPrototypeOf(X),Z)};var r98="[\\s\\S]*?",l98="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",ah=(X,J)=>{switch(X._tag){case"Literal":return l$(String(X.literal));case"StringKeyword":return r98;case"NumberKeyword":return l98;case"TemplateLiteral":return sh(X,J,!1);case"Union":return X.types.map((Z)=>ah(Z,J)).join("|")}},i98=(X,J,Z,Y)=>{if(WU(X)){if(Z&&!Y)return`(?:${J})`}else if(!Z||!Y)return J;return`(${J})`},sh=(X,J,Z)=>{let Y="";if(X.head!==""){let $=l$(X.head);Y+=J&&Z?`(${$})`:$}for(let $ of X.spans){let Q=ah($.type,J);if(Y+=i98($.type,Q,J,Z),$.literal!==""){let G=l$($.literal);Y+=J&&Z?`(${G})`:G}}return Y},th=(X)=>new RegExp(`^${sh(X,!1,!0)}$`);var HL=(X,J)=>{let Z=[],Y=[],$=(Q)=>{switch(Q._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":Y.push(new CQ(Q,J,!0));break;case"Literal":if(G6(Q.literal)||g4(Q.literal))Z.push(new B6(Q.literal,J,!1,!0));else throw Error(zh(Q.literal));break;case"Enums":{for(let[G,H]of Q.enums)Z.push(new B6(H,J,!1,!0));break}case"UniqueSymbol":Z.push(new B6(Q.symbol,J,!1,!0));break;case"Union":Q.types.forEach($);break;default:throw Error(Nh(Q))}};return $(X),{propertySignatures:Z,indexSignatures:Y}};var KL=(X)=>(J)=>{let Z=void 0;for(let Y of X)if(Object.prototype.hasOwnProperty.call(J.annotations,Y)){if(Z===void 0)Z={};Z[Y]=J.annotations[Y]}return Z},eh=(X)=>(J)=>{let Z={...J.annotations};for(let Y of X)delete Z[Y];return Z},a98=KL([gw,hw,mw,dw,cw,uw]),i0=(X)=>{switch(X._tag){case"Declaration":{let J=O5(X.typeParameters,i0);return J===X.typeParameters?X:new RQ(J,X.decodeUnknown,X.encodeUnknown,X.annotations)}case"TupleType":{let J=O5(X.elements,($)=>{let Q=i0($.type);return Q===$.type?$:new DY(Q,$.isOptional)}),Z=fh(X.rest),Y=O5(Z,i0);return J===X.elements&&Y===Z?X:new BU(J,Y.map(($)=>new r3($)),X.isReadonly,X.annotations)}case"TypeLiteral":{let J=O5(X.propertySignatures,(Y)=>{let $=i0(Y.type);return $===Y.type?Y:new B6(Y.name,$,Y.isOptional,Y.isReadonly)}),Z=O5(X.indexSignatures,(Y)=>{let $=i0(Y.type);return $===Y.type?Y:new CQ(Y.parameter,$,Y.isReadonly)});return J===X.propertySignatures&&Z===X.indexSignatures?X:new Z7(J,Z,X.annotations)}case"Union":{let J=O5(X.types,i0);return J===X.types?X:q4.make(J,X.annotations)}case"Suspend":return new AY(()=>i0(X.f()),X.annotations);case"Refinement":{let J=i0(X.from);return J===X.from?X:new EQ(J,X.filter,X.annotations)}case"Transformation":{let J=a98(X);return i0(J!==void 0?zU(X.to,J):X.to)}}return X};function O5(X,J){let Z=!1,Y=NX(X.length);for(let $=0;$<X.length;$++){let Q=X[$],G=J(Q);if(G!==Q)Z=!0;Y[$]=G}return Z?Y:X}var yw=(X)=>{switch(X._tag){case"Transformation":return X.from;case"Refinement":return yw(X.from);case"Suspend":return yw(X.f())}},f7=(X,J)=>{switch(X._tag){case"Declaration":{let Z=O5(X.typeParameters,(Y)=>f7(Y,J));return Z===X.typeParameters?X:new RQ(Z,X.decodeUnknown,X.encodeUnknown)}case"TupleType":{let Z=O5(X.elements,(Q)=>{let G=f7(Q.type,J);return G===Q.type?Q:new DY(G,Q.isOptional)}),Y=fh(X.rest),$=O5(Y,(Q)=>f7(Q,J));return Z===X.elements&&$===Y?X:new BU(Z,$.map((Q)=>new r3(Q)),X.isReadonly)}case"TypeLiteral":{let Z=O5(X.propertySignatures,($)=>{let Q=f7($.type,J);return Q===$.type?$:new B6($.name,Q,$.isOptional,$.isReadonly)}),Y=O5(X.indexSignatures,($)=>{let Q=f7($.type,J);return Q===$.type?$:new CQ($.parameter,Q,$.isReadonly)});return Z===X.propertySignatures&&Y===X.indexSignatures?X:new Z7(Z,Y)}case"Union":{let Z=O5(X.types,(Y)=>f7(Y,J));return Z===X.types?X:q4.make(Z)}case"Suspend":{let Z=void 0,Y=b98(X);if(H8(Y)){let $=J?"Bound":"";Z={[ZU]:`${Y.value}Encoded${$}`}}return new AY(()=>f7(X.f(),J),Z)}case"Refinement":{let Z=f7(X.from,J);if(J){if(Z===X.from)return X;if(yw(X.from)===void 0&&tw(X))return new EQ(Z,X.filter,X.annotations);return Z}else return Z}case"Transformation":return f7(X.from,J)}return X},i3=(X)=>f7(X,!1);var u0=(X)=>{let J={};for(let Z of Object.getOwnPropertySymbols(X))J[String(Z)]=X[Z];return J},BL=(X)=>{switch(X._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return X;case"Refinement":return BL(X.from)}};var Xm=(X,J)=>new XJ(X,J,$L);var Y7=(X)=>i(n7(X),()=>X._tag);function s98(X){return n(Ph(X),{onNone:()=>"",onSome:(J)=>J.map((Z)=>` & Brand<${y9(Z)}>`).join("")})}var Jm=(X)=>lw(X).pipe(c4(()=>aw(X)),c4(()=>iw(X)),q0((J)=>J+s98(X))),n7=(X)=>c4(o3(X),()=>Jm(X));class F6{path;actual;issue;_tag="Pointer";constructor(X,J,Z){this.path=X,this.actual=J,this.issue=Z}}class NL{actual;message;_tag="Unexpected";constructor(X,J){this.actual=X,this.message=J}}class IQ{ast;message;_tag="Missing";actual=void 0;constructor(X,J){this.ast=X,this.message=J}}class R0{ast;actual;issues;output;_tag="Composite";constructor(X,J,Z,Y){this.ast=X,this.actual=J,this.issues=Z,this.output=Y}}class OU{ast;actual;kind;issue;_tag="Refinement";constructor(X,J,Z,Y){this.ast=X,this.actual=J,this.kind=Z,this.issue=Y}}class DU{ast;actual;kind;issue;_tag="Transformation";constructor(X,J,Z,Y){this.ast=X,this.actual=J,this.kind=Z,this.issue=Y}}class I4{ast;actual;message;_tag="Type";constructor(X,J,Z){this.ast=X,this.actual=J,this.message=Z}}class zL{ast;actual;message;_tag="Forbidden";constructor(X,J,Z){this.ast=X,this.actual=J,this.message=Z}}var Zm=Symbol.for("effect/Schema/ParseErrorTypeId");class Qm extends FW("ParseError"){[Zm]=Zm;get message(){return this.toString()}toString(){return e3.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[T8](){return this.toJSON()}}var OL=(X)=>new Qm({issue:X}),_Y=Z8,AU=$8;var Gm=mF,E4=DK,JJ=B(2,(X,J)=>{return E4(X)?U6(X,{onLeft:$8,onRight:J}):R(X,J)}),Q9=B(2,(X,J)=>{return E4(X)?uF(X,J):k(X,J)}),t3=B(2,(X,J)=>{return E4(X)?cF(X,J):s6(X,J)});var Hm=B(2,(X,J)=>{return E4(X)?dF(X,{onLeft:J.onFailure,onRight:J.onSuccess}):v9(X,J)}),Km=B(2,(X,J)=>{return E4(X)?U6(X,{onLeft:J,onRight:Z8}):a6(X,J)}),_U=(X,J)=>{if(J===void 0||g4(J))return X;if(X===void 0)return J;return{...X,...J}},e98=(X,J,Z)=>{let Y=h6(X,J);return($,Q)=>Y($,_U(Z,Q))},DL=(X,J,Z)=>{let Y=e98(X,J,Z);return($,Q)=>AK(Y($,Q),OL)};var Bm=(X,J,Z)=>{let Y=h6(X,J);return($,Q)=>Y($,{..._U(Z,Q),isEffectAllowed:!0})},Vm=(X,J)=>DL(X.ast,!0,J);var AL=(X,J)=>Bm(X.ast,!0,J),Wm=(X,J)=>DL(X.ast,!1,J);var _L=(X,J)=>Bm(X.ast,!1,J),wL=Vm;var JH=(X,J)=>DL(i0(X.ast),!0,J);var vQ=(X,J)=>{let Z=h6(i0(X.ast),!0);return(Y,$)=>d4(Z(Y,{exact:!0,..._U(J,$)}))};var LL=Wm;var X58=X8(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),J58=X8(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),h6=(X,J)=>{let Z=J?X58:J58,Y=Z.get(X);if(Y)return Y;let $=Z58(X,J),Q=Eh(X),G=H8(Q)?(V,W)=>$(V,_U(W,Q.value)):$,H=Ih(X),K=J&&H8(H)?(V,W)=>s3(Km(G(V,W),H.value),X,V,W):G;return Z.set(X,K),K},WL=(X)=>e0(Rh(X)),UL=(X)=>e0(jh(X)),Z58=(X,J)=>{switch(X._tag){case"Refinement":if(J){let Z=h6(X.from,!0);return(Y,$)=>{$=$??UU;let Q=$?.errors==="all",G=JJ(Km(Z(Y,$),(H)=>{let K=new OU(X,Y,"From",H);if(Q&&tw(X)&&Om(H))return n(X.filter(Y,$,X),{onNone:()=>$8(K),onSome:(V)=>$8(new R0(X,Y,[K,new OU(X,Y,"Predicate",V)]))});return $8(K)}),(H)=>n(X.filter(H,$,X),{onNone:()=>Z8(H),onSome:(K)=>$8(new OU(X,Y,"Predicate",K))}));return s3(G,X,Y,$)}}else{let Z=h6(i0(X),!0),Y=h6(Nm(X.from),!1);return($,Q)=>s3(JJ(Z($,Q),(G)=>Y(G,Q)),X,$,Q)}case"Transformation":{let Z=$58(X.transformation,J),Y=J?h6(X.from,!0):h6(X.to,!1),$=J?h6(X.to,!0):h6(X.from,!1);return(Q,G)=>s3(JJ(t3(Y(Q,G),(H)=>new DU(X,Q,J?"Encoded":"Type",H)),(H)=>JJ(t3(Z(H,G??UU,X,Q),(K)=>new DU(X,Q,"Transformation",K)),(K)=>t3($(K,G),(V)=>new DU(X,Q,J?"Type":"Encoded",V)))),X,Q,G)}case"Declaration":{let Z=J?X.decodeUnknown(...X.typeParameters):X.encodeUnknown(...X.typeParameters);return(Y,$)=>s3(Z(Y,$??UU,X),X,Y,$)}case"Literal":return b9(X,(Z)=>Z===X.literal);case"UniqueSymbol":return b9(X,(Z)=>Z===X.symbol);case"UndefinedKeyword":return b9(X,AF);case"NeverKeyword":return b9(X,_F);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return Z8;case"StringKeyword":return b9(X,G6);case"NumberKeyword":return b9(X,g4);case"BooleanKeyword":return b9(X,z9);case"BigIntKeyword":return b9(X,TJ);case"SymbolKeyword":return b9(X,a1);case"ObjectKeyword":return b9(X,t0);case"Enums":return b9(X,(Z)=>X.enums.some(([Y,$])=>$===Z));case"TemplateLiteral":{let Z=th(X);return b9(X,(Y)=>G6(Y)&&Z.test(Y))}case"TupleType":{let Z=X.elements.map((V)=>h6(V.type,J)),Y=X.rest.map((V)=>h6(V.type,J)),$=X.elements.filter((V)=>!V.isOptional);if(X.rest.length>0)$=$.concat(X.rest.slice(1));let Q=$.length,G=X.elements.length>0?X.elements.map((V,W)=>W).join(" | "):"never",H=WL(X),K=UL(X);return(V,W)=>{if(!zX(V))return $8(new I4(X,V));let N=W?.errors==="all",z=[],q=0,A=[],E=V.length;for(let y=E;y<=Q-1;y++){let s=new F6(y,V,new IQ($[y-E]));if(N){z.push([q++,s]);continue}else return $8(new R0(X,V,s,A))}if(X.rest.length===0)for(let y=X.elements.length;y<=E-1;y++){let s=new F6(y,V,new NL(V[y],`is unexpected, expected: ${G}`));if(N){z.push([q++,s]);continue}else return $8(new R0(X,V,s,A))}let P=0,M=void 0;for(;P<Z.length;P++)if(E<P+1){if(X.elements[P].isOptional)continue}else{let y=Z[P],s=y(V[P],W);if(E4(s)){if(z0(s)){let Y8=new F6(P,V,s.left);if(N){z.push([q++,Y8]);continue}else return $8(new R0(X,V,Y8,$7(A)))}A.push([q++,s.right])}else{let Y8=q++,l=P;if(!M)M=[];M.push(({es:G8,output:P8})=>R(T1(s),(r8)=>{if(z0(r8)){let l8=new F6(l,V,r8.left);if(N)return G8.push([Y8,l8]),o;else return $8(new R0(X,V,l8,$7(P8)))}return P8.push([Y8,r8.right]),o}))}}if(Q8(Y)){let[y,...s]=Y;for(;P<E-s.length;P++){let Y8=y(V[P],W);if(E4(Y8))if(z0(Y8)){let l=new F6(P,V,Y8.left);if(N){z.push([q++,l]);continue}else return $8(new R0(X,V,l,$7(A)))}else A.push([q++,Y8.right]);else{let l=q++,G8=P;if(!M)M=[];M.push(({es:P8,output:r8})=>R(T1(Y8),(l8)=>{if(z0(l8)){let y8=new F6(G8,V,l8.left);if(N)return P8.push([l,y8]),o;else return $8(new R0(X,V,y8,$7(r8)))}else return r8.push([l,l8.right]),o}))}}for(let Y8=0;Y8<s.length;Y8++)if(P+=Y8,E<P+1)continue;else{let l=s[Y8](V[P],W);if(E4(l)){if(z0(l)){let G8=new F6(P,V,l.left);if(N){z.push([q++,G8]);continue}else return $8(new R0(X,V,G8,$7(A)))}A.push([q++,l.right])}else{let G8=q++,P8=P;if(!M)M=[];M.push(({es:r8,output:l8})=>R(T1(l),(y8)=>{if(z0(y8)){let I0=new F6(P8,V,y8.left);if(N)return r8.push([G8,I0]),o;else return $8(new R0(X,V,I0,$7(l8)))}return l8.push([G8,y8.right]),o}))}}}let c=({es:y,output:s})=>qX(y)?$8(new R0(X,V,$7(y),$7(s))):Z8($7(s));if(M&&M.length>0){let y=M;return z8(()=>{let s={es:q$(z),output:q$(A)};return R(F0(y,(Y8)=>Y8(s),{concurrency:H,batching:K,discard:!0}),()=>c(s))})}return c({output:A,es:z})}}case"TypeLiteral":{if(X.propertySignatures.length===0&&X.indexSignatures.length===0)return b9(X,wF);let Z=[],Y={},$=[];for(let W of X.propertySignatures)Z.push([h6(W.type,J),W]),Y[W.name]=null,$.push(W.name);let Q=X.indexSignatures.map((W)=>[h6(W.parameter,J),h6(W.type,J),W.parameter]),G=q4.make(X.indexSignatures.map((W)=>W.parameter).concat($.map((W)=>a1(W)?new YU(W):new jQ(W)))),H=h6(G,J),K=WL(X),V=UL(X);return(W,N)=>{if(!ez(W))return $8(new I4(X,W));let z=N?.errors==="all",q=[],A=0,E=N?.onExcessProperty==="error",P=N?.onExcessProperty==="preserve",M={},c;if(E||P){c=Reflect.ownKeys(W);for(let l of c){let G8=H(l,N);if(E4(G8)&&z0(G8))if(E){let P8=new F6(l,W,new NL(W[l],`is unexpected, expected: ${String(G)}`));if(z){q.push([A++,P8]);continue}else return $8(new R0(X,W,P8,M))}else M[l]=W[l]}}let y=void 0,s=N?.exact===!0;for(let l=0;l<Z.length;l++){let G8=Z[l][1],P8=G8.name,r8=Object.prototype.hasOwnProperty.call(W,P8);if(!r8){if(G8.isOptional)continue;else if(s){let I0=new F6(P8,W,new IQ(G8));if(z){q.push([A++,I0]);continue}else return $8(new R0(X,W,I0,M))}}let l8=Z[l][0],y8=l8(W[P8],N);if(E4(y8)){if(z0(y8)){let I0=new F6(P8,W,r8?y8.left:new IQ(G8));if(z){q.push([A++,I0]);continue}else return $8(new R0(X,W,I0,M))}M[P8]=y8.right}else{let I0=A++,r9=P8;if(!y)y=[];y.push(({es:l9,output:j5})=>R(T1(y8),(Z4)=>{if(z0(Z4)){let p6=new F6(r9,W,r8?Z4.left:new IQ(G8));if(z)return l9.push([I0,p6]),o;else return $8(new R0(X,W,p6,j5))}return j5[r9]=Z4.right,o}))}}for(let l=0;l<Q.length;l++){let G8=Q[l],P8=G8[0],r8=G8[1],l8=Cw(W,G8[2]);for(let y8 of l8){let I0=P8(y8,N);if(E4(I0)&&d4(I0)){let r9=r8(W[y8],N);if(E4(r9)){if(z0(r9)){let l9=new F6(y8,W,r9.left);if(z){q.push([A++,l9]);continue}else return $8(new R0(X,W,l9,M))}else if(!Object.prototype.hasOwnProperty.call(Y,y8))M[y8]=r9.right}else{let l9=A++,j5=y8;if(!y)y=[];y.push(({es:Z4,output:p6})=>R(T1(r9),(i9)=>{if(z0(i9)){let X$=new F6(j5,W,i9.left);if(z)return Z4.push([l9,X$]),o;else return $8(new R0(X,W,X$,p6))}else{if(!Object.prototype.hasOwnProperty.call(Y,y8))p6[y8]=i9.right;return o}}))}}}}let Y8=({es:l,output:G8})=>{if(qX(l))return $8(new R0(X,W,$7(l),G8));if(N?.propertyOrder==="original"){let P8=c||Reflect.ownKeys(W);for(let l8 of $)if(P8.indexOf(l8)===-1)P8.push(l8);let r8={};for(let l8 of P8)if(Object.prototype.hasOwnProperty.call(G8,l8))r8[l8]=G8[l8];return Z8(r8)}return Z8(G8)};if(y&&y.length>0){let l=y;return z8(()=>{let G8={es:q$(q),output:Object.assign({},M)};return R(F0(l,(P8)=>P8(G8),{concurrency:K,batching:V,discard:!0}),()=>Y8(G8))})}return Y8({es:q,output:M})}}case"Union":{let Z=Um(X.types,J),Y=Reflect.ownKeys(Z.keys),$=Y.length,Q=X.types.length,G=new Map;for(let V=0;V<Q;V++)G.set(X.types[V],h6(X.types[V],J));let H=WL(X)??1,K=UL(X);return(V,W)=>{let N=[],z=0,q=[];if($>0)if(xG(V))for(let P=0;P<$;P++){let M=Y[P],c=Z.keys[M].buckets;if(Object.prototype.hasOwnProperty.call(V,M)){let y=String(V[M]);if(Object.prototype.hasOwnProperty.call(c,y))q=q.concat(c[y]);else{let{candidates:s,literals:Y8}=Z.keys[M],l=q4.make(Y8),G8=s.length===Q?new Z7([new B6(M,l,!1,!0)],[]):q4.make(s);N.push([z++,new R0(G8,V,new F6(M,V,new I4(l,V[M])))])}}else{let{candidates:y,literals:s}=Z.keys[M],Y8=new B6(M,q4.make(s),!1,!0),l=y.length===Q?new Z7([Y8],[]):q4.make(y);N.push([z++,new R0(l,V,new F6(M,V,new IQ(Y8)))])}}else{let P=Z.candidates.length===Q?X:q4.make(Z.candidates);N.push([z++,new I4(P,V)])}if(Z.otherwise.length>0)q=q.concat(Z.otherwise);let A=void 0;for(let P=0;P<q.length;P++){let M=q[P],c=G.get(M)(V,W);if(E4(c)&&(!A||A.length===0))if(d4(c))return c;else N.push([z++,c.left]);else{let y=z++;if(!A)A=[];A.push((s)=>z8(()=>{if("finalResult"in s)return o;else return R(T1(c),(Y8)=>{if(d4(Y8))s.finalResult=Y8;else s.es.push([y,Y8.left]);return o})}))}}let E=(P)=>qX(P)?P.length===1&&P[0][1]._tag==="Type"?$8(P[0][1]):$8(new R0(X,V,$7(P))):$8(new I4(X,V));if(A&&A.length>0){let P=A;return z8(()=>{let M={es:q$(N)};return R(F0(P,(c)=>c(M),{concurrency:H,batching:K,discard:!0}),()=>{if("finalResult"in M)return M.finalResult;return E(M.es)})})}return E(N)}}case"Suspend":{let Z=p3(()=>h6(X.f(),J));return(Y,$)=>Z()(Y,$)}}},b9=(X,J)=>(Z)=>J(Z)?Z8(Z):$8(new I4(X,Z)),a3=(X,J)=>{switch(X._tag){case"Declaration":{let Z=sw(X);if(H8(Z))return a3(Z.value,J);break}case"TypeLiteral":{let Z=[];for(let Y=0;Y<X.propertySignatures.length;Y++){let $=X.propertySignatures[Y],Q=J?i3($.type):i0($.type);if(OY(Q)&&!$.isOptional)Z.push([$.name,Q])}return Z}case"TupleType":{let Z=[];for(let Y=0;Y<X.elements.length;Y++){let $=X.elements[Y],Q=J?i3($.type):i0($.type);if(OY(Q)&&!$.isOptional)Z.push([Y,Q])}return Z}case"Refinement":return a3(X.from,J);case"Suspend":return a3(X.f(),J);case"Transformation":return a3(J?X.from:X.to,J)}return[]},Um=(X,J)=>{let Z={},Y=[],$=[];for(let Q=0;Q<X.length;Q++){let G=X[Q],H=a3(G,J);if(H.length>0){$.push(G);for(let K=0;K<H.length;K++){let[V,W]=H[K],N=String(W.literal);Z[V]=Z[V]||{buckets:{},literals:[],candidates:[]};let z=Z[V].buckets;if(Object.prototype.hasOwnProperty.call(z,N)){if(K<H.length-1)continue;z[N].push(G),Z[V].literals.push(W),Z[V].candidates.push(G)}else{z[N]=[G],Z[V].literals.push(W),Z[V].candidates.push(G);break}}}else Y.push(G)}return{keys:Z,otherwise:Y,candidates:$}},Nm=(X)=>F1(X)?Nm(X.from):X,s3=(X,J,Z,Y)=>{if(Y?.isEffectAllowed===!0)return X;if(E4(X))return X;let $=new u2,Q=sX(X,{scheduler:$});$.flush();let G=Q.unsafePoll();if(G){if(a2(G))return Z8(G.value);let H=G.cause;if(Qy(H))return $8(H.error);return $8(new zL(J,Z,GW(H)))}return $8(new zL(J,Z,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},Y58=([X],[J])=>X>J?1:X<J?-1:0;function $7(X){return X.sort(Y58).map((J)=>J[1])}var $58=(X,J)=>{switch(X._tag){case"FinalTransformation":return J?X.decode:X.encode;case"ComposeTransformation":return Z8;case"TypeLiteralTransformation":return(Z)=>{let Y=Z8(Z);for(let $ of X.propertySignatureTransformations){let[Q,G]=J?[$.from,$.to]:[$.to,$.from],H=J?$.decode:$.encode;Y=Q9(Y,(V)=>{let W=H(Object.prototype.hasOwnProperty.call(V,Q)?D(V[Q]):_());if(delete V[Q],H8(W))V[G]=W.value;return V})}return Y}}},C4=(X,J=[])=>({value:X,forest:J}),e3={formatIssue:(X)=>Q9(SQ(X),Q58),formatIssueSync:(X)=>{let J=e3.formatIssue(X);return E4(J)?pF(J):c0(J)},formatError:(X)=>e3.formatIssue(X.issue),formatErrorSync:(X)=>e3.formatIssueSync(X.issue)},Q58=(X)=>X.value+zm(`
`,X.forest),zm=(X,J)=>{let Z="",Y=J.length,$;for(let Q=0;Q<Y;Q++){$=J[Q];let G=Q===Y-1;Z+=X+(G?"":"")+" "+$.value,Z+=zm(X+(Y>1&&!G?"  ":"   "),$.forest)}return Z},G58=(X)=>{switch(X){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},H58=(X)=>{switch(X){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},qm=(X)=>("ast"in X)?D(X.ast):_(),qL=Z8(void 0),K58=(X)=>qm(X).pipe(C6(Mh),n({onNone:()=>qL,onSome:(J)=>{let Z=J(X);if(G6(Z))return Z8({message:Z,override:!1});if(T6(Z))return k(Z,(Y)=>({message:Y,override:!1}));if(G6(Z.message))return Z8({message:Z.message,override:Z.override});return k(Z.message,(Y)=>({message:Y,override:Z.override}))}})),TL=(X)=>(J)=>J._tag===X,Om=TL("Composite"),Ym=TL("Refinement"),$m=TL("Transformation"),XH=(X)=>JJ(K58(X),(J)=>{if(J!==void 0)return!J.override&&(Om(X)||Ym(X)&&X.kind==="From"||$m(X)&&X.kind!=="Transformation")?$m(X)||Ym(X)?XH(X.issue):qL:Z8(J.message);return qL}),Dm=(X)=>qm(X).pipe(C6(Ch),lF((J)=>J(X)),e0);function B58(X){return aw(X).pipe(c4(()=>lw(X)),c4(()=>iw(X)),c4(()=>o3(X)),i(()=>`{ ${X.from} | filter }`))}function V58(X){if(X.message!==void 0)return X.message;return`Expected ${F1(X.ast)?B58(X.ast):String(X.ast)}, actual ${y9(X.actual)}`}var W58=(X)=>Q9(XH(X),(J)=>J??Dm(X)??V58(X)),qU=(X)=>Dm(X)??String(X.ast),U58=(X)=>X.message??"is forbidden",N58=(X)=>X.message??"is unexpected",z58=(X)=>{let J=Fh(X.ast);if(H8(J)){let Z=J.value();return G6(Z)?Z8(Z):Z}return Z8(X.message??"is missing")},SQ=(X)=>{switch(X._tag){case"Type":return Q9(W58(X),C4);case"Forbidden":return Z8(C4(qU(X),[C4(U58(X))]));case"Unexpected":return Z8(C4(N58(X)));case"Missing":return Q9(z58(X),C4);case"Transformation":return JJ(XH(X),(J)=>{if(J!==void 0)return Z8(C4(J));return Q9(SQ(X.issue),(Z)=>C4(qU(X),[C4(G58(X.kind),[Z])]))});case"Refinement":return JJ(XH(X),(J)=>{if(J!==void 0)return Z8(C4(J));return Q9(SQ(X.issue),(Z)=>C4(qU(X),[C4(H58(X.kind),[Z])]))});case"Pointer":return Q9(SQ(X.issue),(J)=>C4(tW(X.path),[J]));case"Composite":return JJ(XH(X),(J)=>{if(J!==void 0)return Z8(C4(J));let Z=qU(X);return Iw(X.issues)?Q9(F0(X.issues,SQ),(Y)=>C4(Z,Y)):Q9(SQ(X.issues),(Y)=>C4(Z,[Y]))})}};var _m=Symbol.for("effect/Brand/Refined");var ZH=()=>{return Object.assign((X)=>X,{[_m]:_m,option:(X)=>D(X),either:(X)=>Z8(X),is:(X)=>!0})};var wm=D6;var ML=eV;var Lm=B(2,(X,J)=>N0(K3,J)(X));var kQ=M3;var Tm=LW;var RL=R3;var wY=TW;var Pm=OQ,Mm=cb;var O58="effect/QueueEnqueue",Fm=Symbol.for(O58),D58="effect/QueueDequeue",Rm=Symbol.for(D58),A58="effect/QueueStrategy",TU=Symbol.for(A58),_58="effect/BackingQueue",jm=Symbol.for(_58),jL={_A:(X)=>X},w58={_A:(X)=>X},L58={_In:(X)=>X},T58={_Out:(X)=>X};class Cm extends a4{queue;takers;shutdownHook;shutdownFlag;strategy;[Fm]=L58;[Rm]=T58;constructor(X,J,Z,Y,$){super();this.queue=X,this.takers=J,this.shutdownHook=Z,this.shutdownFlag=Y,this.strategy=$}pipe(){return C(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return h(()=>T9(this.unsafeSize(),()=>M4))}unsafeSize(){if(h0(this.shutdownFlag))return _();return D(this.queue.length()-yW(this.takers)+this.strategy.surplusSize())}get isEmpty(){return I(this.size,(X)=>X<=0)}get isFull(){return I(this.size,(X)=>X>=this.capacity())}get shutdown(){return f5(A8((X)=>{return U(this.shutdownFlag,J5(!0)),U(g7(xQ(this.takers),(J)=>rB(J,X.id()),!1,!1),j8(this.strategy.shutdown),iJ(r$(this.shutdownHook,void 0)),W0)}))}get isShutdown(){return T(()=>h0(this.shutdownFlag))}get awaitShutdown(){return m0(this.shutdownHook)}isActive(){return!h0(this.shutdownFlag)}unsafeOffer(X){if(h0(this.shutdownFlag))return!1;let J;if(this.queue.length()===0){let Y=U(this.takers,t5(L6));if(Y!==L6)TY(Y,X),J=!0;else J=!1}else J=!1;if(J)return!0;let Z=this.queue.offer(X);return LY(this.strategy,this.queue,this.takers),Z}offer(X){return h(()=>{if(h0(this.shutdownFlag))return M4;let J;if(this.queue.length()===0){let Y=U(this.takers,t5(L6));if(Y!==L6)TY(Y,X),J=!0;else J=!1}else J=!1;if(J)return w(!0);let Z=this.queue.offer(X);return LY(this.strategy,this.queue,this.takers),Z?w(!0):this.strategy.handleSurplus([X],this.queue,this.takers,this.shutdownFlag)})}offerAll(X){return h(()=>{if(h0(this.shutdownFlag))return M4;let J=J8(X),Z=this.queue.length()===0?J8(M58(this.takers,J.length)):t,[Y,$]=U(J,pG(Z.length));for(let G=0;G<Z.length;G++){let H=Z[G],K=Y[G];TY(H,K)}if($.length===0)return w(!0);let Q=this.queue.offerAll($);return LY(this.strategy,this.queue,this.takers),g5(Q)?w(!0):this.strategy.handleSurplus(Q,this.queue,this.takers,this.shutdownFlag)})}get take(){return A8((X)=>{if(h0(this.shutdownFlag))return M4;let J=this.queue.poll(L6);if(J!==L6)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),w(J);else{let Z=Z1(X.id());return U(h(()=>{return U(this.takers,_1(Z)),LY(this.strategy,this.queue,this.takers),h0(this.shutdownFlag)?M4:m0(Z)}),M9(()=>{return T(()=>F58(this.takers,Z))}))}})}get takeAll(){return h(()=>{return h0(this.shutdownFlag)?M4:T(()=>{let X=this.queue.pollUpTo(Number.POSITIVE_INFINITY);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),H4(X)})})}takeUpTo(X){return h(()=>h0(this.shutdownFlag)?M4:T(()=>{let J=this.queue.pollUpTo(X);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),H4(J)}))}takeBetween(X,J){return h(()=>Em(this,X,J,e8()))}}var Em=(X,J,Z,Y)=>{if(Z<J)return w(Y);return U(hm(X,Z),O(($)=>{let Q=J-$.length;if(Q===1)return U(wU(X),I((G)=>U(Y,t8($),_X(G))));if(Q>1)return U(wU(X),O((G)=>Em(X,Q-1,Z-$.length-1,U(Y,t8($),_X(G)))));return w(U(Y,t8($)))}))};var Im=(X)=>U(T(()=>xW(X)),O((J)=>YH(PU(J),mm()))),Sm=(X)=>U(T(()=>xW(X)),O((J)=>YH(PU(J),CL()))),vm=(X)=>U(T(()=>xW(X)),O((J)=>YH(PU(J),dm()))),km=()=>U(T(()=>AQ()),O((X)=>YH(PU(X),CL()))),P58=(X,J,Z,Y,$)=>{return new Cm(X,J,Z,Y,$)},YH=(X,J)=>U(W4(),I((Z)=>P58(X,AQ(),Z,f4(!1),J)));class xm{mutable;[jm]=w58;constructor(X){this.mutable=X}poll(X){return t5(this.mutable,X)}pollUpTo(X){return gW(this.mutable,X)}offerAll(X){return Gw(this.mutable,X)}offer(X){return _1(this.mutable,X)}capacity(){return Sg(this.mutable)}length(){return yW(this.mutable)}}var PU=(X)=>new xm(X);var ym=(X)=>X.size;var bm=(X)=>X.shutdown,gm=B(2,(X,J)=>X.offer(J));var wU=(X)=>X.take;var hm=B(2,(X,J)=>X.takeUpTo(J));var mm=()=>new cm,CL=()=>new um,dm=()=>new pm;class cm{[TU]=jL;putters=AQ();surplusSize(){return yW(this.putters)}onCompleteTakersWithEmptyQueue(X){while(!bW(this.putters)&&!bW(X)){let J=t5(X,void 0),Z=t5(this.putters,void 0);if(Z[2])TY(Z[1],!0);TY(J,Z[0])}}get shutdown(){return U(R7,O((X)=>U(T(()=>xQ(this.putters)),O((J)=>g7(J,([Z,Y,$])=>$?U(rB(Y,X),W0):K8,!1,!1)))))}handleSurplus(X,J,Z,Y){return A8(($)=>{let Q=Z1($.id());return U(h(()=>{return this.unsafeOffer(X,Q),this.unsafeOnQueueEmptySpace(J,Z),LY(this,J,Z),h0(Y)?M4:m0(Q)}),M9(()=>T(()=>this.unsafeRemove(Q))))})}unsafeOnQueueEmptySpace(X,J){let Z=!0;while(Z&&(X.capacity()===Number.POSITIVE_INFINITY||X.length()<X.capacity())){let Y=U(this.putters,t5(L6));if(Y===L6)Z=!1;else{let $=X.offer(Y[0]);if($&&Y[2])TY(Y[1],!0);else if(!$)LU(this.putters,U(xQ(this.putters),O0(Y)));LY(this,X,J)}}}unsafeOffer(X,J){let Z=J8(X);for(let Y=0;Y<Z.length;Y++){let $=Z[Y];if(Y===Z.length-1)U(this.putters,_1([$,J,!0]));else U(this.putters,_1([$,J,!1]))}}unsafeRemove(X){LU(this.putters,U(xQ(this.putters),w$(([,J])=>J!==X)))}}class um{[TU]=jL;surplusSize(){return 0}get shutdown(){return K8}onCompleteTakersWithEmptyQueue(){}handleSurplus(X,J,Z,Y){return w(!1)}unsafeOnQueueEmptySpace(X,J){}}class pm{[TU]=jL;surplusSize(){return 0}get shutdown(){return K8}onCompleteTakersWithEmptyQueue(){}handleSurplus(X,J,Z,Y){return T(()=>{return this.unsafeOffer(J,X),LY(this,J,Z),!0})}unsafeOnQueueEmptySpace(X,J){}unsafeOffer(X,J){let Z=J[Symbol.iterator](),Y,$=!0;while(!(Y=Z.next()).done&&$){if(X.capacity()===0)return;X.poll(L6),$=X.offer(Y.value)}}}var TY=(X,J)=>{return Y1(X,w(J))},LU=(X,J)=>{return U(X,Gw(J))},xQ=(X)=>{return U(X,gW(Number.POSITIVE_INFINITY))},M58=(X,J)=>{return U(X,gW(J))},F58=(X,J)=>{LU(X,U(xQ(X),w$((Z)=>J!==Z)))},LY=(X,J,Z)=>{let Y=!0;while(Y&&J.length()!==0){let $=U(Z,t5(L6));if($!==L6){let Q=J.poll(L6);if(Q!==L6)TY($,Q),X.unsafeOnQueueEmptySpace(J,Z);else LU(Z,U(xQ(Z),O0($)));Y=!0}else Y=!1}if(Y&&J.length()===0&&!bW(Z))X.onCompleteTakersWithEmptyQueue(Z)};var yQ=Im,MU=Sm,FU=vm,$H=km;var fm=ym;var ZJ=bm,D5=gm;var PY=wU;var RU="Continue",IL="Close",SL="Yield";var j58="effect/ChannelChildExecutorDecision",om=Symbol.for(j58),C58={[om]:om},vL=(X)=>{let J=Object.create(C58);return J._tag=RU,J};var bQ="ContinuationK",rm="ContinuationFinalizer";var im=Symbol.for("effect/ChannelContinuation"),am={_Env:(X)=>X,_InErr:(X)=>X,_InElem:(X)=>X,_InDone:(X)=>X,_OutErr:(X)=>X,_OutDone:(X)=>X,_OutErr2:(X)=>X,_OutElem:(X)=>X,_OutDone2:(X)=>X};class jU{onSuccess;onHalt;_tag=bQ;[im]=am;constructor(X,J){this.onSuccess=X,this.onHalt=J}onExit(X){return V5(X)?this.onHalt(X.cause):this.onSuccess(X.value)}}class kL{finalizer;_tag=rm;[im]=am;constructor(X){this.finalizer=X}}var CU="PullAfterNext",xL="PullAfterAllEnqueued";var S58="effect/ChannelUpstreamPullStrategy",v58=Symbol.for(S58),k58={_A:(X)=>X},x58={[v58]:k58},yL=(X)=>{let J=Object.create(x58);return J._tag=CU,J.emitSeparator=X,J};var EU="BracketOut",IU="Bridge",QH="ConcatAll",SU="Emit",vU="Ensuring",kU="Fail",xU="Fold",yU="FromEffect",bU="PipeTo",bL="Provide",gU="Read",hU="Succeed",mU="SucceedNow",dU="Suspend";var b58="effect/Channel",gL=Symbol.for(b58),g58={_Env:(X)=>X,_InErr:(X)=>X,_InElem:(X)=>X,_InDone:(X)=>X,_OutErr:(X)=>X,_OutElem:(X)=>X,_OutDone:(X)=>X},G9={[gL]:g58,pipe(){return C(this,arguments)}},cU=(X)=>v(X,gL)||T6(X),hL=B(2,(X,J)=>{let Z=Object.create(G9);return Z._tag=EU,Z.acquire=()=>X,Z.finalizer=J,Z});var uU=(X)=>{return _5(()=>{let J=[];return M8(a0(X,em(J)),(Z)=>YJ(()=>[H4(J),Z]))})},em=(X)=>Q7({onInput:(J)=>M8(YJ(()=>{X.push(J)}),()=>em(X)),onFailure:A5,onDone:S4});var pU=(X,J,Z)=>{let Y=Object.create(G9);return Y._tag=QH,Y.combineInners=J,Y.combineAll=Z,Y.onPull=()=>yL(_()),Y.onEmit=()=>vL,Y.value=()=>X,Y.k=g,Y},mL=B(4,(X,J,Z,Y)=>{let $=Object.create(G9);return $._tag=QH,$.combineInners=Z,$.combineAll=Y,$.onPull=()=>yL(_()),$.onEmit=()=>vL,$.value=()=>X,$.k=J,$});var GH=B(2,(X,J)=>{let Z=Object.create(G9);return Z._tag=IU,Z.input=J,Z.channel=X,Z}),gQ=B(2,(X,J)=>{let Z=Object.create(G9);return Z._tag=vU,Z.channel=X,Z.finalizer=J,Z}),A5=(X)=>p0(JW(X));var p0=(X)=>fU(()=>X),fU=(X)=>{let J=Object.create(G9);return J._tag=kU,J.error=X,J},M8=B(2,(X,J)=>{let Z=Object.create(G9);return Z._tag=xU,Z.channel=X,Z.k=new jU(J,p0),Z});var G0=(X)=>{let J=Object.create(G9);return J._tag=yU,J.effect=()=>X,J},a0=B(2,(X,J)=>{let Z=Object.create(G9);return Z._tag=bU,Z.left=()=>X,Z.right=()=>J,Z});var Q7=(X)=>H9({onInput:X.onInput,onFailure:(J)=>U6($W(J),{onLeft:X.onFailure,onRight:p0}),onDone:X.onDone}),H9=(X)=>{let J=Object.create(G9);return J._tag=gU,J.more=X.onInput,J.done=new jU(X.onDone,X.onFailure),J},o7=(X)=>YJ(()=>X),S4=(X)=>{let J=Object.create(G9);return J._tag=mU,J.terminal=X,J},_5=(X)=>{let J=Object.create(G9);return J._tag=dU,J.channel=X,J},YJ=(X)=>{let J=Object.create(G9);return J._tag=hU,J.evaluate=X,J},t6=S4(void 0);var d8=(X)=>{let J=Object.create(G9);return J._tag=SU,J.out=X,J};var j1="Done",C1="Emit",$J="FromEffect",E1="Read";var h58=Symbol.for("effect/ChannelState"),m58={_E:(X)=>X,_R:(X)=>X},nU={[h58]:m58},MY=()=>{let X=Object.create(nU);return X._tag=j1,X},oU=()=>{let X=Object.create(nU);return X._tag=C1,X},mQ=(X)=>{let J=Object.create(nU);return J._tag=$J,J.effect=X,J},rU=(X,J,Z,Y)=>{let $=Object.create(nU);return $._tag=E1,$.upstream=X,$.onEffect=J,$.onEmit=Z,$.onDone=Y,$};var HH=(X)=>X._tag===$J;var Xd=(X)=>HH(X)?X.effect:o,cL=(X)=>HH(X)?wQ(X.effect):void 0;var uL="PullFromChild",lU="PullFromUpstream",iU="DrainChildExecutors",pL="Emit";class dQ{childExecutor;parentSubexecutor;onEmit;_tag=uL;constructor(X,J,Z){this.childExecutor=X,this.parentSubexecutor=J,this.onEmit=Z}close(X){let J=this.childExecutor.close(X),Z=this.parentSubexecutor.close(X);if(J!==void 0&&Z!==void 0)return z4($6(J),$6(Z),(Y,$)=>U(Y,XY($)));else if(J!==void 0)return J;else if(Z!==void 0)return Z;else return}enqueuePullFromChild(X){return this}}class I1{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=lU;constructor(X,J,Z,Y,$,Q,G,H){this.upstreamExecutor=X,this.createChild=J,this.lastDone=Z,this.activeChildExecutors=Y,this.combineChildResults=$,this.combineWithChildResult=Q,this.onPull=G,this.onEmit=H}close(X){let J=this.upstreamExecutor.close(X),Y=[...this.activeChildExecutors.map(($)=>$!==void 0?$.childExecutor.close(X):void 0),J].reduce(($,Q)=>{if($!==void 0&&Q!==void 0)return z4($,$6(Q),(G,H)=>XY(G,H));else if($!==void 0)return $;else if(Q!==void 0)return $6(Q);else return},void 0);return Y===void 0?Y:Y}enqueuePullFromChild(X){return new I1(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,X],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class FY{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=iU;constructor(X,J,Z,Y,$,Q,G){this.upstreamExecutor=X,this.lastDone=J,this.activeChildExecutors=Z,this.upstreamDone=Y,this.combineChildResults=$,this.combineWithChildResult=Q,this.onPull=G}close(X){let J=this.upstreamExecutor.close(X),Y=[...this.activeChildExecutors.map(($)=>$!==void 0?$.childExecutor.close(X):void 0),J].reduce(($,Q)=>{if($!==void 0&&Q!==void 0)return z4($,$6(Q),(G,H)=>XY(G,H));else if($!==void 0)return $;else if(Q!==void 0)return $6(Q);else return},void 0);return Y===void 0?Y:Y}enqueuePullFromChild(X){return new FY(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,X],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class KH{value;next;_tag=pL;constructor(X,J){this.value=X,this.next=J}close(X){let J=this.next.close(X);return J===void 0?J:J}enqueuePullFromChild(X){return this}}var Jd="Pulled",Zd="NoUpstream";var p58="effect/ChannelUpstreamPullRequest",f58=Symbol.for(p58),n58={_A:(X)=>X},Yd={[f58]:n58},fL=(X)=>{let J=Object.create(Yd);return J._tag=Jd,J.value=X,J},$d=(X)=>{let J=Object.create(Yd);return J._tag=Zd,J.activeDownstreamCount=X,J};class S1{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(X,J,Z){this._currentChannel=X,this._executeCloseLastSubstream=Z,this._providedEnv=J}run(){let X=void 0;while(X===void 0)if(this._cancelled!==void 0)X=this.processCancellation();else if(this._activeSubexecutor!==void 0)X=this.runSubexecutor();else try{if(this._currentChannel===void 0)X=MY();else{if(T6(this._currentChannel))this._currentChannel=G0(this._currentChannel);switch(this._currentChannel._tag){case EU:{X=this.runBracketOut(this._currentChannel);break}case IU:{let J=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,this._input!==void 0){let Z=this._input;this._input=void 0;let Y=()=>R(J.awaitRead(),()=>z8(()=>{let $=Z.run();switch($._tag){case j1:return s4(Z.getDone(),{onFailure:(Q)=>J.error(Q),onSuccess:(Q)=>J.done(Q)});case C1:return R(J.emit(Z.getEmit()),()=>Y());case $J:return x9($.effect,{onFailure:(Q)=>J.error(Q),onSuccess:()=>Y()});case E1:return sU($,()=>Y(),(Q)=>J.error(Q))}}));X=mQ(R(UY(g6(Y())),($)=>V8(()=>this.addFinalizer((Q)=>R(nX($),()=>z8(()=>{let G=this.restorePipe(Q,Z);return G!==void 0?G:o}))))))}break}case QH:{let J=new S1(this._currentChannel.value(),this._providedEnv,(Y)=>V8(()=>{let $=this._closeLastSubstream===void 0?o:this._closeLastSubstream;this._closeLastSubstream=U($,B8(Y))}));J._input=this._input;let Z=this._currentChannel;this._activeSubexecutor=new I1(J,(Y)=>Z.k(Y),void 0,[],(Y,$)=>Z.combineInners(Y,$),(Y,$)=>Z.combineAll(Y,$),(Y)=>Z.onPull(Y),(Y)=>Z.onEmit(Y)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case SU:{this._emitted=this._currentChannel.out,this._currentChannel=this._activeSubexecutor!==void 0?void 0:t6,X=oU();break}case vU:{this.runEnsuring(this._currentChannel);break}case kU:{X=this.doneHalt(this._currentChannel.error());break}case xU:{this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break}case yU:{let J=this._providedEnv===void 0?this._currentChannel.effect():U(this._currentChannel.effect(),L1(this._providedEnv));X=mQ(x9(J,{onFailure:(Z)=>{let Y=this.doneHalt(Z);return Y!==void 0&&HH(Y)?Y.effect:o},onSuccess:(Z)=>{let Y=this.doneSucceed(Z);return Y!==void 0&&HH(Y)?Y.effect:o}}));break}case bU:{let J=this._input,Z=new S1(this._currentChannel.left(),this._providedEnv,(Y)=>this._executeCloseLastSubstream(Y));Z._input=J,this._input=Z,this.addFinalizer((Y)=>{let $=this.restorePipe(Y,J);return $!==void 0?$:o}),this._currentChannel=this._currentChannel.right();break}case bL:{let J=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>V8(()=>{this._providedEnv=J}));break}case gU:{let J=this._currentChannel;X=rU(this._input,g,(Z)=>{try{this._currentChannel=J.more(Z)}catch(Y){this._currentChannel=J.done.onExit(kV(Y))}return},(Z)=>{let Y=($)=>{return J.done.onExit($)};this._currentChannel=Y(Z);return});break}case hU:{X=this.doneSucceed(this._currentChannel.evaluate());break}case mU:{X=this.doneSucceed(this._currentChannel.terminal);break}case dU:{this._currentChannel=this._currentChannel.channel();break}}}}catch(J){this._currentChannel=p0(q1(J))}return X}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(X){this._cancelled=X}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(X){this._inProgressFinalizer=X}popAllFinalizers(X){let J=[],Z=this._doneStack.pop();while(Z){if(Z._tag==="ContinuationFinalizer")J.push(Z.finalizer);Z=this._doneStack.pop()}let Y=J.length===0?o:oL(J,X);return this.storeInProgressFinalizer(Y),Y}popNextFinalizers(){let X=[];while(this._doneStack.length!==0){let J=this._doneStack[this._doneStack.length-1];if(J._tag===bQ)return X;X.push(J),this._doneStack.pop()}return X}restorePipe(X,J){let Z=this._input;if(this._input=J,Z!==void 0)return Z.close(X);return o}close(X){let J=void 0,Z=this._inProgressFinalizer;if(Z!==void 0)J=U(Z,Z9(V8(()=>this.clearInProgressFinalizer())));let Y=void 0,$=this.popAllFinalizers(X);if($!==void 0)Y=U($,Z9(V8(()=>this.clearInProgressFinalizer())));let Q=this._activeSubexecutor===void 0?void 0:this._activeSubexecutor.close(X);if(Q===void 0&&J===void 0&&Y===void 0)return;return U($6(nL(Q)),Y9($6(nL(J))),Y9($6(nL(Y))),k(([[G,H],K])=>U(G,XY(H),XY(K))),e5,R((G)=>z8(()=>G)))}doneSucceed(X){if(this._doneStack.length===0)return this._done=x6(X),this._currentChannel=void 0,MY();let J=this._doneStack[this._doneStack.length-1];if(J._tag===bQ){this._doneStack.pop(),this._currentChannel=J.onSuccess(X);return}let Z=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=Z.reverse(),this._done=x6(X),this._currentChannel=void 0,MY();let Y=oL(Z.map((Q)=>Q.finalizer),x6(X));this.storeInProgressFinalizer(Y);let $=U(Y,Z9(V8(()=>this.clearInProgressFinalizer())),e5,R(()=>V8(()=>this.doneSucceed(X))));return mQ($)}doneHalt(X){if(this._doneStack.length===0)return this._done=w6(X),this._currentChannel=void 0,MY();let J=this._doneStack[this._doneStack.length-1];if(J._tag===bQ){this._doneStack.pop();try{this._currentChannel=J.onHalt(X)}catch(Q){this._currentChannel=p0(q1(Q))}return}let Z=this.popNextFinalizers();if(this._doneStack.length===0)return this._doneStack=Z.reverse(),this._done=w6(X),this._currentChannel=void 0,MY();let Y=oL(Z.map((Q)=>Q.finalizer),w6(X));this.storeInProgressFinalizer(Y);let $=U(Y,Z9(V8(()=>this.clearInProgressFinalizer())),e5,R(()=>V8(()=>this.doneHalt(X))));return mQ($)}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,MY()}runBracketOut(X){let J=e5(x9(this.provide(X.acquire()),{onFailure:(Z)=>V8(()=>{this._currentChannel=p0(Z)}),onSuccess:(Z)=>V8(()=>{this.addFinalizer((Y)=>this.provide(X.finalizer(Z,Y))),this._currentChannel=d8(Z)})}));return mQ(J)}provide(X){if(this._providedEnv===void 0)return X;return U(X,L1(this._providedEnv))}runEnsuring(X){this.addFinalizer(X.finalizer),this._currentChannel=X.channel}addFinalizer(X){this._doneStack.push(new kL(X))}runSubexecutor(){let X=this._activeSubexecutor;switch(X._tag){case uL:return this.pullFromChild(X.childExecutor,X.parentSubexecutor,X.onEmit,X);case lU:return this.pullFromUpstream(X);case iU:return this.drainChildExecutors(X);case pL:return this._emitted=X.value,this._activeSubexecutor=X.next,oU()}}replaceSubexecutor(X){this._currentChannel=void 0,this._activeSubexecutor=X}finishWithExit(X){let J=s4(X,{onFailure:(Z)=>this.doneHalt(Z),onSuccess:(Z)=>this.doneSucceed(Z)});return this._activeSubexecutor=void 0,J===void 0?o:Xd(J)}finishSubexecutorWithCloseEffect(X,...J){this.addFinalizer(()=>U(J,F0((Y)=>U(V8(()=>Y(X)),R(($)=>$!==void 0?$:o)),{discard:!0})));let Z=U(X,s4({onFailure:(Y)=>this.doneHalt(Y),onSuccess:(Y)=>this.doneSucceed(Y)}));return this._activeSubexecutor=void 0,Z}applyUpstreamPullStrategy(X,J,Z){switch(Z._tag){case CU:{let Y=!X||J.some(($)=>$!==void 0);return[Z.emitSeparator,Y?[void 0,...J]:J]}case xL:{let Y=!X||J.some(($)=>$!==void 0);return[Z.emitSeparator,Y?[...J,void 0]:J]}}}pullFromChild(X,J,Z,Y){return rU(X,g,($)=>{let Q=Z($);switch(Q._tag){case RU:break;case IL:{this.finishWithDoneValue(X,J,Q.value);break}case SL:{let G=J.enqueuePullFromChild(Y);this.replaceSubexecutor(G);break}}this._activeSubexecutor=new KH($,this._activeSubexecutor);return},s4({onFailure:($)=>{let Q=this.handleSubexecutorFailure(X,J,$);return Q===void 0?void 0:cL(Q)},onSuccess:($)=>{this.finishWithDoneValue(X,J,$);return}}))}finishWithDoneValue(X,J,Z){let Y=J;switch(Y._tag){case lU:{let $=new I1(Y.upstreamExecutor,Y.createChild,Y.lastDone!==void 0?Y.combineChildResults(Y.lastDone,Z):Z,Y.activeChildExecutors,Y.combineChildResults,Y.combineWithChildResult,Y.onPull,Y.onEmit);this._closeLastSubstream=X.close(x6(Z)),this.replaceSubexecutor($);break}case iU:{let $=new FY(Y.upstreamExecutor,Y.lastDone!==void 0?Y.combineChildResults(Y.lastDone,Z):Z,Y.activeChildExecutors,Y.upstreamDone,Y.combineChildResults,Y.combineWithChildResult,Y.onPull);this._closeLastSubstream=X.close(x6(Z)),this.replaceSubexecutor($);break}default:break}}handleSubexecutorFailure(X,J,Z){return this.finishSubexecutorWithCloseEffect(w6(Z),(Y)=>J.close(Y),(Y)=>X.close(Y))}pullFromUpstream(X){if(X.activeChildExecutors.length===0)return this.performPullFromUpstream(X);let J=X.activeChildExecutors[0],Z=new I1(X.upstreamExecutor,X.createChild,X.lastDone,X.activeChildExecutors.slice(1),X.combineChildResults,X.combineWithChildResult,X.onPull,X.onEmit);if(J===void 0)return this.performPullFromUpstream(Z);this.replaceSubexecutor(new dQ(J.childExecutor,Z,J.onEmit));return}performPullFromUpstream(X){return rU(X.upstreamExecutor,(J)=>{let Z=this._closeLastSubstream===void 0?o:this._closeLastSubstream;return this._closeLastSubstream=void 0,U(this._executeCloseLastSubstream(Z),B8(J))},(J)=>{if(this._closeLastSubstream!==void 0){let Q=this._closeLastSubstream;return this._closeLastSubstream=void 0,U(this._executeCloseLastSubstream(Q),k(()=>{let G=new S1(X.createChild(J),this._providedEnv,this._executeCloseLastSubstream);G._input=this._input;let[H,K]=this.applyUpstreamPullStrategy(!1,X.activeChildExecutors,X.onPull(fL(J)));if(this._activeSubexecutor=new dQ(G,new I1(X.upstreamExecutor,X.createChild,X.lastDone,K,X.combineChildResults,X.combineWithChildResult,X.onPull,X.onEmit),X.onEmit),H8(H))this._activeSubexecutor=new KH(H.value,this._activeSubexecutor);return}))}let Z=new S1(X.createChild(J),this._providedEnv,this._executeCloseLastSubstream);Z._input=this._input;let[Y,$]=this.applyUpstreamPullStrategy(!1,X.activeChildExecutors,X.onPull(fL(J)));if(this._activeSubexecutor=new dQ(Z,new I1(X.upstreamExecutor,X.createChild,X.lastDone,$,X.combineChildResults,X.combineWithChildResult,X.onPull,X.onEmit),X.onEmit),H8(Y))this._activeSubexecutor=new KH(Y.value,this._activeSubexecutor);return},(J)=>{if(X.activeChildExecutors.some(($)=>$!==void 0)){let $=new FY(X.upstreamExecutor,X.lastDone,[void 0,...X.activeChildExecutors],X.upstreamExecutor.getDone(),X.combineChildResults,X.combineWithChildResult,X.onPull);if(this._closeLastSubstream!==void 0){let Q=this._closeLastSubstream;return this._closeLastSubstream=void 0,U(this._executeCloseLastSubstream(Q),k(()=>this.replaceSubexecutor($)))}this.replaceSubexecutor($);return}let Z=this._closeLastSubstream,Y=this.finishSubexecutorWithCloseEffect(U(J,AA(($)=>X.combineWithChildResult(X.lastDone,$))),()=>Z,($)=>X.upstreamExecutor.close($));return Y===void 0?void 0:cL(Y)})}drainChildExecutors(X){if(X.activeChildExecutors.length===0){let $=this._closeLastSubstream;if($!==void 0)this.addFinalizer(()=>L($));return this.finishSubexecutorWithCloseEffect(X.upstreamDone,()=>$,(Q)=>X.upstreamExecutor.close(Q))}let J=X.activeChildExecutors[0],Z=X.activeChildExecutors.slice(1);if(J===void 0){let[$,Q]=this.applyUpstreamPullStrategy(!0,Z,X.onPull($d(Z.reduce((G,H)=>H!==void 0?G+1:G,0))));if(this.replaceSubexecutor(new FY(X.upstreamExecutor,X.lastDone,Q,X.upstreamDone,X.combineChildResults,X.combineWithChildResult,X.onPull)),H8($))return this._emitted=$.value,oU();return}let Y=new FY(X.upstreamExecutor,X.lastDone,Z,X.upstreamDone,X.combineChildResults,X.combineWithChildResult,X.onPull);this.replaceSubexecutor(new dQ(J.childExecutor,Y,J.onEmit));return}}var nL=(X)=>X!==void 0?X:o,oL=(X,J)=>{return U(F0(X,(Z)=>$6(Z(J))),k((Z)=>U(lv(Z),i(()=>b7))),R((Z)=>z8(()=>Z)))},sU=(X,J,Z)=>{let Y=[X],$=()=>{let Q=Y.pop();if(Q===void 0||Q.upstream===void 0)return oX("Unexpected end of input for channel execution");let G=Q.upstream.run();switch(G._tag){case C1:{let H=Q.onEmit(Q.upstream.getEmit());if(Y.length===0){if(H===void 0)return z8(J);return U(H,x9({onFailure:Z,onSuccess:J}))}if(H===void 0)return z8(()=>$());return U(H,x9({onFailure:Z,onSuccess:()=>$()}))}case j1:{let H=Q.onDone(Q.upstream.getDone());if(Y.length===0){if(H===void 0)return z8(J);return U(H,x9({onFailure:Z,onSuccess:J}))}if(H===void 0)return z8(()=>$());return U(H,x9({onFailure:Z,onSuccess:()=>$()}))}case $J:return Y.push(Q),U(Q.onEffect(G.effect),c7((H)=>z8(()=>{let K=Q.onDone(w6(H));return K===void 0?o:K})),x9({onFailure:Z,onSuccess:()=>$()}));case E1:return Y.push(Q),Y.push(G),z8(()=>$())}};return $()},rL=B(2,(X,J)=>{let Z=(Y,$,Q)=>LQ(V8(()=>new S1(X,void 0,g)),(G)=>z8(()=>aU(G.run(),G).pipe(MQ(Y),B8(k8(Y)),N4(k8($)))),(G,H)=>{let K=G.close(H);if(K===void 0)return o;return lX(K,(V)=>fX(Q,U4(V)))});return WY((Y)=>y3([UW(J,a$),K0(),K0()]).pipe(R(([$,Q,G])=>Y(Z(Q,G,$)).pipe(X7(J),R((H)=>J.addFinalizer((K)=>{let V=V5(K)?Gy(K.cause):void 0;return A1(Q).pipe(R((W)=>W?b6(G,void 0).pipe(B8(w3(H)),B8(R_(H))):b6(G,void 0).pipe(B8(V&&LX(V)>0?L3(H,jj(V)):nX(H)),B8(R_(H)))))}).pipe(B8(Y(k8(Q)))))))))}),aU=(X,J)=>{let Z=X;switch(Z._tag){case $J:return U(Z.effect,R(()=>aU(J.run(),J)));case C1:return aU(J.run(),J);case j1:return z8(()=>J.getDone());case E1:return sU(Z,()=>aU(J.run(),J),U4)}};var lL="Done",Qd="Await";var l58="effect/ChannelMergeDecision",i58=Symbol.for(l58),a58={[i58]:{_R:(X)=>X,_E0:(X)=>X,_Z0:(X)=>X,_E:(X)=>X,_Z:(X)=>X}};var iL=(X)=>{let J=Object.create(a58);return J._tag=Qd,J.f=X,J};var tU="BothRunning",eU="LeftDone",XN="RightDone";var t58="effect/ChannelMergeState",Kd=Symbol.for(t58),aL={[Kd]:Kd},JN=(X,J)=>{let Z=Object.create(aL);return Z._tag=tU,Z.left=X,Z.right=J,Z},sL=(X)=>{let J=Object.create(aL);return J._tag=eU,J.f=X,J},tL=(X)=>{let J=Object.create(aL);return J._tag=XN,J.f=X,J};var eL="BackPressure",XT="BufferSliding";var J78="effect/ChannelMergeStrategy",Bd=Symbol.for(J78),Vd={[Bd]:Bd},Wd=(X)=>{let J=Object.create(Vd);return J._tag=eL,J},Ud=(X)=>{let J=Object.create(Vd);return J._tag=XT,J};var Nd=B(2,(X,{onBackPressure:J,onBufferSliding:Z})=>{switch(X._tag){case eL:return J();case XT:return Z()}});var cQ="Empty",BH="Emit",VH="Error",WH="Done",qd=(X)=>({_tag:cQ,notifyProducer:X}),JT=(X)=>({_tag:BH,notifyConsumers:X}),Z78=(X)=>({_tag:VH,cause:X}),Y78=(X)=>({_tag:WH,done:X});class Od{ref;constructor(X){this.ref=X}awaitRead(){return z5(K1(this.ref,(X)=>X._tag===cQ?[k8(X.notifyProducer),X]:[o,X]))}get close(){return fW((X)=>this.error(ZW(X)))}done(X){return z5(K1(this.ref,(J)=>{switch(J._tag){case cQ:return[k8(J.notifyProducer),J];case BH:return[F0(J.notifyConsumers,(Z)=>b6(Z,$8(X)),{discard:!0}),Y78(X)];case VH:return[rX,J];case WH:return[rX,J]}}))}emit(X){return R(K0(),(J)=>z5(K1(this.ref,(Z)=>{switch(Z._tag){case cQ:return[k8(Z.notifyProducer),Z];case BH:{let Y=Z.notifyConsumers[0],$=Z.notifyConsumers.slice(1);if(Y!==void 0)return[b6(Y,Z8(X)),$.length===0?qd(J):JT($)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case VH:return[rX,Z];case WH:return[rX,Z]}})))}error(X){return z5(K1(this.ref,(J)=>{switch(J._tag){case cQ:return[k8(J.notifyProducer),J];case BH:return[F0(J.notifyConsumers,(Z)=>d7(Z,X),{discard:!0}),Z78(X)];case VH:return[rX,J];case WH:return[rX,J]}}))}get take(){return this.takeWith((X)=>w6(O1(X,$8)),(X)=>x6(X),(X)=>W1(Z8(X)))}takeWith(X,J,Z){return R(K0(),(Y)=>z5(K1(this.ref,($)=>{switch($._tag){case cQ:return[B8(b6($.notifyProducer,void 0),P1(k8(Y),{onFailure:X,onSuccess:U6({onLeft:Z,onRight:J})})),JT([Y])];case BH:return[P1(k8(Y),{onFailure:X,onSuccess:U6({onLeft:Z,onRight:J})}),JT([...$.notifyConsumers,Y])];case VH:return[L(X($.cause)),$];case WH:return[L(Z($.done)),$]}})))}}var ZT=()=>U(K0(),R((X)=>v6(qd(X))),k((X)=>new Od(X)));var _d=(X,J,Z)=>M8(G0(v6(()=>o)),(Y)=>U(G0(e5(X0(X,($)=>JQ(Y,(Q)=>Z($,Q))))),M8(J),gQ(($)=>R(k6(Y),(Q)=>Q($)))));var UH=B(2,(X,J)=>mL(X,J,()=>{return},()=>{return}));var pQ=(X)=>{let J=H9({onInput:()=>J,onFailure:p0,onDone:o7});return a0(X,J)};var NH=B(2,(X,J)=>gQ(X,()=>J));var wd=(X)=>M8(X,g);var YN=(X)=>G7(X.takeWith(p0,(J)=>M8(d8(J),()=>YN(X)),o7));var zH=()=>Q7({onInput:(X)=>M8(d8(X),()=>zH()),onFailure:A5,onDone:S4});var $N=B(2,(X,J)=>M8(X,(Z)=>YJ(()=>J(Z))));var qH=B(2,(X,J)=>{let Z=Q7({onInput:(Y)=>M8(d8(J(Y)),()=>Z),onFailure:A5,onDone:S4});return a0(X,Z)}),QT=B(2,(X,J)=>{let Z=H9({onInput:(Y)=>U(G0(J(Y)),M8(d8),M8(()=>Z)),onFailure:p0,onDone:S4});return a0(X,Z)});var Ld=(X)=>{return(J)=>Td(X)(J,Y4)};var Td=({bufferSize:X=16,concurrency:J,mergeStrategy:Z=Wd()})=>(Y,$)=>DH((Q)=>_8(function*(){let G=J==="unbounded"?Number.MAX_SAFE_INTEGER:J,H=yield*ZT(),K=YN(H),V=yield*yQ(X);yield*fX(Q,ZJ(V));let W=yield*$H();yield*fX(Q,ZJ(W));let N=yield*v6(_()),z=yield*K0(),q=(yield*aW(G)).withPermits,A=yield*uQ(a0(K,Y),Q);function E(M){return M.pipe(R(U6({onLeft:(c)=>L(D(c)),onRight:(c)=>K6(D5(V,L(Z8(c))),_())})),iW({until:(c)=>H8(c)}),R((c)=>l5(N,n({onNone:()=>D(c.value),onSome:(y)=>D($(y,c.value))}))),c7((c)=>YW(c)?U4(c):D5(V,U4(c)).pipe(B8(b6(z,void 0)),J9)))}yield*A.pipe(x9({onFailure:(M)=>D5(V,U4(M)).pipe(B8(L(!1))),onSuccess:U6({onLeft:(M)=>c3(g6(k8(z)),g6(q(G)(o)),{onSelfDone:(c,y)=>K6(nX(y),!1),onOtherDone:(c,y)=>B8(nX(y),k6(N).pipe(R(n({onNone:()=>D5(V,L($8(M))),onSome:(s)=>D5(V,L($8($(s,M))))})),K6(!1)))}),onRight:(M)=>Nd(Z,{onBackPressure:()=>_8(function*(){let c=yield*K0(),y=m3((Y8)=>uQ(a0(K,M),Y8).pipe(R((l)=>d3($6(E(l)),$6(g6(k8(z))))),R(g)));return yield*b6(c,void 0).pipe(B8(y),q(1),X7(Q)),yield*k8(c),!(yield*A1(z))}),onBufferSliding:()=>_8(function*(){let c=yield*K0(),y=yield*K0(),s=yield*fm(W);yield*PY(W).pipe(R((G8)=>b6(G8,void 0)),J7(()=>s>=G)),yield*D5(W,c);let Y8=m3((G8)=>uQ(a0(K,M),G8).pipe(R((P8)=>$6(E(P8)).pipe(d3($6(g6(k8(z)))),d3($6(g6(k8(c)))))),R(g)));return yield*b6(y,void 0).pipe(B8(Y8),q(1),X7(Q)),yield*k8(y),!(yield*A1(z))})})})}),iW({while:(M)=>M}),X7(Q));let P=U(PY(V),z5,P1({onFailure:p0,onSuccess:U6({onLeft:S4,onRight:(M)=>M8(d8(M),()=>P)})}),G7);return GH(P,H)})),QN=B(3,(X,J,Z)=>Ld(Z)(qH(X,J)));var GN=B(2,(X,J)=>{function Z(Y){return _8(function*(){let $=yield*ZT(),Q=YN($),G=yield*uQ(a0(Q,X),Y),H=yield*uQ(a0(Q,J.other),Y);function K(W,N,z){return(q,A,E)=>{function P(M){let c=M;if(c._tag===lL)return L(G0(B8(nX(N),c.effect)));return k(w3(N),s4({onFailure:(y)=>G0(c.f(w6(y))),onSuccess:U6({onLeft:(y)=>G0(c.f(x6(y))),onRight:(y)=>QJ(d8(y),V(E(c.f)))})}))}return s4(W,{onFailure:(M)=>P(q(w6(M))),onSuccess:U6({onLeft:(M)=>P(q(x6(M))),onRight:(M)=>L(M8(d8(M),()=>M8(G0(X7(g6(z),Y)),(c)=>V(A(c,N)))))})})}}function V(W){switch(W._tag){case tU:{let N=g6(j_(W.left)),z=g6(j_(W.right));return G7(c3(N,z,{onSelfDone:(q,A)=>B8(nX(A),K(q,W.right,G)(J.onSelfDone,JN,(E)=>sL(E))),onOtherDone:(q,A)=>B8(nX(A),K(q,W.left,H)(J.onOtherDone,(E,P)=>JN(P,E),(E)=>tL(E)))}))}case eU:return G7(k($6(H),s4({onFailure:(N)=>G0(W.f(w6(N))),onSuccess:U6({onLeft:(N)=>G0(W.f(x6(N))),onRight:(N)=>M8(d8(N),()=>V(sL(W.f)))})})));case XN:return G7(k($6(G),s4({onFailure:(N)=>G0(W.f(w6(N))),onSuccess:U6({onLeft:(N)=>G0(W.f(x6(N))),onRight:(N)=>M8(d8(N),()=>V(tL(W.f)))})})))}}return G0(w1((W)=>{let N=w1((A)=>{return A.transferChildren(W.scope()),o}),z=g6(G).pipe(Z9(N),X7(Y)),q=g6(H).pipe(Z9(N),X7(Y));return z4(z,q,(A,E)=>JN(A,E))})).pipe(M8(V),GH($))})}return DH(Z)});var OH=B(2,(X,J)=>_5(()=>{let Z=void 0,Y=Q7({onInput:(Q)=>M8(d8(Q),()=>Y),onFailure:(Q)=>{return Z=Fd(Q),p0(q1(Z))},onDone:S4}),$=H9({onInput:(Q)=>U(d8(Q),M8(()=>$)),onFailure:(Q)=>K_(Q)&&Rd(Q.defect)&&S(Q.defect,Z)?A5(Q.defect.error):p0(Q),onDone:S4});return a0(a0(a0(X,Y),J),$)}));var GT=(X)=>m3((J)=>rL(X,J));var HT=(X)=>GT(pQ(X)),HN=(X)=>Aw((J)=>rL(X,J)),KN=(X)=>G7(WY((J)=>k(my(),(Z)=>hL(lX(J(hy(X,Z)),(Y)=>D3(Z,w6(Y))),(Y,$)=>D3(Z,$))))),KT=(X)=>RY(k(h3,(J)=>M8(G0(X(J)),d8)));var BT=()=>_5(()=>{let X="",J=!1,Z=($)=>{let Q=[];return BZ($,(G)=>{if(G.length!==0){let H=0,K=G.indexOf("\r"),V=G.indexOf(`
`);if(J){if(V===0)Q.push(X),X="",H=1,V=G.indexOf(`
`,H);else X=X+"\r";J=!1}while(K!==-1||V!==-1)if(K===-1||V!==-1&&V<K){if(X.length===0)Q.push(G.substring(H,V));else Q.push(X+G.substring(H,V)),X="";H=V+1,V=G.indexOf(`
`,H)}else if(G.length===K+1)J=!0,K=-1;else if(V===K+1){if(X.length===0)Q.push(G.substring(H,K));else X=X+G.substring(H,K),Q.push(X),X="";H=K+2,K=G.indexOf("\r",H),V=G.indexOf(`
`,H)}else K=G.indexOf("\r",K+1);if(J)X=X+G.substring(H,G.length-1);else X=X+G.substring(H,G.length)}}),b0(Q)},Y=H9({onInput:($)=>{let Q=Z($);return g5(Q)?Y:M8(d8(Q),()=>Y)},onFailure:($)=>X.length===0?p0($):M8(d8(I8(X)),()=>p0($)),onDone:($)=>X.length===0?o7($):M8(d8(I8(X)),()=>o7($))});return Y});var uQ=B(2,(X,J)=>Y9(V8(()=>new S1(X,void 0,g)),aX()).pipe(X0(([Z,Y])=>gy(J,($)=>{let Q=Z.close($);return Q!==void 0?L1(Q,Y):o})),e5,k(([Z])=>z8(()=>YT(Z.run(),Z))))),YT=(X,J)=>{let Z=X;switch(Z._tag){case j1:return s4(J.getDone(),{onFailure:U4,onSuccess:(Y)=>L($8(Y))});case C1:return L(Z8(J.getEmit()));case $J:return U(Z.effect,R(()=>YT(J.run(),J)));case E1:return sU(Z,()=>YT(J.run(),J),(Y)=>U4(Y))}};var G7=(X)=>wd(G0(X)),RY=(X)=>pU(KN(X),(J,Z)=>J,(J,Z)=>J),DH=(X)=>pU(KT(X),(J,Z)=>J,(J,Z)=>J);var fQ=(X)=>Pd(0,X.length,X),Pd=(X,J,Z)=>{return X===J?t6:U(d8(U(Z,y5(X))),M8(()=>Pd(X+1,J,Z)))},Md=B((X)=>cU(X[1]),(X,J,Z)=>Z?.concurrent?GN(X,{other:J,onSelfDone:(Y)=>iL(($)=>z8(()=>wA(Y,$))),onOtherDone:(Y)=>iL(($)=>z8(()=>wA($,Y)))}):M8(X,(Y)=>$N(J,($)=>[Y,$])));var QJ=B((X)=>cU(X[1]),(X,J,Z)=>Z?.concurrent?$N(Md(X,J,{concurrent:!0}),(Y)=>Y[1]):M8(X,()=>J)),ZN=Symbol.for("effect/Channel/ChannelException"),Fd=(X)=>({_tag:"ChannelException",[ZN]:ZN,error:X}),Rd=(X)=>v(X,ZN);var Id=Symbol.for("effect/Sink"),w78={_A:(X)=>X,_In:(X)=>X,_L:(X)=>X,_E:(X)=>X,_R:(X)=>X};class GJ{channel;[Id]=w78;constructor(X){this.channel=X}pipe(){return C(this,arguments)}}var Sd=(X)=>new GJ(_5(()=>jY(X())));var VT=()=>new GJ(vd(e8())),vd=(X)=>H9({onInput:(J)=>vd(U(X,t8(J))),onFailure:p0,onDone:()=>o7(X)});var WT=new GJ(pQ(zH()));var kd=(X,J,Z)=>Sd(()=>new GJ(xd(X,J,Z))),xd=(X,J,Z)=>{if(!J(X))return S4(X);return Q7({onInput:(Y)=>xd(Z(X,Y),J,Z),onFailure:A5,onDone:()=>S4(X)})};var yd=(X,J)=>kd(X,b4,J);var UT=(X)=>{let J=H9({onInput:(Z)=>U(G0(F0(Z,(Y)=>X(Y),{discard:!0})),M8(()=>J)),onFailure:p0,onDone:()=>t6});return new GJ(J)};var NT=(X)=>new GJ(X),zT=(X)=>new GJ(G0(X));var jY=(X)=>T6(X)?jY(zT(X)):X.channel;var bd=(X)=>new GJ(RY(X.pipe(k((J)=>jY(J)))));var hd=Symbol.for("effect/RcRef"),qT={_tag:"Empty"},L78={_tag:"Closed"},T78={_A:g,_E:g};class md extends a4{acquire;context;scope;idleTimeToLive;[hd]=T78;[r5]=r5;state=qT;semaphore=UQ(1);constructor(X,J,Z,Y){super();this.acquire=X,this.context=J,this.scope=Z,this.idleTimeToLive=Y,this.get=OT(this)}get;commit(){return this.get}}var dd=(X)=>A8((J)=>{let Z=J.getFiberRef(D6),Y=z6(Z,e4),$=new md(X.acquire,Z,Y,X.idleTimeToLive?g0(X.idleTimeToLive):void 0);return s8(Y.addFinalizer(()=>$.semaphore.withPermits(1)(h(()=>{let Q=$.state._tag==="Acquired"?n5($.state.scope,M0):K8;return $.state=L78,Q}))),$)}),OT=(X)=>{let J=X;return U0((Z)=>h(()=>{switch(J.state._tag){case"Closed":return M4;case"Acquired":return J.state.refCount++,J.state.fiber?s8(sJ(J.state.fiber),J.state):w(J.state);case"Empty":return z1().pipe(o2("scope"),n2("value",({scope:Y})=>Z(N0(J.acquire,D6,$0(J.context,e4,Y)))),I(({scope:Y,value:$})=>{let Q={_tag:"Acquired",value:$,scope:Y,fiber:void 0,refCount:1};return J.state=Q,Q}))}})).pipe(J.semaphore.withPermits(1),o2("state"),n2("scope",()=>e4),V4(({scope:Z,state:Y})=>Z.addFinalizer(()=>h(()=>{if(Y.refCount--,Y.refCount>0)return K8;if(J.idleTimeToLive===void 0)return J.state=qT,n5(Y.scope,M0);return hX(J.idleTimeToLive).pipe(p5,j8(h(()=>{if(J.state._tag==="Acquired"&&J.state.refCount===0)return J.state=qT,n5(Y.scope,M0);return K8})),X9(T(()=>{Y.fiber=void 0})),A3(J.scope),V4(($)=>{Y.fiber=$}),J.semaphore.withPermits(1))}))),I(({state:Z})=>Z.value))};var cd=dd,DT=OT;var AT=qQ;var pd=AW;var fd=wb;var nd=Wg;var rd=(X)=>{return Object.assign(X,{chunk(Z){return this(L(Z))},die(Z){return this(I9(Z))},dieMessage(Z){return this(oX(Z))},done(Z){return this(z8(()=>_A(Z,{onFailure:D,onSuccess:I8})))},end(){return this(x(_()))},fail(Z){return this(x(D(Z)))},fromEffect(Z){return this(v9(Z,{onFailure:D,onSuccess:I8}))},fromEffectChunk(Z){return this(U(Z,s6(D)))},halt(Z){return this(U4(U(Z,O1(D))))},single(Z){return this(L(I8(Z)))}})};var R78="effect/Take",j78=Symbol.for(R78),C78={_A:(X)=>X,_E:(X)=>X};class VN{exit;[j78]=C78;constructor(X){this.exit=X}pipe(){return C(this,arguments)}}var WN=(X)=>new VN(x6(X));var ld=(X)=>z8(()=>X.exit),UN=new VN(W1(_()));var NN=(X)=>new VN(w6(U(X,O1(D))));var id=(X)=>P1(X,{onFailure:(J)=>n(QW(J),{onNone:()=>UN,onSome:NN}),onSuccess:WN});var wT=B(2,(X,{onEnd:J,onFailure:Z,onSuccess:Y})=>s4(X.exit,{onFailure:($)=>n(QW($),{onNone:J,onSome:Z}),onSuccess:Y}));var ad=()=>x(_());var XX8="effect/Stream",LT=Symbol.for(XX8),JX8={_R:(X)=>X,_E:(X)=>X,_A:(X)=>X};class v4{channel;[LT]=JX8;constructor(X){this.channel=X}pipe(){return C(this,arguments)}}var TT=(X)=>v(X,LT)||T6(X);var ZX8=(X)=>{if(X==="unbounded")return $H();else if(typeof X==="number"||X===void 0)return yQ(X??16);switch(X.strategy){case"dropping":return MU(X.bufferSize??16);case"sliding":return FU(X.bufferSize??16);default:return yQ(X.bufferSize??16)}};var ed=(X,J)=>U(P6(ZX8(J),(Z)=>ZJ(Z)),R((Z)=>U(aX(),R((Y)=>U(X(rd(($)=>U(id($),R((Q)=>D5(Z,Q)),J9,pd(Y)).then((Q)=>{if(V5(Q)){if(!YW(Q.cause))throw B_(Q.cause)}}))),B8(v6(!1)),R(($)=>U(k6($),k((Q)=>Q?ad():U(PY(Z),R(ld),g3(()=>U(JQ($,!0),B8(ZJ(Z)))))))))))),jT,PT(Gc));var Xc=B(2,(X,J)=>{if(J.strategy==="dropping")return YX8(X,J.capacity);else if(J.strategy==="sliding")return $X8(X,J.capacity);let Z=Wc(X,J);return new v4(RY(k(Z,(Y)=>{let $=U(G0(PY(Y)),M8(wT({onEnd:()=>t6,onFailure:p0,onSuccess:(Q)=>U(d8(Q),M8(()=>$))})));return $})))}),YX8=B(2,(X,J)=>{let Z=P6(MU(J),(Y)=>ZJ(Y));return new v4(Jc(Z,D4(X)))}),$X8=B(2,(X,J)=>{let Z=P6(FU(J),(Y)=>ZJ(Y));return new v4(Jc(Z,D4(X)))});var Jc=(X,J)=>{let Z=($,Q)=>{let G=(H)=>U(k6(Q),X0(k8),B8(K0()),R((K)=>U(D5($,[H,K]),B8(JQ(Q,K)),B8(k8(K)))),J9,G0);return H9({onInput:(H)=>U(K0(),R((K)=>U(D5($,[WN(H),K]),R((V)=>U(JQ(Q,K),J7(()=>V))))),J9,G0,M8(()=>Z($,Q))),onFailure:(H)=>G(NN(H)),onDone:()=>G(UN)})},Y=($)=>{let Q=U(G0(PY($)),M8(([G,H])=>QJ(G0(b6(H,void 0)),wT(G,{onEnd:()=>t6,onFailure:p0,onSuccess:(K)=>U(d8(K),M8(()=>Q))}))));return Q};return RY(U(X,R(($)=>U(K0(),X0((Q)=>b6(Q,void 0)),R((Q)=>U(v6(Q),R((G)=>U(J,a0(Z($,G)),HN,TQ)),K6(Y($))))))))};var PT=B((X)=>TT(X[0]),(X,J,Z)=>{let Y=Z?.bufferSize??16;if(Z?.switch)return sd(Z?.concurrency,()=>td(X,1,Y,J),($)=>td(X,$,Y,J));return sd(Z?.concurrency,()=>new v4(UH(D4(X),($)=>U($,BZ((Q)=>D4(J(Q))),iG(t6,(Q,G)=>U(Q,QJ(G)))))),($)=>new v4(U(D4(X),UH(fQ),QN((Q)=>D4(J(Q)),Z))))}),sd=(X,J,Z)=>{switch(X){case void 0:return J();case"unbounded":return Z(Number.MAX_SAFE_INTEGER);default:return X>1?Z(X):J()}},td=B(4,(X,J,Z,Y)=>new v4(U(D4(X),UH(fQ),QN(($)=>D4(Y($)),{concurrency:J,mergeStrategy:Ud(),bufferSize:Z})))),MT=B((X)=>TT(X[0]),(X,J)=>PT(X,g,J));var Zc=(X)=>new v4(X),D4=(X)=>{if("channel"in X)return X.channel;else if(T6(X))return D4(FT(X));else throw TypeError("Expected a Stream.")};var FT=(X)=>U(X,s6(D),Yc),Yc=(X)=>new v4(G7(q5(X,{onFailure:n({onNone:()=>t6,onSome:A5}),onSuccess:(J)=>d8(I8(J))})));var $c=B(2,(X,J)=>new v4(U(D4(X),qH(J))));var Qc=B(2,(X,J)=>new v4(a0(D4(X),J)));var Gc=(X)=>Nc(X,(J)=>U(k(J,(Z)=>D([Z,J])),a6(n({onNone:()=>L(_()),onSome:x}))));var RT=B(2,(X,J)=>D4(X).pipe(OH(jY(J)),HT)),Hc=(X)=>RT(X,VT());var Kc=B(2,(X,J)=>{let Z=H9({onInput:(Y)=>M8(d8(WN(Y)),()=>Z),onFailure:(Y)=>d8(NN(Y)),onDone:()=>d8(UN)});return U(a0(D4(X),Z),QT((Y)=>D5(J,Y)),pQ,HN,J9)});var jT=(X)=>new v4(NH(KN(U(X,k(I8))),o));var Bc=(X)=>Qc(X,BT());var Vc=(X)=>new v4(_5(()=>D4(X())));var Wc=B((X)=>TT(X[0]),(X,J)=>X0(P6(J?.strategy==="unbounded"?$H():J?.strategy==="dropping"?MU(J.capacity??2):J?.strategy==="sliding"?FU(J.capacity??2):yQ(J?.capacity??2),(Z)=>ZJ(Z)),(Z)=>TQ(Kc(X,Z))));var Uc=B(2,(X,J)=>{let Z=_5(()=>{let Y={ref:e8()},$={ref:!1},Q=_5(()=>{let V=Y.ref;if(g5(V))return Q7({onInput:(W)=>U(d8(W),M8(()=>Q)),onFailure:A5,onDone:S4});return Y.ref=e8(),U(fQ(V),M8(()=>Q))}),G=(V)=>{let W=Y.ref,N=t8(W,w$(V,(z)=>z.length!==0));return Y.ref=N,N},H=Q7({onInput:(V)=>M8(d8(V),()=>H),onFailure:A5,onDone:(V)=>QJ(YJ(()=>{$.ref=!0}),S4(V))}),K=U(J,jY,uU,M8(([V,W])=>U(o7([$.ref,G(V)]),M8(([N,z])=>{let q=N&&g5(z)?t6:K;return U(d8(I8(W)),M8(()=>q))}))));return U(D4(X),a0(H),a0(Q),OH(K))});return new v4(Z)});var Nc=(X,J)=>Vc(()=>{let Z=(Y)=>G7(k(J(Y),n({onNone:()=>t6,onSome:([$,Q])=>M8(d8($),()=>Z(Q))})));return new v4(Z(X))});var zc=(X)=>MT(FT(X)),qc=(X)=>MT(jT(X));var Oc=_d;var CT=GH;var Dc=NH;var v1=M8;var Ac=G0;var ET=_5;var AH=t6;var zN=d8;var _c=WT;var wc=yd;var Lc=UT;var Tc=NT;var Pc=bd;var Mc=ed;var Fc=Xc;var nQ=Zc;var Rc=$c;var qN=RT,jc=Hc;var Cc=Bc;var Ec=Uc;var Ic=zc,k1=qc;var Sc="effect/Redacted",oQ=X8("effect/Redacted/redactedRegistry",()=>new WeakMap),IT=Symbol.for(Sc),ST={[IT]:{_A:(X)=>X},pipe(){return C(this,arguments)},toString(){return"<redacted>"},toJSON(){return"<redacted>"},[T8](){return"<redacted>"},[f](){return U(F(Sc),b(F(oQ.get(this))),D8(this))},[u](X){return vc(X)&&S(oQ.get(this),oQ.get(X))}},vc=(X)=>v(X,IT),kc=(X)=>{let J=Object.create(ST);return oQ.set(J,X),J};var GX8="effect/Secret",vT=Symbol.for(GX8);var HX8={...ST,[vT]:vT},yc=(X)=>{let J=Object.create(HX8);return Object.defineProperty(J,"toString",{enumerable:!1,value(){return"Secret(<redacted>)"}}),Object.defineProperty(J,"toJSON",{enumerable:!1,value(){return"<redacted>"}}),Object.defineProperty(J,"raw",{enumerable:!1,value:X}),oQ.set(J,X.map((Z)=>String.fromCharCode(Z)).join("")),J};var bc=(X)=>{return yc(X.split("").map((J)=>J.charCodeAt(0)))};var BX8="effect/Config",kT=Symbol.for(BX8),VX8={_A:(X)=>X},sT8={...E5,[kT]:VX8,commit(){return cE(this)}};var gc=(X)=>v(X,kT);var hc=gc;var dc=Symbol.for("effect/SchemaId/DateFromSelf");var cc=Symbol.for("effect/SchemaId/Int");var ON=kc;var uc=B((X)=>t0(X[0]),(X,...J)=>{let Z={};for(let Y of J)if(Y in X)Z[Y]=X[Y];return Z}),pc=B((X)=>t0(X[0]),(X,...J)=>{let Z={...X};for(let Y of J)delete Z[Y];return Z});var lQ=Symbol.for("effect/Schema");function R6(X){return class{[lQ]=yT;static ast=X;static annotations(Z){return R6(vY(this.ast,Z))}static pipe(){return C(this,arguments)}static toString(){return String(X)}static Type;static Encoded;static Context;static[lQ]=yT}}var yT={_A:(X)=>X,_I:(X)=>X,_R:(X)=>X};var nc={schemaId:wh,message:bw,missingMessage:JU,identifier:f3,title:$9,description:tX,examples:gw,default:hw,documentation:Lh,jsonSchema:mw,arbitrary:dw,pretty:cw,equivalence:uw,concurrency:pw,batching:fw,parseIssueTitle:nw,parseOptions:ow,decodingFallback:rw},iQ=(X)=>{if(!X)return{};let J={...X};for(let Z in nc)if(Z in X){let Y=nc[Z];J[Y]=X[Z],delete J[Z]}return J},vY=(X,J)=>zU(X,iQ(J));function _N(X){return X}var NX8=(X)=>String(X.ast),zX8=(X)=>R6(i3(X.ast));var wN=(X)=>R6(i0(X.ast));var r7=(X,J)=>{let Z=AL(X,J);return(Y,$)=>t3(Z(Y,$),OL)};var SY=(X)=>v(X,lQ)&&t0(X[lQ]);function qX8(X){return VU(X)?q4.make(rh(X,(J)=>new jQ(J))):new jQ(X[0])}function Xu(X,J=qX8(X)){return class extends R6(J){static annotations(Y){return Xu(this.literals,vY(this.ast,Y))}static literals=[...X]}}function m6(...X){return Q8(X)?Xu(X):fT}var OX8=(X,J,Z)=>uT(X,new RQ(X.map((Y)=>Y.ast),(...Y)=>J.decode(...Y.map(R6)),(...Y)=>J.encode(...Y.map(R6)),iQ(Z))),DX8=(X,J)=>{let Z=()=>($,Q,G)=>X($)?_Y($):AU(new I4(G,$));return uT([],new RQ([],Z,Z,iQ(J)))};function uT(X,J){return class extends R6(J){static annotations(Y){return uT(this.typeParameters,vY(this.ast,Y))}static typeParameters=[...X]}}var pT=function(){if(Array.isArray(arguments[0])){let Z=arguments[0],Y=arguments[1],$=arguments[2];return OX8(Z,Y,$)}let X=arguments[0],J=arguments[1];return DX8(X,J)};class Ju extends R6($U){}class fT extends R6(QU){}class bT extends R6(ew){}class k4 extends R6(GU){}class MH extends R6(KU){}var AX8=(X)=>q4.make(X.map((J)=>J.ast));function Zu(X,J=AX8(X)){return class extends R6(J){static annotations(Y){return Zu(this.members,vY(this.ast,Y))}static members=[...X]}}function FH(...X){return VU(X)?Zu(X):Q8(X)?X[0]:fT}var _X8=(X)=>FH(X,Ju);var gT=(X)=>X?'"?:"':'":"';class RH extends DY{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(X,J,Z,Y,$){super(X,J,Y);this.isReadonly=Z,this.defaultValue=$}toString(){let X=gT(this.isOptional),J=String(this.type);return`PropertySignature<${X}, ${J}, never, ${X}, ${J}>`}}class nT extends DY{isReadonly;defaultValue;constructor(X,J,Z,Y,$){super(X,J,Y);this.isReadonly=Z,this.defaultValue=$}}var wX8=(X)=>{if(X===void 0)return"never";if(G6(X))return JSON.stringify(X);return String(X)};class oT{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(X,J,Z,Y){this.from=X,this.to=J,this.decode=Z,this.encode=Y}toString(){return`PropertySignature<${gT(this.to.isOptional)}, ${this.to.type}, ${wX8(this.from.fromKey)}, ${gT(this.from.isOptional)}, ${this.from.type}>`}}var Yu=(X,J)=>{switch(X._tag){case"PropertySignatureDeclaration":return new RH(X.type,X.isOptional,X.isReadonly,{...X.annotations,...J},X.defaultValue);case"PropertySignatureTransformation":return new oT(X.from,new nT(X.to.type,X.to.isOptional,X.to.isReadonly,{...X.to.annotations,...J},X.to.defaultValue),X.decode,X.encode)}},$u=Symbol.for("effect/PropertySignature"),rT=(X)=>v(X,$u);class MN{ast;[lQ];[$u]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(X){this.ast=X}pipe(){return C(this,arguments)}annotations(X){return new MN(Yu(this.ast,iQ(X)))}toString(){return String(this.ast)}}var oc=(X)=>new MN(X);class FN extends MN{from;constructor(X,J){super(X);this.from=J}annotations(X){return new FN(Yu(this.ast,iQ(X)),this.from)}}var LX8=(X)=>new FN(new RH(X.ast,!1,!0,{},void 0),X),TX8=B(2,(X,J)=>{let Z=X.ast;switch(Z._tag){case"PropertySignatureDeclaration":return oc(new RH(Z.type,Z.isOptional,Z.isReadonly,Z.annotations,J));case"PropertySignatureTransformation":return oc(new oT(Z.from,new nT(Z.to.type,Z.to.isOptional,Z.to.isReadonly,Z.to.annotations,J),Z.decode,Z.encode))}});var kY=(X)=>{let J=X.ast===$U||X.ast===QU?$U:_X8(X).ast;return new FN(new RH(J,!0,!0,{},void 0),X)};var PX8=KL([JU]),MX8=(X,J)=>{let Z=Reflect.ownKeys(X),Y=[];if(Z.length>0){let Q=[],G=[],H=[];for(let K=0;K<Z.length;K++){let V=Z[K],W=X[V];if(rT(W)){let N=W.ast;switch(N._tag){case"PropertySignatureDeclaration":{let{type:z,isOptional:q,annotations:A}=N;Q.push(new B6(V,z,q,!0,PX8(N))),G.push(new B6(V,i0(z),q,!0,A)),Y.push(new B6(V,z,q,!0,A));break}case"PropertySignatureTransformation":{let z=N.from.fromKey??V;Q.push(new B6(z,N.from.type,N.from.isOptional,!0,N.from.annotations)),G.push(new B6(V,N.to.type,N.to.isOptional,!0,N.to.annotations)),H.push(new QL(z,V,N.decode,N.encode));break}}}else Q.push(new B6(V,W.ast,!1,!0)),G.push(new B6(V,i0(W.ast),!1,!0)),Y.push(new B6(V,W.ast,!1,!0))}if(Q8(H)){let K=[],V=[];for(let W of J){let{indexSignatures:N,propertySignatures:z}=HL(W.key.ast,W.value.ast);z.forEach((q)=>{Q.push(q),G.push(new B6(q.name,i0(q.type),q.isOptional,q.isReadonly,q.annotations))}),N.forEach((q)=>{K.push(q),V.push(new CQ(q.parameter,i0(q.type),q.isReadonly))})}return new XJ(new Z7(Q,K,{[qY]:"Struct (Encoded side)"}),new Z7(G,V,{[qY]:"Struct (Type side)"}),new l3(H))}}let $=[];for(let Q of J){let{indexSignatures:G,propertySignatures:H}=HL(Q.key.ast,Q.value.ast);H.forEach((K)=>Y.push(K)),G.forEach((K)=>$.push(K))}return new Z7(Y,$)},Qu=(X,J)=>{let Z=Reflect.ownKeys(X);for(let Y of Z){let $=X[Y];if(J[Y]===void 0&&rT($)){let Q=$.ast,G=Q._tag==="PropertySignatureDeclaration"?Q.defaultValue:Q.to.defaultValue;if(G!==void 0)J[Y]=G()}}return J};function Gu(X,J,Z=MX8(X,J)){return class extends R6(Z){static annotations($){return Gu(this.fields,this.records,vY(this.ast,$))}static fields={...X};static records=[...J];static make=($,Q)=>{let G=Qu(X,{...$});return eT(Q)?G:JH(this)(G)};static pick(...$){return A4(uc(X,...$))}static omit(...$){return A4(pc(X,...$))}}}function A4(X,...J){return Gu(X,J)}var LH=(X,J,Z)=>{if(YL(X)&&YL(J)){let Y=[...X.propertySignatures];for(let $ of J.propertySignatures){let Q=$.name,G=Y.findIndex((H)=>H.name===Q);if(G===-1)Y.push($);else{let{isOptional:H,type:K}=Y[G];Y[G]=new B6(Q,LN(K,$.type,Z.concat(Q)),H,!0)}}return new Z7(Y,X.indexSignatures.concat(J.indexSignatures))}throw Error(Sw(X,J,Z))},FX8=eh([f3]),TH=(X,J)=>J.map((Z)=>new EQ(Z,X.filter,FX8(X))),LN=(X,J,Z)=>q4.make(HJ([X],[J],Z)),EY=(X)=>WU(X)?X.types:[X],HJ=(X,J,Z)=>J6(X,(Y)=>J6(J,($)=>{switch($._tag){case"Literal":{if(G6($.literal)&&HU(Y)||g4($.literal)&&XL(Y)||z9($.literal)&&ZL(Y))return[$];break}case"StringKeyword":{if($===GU){if(HU(Y)||OY(Y)&&G6(Y.literal))return[Y];else if(F1(Y))return TH(Y,HJ(EY(Y.from),[$],Z))}else if(Y===GU)return[$];break}case"NumberKeyword":{if($===KU){if(XL(Y)||OY(Y)&&g4(Y.literal))return[Y];else if(F1(Y))return TH(Y,HJ(EY(Y.from),[$],Z))}else if(Y===KU)return[$];break}case"BooleanKeyword":{if($===JL){if(ZL(Y)||OY(Y)&&z9(Y.literal))return[Y];else if(F1(Y))return TH(Y,HJ(EY(Y.from),[$],Z))}else if(Y===JL)return[$];break}case"Union":return HJ(EY(Y),$.types,Z);case"Suspend":return[new AY(()=>LN(Y,$.f(),Z))];case"Refinement":return TH($,HJ(EY(Y),EY($.from),Z));case"TypeLiteral":{switch(Y._tag){case"Union":return HJ(Y.types,[$],Z);case"Suspend":return[new AY(()=>LN(Y.f(),$,Z))];case"Refinement":return TH(Y,HJ(EY(Y.from),[$],Z));case"TypeLiteral":return[LH(Y,$,Z)];case"Transformation":{let Q=Y.transformation,G=LH(Y.from,$,Z),H=LH(Y.to,i0($),Z);switch(Q._tag){case"TypeLiteralTransformation":return[new XJ(G,H,new l3(Q.propertySignatureTransformations))];case"ComposeTransformation":return[new XJ(G,H,$L)];case"FinalTransformation":return[new XJ(G,H,new NU((K,V,W,N)=>Q9(Q.decode(K,V,W,N),(z)=>({...K,...z})),(K,V,W,N)=>Q9(Q.encode(K,V,W,N),(z)=>({...K,...z}))))]}}}break}case"Transformation":{if(lh(Y)){if(GL($.transformation)&&GL(Y.transformation))return[new XJ(LH(Y.from,$.from,Z),LH(Y.to,$.to,Z),new l3($.transformation.propertySignatureTransformations.concat(Y.transformation.propertySignatureTransformations)))]}else return HJ([$],[Y],Z);break}}throw Error(Sw(Y,$,Z))})),Hu=B(2,(X,J)=>R6(LN(X.ast,J.ast,[]))),Ku=B((X)=>SY(X[1]),(X,J)=>iT(X,J,Xm(X.ast,J.ast))),hT=(X)=>R6(new AY(()=>X().ast)),Bu=Symbol.for("effect/SchemaId/Refine");function Vu(X,J,Z){return class extends R6(Z){static annotations($){return Vu(this.from,this.filter,vY(this.ast,$))}static[Bu]=X;static from=X;static filter=J;static make=($,Q)=>{return eT(Q)?$:JH(this)($)}}}var rc=(X,J,Z)=>{if(z9(X))return X?_():D(new I4(J,Z));if(G6(X))return D(new I4(J,Z,X));if(X!==void 0){if("_tag"in X)return D(X);let Y=new I4(J,Z,X.message);return D(Q8(X.path)?new F6(X.path,Z,Y):Y)}return _()},RX8=(X,J,Z)=>{if(Uh(X))return rc(X,J,Z);if(Q8(X)){let Y=v5(X,($)=>rc($,J,Z));if(Q8(Y))return D(Y.length===1?Y[0]:new R0(J,Z,Y))}return _()};function lT(X,J){return(Z)=>{function Y(Q,G,H){return RX8(X(Q,G,H),H,Q)}let $=new EQ(Z.ast,Y,iQ(J));return Vu(Z,Y,$)}}function iT(X,J,Z){return class extends R6(Z){static annotations($){return iT(this.from,this.to,vY(this.ast,$))}static from=X;static to=J}}var TN=B((X)=>SY(X[0])&&SY(X[1]),(X,J,Z)=>iT(X,J,new XJ(X.ast,J.ast,new NU(Z.decode,Z.encode)))),RN=B((X)=>SY(X[0])&&SY(X[1]),(X,J,Z)=>TN(X,J,{strict:!0,decode:(Y,$,Q,G)=>_Y(Z.decode(Y,G)),encode:(Y,$,Q,G)=>_Y(Z.encode(Y,G))}));var lc=Symbol.for("effect/SchemaId/Pattern"),jX8=(X,J)=>(Z)=>{let Y=X.source;return Z.pipe(lT(($)=>{return X.lastIndex=0,X.test($)},{schemaId:lc,[lc]:{regex:X},description:`a string matching the pattern ${Y}`,jsonSchema:{pattern:Y},...J}))};var CX8=Symbol.for("effect/SchemaId/UUID"),ic=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class EX8 extends k4.pipe(jX8(ic,{schemaId:CX8,identifier:"UUID",jsonSchema:{format:"uuid",pattern:ic.source},description:"a Universally Unique Identifier",arbitrary:()=>(X)=>X.uuid()})){}var IX8=cc,aT=(X)=>(J)=>J.pipe(lT((Z)=>Number.isSafeInteger(Z),{schemaId:IX8,title:"int",description:"an integer",jsonSchema:{type:"integer"},...X}));function SX8(X){return TN(X,MH,{strict:!1,decode:(J,Z,Y)=>Gm(HE(J),()=>new I4(Y,J,`Unable to decode ${JSON.stringify(J)} into a number`)),encode:(J)=>_Y(String(J))})}class xY extends SX8(k4.annotations({description:"a string to be decoded into a number"})).annotations({identifier:"NumberFromString"}){}class PH extends MH.pipe(aT({identifier:"Int"})){}var vX8=(X,J,Z,Y)=>Hm(X,{onFailure:($)=>new R0(Z,Y,$),onSuccess:J});var ac=Symbol.for("effect/SchemaId/ValidDate"),kX8=(X)=>(J)=>J.pipe(lT((Z)=>!Number.isNaN(Z.getTime()),{schemaId:ac,[ac]:{noInvalidDate:!0},title:"validDate",description:"a valid Date",...X}));var sc=dc;class Wu extends pT(GK,{identifier:"DateFromSelf",schemaId:sc,[sc]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>(X)=>`new Date(${JSON.stringify(X)})`,arbitrary:()=>(X)=>X.date({noInvalidDate:!1}),equivalence:()=>NF}){}class Uu extends RN(k4.annotations({description:"a string to be decoded into a Date"}),Wu,{strict:!0,decode:(X)=>new Date(X),encode:(X)=>Ew(X)}).annotations({identifier:"DateFromString"}){}class sT extends Uu.pipe(kX8({identifier:"Date"})){}var xX8=(X)=>SY(X)||rT(X),Nu=(X)=>Reflect.ownKeys(X).every((J)=>xX8(X[J])),tT=(X)=>("fields"in X)?X.fields:tT(X[Bu]),zu=(X)=>Nu(X)?A4(X):SY(X)?X:A4(tT(X)),qu=(X)=>Nu(X)?X:tT(X);var yX8=(X)=>TX8(LX8(m6(X)),()=>X);var jH=(X)=>(J,Z,Y)=>{class $ extends u_{}$.prototype.name=J;let Q=qu(Z),G=zu(Z),H={_tag:yX8(J)},K=DN(H,Q),V="message"in K;class W extends AN({kind:"TaggedError",identifier:X??J,schema:Hu(G,A4(H)),fields:K,Base:$,annotations:Y,disableToString:!0}){static _tag=J}if(!V)Object.defineProperty(W.prototype,"message",{get(){return`{ ${Reflect.ownKeys(Q).map((N)=>`${zY(N)}: ${y9(this[N])}`).join(", ")} }`},enumerable:!1,configurable:!0});return W},DN=(X,J)=>{let Z={...X};for(let Y of Reflect.ownKeys(J)){if(Y in X)throw Error(XU(Y));Z[Y]=J[Y]}return Z};function eT(X){return z9(X)?X:X?.disableValidation??!1}var tc=X8("effect/Schema/astCache",()=>new WeakMap),bX8=(X)=>{if(X===void 0)return[];else if(Array.isArray(X))return X;else return[X]},AN=({Base:X,annotations:J,disableToString:Z,fields:Y,identifier:$,kind:Q,schema:G})=>{let H=Symbol.for(`effect/Schema/${Q}/${$}`),[K,V,W]=bX8(J),N=wN(G),z=N.annotations({identifier:$,...K}),q=N.annotations({[qY]:`${$} (Type side)`,...K}),A=G.annotations({[qY]:`${$} (Constructor)`,...K}),E=G.annotations({[qY]:`${$} (Encoded side)`,...W}),P=G.annotations({...W,...K,...V}),M=(y)=>v(y,H)&&vQ(q)(y),c=class extends X{constructor(y={},s=!1){if(y={...y},Q!=="Class")delete y._tag;if(y=Qu(Y,y),!eT(s))y=JH(A)(y);super(y,!0)}static[lQ]=yT;static get ast(){let y=tc.get(this);if(y)return y;let s=pT([G],{decode:()=>(Y8,l,G8)=>Y8 instanceof this||M(Y8)?_Y(Y8):AU(new I4(G8,Y8)),encode:()=>(Y8,l)=>Y8 instanceof this?_Y(Y8):Q9(_L(q)(Y8,l),(G8)=>new this(G8,!0))},{identifier:$,pretty:(Y8)=>(l)=>`${$}(${Y8(l)})`,arbitrary:(Y8)=>(l)=>Y8(l).map((G8)=>new this(G8)),equivalence:g,[n3]:z.ast,...K});return y=RN(E,s,{strict:!0,decode:(Y8)=>new this(Y8,!0),encode:g}).annotations({[n3]:P.ast,...V}).ast,tc.set(this,y),y}static pipe(){return C(this,arguments)}static annotations(y){return R6(this.ast).annotations(y)}static toString(){return`(${String(E)} <-> ${$})`}static make(...y){return new this(...y)}static fields={...Y};static identifier=$;static extend(y){return(s,Y8)=>{let l=qu(s),G8=zu(s),P8=DN(Y,l);return AN({kind:Q,identifier:y,schema:Hu(G,G8),fields:P8,Base:this,annotations:Y8})}}static transformOrFail(y){return(s,Y8,l)=>{let G8=DN(Y,s);return AN({kind:Q,identifier:y,schema:TN(G,wN(A4(G8)),Y8),fields:G8,Base:this,annotations:l})}}static transformOrFailFrom(y){return(s,Y8,l)=>{let G8=DN(Y,s);return AN({kind:Q,identifier:y,schema:TN(zX8(G),A4(G8),Y8),fields:G8,Base:this,annotations:l})}}get[H](){return H}};if(Z!==!0)Object.defineProperty(c.prototype,"toString",{value(){return`${$}({ ${Reflect.ownKeys(Y).map((y)=>`${zY(y)}: ${y9(this[y])}`).join(", ")} })`},configurable:!0,writable:!0});return c},gX8=A4({_tag:m6("None")}).annotations({identifier:"FiberIdNoneEncoded"}),hX8=A4({_tag:m6("Runtime"),id:PH,startTimeMillis:PH}).annotations({identifier:"FiberIdRuntimeEncoded"}),mX8=A4({_tag:m6("Composite"),left:hT(()=>mT),right:hT(()=>mT)}).annotations({identifier:"FiberIdCompositeEncoded"}),mT=FH(gX8,hX8,mX8).annotations({identifier:"FiberIdEncoded"}),dX8=(X)=>X.letrec((J)=>({None:X.record({_tag:X.constant("None")}),Runtime:X.record({_tag:X.constant("Runtime"),id:X.integer(),startTimeMillis:X.integer()}),Composite:X.record({_tag:X.constant("Composite"),left:J("FiberId"),right:J("FiberId")}),FiberId:X.oneof(J("None"),J("Runtime"),J("Composite"))})).FiberId.map(PN),dT=(X)=>{switch(X._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${X.id}, ${X.startTimeMillis})`;case"Composite":return`FiberId.composite(${dT(X.right)}, ${dT(X.left)})`}};var PN=(X)=>{switch(X._tag){case"None":return I6;case"Runtime":return Fj(X.id,X.startTimeMillis);case"Composite":return Rj(PN(X.left),PN(X.right))}};var cX8=(X)=>A4({_tag:m6("Die"),defect:X}),uX8=A4({_tag:m6("Empty")}),pX8=(X)=>A4({_tag:m6("Fail"),error:X}),fX8=A4({_tag:m6("Interrupt"),fiberId:mT}),nX8=0,cT=(X,J)=>{let Z=_N(X),Y=_N(J),$=hT(()=>Q),Q=FH(uX8,pX8(Z),cX8(Y),fX8,A4({_tag:m6("Sequential"),left:$,right:$}),A4({_tag:m6("Parallel"),left:$,right:$})).annotations({title:`CauseEncoded<${NX8(X)}>`,[ZU]:`CauseEncoded${nX8++}`});return Q},oX8=(X,J)=>(Z)=>Z.letrec((Y)=>({Empty:Z.record({_tag:Z.constant("Empty")}),Fail:Z.record({_tag:Z.constant("Fail"),error:X(Z)}),Die:Z.record({_tag:Z.constant("Die"),defect:J(Z)}),Interrupt:Z.record({_tag:Z.constant("Interrupt"),fiberId:dX8(Z)}),Sequential:Z.record({_tag:Z.constant("Sequential"),left:Y("Cause"),right:Y("Cause")}),Parallel:Z.record({_tag:Z.constant("Parallel"),left:Y("Cause"),right:Y("Cause")}),Cause:Z.oneof(Y("Empty"),Y("Fail"),Y("Die"),Y("Interrupt"),Y("Sequential"),Y("Parallel"))})).Cause.map(IY),rX8=(X)=>(J)=>{let Z=(Y)=>{switch(Y._tag){case"Empty":return"Cause.empty";case"Fail":return`Cause.fail(${X(Y.error)})`;case"Die":return`Cause.die(${GW(Y)})`;case"Interrupt":return`Cause.interrupt(${dT(Y.fiberId)})`;case"Sequential":return`Cause.sequential(${Z(Y.left)}, ${Z(Y.right)})`;case"Parallel":return`Cause.parallel(${Z(Y.left)}, ${Z(Y.right)})`}};return Z(J)},ec=(X)=>(J,Z,Y)=>$y(J)?vX8(X(rQ(J),Z),IY,Y,J):AU(new I4(Y,J)),lX8=({defect:X,error:J})=>{return pT([J,X],{decode:(Z,Y)=>ec(AL(cT(Z,Y))),encode:(Z,Y)=>ec(_L(cT(Z,Y)))},{title:`Cause<${J.ast}>`,pretty:rX8,arbitrary:oX8})};function IY(X){switch(X._tag){case"Empty":return Jy;case"Fail":return JW(X.error);case"Die":return q1(X.defect);case"Interrupt":return ZW(PN(X.fiberId));case"Sequential":return Yy(IY(X.left),IY(X.right));case"Parallel":return Zy(IY(X.left),IY(X.right))}}function rQ(X){switch(X._tag){case"Empty":return{_tag:"Empty"};case"Fail":return{_tag:"Fail",error:X.error};case"Die":return{_tag:"Die",defect:X.defect};case"Interrupt":return{_tag:"Interrupt",fiberId:X.fiberId};case"Sequential":return{_tag:"Sequential",left:rQ(X.left),right:rQ(X.right)};case"Parallel":return{_tag:"Parallel",left:rQ(X.left),right:rQ(X.right)}}}var Ou=({defect:X,error:J})=>{let Z=_N(J),Y=_N(X);return RN(cT(Z,Y),lX8({error:wN(Z),defect:wN(Y)}),{strict:!1,decode:(Q)=>IY(Q),encode:(Q)=>rQ(Q)})};class yY extends RN(bT,bT,{strict:!0,decode:(X)=>{if(t0(X)&&"message"in X&&typeof X.message==="string"){let J=Error(X.message,{cause:X});if("name"in X&&typeof X.name==="string")J.name=X.name;return J.stack="stack"in X&&typeof X.stack==="string"?X.stack:"",J}return _B(X)},encode:(X)=>{if(X instanceof Error)return{name:X.name,message:X.message};return _B(X)}}).annotations({identifier:"Defect"}){}var jN=Symbol.for("@effect/platform/Error");var Du=m6("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class x4 extends jH("@effect/platform/Error/BadArgument")("BadArgument",{module:Du,method:k4,description:kY(k4),cause:kY(yY)}){[jN]=jN;get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}}var iX8=m6("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class bY extends jH("@effect/platform/Error/SystemError")("SystemError",{reason:iX8,module:Du,method:k4,description:kY(k4),syscall:kY(k4),pathOrDescriptor:kY(FH(k4,MH)),cause:kY(yY)}){[jN]=jN;get message(){return`${this.reason}: ${this.module}.${this.method}${this.pathOrDescriptor!==void 0?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}}var JP=o8("@effect/platform/FileSystem"),IH=(X)=>typeof X==="bigint"?X:BigInt(X);var EH=BigInt(1024),$F8=EH*EH*EH*EH*EH;var Au=(X)=>{return JP.of({...X,exists:(J)=>U(X.access(J),K6(!0),S9("SystemError",(Z)=>Z.reason==="NotFound"?L(!1):x(Z))),readFileString:(J,Z)=>Ow(X.readFile(J),{try:(Y)=>new TextDecoder(Z).decode(Y),catch:(Y)=>new x4({module:"FileSystem",method:"readFileString",description:"invalid encoding",cause:Y})}),stream:(J,Z)=>U(X.open(J,{flag:"r"}),Z?.offset?X0((Y)=>Y.seek(Z.offset,"start")):g,k((Y)=>aX8(Y,Z)),k1),sink:(J,Z)=>U(X.open(J,{flag:"w",...Z}),k((Y)=>Lc(($)=>Y.writeAll($))),Pc),writeFileString:(J,Z,Y)=>R(p7({try:()=>new TextEncoder().encode(Z),catch:($)=>new x4({module:"FileSystem",method:"writeFileString",description:"could not encode string",cause:$})}),($)=>X.writeFile(J,$,Y))})};var aX8=(X,{bufferSize:J=16,bytesToRead:Z,chunkSize:Y=IH(65536)}={})=>{let $=Z!==void 0?IH(Z):void 0,Q=IH(Y);function G(H){if($!==void 0&&$<=H)return AH;let K=$!==void 0&&$-H<Q?$-H:Q;return v1(X.readAlloc(K),n({onNone:()=>AH,onSome:(V)=>v1(zN(I8(V)),(W)=>G(H+BigInt(V.length)))}))}return Fc(nQ(G(BigInt(0))),{capacity:J})};var aQ=IH;var l7=JP,_u=Au;var CN=Symbol.for("@effect/platform/FileSystem/File");var wu=ZH(),Lu=E3("Create"),Tu=E3("Update"),Pu=E3("Remove");class ZP extends xK("@effect/platform/FileSystem/WatchBackend")(){}function Mu(X,J){return function(Z){if(Array.isArray(Z))return Z.reduce(J,X);let Y=X;for(let $ of Z)Y=J(Y,$);return Y}}function Fu(X){return function(J){if(Array.isArray(J))return J.map(X);return function*(){for(let Z of J)yield X(Z)}()}}var Ru=(X)=>(J)=>{let Z=Object.keys(J);return X.imap(X.productAll(Z.map((Y)=>J[Y])),(Y)=>{let $={};for(let Q=0;Q<Y.length;Q++)$[Z[Q]]=Y[Q];return $},(Y)=>Z.map(($)=>Y[$]))};var KJ=(X,J=(Z,Y)=>Mu(Z,X)(Y))=>({combine:X,combineMany:J});var eX8=(X)=>KJ(()=>X,()=>X);var ju=()=>KJ((X)=>X,(X)=>X);var XJ8=B(3,(X,J,Z)=>KJ((Y,$)=>J(X.combine(Z(Y),Z($))),(Y,$)=>J(X.combineMany(Z(Y),Fu(Z)($)))));var JJ8=(X,J)=>KJ(([Z,Y],[$,Q])=>[X.combine(Z,$),J.combine(Y,Q)]),Cu=(X)=>{return KJ((J,Z)=>{let Y=Math.min(J.length,Z.length),$=[],Q=0;for(let G of X){if(Q>=Y)break;$.push(G.combine(J[Q],Z[Q])),Q++}return $})},ZJ8=(X,J)=>{let Z=Cu(J);return KJ((Y,$)=>[X.combine(Y[0],$[0]),...Z.combine(Y.slice(1),$.slice(1))])};var YJ8=eX8,$J8={of:YJ8,imap:XJ8,product:JJ8,productMany:ZJ8,productAll:Cu};var IN=()=>KJ((X,J)=>X.concat(J)),SN=Ru($J8);var SH=(X,J)=>({combine:X.combine,combineMany:X.combineMany,empty:J,combineAll:(Z)=>X.combineMany(J,Z)});var Iu=()=>SH(IN(),[]),Su=(X)=>{let J={};for(let Z in X)if(Object.prototype.hasOwnProperty.call(X,Z))J[Z]=X[Z].empty;return SH(SN(X),J)};var vN={_tag:"Black"},kN={_tag:"Red"},YP={_tag:"Green"};var $P={_tag:"Magenta"},xN={_tag:"Cyan"},yN={_tag:"White"},sQ=(X)=>{switch(X._tag){case"Black":return 0;case"Red":return 1;case"Green":return 2;case"Yellow":return 3;case"Blue":return 4;case"Magenta":return 5;case"Cyan":return 6;case"White":return 7}};var vu={_tag:"Reset"},ku=(X)=>({_tag:"SetBold",bold:X}),GP=(X,J,Z)=>({_tag:"SetColor",color:X,vivid:J,layer:Z}),xu=(X)=>({_tag:"SetItalicized",italicized:X}),yu=(X)=>({_tag:"SetStrikethrough",strikethrough:X}),bu=(X)=>({_tag:"SetUnderlined",underlined:X}),GJ8=(X)=>{switch(X._tag){case"Reset":return 0;case"SetBold":return X.bold?1:22;case"SetColor":switch(X.layer){case"foreground":return X.vivid?90+sQ(X.color):30+sQ(X.color);case"background":return X.vivid?100+sQ(X.color):40+sQ(X.color)}case"SetItalicized":return X.italicized?3:23;case"SetStrikethrough":return X.strikethrough?9:29;case"SetUnderlined":return X.underlined?4:24}},gu=(X)=>HJ8("m",X),HJ8=(X,J)=>{return`\x1B[${Array.from(J).map((Y)=>`${GJ8(Y)}`).join(";")}${X}`};var WJ8="@effect/printer-ansi/Ansi",bN=Symbol.for(WJ8),f0=(X)=>({...mu.empty,...X}),hu=ju(),gY=KJ((X,J)=>H8(X)?X:J),UJ8=SN({[bN]:hu,commands:IN(),foreground:gY,background:gY,bold:gY,italicized:gY,strikethrough:gY,underlined:gY}),NJ8=SH(hu,bN),tQ=SH(gY,_()),mu=Su({[bN]:NJ8,commands:Iu(),foreground:tQ,background:tQ,bold:tQ,italicized:tQ,strikethrough:tQ,underlined:tQ}),du=mu.empty,Q6="\x1B[",zJ8="\x07",qJ8=";",cu=f0({bold:D(ku(!0))}),uu=f0({italicized:D(xu(!0))}),pu=f0({strikethrough:D(yu(!0))}),fu=f0({underlined:D(bu(!0))}),HP=(X)=>f0({foreground:D(GP(X,!0,"foreground"))}),eQ=(X)=>f0({foreground:D(GP(X,!1,"foreground"))});var nu=eQ(vN),ou=eQ(kN),ru=eQ(YP);var lu=eQ(yN),iu=HP(vN);var au=HP(xN);var KP=f0({commands:a(zJ8)}),BP=(X,J)=>{if(J===void 0){let Y=`${Q6}${Math.max(X+1,0)}G`;return f0({commands:a(Y)})}let Z=`${Q6}${J+1}${qJ8}${Math.max(X+1,0)}H`;return f0({commands:a(Z)})},VP=(X,J=0)=>{let Z="";if(J<0)Z+=`${Q6}${-J}A`;if(J>0)Z+=`${Q6}${J}B`;if(X>0)Z+=`${Q6}${X}C`;if(X<0)Z+=`${Q6}${-X}D`;return f0({commands:a(Z)})};var WP=(X=1)=>{let J=`${Q6}${X}B`;return f0({commands:a(J)})};var UP=f0({commands:a(`${Q6}G`)}),NP=f0({commands:a(`${Q6}s`)}),zP=f0({commands:a(`${Q6}u`)});var qP=f0({commands:a(`${Q6}?25l`)}),OP=f0({commands:a(`${Q6}?25h`)}),DP=(X)=>{let J="";for(let Z=0;Z<X;Z++)J+=`${Q6}2K`+(Z<X-1?`${Q6}1A`:"");if(X>0)J+=`${Q6}G`;return f0({commands:a(J)})},su=f0({commands:a(`${Q6}K`)}),tu=f0({commands:a(`${Q6}1K`)}),AP=f0({commands:a(`${Q6}2K`)}),eu=f0({commands:a(`${Q6}J`)}),Xp=f0({commands:a(`${Q6}1J`)}),Jp=f0({commands:a(`${Q6}2J`)}),gN=(X)=>DJ8(X),hN=B(2,(X,J)=>OJ8(X,J)),OJ8=(X,J)=>UJ8.combine(X,J),DJ8=(X)=>{let J=gu(RJ([D(vu),X.foreground,X.background,X.bold,X.italicized,X.strikethrough,X.underlined])),Z=F8(X.commands,"");return`${J}${Z}`};var d6=cu,XG=uu,Zp=pu,y4=fu,Yp=eQ;var $p=nu,H7=ou,g9=ru;var x1=lu,B0=iu;var V6=au;var c6=hN;var mN="@effect/printer/Flatten",Qp=Symbol.for(mN),PJ8={Flattened:(X)=>b(F(X.value))(N8(mN)),AlreadyFlat:(X)=>b(N8("@effect/printer/Flattened/AlreadyFlat"))(N8(mN)),NeverFlat:(X)=>b(N8("@effect/printer/Flattened/NeverFlat"))(N8(mN))},MJ8={Flattened:(X,J)=>wP(J)&&J._tag==="Flattened"&&S(X.value,J.value),AlreadyFlat:(X,J)=>wP(J)&&J._tag==="AlreadyFlat",NeverFlat:(X,J)=>wP(J)&&J._tag==="NeverFlat"},LP={[Qp]:{_A:(X)=>X},[f](){return D8(this,PJ8[this._tag](this))},[u](X){return MJ8[this._tag](this,X)}},wP=(X)=>typeof X==="object"&&X!=null&&(Qp in X),JG=(X)=>X._tag==="Flattened",vH=(X)=>X._tag==="AlreadyFlat",TP=(X)=>X._tag==="NeverFlat",i7=(X)=>(()=>{let J=Object.create(LP);return J._tag="Flattened",J.value=X,J})(),dN=(()=>{let X=Object.create(LP);return X._tag="AlreadyFlat",X})(),cN=(()=>{let X=Object.create(LP);return X._tag="NeverFlat",X})(),PP=B(2,(X,J)=>{switch(X._tag){case"Flattened":return i7(J(X.value));case"AlreadyFlat":return dN;case"NeverFlat":return cN}});var K9="@effect/printer/Doc",FP=Symbol.for(K9),RJ8={Fail:(X)=>b(F(K9))(F("@effect/printer/Doc/Fail")),Empty:(X)=>b(F(K9))(F("@effect/printer/Doc/Empty")),Char:(X)=>b(F(K9))(N8(X.char)),Text:(X)=>b(F(K9))(N8(X.text)),Line:(X)=>b(F(K9))(F("@effect/printer/Doc/Line")),FlatAlt:(X)=>b(F(K9))(b(F(X.left))(F(X.right))),Cat:(X)=>b(F(K9))(b(F(X.left))(F(X.right))),Nest:(X)=>b(F(K9))(b(F(X.indent))(F(X.doc))),Union:(X)=>b(F(K9))(b(F(X.left))(F(X.right))),Column:(X)=>b(F(K9))(F(X.react)),WithPageWidth:(X)=>b(F(K9))(F(X.react)),Nesting:(X)=>b(F(K9))(F(X.react)),Annotated:(X)=>b(F(K9))(b(F(X.annotation))(F(X.doc)))},jJ8={Fail:(X,J)=>B9(J)&&J._tag==="Fail",Empty:(X,J)=>B9(J)&&J._tag==="Empty",Char:(X,J)=>B9(J)&&J._tag==="Char"&&X.char===J.char,Text:(X,J)=>B9(J)&&J._tag==="Text"&&X.text===J.text,Line:(X,J)=>B9(J)&&J._tag==="Line",FlatAlt:(X,J)=>B9(J)&&J._tag==="FlatAlt"&&S(J.left)(X.left)&&S(J.right)(X.right),Cat:(X,J)=>B9(J)&&J._tag==="Cat"&&S(J.left)(X.left)&&S(J.right)(X.right),Nest:(X,J)=>B9(J)&&J._tag==="Nest"&&X.indent===J.indent&&S(J.doc)(X.doc),Union:(X,J)=>B9(J)&&J._tag==="Union"&&S(J.left)(X.left)&&S(J.right)(X.right),Column:(X,J)=>B9(J)&&J._tag==="Column"&&S(J.react)(X.react),WithPageWidth:(X,J)=>B9(J)&&J._tag==="WithPageWidth"&&S(J.react)(X.react),Nesting:(X,J)=>B9(J)&&J._tag==="Nesting"&&S(J.react)(X.react),Annotated:(X,J)=>B9(J)&&J._tag==="Annotated"&&S(J.annotation)(X.annotation)&&S(J.doc)(X.doc)},h9={[FP]:{_A:(X)=>X},[f](){return D8(this,RJ8[this._tag](this))},[u](X){return jJ8[this._tag](this,X)},pipe(){return C(this,arguments)}},B9=(X)=>typeof X==="object"&&X!=null&&(FP in X);var xH=(X)=>X._tag==="Empty",w5=(X)=>X._tag==="Char",L5=(X)=>X._tag==="Text";var b1=(X)=>X._tag==="Cat",RP=(X)=>X._tag==="Nest";var yH=(X)=>{let J=Object.create(h9);return J._tag="Char",J.char=X,J},g1=(X)=>{let J=Object.create(h9);return J._tag="Text",J.text=X,J},bH=B(2,(X,J)=>{let Z=Object.create(h9);return Z._tag="FlatAlt",Z.left=X,Z.right=J,Z}),ZG=B(2,(X,J)=>{let Z=Object.create(h9);return Z._tag="Union",Z.left=X,Z.right=J,Z}),j6=B(2,(X,J)=>{let Z=Object.create(h9);return Z._tag="Cat",Z.left=X,Z.right=J,Z}),gH=(()=>{let X=Object.create(h9);return X._tag="Empty",X})(),Gp=(()=>{let X=Object.create(h9);return X._tag="Fail",X})(),pN=(()=>{let X=Object.create(h9);return X._tag="Line",X})(),Hp=bH(pN,yH(" ")),Kp=bH(pN,gH);var jP=yH(" ");var Bp=(X)=>Op(Np(X)),Vp=B(2,(X,J)=>j6(X,j6(Hp,J))),Wp=B(2,(X,J)=>j6(X,j6(Kp,J)));var Up=B(2,(X,J)=>j6(X,j6(jP,J))),fN=B(2,(X,J)=>JR(J8(X),{onEmpty:()=>gH,onNonEmpty:(Z,Y)=>t9(Z,Y,($,Q)=>J(Q,$))})),Np=(X)=>fN(X,(J,Z)=>Wp(J,Z));var zp=(X)=>fN(X,(J,Z)=>Up(J,Z)),qp=(X)=>fN(X,(J,Z)=>Vp(J,Z));var Op=(X)=>{switch(X._tag){case"FlatAlt":{let J=MP(X.right);switch(J._tag){case"Flattened":return ZG(J.value,X.left);case"AlreadyFlat":return ZG(X.right,X.left);case"NeverFlat":return X.left}}case"Union":return X;default:{let J=MP(X);return JG(J)?ZG(J.value,X):X}}},YG=(X)=>{let J=Object.create(h9);return J._tag="Column",J.react=X,J},$G=(X)=>{let J=Object.create(h9);return J._tag="Nesting",J.react=X,J};var hH=(X)=>{let J=Object.create(h9);return J._tag="WithPageWidth",J.react=X,J},BJ=B(2,(X,J)=>J===0?X:(()=>{let Z=Object.create(h9);return Z._tag="Nest",Z.indent=J,Z.doc=X,Z})()),CP=(X)=>YG((J)=>$G((Z)=>BJ(X,J-Z))),Dp=B(2,(X,J)=>CP(BJ(X,J))),Ap=B(2,(X,J)=>Dp(j6(_p(J),X),J));var uN=(X)=>c0(K7(X)),K7=(X)=>_8(function*(){switch(X._tag){case"Fail":return X;case"Empty":return X;case"Char":return X;case"Text":return X;case"Line":return Gp;case"FlatAlt":return yield*K7(X.right);case"Cat":{let J=yield*K7(X.left),Z=yield*K7(X.right);return j6(J,Z)}case"Nest":{let J=yield*K7(X.doc);return BJ(J,X.indent)}case"Union":return yield*K7(X.left);case"Column":return YG((J)=>uN(X.react(J)));case"WithPageWidth":return hH((J)=>uN(X.react(J)));case"Nesting":return $G((J)=>uN(X.react(J)));case"Annotated":{let J=yield*K7(X.doc);return QG(J,X.annotation)}}}),MP=(X)=>c0(kH(X)),kH=(X)=>_8(function*(){switch(X._tag){case"Fail":case"Line":return cN;case"Empty":case"Char":case"Text":return dN;case"FlatAlt":{let J=yield*K7(X.right);return i7(J)}case"Cat":{let J=yield*kH(X.left),Z=yield*kH(X.right);if(TP(J)||TP(Z))return cN;if(JG(J)&&JG(Z))return i7(j6(J.value,Z.value));if(JG(J)&&vH(Z))return i7(j6(J.value,X.right));if(vH(J)&&JG(Z))return i7(j6(X.left,Z.value));if(vH(J)&&vH(Z))return dN;throw Error("[BUG]: Doc.changesUponFlattening - unable to flatten a Cat document - please open an issue at https://github.com/IMax153/contentlayer/issues/new")}case"Nest":return yield*U(kH(X.doc),k(PP((J)=>BJ(J,X.indent))));case"Union":return i7(X.left);case"Column":{let J=YG((Z)=>c0(K7(X.react(Z))));return i7(J)}case"WithPageWidth":{let J=hH((Z)=>c0(K7(X.react(Z))));return i7(J)}case"Nesting":{let J=$G((Z)=>c0(K7(X.react(Z))));return i7(J)}case"Annotated":return yield*U(kH(X.doc),k(PP((J)=>QG(J,X.annotation))))}}),QG=B(2,(X,J)=>{let Z=Object.create(h9);return Z._tag="Annotated",Z.doc=X,Z.annotation=J,Z});var _p=(X)=>{if(X<=0)return gH;if(X===1)return yH(" ");return g1(wp(X))};var wp=(X)=>{let J="";for(let Z=0;Z<X;Z++)J=J+=" ";return J};var h1="@effect/printer/DocStream",Tp=Symbol.for(h1),CJ8={FailedStream:(X)=>U(N8("@effect/printer/DocStream/FailedStream"),b(N8(h1))),EmptyStream:(X)=>U(N8("@effect/printer/DocStream/EmptyStream"),b(N8(h1))),CharStream:(X)=>U(F("@effect/printer/DocStream/CharStream"),b(N8(h1)),b(N8(X.char)),b(F(X.stream))),TextStream:(X)=>U(N8("@effect/printer/DocStream/TextStream"),b(N8(h1)),b(N8(X.text)),b(F(X.stream))),LineStream:(X)=>U(N8("@effect/printer/DocStream/LineStream"),b(N8(h1)),b(F(X.stream))),PushAnnotationStream:(X)=>U(N8("@effect/printer/DocStream/PopAnnotationStream"),b(N8(h1)),b(F(X.annotation)),b(F(X.stream))),PopAnnotationStream:(X)=>U(N8("@effect/printer/DocStream/PopAnnotationStream"),b(N8(h1)),b(F(X.stream)))},EJ8={FailedStream:(X,J)=>hY(J)&&J._tag==="FailedStream",EmptyStream:(X,J)=>hY(J)&&J._tag==="EmptyStream",CharStream:(X,J)=>hY(J)&&J._tag==="CharStream"&&X.char===J.char&&S(X.stream,J.stream),TextStream:(X,J)=>hY(J)&&J._tag==="TextStream"&&X.text===J.text&&S(X.stream,J.stream),LineStream:(X,J)=>hY(J)&&J._tag==="LineStream"&&S(X.stream,J.stream),PushAnnotationStream:(X,J)=>hY(J)&&J._tag==="PushAnnotationStream"&&S(X.annotation,J.annotation)&&S(X.stream,J.stream),PopAnnotationStream:(X,J)=>hY(J)&&J._tag==="PopAnnotationStream"&&S(X.stream,J.stream)},mY={[Tp]:{_A:(X)=>X},[f](){return D8(this,CJ8[this._tag](this))},[u](X){return EJ8[this._tag](this,X)}},hY=(X)=>typeof X==="object"&&X!=null&&(Tp in X);var Pp=(X)=>X._tag==="EmptyStream";var Mp=(X)=>X._tag==="LineStream";var EP=(()=>{let X=Object.create(mY);return X._tag="FailedStream",X})(),IP=(()=>{let X=Object.create(mY);return X._tag="EmptyStream",X})(),SP=B(2,(X,J)=>{let Z=Object.create(mY);return Z._tag="CharStream",Z.char=J,Z.stream=X,Z}),vP=B(2,(X,J)=>{let Z=Object.create(mY);return Z._tag="TextStream",Z.text=J,Z.stream=X,Z}),kP=B(2,(X,J)=>{let Z=Object.create(mY);return Z._tag="LineStream",Z.indentation=J,Z.stream=X,Z}),Fp=B(2,(X,J)=>{let Z=Object.create(mY);return Z._tag="PushAnnotationStream",Z.annotation=J,Z.stream=X,Z}),Rp=(X)=>{let J=Object.create(mY);return J._tag="PopAnnotationStream",J.stream=X,J};var jp={_tag:"Nil"},T5=(X,J,Z)=>({_tag:"Cons",indent:X,document:J,pipeline:Z}),Cp=(X)=>({_tag:"UndoAnnotation",pipeline:X});var xP="@effect/printer/PageWidth",nN=Symbol.for(xP),vJ8={AvailablePerLine:(X)=>U(F("@effect/printer/PageWidth/AvailablePerLine"),b(F(xP)),b(F(X.lineWidth)),b(F(X.ribbonFraction))),Unbounded:(X)=>U(F("@effect/printer/PageWidth/Unbounded"),b(F(xP)))},kJ8={AvailablePerLine:(X,J)=>yP(J)&&J._tag==="AvailablePerLine"&&X.lineWidth===J.lineWidth&&X.ribbonFraction===J.ribbonFraction,Unbounded:(X,J)=>yP(J)&&J._tag==="Unbounded"},Ep={[nN]:nN,[f](){return D8(this,vJ8[this._tag](this))},[u](X){return kJ8[this._tag](this,X)}},yP=(X)=>typeof X==="object"&&X!=null&&(nN in X);var Ip=(X,J)=>{let Z=Object.create(Ep);return Z._tag="AvailablePerLine",Z.lineWidth=X,Z.ribbonFraction=J,Z},oN=(()=>{let X=Object.create(Ep);return X._tag="Unbounded",X})(),bP=Ip(80,1),rN=(X,J,Z,Y)=>{let $=X-Y,Q=Math.max(0,Math.min(X,Math.floor(X*J))),G=Z+Q-Y;return Math.min($,G)};var vp=(X)=>({pageWidth:X});var lN=B(3,(X,J,Z)=>c0(xJ8(T5(0,X,jp),0,0,J,Z))),xJ8=(X,J,Z,Y,$)=>{let Q=(G,H,K)=>_8(function*(){switch(G._tag){case"Nil":return IP;case"Cons":switch(G.document._tag){case"Fail":return EP;case"Empty":return yield*Q(G.pipeline,H,K);case"Char":{let V=yield*Q(G.pipeline,H,K+1);return SP(V,G.document.char)}case"Text":{let V=G.document.text.length,W=yield*Q(G.pipeline,H,K+V);return vP(W,G.document.text)}case"Line":{let V=yield*Q(G.pipeline,G.indent,G.indent),W=Pp(V)||Mp(V)?0:G.indent;return kP(V,W)}case"FlatAlt":{let V=T5(G.indent,G.document.left,G.pipeline);return yield*Q(V,H,K)}case"Cat":{let V=T5(G.indent,G.document.right,G.pipeline),W=T5(G.indent,G.document.left,V);return yield*Q(W,H,K)}case"Nest":{let V=G.indent+G.document.indent,W=T5(V,G.document.doc,G.pipeline);return yield*Q(W,H,K)}case"Union":{let V=T5(G.indent,G.document.left,G.pipeline),W=T5(G.indent,G.document.right,G.pipeline),N=Q(V,H,K),z=Q(W,H,K);return yJ8(Y,H,K,N,z)}case"Column":{let V=G.document.react(K),W=T5(G.indent,V,G.pipeline);return yield*Q(W,H,K)}case"WithPageWidth":{let V=G.document.react($.pageWidth),W=T5(G.indent,V,G.pipeline);return yield*Q(W,H,K)}case"Nesting":{let V=G.document.react(G.indent),W=T5(G.indent,V,G.pipeline);return yield*Q(W,H,K)}case"Annotated":{let V=Cp(G.pipeline),W=T5(G.indent,G.document.doc,V),N=yield*Q(W,H,K);return Fp(N,G.document.annotation)}}case"UndoAnnotation":{let V=yield*Q(G.pipeline,J,Z);return Rp(V)}}});return Q(X,J,Z)},yJ8=(X,J,Z,Y,$)=>{let Q=c0(Y),G=void 0;return X(Q,J,Z,()=>G??(G=c0($),G))?Q:G??c0($)},kp=(X)=>c0(m9(FX(X),0)),m9=(X,J)=>_8(function*(){if(L4(X))return IP;let{head:Z,tail:Y}=X;switch(Z._tag){case"Fail":return EP;case"Empty":return yield*m9(Y,J);case"Char":{let $=yield*m9(Y,J+1);return SP($,Z.char)}case"Text":{let $=yield*m9(Y,J+Z.text.length);return vP($,Z.text)}case"Line":{let $=yield*m9(Y,0);return kP($,0)}case"FlatAlt":return yield*m9(Z6(Z.left,Y),J);case"Cat":{let $=Z6(Z.left,Z6(Z.right,Y));return yield*m9($,J)}case"Nest":return yield*m9(Z6(Z.doc,Y),J);case"Union":return yield*m9(Z6(Z.right,Y),J);case"Column":return yield*m9(Z6(Z.react(J),Y),J);case"WithPageWidth":return yield*m9(Z6(Z.react(oN),Y),J);case"Nesting":return yield*m9(Z6(Z.react(0),Y),J);case"Annotated":return yield*m9(Z6(Z.doc,Y),J)}}),xp=B(2,(X,J)=>{let Z=J.pageWidth;if(Z._tag==="AvailablePerLine")return lN(X,(Y,$,Q)=>{let G=rN(Z.lineWidth,Z.ribbonFraction,$,Q);return bJ8(Y,G)},J);return gP(X)}),bJ8=(X,J)=>{let Z=J,Y=X;while(Z>=0)switch(Y._tag){case"FailedStream":return!1;case"EmptyStream":return!0;case"CharStream":{Z=Z-1,Y=Y.stream;break}case"TextStream":{Z=Z-Y.text.length,Y=Y.stream;break}case"LineStream":return!0;case"PushAnnotationStream":{Y=Y.stream;break}case"PopAnnotationStream":{Y=Y.stream;break}}return!1},yp=B(2,(X,J)=>{let Z=J.pageWidth;if(Z._tag==="AvailablePerLine")return lN(X,gJ8(Z.lineWidth,Z.ribbonFraction),J);return gP(X)}),gJ8=(X,J)=>{return(Z,Y,$,Q)=>{let G=rN(X,J,Y,$);return hJ8(Z,Q,X,$,G)}},hJ8=(X,J,Z,Y,$)=>{let Q,G=X,H=$;while(H>=0)switch(G._tag){case"FailedStream":return!1;case"EmptyStream":return!0;case"CharStream":{H=H-1,G=G.stream;break}case"TextStream":{H=H-G.text.length,G=G.stream;break}case"LineStream":{if(!Q)Q=n(mJ8(J()),{onNone:()=>Y,onSome:(K)=>Math.min(K,Y)});if(Q<G.indentation)return!1;H=Z-G.indentation,G=G.stream;break}case"PushAnnotationStream":{G=G.stream;break}case"PopAnnotationStream":{G=G.stream;break}}return!1},mJ8=(X)=>{let J=X;while(J._tag==="LineStream"||J._tag==="PushAnnotationStream"||J._tag==="PopAnnotationStream"){if(J._tag==="LineStream")return D(J.indentation);J=J.stream}return _()},gP=(X)=>lN(X,(J)=>!dJ8(J),{pageWidth:oN}),dJ8=(X)=>{let J=X;while(!0)switch(J._tag){case"FailedStream":return!0;case"EmptyStream":return!1;case"CharStream":{J=J.stream;break}case"TextStream":{J=J.stream;break}case"LineStream":return!1;case"PushAnnotationStream":{J=J.stream;break}case"PopAnnotationStream":{J=J.stream;break}}throw Error("bug")};var mH=yH,e=g1;var c8=gH;var n0=pN;var b8=jP;var j=j6,hP=Bp;var V9=zp,s0=qp;var d9=BJ,dY=CP;var iN=Ap;var d=QG;var bp=d(c8,KP),gp=(X,J)=>d(c8,BP(X,J)),hp=(X,J)=>d(c8,VP(X,J));var mp=(X=1)=>d(c8,WP(X));var dp=d(c8,UP),cp=d(c8,NP),up=d(c8,zP);var pp=d(c8,qP),fp=d(c8,OP),np=(X)=>d(c8,DP(X));var op=d(c8,AP);var mP=bP;var dP=vp;var rp=kp,lp=xp,ip=yp;var sp=B(2,(X,J)=>{switch(J.style){case"compact":return cP(rp(X));case"pretty":{let Z=Object.assign({},mP,J.options);return cP(lp(X,dP(Z)))}case"smart":{let Z=Object.assign({},mP,J.options);return cP(ip(X,dP(Z)))}}}),cP=(X)=>c0(GG(X,FX(du))),ap=(X)=>{if(L4(X))throw Error("BUG: AnsiRender.unsafePeek - peeked at an empty stack - please report an issue at https://github.com/Effect-TS/printer/issues");return X.head},oJ8=(X)=>{if(L4(X))throw Error("BUG: AnsiRender.unsafePop - popped from an empty stack - please report an issue at https://github.com/Effect-TS/printer/issues");return[X.head,X.tail]},GG=(X,J)=>{switch(X._tag){case"FailedStream":return oX("BUG: AnsiRender.renderSafe - attempted to render a failed doc stream - please report an issue at https://github.com/Effect-TS/printer/issues");case"EmptyStream":return L("");case"CharStream":return k(z8(()=>GG(X.stream,J)),(Z)=>X.char+Z);case"TextStream":return k(z8(()=>GG(X.stream,J)),(Z)=>X.text+Z);case"LineStream":{let Z=`
`;for(let Y=0;Y<X.indentation;Y++)Z=Z+=" ";return k(z8(()=>GG(X.stream,J)),(Y)=>Z+Y)}case"PushAnnotationStream":{let Z=ap(J),Y=hN(X.annotation,Z);return k(z8(()=>GG(X.stream,Z6(X.annotation,J))),($)=>gN(Y)+$)}case"PopAnnotationStream":{let[,Z]=oJ8(J),Y=ap(Z);return k(z8(()=>GG(X.stream,Z)),($)=>gN(Y)+$)}}};var P5=bp,tp=gp,ep=hp;var HG=mp;var a7=dp,KG=cp,BG=up;var VJ=pp,Xf=fp,Jf=np;var M5=op;var u8=sp;var Zf=B(2,(X,J)=>c0(aN(X,J))),aN=(X,J)=>{let Z=(Y)=>_8(function*(){switch(Y._tag){case"Fail":case"Empty":case"Char":case"Text":case"Line":return Y;case"FlatAlt":{let $=yield*Z(Y.left),Q=yield*Z(Y.right);return bH($,Q)}case"Cat":{if(xH(Y.left))return yield*Z(Y.right);if(xH(Y.right))return yield*Z(Y.left);if(w5(Y.left)&&w5(Y.right))return g1(Y.left.char+Y.right.char);if(L5(Y.left)&&w5(Y.right))return g1(Y.left.text+Y.right.char);if(w5(Y.left)&&L5(Y.right))return g1(Y.left.char+Y.right.text);if(L5(Y.left)&&L5(Y.right))return g1(Y.left.text+Y.right.text);if(w5(Y.left)&&b1(Y.right)&&w5(Y.right.left)||w5(Y.left)&&b1(Y.right)&&L5(Y.right.left)||L5(Y.left)&&b1(Y.right)&&w5(Y.right.left)||L5(Y.left)&&b1(Y.right)&&L5(Y.right.left)){let G=yield*Z(j6(Y.left,Y.right.left));return yield*Z(j6(G,Y.right.right))}if(b1(Y.left)&&w5(Y.left.right)||b1(Y.left)&&L5(Y.left.right)){let G=yield*Z(j6(Y.left.right,Y.right));return yield*Z(j6(Y.left.left,G))}let $=yield*Z(Y.left),Q=yield*Z(Y.right);return j6($,Q)}case"Nest":{if(Y.indent===0)return yield*Z(Y.doc);if(xH(Y.doc)||w5(Y.doc)||L5(Y.doc))return Y.doc;if(RP(Y.doc)){let $=Y.indent+Y.doc.indent;return yield*Z(BJ(Y.doc.doc,$))}return BJ(yield*Z(Y.doc),Y.indent)}case"Union":{let $=yield*Z(Y.left),Q=yield*Z(Y.right);return ZG($,Q)}case"Column":return J._tag==="Shallow"?Y:YG(($)=>c0(aN(Y.react($),J)));case"WithPageWidth":return J._tag==="Shallow"?Y:hH(($)=>c0(aN(Y.react($),J)));case"Nesting":return J._tag==="Shallow"?Y:$G(($)=>c0(aN(Y.react($),J)));case"Annotated":return QG(yield*Z(Y.doc),Y.annotation)}});return Z(X)};var j0={_tag:"Deep"},C0=Zf;var Yf=kN;var uP=$P,sN=xN,$f=yN;var L8=(X)=>({_tag:"Text",value:X}),c9=L8(""),W9=L8(" "),e7=(X)=>m1(X,$f),Qf=(X)=>m1(X,Yf),m1=(X,J)=>({_tag:"Highlight",value:typeof X==="string"?L8(X):X,color:J}),tN=(X)=>({_tag:"Strong",value:typeof X==="string"?L8(X):X});var Gf=(X)=>({_tag:"Weak",value:typeof X==="string"?L8(X):X});var fP=(X)=>X._tag==="Text";var e6=B(2,(X,J)=>({_tag:"Sequence",left:X,right:J})),t7=(X)=>{switch(X._tag){case"Text":case"URI":return X.value;case"Highlight":case"Weak":case"Strong":return t7(X.value);case"Sequence":return t7(X.left)+t7(X.right)}},U9=(X)=>{let J=J8(X);if(Q8(J))return J.slice(1).reduce(e6,J[0]);return c9},nP=(X)=>uY(X)===0,uY=(X)=>{switch(X._tag){case"Text":case"URI":return X.value.length;case"Highlight":case"Strong":case"Weak":return uY(X.value);case"Sequence":return uY(X.left)+uY(X.right)}},WJ=(X)=>{switch(X._tag){case"Highlight":return d(WJ(X.value),Yp(X.color));case"Sequence":return j(WJ(X.left),WJ(X.right));case"Strong":return d(WJ(X.value),d6);case"Text":return e(X.value);case"URI":return d(e(X.value),y4);case"Weak":return d(WJ(X.value),$p)}};var d1=(X)=>X._tag==="Empty",Hf=(X)=>X._tag==="Header",Kf=(X)=>X._tag==="Paragraph",Bf=(X)=>X._tag==="DescriptionList";var V0={_tag:"Empty"},U8=B(2,(X,J)=>{if(d1(X))return J;if(d1(J))return X;return{_tag:"Sequence",left:X,right:J}});var oP=(X)=>{let J=J8(X);if(Q8(J))return J.slice(1).reduce(U8,J[0]);return V0},B7=(X)=>Hf(X)||Kf(X)?X.value:c9,c1=(X)=>({_tag:"DescriptionList",definitions:X}),cH=(X)=>({_tag:"Enumeration",elements:X}),V7=(X)=>({_tag:"Header",value:typeof X==="string"?L8(X):X,level:1});var m=(X)=>({_tag:"Paragraph",value:typeof X==="string"?L8(X):X}),XX=B(2,(X,J)=>Bf(X)?c1(r(X.definitions,([Z,Y])=>J(Z,Y))):X),Vf=(X)=>C0(dH(X),j0),n8=(X)=>u8(Vf(X),{style:"pretty"}),dH=(X)=>{switch(X._tag){case"Empty":return c8;case"Header":return U(d(WJ(X.value),d6),j(n0));case"Paragraph":return U(WJ(X.value),j(n0));case"DescriptionList":{let J=X.definitions.map(([Z,Y])=>hP([d(WJ(Z),d6),c8,iN(dH(Y),2)]));return s0(J)}case"Enumeration":{let J=X.elements.map((Z)=>j(e("- "),dH(Z)));return iN(s0(J),2)}case"Sequence":return s0([dH(X.left),dH(X.right)])}};var Wf=bc;var Nf=o8("@effect/cli/CliConfig"),eN={isCaseSensitive:!1,autoCorrectLimit:2,finalCheckBuiltIn:!1,showAllNames:!0,showBuiltIns:!0,showTypes:!0};var X4=B(2,(X,J)=>X.isCaseSensitive?J:J.toLowerCase());var zf=o8("@effect/platform/Terminal");class rP extends FW("QuitException"){}var qf=(X)=>typeof X==="object"&&X!=null&&("_tag"in X)&&X._tag==="QuitException",J0=zf;var p=MW();var aJ8="@effect/cli/Prompt",Of=Symbol.for(aJ8),iP={...pZ,[Of]:{_Output:(X)=>X},commit(){return sP(this)},pipe(){return C(this,arguments)}},aP=(X)=>typeof X==="object"&&X!=null&&(Of in X);var u9=(X,J)=>{let Z=Object.create(iP);return Z._tag="Loop",Z.initialState=X,Z.render=J.render,Z.process=J.process,Z.clear=J.clear,Z},NJ=B(2,(X,J)=>sJ8(X,(Z)=>eJ8(J(Z)))),sJ8=B(2,(X,J)=>{let Z=Object.create(iP);return Z._tag="OnSuccess",Z.prompt=X,Z.onSuccess=J,Z}),sP=FQ(function*(X){let J=yield*J0,Z=yield*J.readInput;return yield*lP(X,J,Z)},s6(()=>new rP),k9),lP=(X,J,Z)=>z8(()=>{let Y=X;switch(Y._tag){case"Loop":return tJ8(Y,J,Z);case"OnSuccess":return R(lP(Y.prompt,J,Z),($)=>lP(Y.onSuccess($),J,Z));case"Succeed":return L(Y.value)}}),tJ8=FQ(function*(X,J,Z){let Y=T6(X.initialState)?yield*X.initialState:X.initialState,$=p.NextFrame({state:Y});while(!0){let Q=yield*X.render(Y,$);yield*d0(J.display(Q));let G=yield*Z.take;switch($=yield*X.process(G,Y),$._tag){case"Beep":continue;case"NextFrame":{yield*d0(J.display(yield*X.clear(Y,$))),Y=$.state;continue}case"Submit":{yield*d0(J.display(yield*X.clear(Y,$)));let H=yield*X.render(Y,$);return yield*d0(J.display(H)),$.value}}}},(X,J,Z)=>Z9(X,d0(Z.display(u8(Xf,{style:"pretty"}))))),eJ8=(X)=>{let J=Object.create(iP);return J._tag="Succeed",J.value=X,J};var XM=Symbol.for("@effect/matcher/Matcher"),X18={[XM]:{_input:g,_filters:g,_remaining:g,_result:g,_return:g},_tag:"TypeMatcher",add(X){return J18([...this.cases,X])},pipe(){return C(this,arguments)}};function J18(X){let J=Object.create(X18);return J.cases=X,J}var Z18={[XM]:{_input:g,_filters:g,_remaining:g,_result:g,_provided:g,_return:g},_tag:"ValueMatcher",add(X){if(this.value._tag==="Right")return this;if(X._tag==="When"&&X.guard(this.provided)===!0)return tP(this.provided,Z8(X.evaluate(this.provided)));else if(X._tag==="Not"&&X.guard(this.provided)===!1)return tP(this.provided,Z8(X.evaluate(this.provided)));return this},pipe(){return C(this,arguments)}};function tP(X,J){let Z=Object.create(Z18);return Z.provided=X,Z.value=J,Z}var Y18=(X,J)=>({_tag:"When",guard:X,evaluate:J});var eP=(X)=>{if(typeof X==="function")return X;else if(Array.isArray(X)){let J=X.map(eP),Z=J.length;return(Y)=>{if(!Array.isArray(Y))return!1;for(let $=0;$<Z;$++)if(J[$](Y[$])===!1)return!1;return!0}}else if(X!==null&&typeof X==="object"){let J=Object.entries(X).map(([Y,$])=>[Y,eP($)]),Z=J.length;return(Y)=>{if(typeof Y!=="object"||Y===null)return!1;for(let $=0;$<Z;$++){let[Q,G]=J[$];if(!(Q in Y)||G(Y[Q])===!1)return!1}return!0}}return(J)=>J===X};var Df=(X)=>tP(X,$8(X));var Af=(X,J)=>(Z)=>Z.add(Y18(eP(X),J));var _f=(X)=>(J)=>{let Z=wf(J);if(DK(Z))return Z._tag==="Right"?Z.right:X(Z.left);return(Y)=>{let $=Z(Y);return $._tag==="Right"?$.right:X($.left)}};var wf=(X)=>{if(X._tag==="ValueMatcher")return X.value;let J=X.cases.length;if(J===1){let Z=X.cases[0];return(Y)=>{if(Z._tag==="When"&&Z.guard(Y)===!0)return Z8(Z.evaluate(Y));else if(Z._tag==="Not"&&Z.guard(Y)===!1)return Z8(Z.evaluate(Y));return $8(Y)}}return(Z)=>{for(let Y=0;Y<J;Y++){let $=X.cases[Y];if($._tag==="When"&&$.guard(Z)===!0)return Z8($.evaluate(Z));else if($._tag==="Not"&&$.guard(Z)===!1)return Z8($.evaluate(Z))}return $8(Z)}};var Xz=Df;var F5=Af;var Jz=_f;var uH={arrowUp:e(""),arrowDown:e(""),arrowLeft:e(""),arrowRight:e(""),radioOn:e(""),radioOff:e(""),checkboxOn:e(""),checkboxOff:e(""),tick:e(""),cross:e(""),ellipsis:e(""),pointerSmall:e(""),line:e(""),pointer:e("")},Q18={arrowUp:uH.arrowUp,arrowDown:uH.arrowDown,arrowLeft:uH.arrowLeft,arrowRight:uH.arrowRight,radioOn:e("(*)"),radioOff:e("( )"),checkboxOn:e("[*]"),checkboxOff:e("[ ]"),tick:e(""),cross:e(""),ellipsis:e("..."),pointerSmall:e(""),line:e(""),pointer:e(">")},u6=k(V8(()=>process.platform==="win32"),(X)=>X?Q18:uH);function J4(X,J){if(J===0)return j(M5,tp(0));let Z=0,Y=X.split(/\r?\n/);for(let $ of Y)Z+=1+Math.floor(Math.max($.length-1,0)/J);return Jf(Z)}function WG(X,J){let Z=X.split(/\r?\n/);return J===0?Z.length:U(r(Z,(Y)=>Math.ceil(Y.length/J)),o6(0,(Y,$)=>Y+$))}var G18=u8(P5,{style:"pretty"});function H18(X){return(J,Z)=>{return _8(function*(){let $=yield*(yield*J0).columns,Q=j(M5,a7),G=n(J.error,{onNone:()=>c8,onSome:(K)=>HG(WG(K,$)).pipe(j(J4(`
${K}`,$)))}),H=J4(X.message,$);return G.pipe(j(H),j(Q),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}}var K18=/\r?\n/;function B18(X,J){return n(X.error,{onNone:()=>c8,onSome:(Z)=>{let Y=Z.split(K18);if(Q8(Y)){let $=(H)=>d(e(H),c6(XG,H7)),Q=j(d(J,H7),b8),G=r(Y,(H)=>$(H));return KG.pipe(j(n0),j(Q),j(dY(s0(G))),j(BG))}return c8}})}function Pf(X,J=!1){return o6(X.dateParts,c8,(Z,Y,$)=>{let Q=e(Y.toString());if($===X.cursor&&!J){let G=c6(y4,V6);return j(Z,d(Q,G))}return j(Z,Q)})}function Mf(X,J,Z,Y){let $=(G)=>d(e(G),d6),Q=j(X,b8);return $4(Y.message.split(/\r?\n/),{onEmpty:()=>V9([Q,J,Z]),onNonEmpty:(G)=>{let H=r(G,(K)=>$(K));return Q.pipe(j(d9(s0(H),2)),j(b8),j(J),j(b8),j(Z))}})}function V18(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d(e("?"),V6),G=d($.pointerSmall,B0),H=Pf(X),K=Mf(Q,G,H,J),V=B18(X,$.pointerSmall);return VJ.pipe(j(K),j(V),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function W18(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d($.tick,g9),G=d($.ellipsis,B0),H=Pf(X,!0);return Mf(Q,G,H,J).pipe(j(n0),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function U18(X){return X.dateParts[X.cursor].increment(),p.NextFrame({state:{...X,typed:""}})}function N18(X){return X.dateParts[X.cursor].decrement(),p.NextFrame({state:{...X,typed:""}})}function z18(X){let J=X.dateParts[X.cursor].previousPart();return n(J,{onNone:()=>p.Beep(),onSome:(Z)=>p.NextFrame({state:{...X,typed:"",cursor:X.dateParts.indexOf(Z)}})})}function q18(X){let J=X.dateParts[X.cursor].nextPart();return n(J,{onNone:()=>p.Beep(),onSome:(Z)=>p.NextFrame({state:{...X,typed:"",cursor:X.dateParts.indexOf(Z)}})})}function O18(X){let J=X.dateParts[X.cursor].nextPart(),Z=n(J,{onNone:()=>X.dateParts.findIndex((Y)=>!Y.isToken()),onSome:(Y)=>X.dateParts.indexOf(Y)});return p.NextFrame({state:{...X,cursor:Z}})}function D18(X,J){if(/\d/.test(X)){let Z=J.typed+X;return J.dateParts[J.cursor].setValue(Z),p.NextFrame({state:{...J,typed:Z}})}return p.Beep()}var A18={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function _18(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L(G18),NextFrame:({state:Y})=>V18(Y,X),Submit:()=>W18(J,X)})}}function w18(X){return(J,Z)=>{switch(J.key.name){case"left":return L(z18(Z));case"right":return L(q18(Z));case"k":case"up":return L(U18(Z));case"j":case"down":return L(N18(Z));case"tab":return L(O18(Z));case"enter":case"return":return q5(X.validate(Z.value),{onFailure:(Y)=>p.NextFrame({state:{...Z,error:D(Y)}}),onSuccess:(Y)=>p.Submit({value:Y})});default:{let Y=i(J.input,()=>"");return L(D18(Y,Z))}}}}var Ff=(X)=>{let J={initial:new Date,dateMask:"YYYY-MM-DD HH:mm:ss",validate:L,...X,locales:{...A18,...X.locales}},Z=T18(J.dateMask,J.initial,J.locales),Y=Z.findIndex((Q)=>!Q.isToken()),$={dateParts:Z,typed:"",cursor:Y,value:J.initial,error:_()};return u9($,{render:_18(J),process:w18(J),clear:H18(J)})},L18=/\\(.)|"((?:\\["\\]|[^"])+)"|(D[Do]?|d{3,4}|d)|(M{1,4})|(YY(?:YY)?)|([aA])|([Hh]{1,2})|(m{1,2})|(s{1,2})|(S{1,4})|./g,Tf={1:({token:X,...J})=>new JM({token:X.replace(/\\(.)/g,"$1"),...J}),2:(X)=>new If(X),3:(X)=>new Sf(X),4:(X)=>new vf(X),5:(X)=>new kf(X),6:(X)=>new Ef(X),7:(X)=>new Cf(X),8:(X)=>new jf(X),9:(X)=>new Rf(X)},T18=(X,J,Z)=>{let Y=[],$=null;while($=L18.exec(X)){let G=$.shift(),H=$.findIndex((K)=>K!==void 0);if(H in Tf){let K=$[H]||G;Y.push(Tf[H]({token:K,date:J,parts:Y,locales:Z}))}else Y.push(new JM({token:$[H]||G,date:J,parts:Y,locales:Z}))}let Q=Y.reduce((G,H)=>{let K=G[G.length-1];if(H.isToken()&&K!==void 0&&K.isToken())K.setValue(H.token);else G.push(H);return G},t());return Y.splice(0,Y.length,...Q),Y};class ZX{token;date;parts;locales;constructor(X){this.token=X.token,this.locales=X.locales,this.date=X.date||new Date,this.parts=X.parts||[this]}isToken(){return!1}nextPart(){return PK(this.parts,(X)=>X===this).pipe(C6((X)=>z$(this.parts.slice(X+1),(J)=>!J.isToken())))}previousPart(){return PK(this.parts,(X)=>X===this).pipe(C6((X)=>_q(this.parts.slice(0,X),(J)=>!J.isToken())))}toString(){return String(this.date)}}class JM extends ZX{increment(){}decrement(){}setValue(X){this.token=this.token+X}isToken(){return!0}toString(){return this.token}}class Rf extends ZX{increment(){this.date.setMilliseconds(this.date.getMilliseconds()+1)}decrement(){this.date.setMilliseconds(this.date.getMilliseconds()-1)}setValue(X){this.date.setMilliseconds(Number.parseInt(X.slice(-this.token.length)))}toString(){return`${this.date.getMilliseconds()}`.padStart(4,"0").substring(0,this.token.length)}}class jf extends ZX{increment(){this.date.setSeconds(this.date.getSeconds()+1)}decrement(){this.date.setSeconds(this.date.getSeconds()-1)}setValue(X){this.date.setSeconds(Number.parseInt(X.slice(-2)))}toString(){let X=`${this.date.getSeconds()}`;return this.token.length>1?X.padStart(2,"0"):X}}class Cf extends ZX{increment(){this.date.setMinutes(this.date.getMinutes()+1)}decrement(){this.date.setMinutes(this.date.getMinutes()-1)}setValue(X){this.date.setMinutes(Number.parseInt(X.slice(-2)))}toString(){let X=`${this.date.getMinutes()}`;return this.token.length>1?X.padStart(2,"0"):X}}class Ef extends ZX{increment(){this.date.setHours(this.date.getHours()+1)}decrement(){this.date.setHours(this.date.getHours()-1)}setValue(X){this.date.setHours(Number.parseInt(X.slice(-2)))}toString(){let X=/h/.test(this.token)?this.date.getHours()%12||12:this.date.getHours();return this.token.length>1?`${X}`.padStart(2,"0"):`${X}`}}class If extends ZX{increment(){this.date.setDate(this.date.getDate()+1)}decrement(){this.date.setDate(this.date.getDate()-1)}setValue(X){this.date.setDate(Number.parseInt(X.slice(-2)))}toString(){let X=this.date.getDate(),J=this.date.getDay();return Xz(this.token).pipe(F5("DD",()=>`${X}`.padStart(2,"0")),F5("Do",()=>`${X}${this.ordinalIndicator(X)}`),F5("d",()=>`${J+1}`),F5("ddd",()=>this.locales.weekdaysShort[J]),F5("dddd",()=>this.locales.weekdays[J]),Jz(()=>`${X}`))}ordinalIndicator(X){return Xz(X%10).pipe(F5(1,()=>"st"),F5(2,()=>"nd"),F5(3,()=>"rd"),Jz(()=>"th"))}}class Sf extends ZX{increment(){this.date.setMonth(this.date.getMonth()+1)}decrement(){this.date.setMonth(this.date.getMonth()-1)}setValue(X){let J=Number.parseInt(X.slice(-2))-1;this.date.setMonth(J<0?0:J)}toString(){let X=this.date.getMonth();return Xz(this.token.length).pipe(F5(2,()=>`${X+1}`.padStart(2,"0")),F5(3,()=>this.locales.monthsShort[X]),F5(4,()=>this.locales.months[X]),Jz(()=>`${X+1}`))}}class vf extends ZX{increment(){this.date.setFullYear(this.date.getFullYear()+1)}decrement(){this.date.setFullYear(this.date.getFullYear()-1)}setValue(X){this.date.setFullYear(Number.parseInt(X.slice(-4)))}toString(){let X=`${this.date.getFullYear()}`.padStart(4,"0");return this.token.length===2?X.substring(-2):X}}class kf extends ZX{increment(){this.date.setHours((this.date.getHours()+12)%24)}decrement(){this.increment()}setValue(X){}toString(){let X=this.date.getHours()>12?"pm":"am";return/A/.test(this.token)?X.toUpperCase():X}}var Zz=Symbol.for("@effect/platform/Path"),YM=o8("@effect/platform/Path");function xf(X,J){let Z="",Y=0,$=-1,Q=0,G;for(let H=0;H<=X.length;++H){if(H<X.length)G=X.charCodeAt(H);else if(G===47)break;else G=47;if(G===47){if($===H-1||Q===1);else if($!==H-1&&Q===2){if(Z.length<2||Y!==2||Z.charCodeAt(Z.length-1)!==46||Z.charCodeAt(Z.length-2)!==46){if(Z.length>2){let K=Z.lastIndexOf("/");if(K!==Z.length-1){if(K===-1)Z="",Y=0;else Z=Z.slice(0,K),Y=Z.length-1-Z.lastIndexOf("/");$=H,Q=0;continue}}else if(Z.length===2||Z.length===1){Z="",Y=0,$=H,Q=0;continue}}if(J){if(Z.length>0)Z+="/..";else Z="..";Y=2}}else{if(Z.length>0)Z+="/"+X.slice($+1,H);else Z=X.slice($+1,H);Y=H-$-1}$=H,Q=0}else if(G===46&&Q!==-1)++Q;else Q=-1}return Z}function M18(X,J){let Z=J.dir||J.root,Y=J.base||(J.name||"")+(J.ext||"");if(!Z)return Y;if(Z===J.root)return Z+Y;return Z+X+Y}function F18(X){if(X.protocol!=="file:")return x(new x4({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));else if(X.hostname!=="")return x(new x4({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let J=X.pathname;for(let Z=0;Z<J.length;Z++)if(J[Z]==="%"){let Y=J.codePointAt(Z+2)|32;if(J[Z+1]==="2"&&Y===102)return x(new x4({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return L(decodeURIComponent(J))}var yf=function(){let J="",Z=!1,Y=void 0;for(let $=arguments.length-1;$>=-1&&!Z;$--){let Q;if($>=0)Q=arguments[$];else{let G=globalThis.process;if(Y===void 0&&"process"in globalThis&&typeof G==="object"&&G!==null&&typeof G.cwd==="function")Y=G.cwd();Q=Y}if(Q.length===0)continue;J=Q+"/"+J,Z=Q.charCodeAt(0)===47}if(J=xf(J,!Z),Z)if(J.length>0)return"/"+J;else return"/";else if(J.length>0)return J;else return"."},R18=47;function j18(X){let J=new URL("file://"),Z=yf(X);if(X.charCodeAt(X.length-1)===R18&&Z[Z.length-1]!=="/")Z+="/";return J.pathname=k18(Z),L(J)}var C18=/%/g,E18=/\\/g,I18=/\n/g,S18=/\r/g,v18=/\t/g;function k18(X){if(X.includes("%"))X=X.replace(C18,"%25");if(X.includes("\\"))X=X.replace(E18,"%5C");if(X.includes(`
`))X=X.replace(I18,"%0A");if(X.includes("\r"))X=X.replace(S18,"%0D");if(X.includes("\t"))X=X.replace(v18,"%09");return X}var ZM=YM.of({[Zz]:Zz,resolve:yf,normalize(X){if(X.length===0)return".";let J=X.charCodeAt(0)===47,Z=X.charCodeAt(X.length-1)===47;if(X=xf(X,!J),X.length===0&&!J)X=".";if(X.length>0&&Z)X+="/";if(J)return"/"+X;return X},isAbsolute(X){return X.length>0&&X.charCodeAt(0)===47},join(){if(arguments.length===0)return".";let X;for(let J=0;J<arguments.length;++J){let Z=arguments[J];if(Z.length>0)if(X===void 0)X=Z;else X+="/"+Z}if(X===void 0)return".";return ZM.normalize(X)},relative(X,J){if(X===J)return"";if(X=ZM.resolve(X),J=ZM.resolve(J),X===J)return"";let Z=1;for(;Z<X.length;++Z)if(X.charCodeAt(Z)!==47)break;let Y=X.length,$=Y-Z,Q=1;for(;Q<J.length;++Q)if(J.charCodeAt(Q)!==47)break;let H=J.length-Q,K=$<H?$:H,V=-1,W=0;for(;W<=K;++W){if(W===K){if(H>K){if(J.charCodeAt(Q+W)===47)return J.slice(Q+W+1);else if(W===0)return J.slice(Q+W)}else if($>K){if(X.charCodeAt(Z+W)===47)V=W;else if(W===0)V=0}break}let z=X.charCodeAt(Z+W),q=J.charCodeAt(Q+W);if(z!==q)break;else if(z===47)V=W}let N="";for(W=Z+V+1;W<=Y;++W)if(W===Y||X.charCodeAt(W)===47)if(N.length===0)N+="..";else N+="/..";if(N.length>0)return N+J.slice(Q+V);else{if(Q+=V,J.charCodeAt(Q)===47)++Q;return J.slice(Q)}},dirname(X){if(X.length===0)return".";let J=X.charCodeAt(0),Z=J===47,Y=-1,$=!0;for(let Q=X.length-1;Q>=1;--Q)if(J=X.charCodeAt(Q),J===47){if(!$){Y=Q;break}}else $=!1;if(Y===-1)return Z?"/":".";if(Z&&Y===1)return"//";return X.slice(0,Y)},basename(X,J){let Z=0,Y=-1,$=!0,Q;if(J!==void 0&&J.length>0&&J.length<=X.length){if(J.length===X.length&&J===X)return"";let G=J.length-1,H=-1;for(Q=X.length-1;Q>=0;--Q){let K=X.charCodeAt(Q);if(K===47){if(!$){Z=Q+1;break}}else{if(H===-1)$=!1,H=Q+1;if(G>=0)if(K===J.charCodeAt(G)){if(--G===-1)Y=Q}else G=-1,Y=H}}if(Z===Y)Y=H;else if(Y===-1)Y=X.length;return X.slice(Z,Y)}else{for(Q=X.length-1;Q>=0;--Q)if(X.charCodeAt(Q)===47){if(!$){Z=Q+1;break}}else if(Y===-1)$=!1,Y=Q+1;if(Y===-1)return"";return X.slice(Z,Y)}},extname(X){let J=-1,Z=0,Y=-1,$=!0,Q=0;for(let G=X.length-1;G>=0;--G){let H=X.charCodeAt(G);if(H===47){if(!$){Z=G+1;break}continue}if(Y===-1)$=!1,Y=G+1;if(H===46){if(J===-1)J=G;else if(Q!==1)Q=1}else if(J!==-1)Q=-1}if(J===-1||Y===-1||Q===0||Q===1&&J===Y-1&&J===Z+1)return"";return X.slice(J,Y)},format:function(J){if(J===null||typeof J!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof J);return M18("/",J)},parse(X){let J={root:"",dir:"",base:"",ext:"",name:""};if(X.length===0)return J;let Z=X.charCodeAt(0),Y=Z===47,$;if(Y)J.root="/",$=1;else $=0;let Q=-1,G=0,H=-1,K=!0,V=X.length-1,W=0;for(;V>=$;--V){if(Z=X.charCodeAt(V),Z===47){if(!K){G=V+1;break}continue}if(H===-1)K=!1,H=V+1;if(Z===46){if(Q===-1)Q=V;else if(W!==1)W=1}else if(Q!==-1)W=-1}if(Q===-1||H===-1||W===0||W===1&&Q===H-1&&Q===G+1){if(H!==-1)if(G===0&&Y)J.base=J.name=X.slice(1,H);else J.base=J.name=X.slice(G,H)}else{if(G===0&&Y)J.name=X.slice(1,Q),J.base=X.slice(1,H);else J.name=X.slice(G,Q),J.base=X.slice(G,H);J.ext=X.slice(Q,H)}if(G>0)J.dir=X.slice(0,G-1);else if(Y)J.dir="/";return J},sep:"/",fromFileUrl:F18,toFileUrl:j18,toNamespacedPath:g});var nY=Zz,p9=YM;var Yz=(X,J,Z)=>{let Y=Z===void 0?J:Z,$=Math.min(J-Y,X-Math.floor(Y/2));if($<0)$=0;let Q=Math.min($+Y,J);return{startIndex:$,endIndex:Q}};var bf="The selected directory contains files. Would you like to traverse the selected directory?",pH=MW(),$z=pH.$is("Show"),b18=u8(P5,{style:"pretty"});function NG(X,J){return n(X,{onNone:()=>n(J.startingPath,{onNone:()=>V8(()=>process.cwd()),onSome:(Z)=>R(l7,(Y)=>d0(Y.exists(Z)).pipe(Lw(g,`The provided starting path '${Z}' does not exist`),K6(Z)))}),onSome:(Z)=>L(Z)})}function QM(X,J){return _8(function*(){let Z=yield*l7,Y=yield*p9,$=yield*d0(Z.readDirectory(X)).pipe(k((Q)=>["..",...Q]));return yield*mW($,(Q)=>{let G=J.filter(Q),H=T6(G)?G:L(G),K=J.type==="directory"?k(d0(Z.stat(Y.join(X,Q))),(V)=>V.type==="Directory"):L(!0);return z4(H,K,(V,W)=>V&&W)},{concurrency:$.length})})}function g18(X){return(J,Z)=>{return _8(function*(){let $=yield*(yield*J0).columns,Q=yield*NG(J.path,X),G=`
`.repeat(Math.min(J.files.length,X.maxPerPage)),H=J4(Q,$),K=$z(J.confirm)?bf:X.message,V=J4(`
${K}`,$);return J4(G,$).pipe(j(H),j(V),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}}var h18=/\r?\n/;function $M(X,J,Z,Y){let $=(G)=>d(e(G),d6),Q=j(Z,b8);return $4(J.split(h18),{onEmpty:()=>V9([Q,Y,X]),onNonEmpty:(G)=>{let H=r(G,(K)=>$(K));return Q.pipe(j(d9(s0(H),2)),j(b8),j(Y),j(b8),j(X))}})}function m18(X,J,Z,Y,$){let Q=b8;if(Z===J.startIndex&&J.startIndex>0)Q=$.arrowUp;else if(Z===J.endIndex-1&&J.endIndex<Y)Q=$.arrowDown;return X.cursor===Z?$.pointer.pipe(d(V6),j(Q)):Q.pipe(j(b8))}function d18(X,J){return J?d(e(X),c6(y4,V6)):e(X)}function c18(X,J,Z,Y){let $=J.length,Q=Yz(X.cursor,$,Y.maxPerPage),G=[];for(let H=Q.startIndex;H<Q.endIndex;H++){let K=X.cursor===H,V=m18(X,Q,H,$,Z),W=d18(J[H],K);G.push(j(V,W))}return s0(G)}function u18(X,J){return _8(function*(){let Z=yield*p9,$=yield*(yield*J0).columns,Q=yield*u6,G=yield*NG(X.path,J),H=X.files[X.cursor],K=Z.resolve(G,H),V=Q.pointerSmall.pipe(j(b8),j(e(K)),d(B0));if($z(X.confirm)){let A=d(e("?"),V6),E=d(Q.pointerSmall,B0),P=d(e("(Y/n)"),B0),M=$M(P,bf,A,E);return VJ.pipe(j(M),j(n0),j(V),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))}let W=d(Q.tick,g9),N=d(Q.ellipsis,B0),z=$M(c8,J.message,W,N),q=c18(X,X.files,Q,J);return VJ.pipe(j(z),j(n0),j(V),j(n0),j(q),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}function p18(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d($.tick,g9),G=d($.ellipsis,B0);return $M(c8,J.message,Q,G).pipe(j(b8),j(d(e(X),x1)),j(n0),u8({style:"pretty",options:{lineWidth:Y}}))})}function f18(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L(b18),NextFrame:({state:Y})=>u18(Y,X),Submit:({value:Y})=>p18(Y,X)})}}function n18(X){let J=X.cursor-1;return L(p.NextFrame({state:{...X,cursor:J<0?X.files.length-1:J}}))}function o18(X){return L(p.NextFrame({state:{...X,cursor:(X.cursor+1)%X.files.length}}))}function r18(X,J){return _8(function*(){let Z=yield*l7,Y=yield*p9,$=yield*NG(X.path,J),Q=X.files[X.cursor],G=Y.resolve($,Q);if((yield*d0(Z.stat(G))).type==="Directory"){let K=yield*QM(G,J),V=K.filter((W)=>W!=="..");if(J.type==="directory"||J.type==="either")return V.length===0?p.Submit({value:G}):p.NextFrame({state:{...X,confirm:pH.Show()}});return p.NextFrame({state:{cursor:0,files:K,path:D(G),confirm:pH.Hide()}})}return p.Submit({value:G})})}function l18(X){return(J,Z)=>_8(function*(){switch(J.key.name){case"k":case"up":return yield*n18(Z);case"j":case"down":case"tab":return yield*o18(Z);case"enter":case"return":return yield*r18(Z,X);case"y":case"t":{if($z(Z.confirm)){let Y=yield*p9,$=yield*NG(Z.path,X),Q=Z.files[Z.cursor],G=Y.resolve($,Q),H=yield*QM(G,X);return p.NextFrame({state:{cursor:0,files:H,path:D(G),confirm:pH.Hide()}})}return p.Beep()}case"n":case"f":{if($z(Z.confirm)){let Y=yield*p9,$=yield*NG(Z.path,X),Q=Z.files[Z.cursor],G=Y.resolve($,Q);return p.Submit({value:G})}return p.Beep()}default:return p.Beep()}})}var gf=(X={})=>{let J={type:X.type??"file",message:X.message??"Choose a file",startingPath:Y0(X.startingPath),maxPerPage:X.maxPerPage??10,filter:X.filter??(()=>L(!0))},Z=_8(function*(){let Y=_(),$=yield*NG(Y,J),Q=yield*QM($,J),G=pH.Hide();return{cursor:0,files:Q,path:Y,confirm:G}});return u9(Z,{render:f18(J),process:l18(J),clear:g18(J)})};var mf=xY.pipe(aT(),r7),df=r7(xY),cf=u8(P5,{style:"pretty"});function uf(X){return(J,Z)=>{return _8(function*(){let $=yield*(yield*J0).columns,Q=j(M5,a7),G=n(J.error,{onNone:()=>c8,onSome:(K)=>HG(WG(K,$)).pipe(j(J4(`
${K}`,$)))}),H=J4(X.message,$);return G.pipe(j(H),j(Q),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}}function hf(X,J){let Z=n(X.error,{onNone:()=>c6(y4,V6),onSome:()=>H7}),Y=X.value===""?c8:e(`${X.value}`);return J?Y:d(Y,Z)}var a18=/\r?\n/;function s18(X,J){return n(X.error,{onNone:()=>c8,onSome:(Z)=>$4(Z.split(a18),{onEmpty:()=>c8,onNonEmpty:(Y)=>{let $=(H)=>d(e(H),c6(XG,H7)),Q=j(d(J,H7),b8),G=r(Y,(H)=>$(H));return KG.pipe(j(n0),j(Q),j(dY(s0(G))),j(BG))}})})}function pf(X,J,Z,Y,$=!1){let Q=(H)=>d(e(H),d6),G=j(J,b8);return $4(Y.message.split(/\r?\n/),{onEmpty:()=>V9([G,Z,hf(X,$)]),onNonEmpty:(H)=>{let K=r(H,(V)=>Q(V));return G.pipe(j(d9(s0(K),2)),j(b8),j(Z),j(b8),j(hf(X,$)))}})}function ff(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d(e("?"),V6),G=d($.pointerSmall,B0),H=s18(X,$.pointerSmall);return pf(X,Q,G,J).pipe(j(H),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function nf(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d($.tick,g9),G=d($.ellipsis,B0);return pf(X,Q,G,J,!0).pipe(j(n0),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function of(X){if(X.value.length<=0)return L(p.Beep());let J=X.value.slice(0,X.value.length-1);return L(p.NextFrame({state:{...X,value:J,error:_()}}))}function t18(X,J){if(X.value.length===0&&J==="-")return L(p.NextFrame({state:{...X,value:"-",error:_()}}));return q5(mf(X.value+J),{onFailure:()=>p.Beep(),onSuccess:(Z)=>p.NextFrame({state:{...X,value:`${Z}`,error:_()}})})}function e18(X,J){if(J==="."&&X.value.includes("."))return L(p.Beep());if(X.value.length===0&&J==="-")return L(p.NextFrame({state:{...X,value:"-",error:_()}}));return q5(df(X.value+J),{onFailure:()=>p.Beep(),onSuccess:(Z)=>p.NextFrame({state:{...X,value:J==="."?`${Z}.`:`${Z}`,error:_()}})})}var rf={cursor:0,value:"",error:_()};function XZ8(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L(cf),NextFrame:({state:Y})=>ff(Y,X),Submit:()=>nf(J,X)})}}function JZ8(X){return(J,Z)=>{switch(J.key.name){case"backspace":return of(Z);case"k":case"up":return L(p.NextFrame({state:{...Z,value:Z.value===""||Z.value==="-"?`${X.incrementBy}`:`${Number.parseInt(Z.value)+X.incrementBy}`,error:_()}}));case"j":case"down":return L(p.NextFrame({state:{...Z,value:Z.value===""||Z.value==="-"?`-${X.decrementBy}`:`${Number.parseInt(Z.value)-X.decrementBy}`,error:_()}}));case"enter":case"return":return M6(mf(Z.value),{onFailure:()=>L(p.NextFrame({state:{...Z,error:D("Must provide an integer value")}})),onSuccess:(Y)=>q5(X.validate(Y),{onFailure:($)=>p.NextFrame({state:{...Z,error:D($)}}),onSuccess:($)=>p.Submit({value:$})})});default:{let Y=i(J.input,()=>"");return t18(Z,Y)}}}}var zG=(X)=>{let J={min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY,incrementBy:1,decrementBy:1,validate:(Z)=>{if(Z<J.min)return x(`${Z} must be greater than or equal to ${J.min}`);if(Z>J.max)return x(`${Z} must be less than or equal to ${J.max}`);return L(Z)},...X};return u9(rf,{render:XZ8(J),process:JZ8(J),clear:uf(J)})};function ZZ8(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L(cf),NextFrame:({state:Y})=>ff(Y,X),Submit:()=>nf(J,X)})}}function YZ8(X){return(J,Z)=>{switch(J.key.name){case"backspace":return of(Z);case"k":case"up":return L(p.NextFrame({state:{...Z,value:Z.value===""||Z.value==="-"?`${X.incrementBy}`:`${Number.parseFloat(Z.value)+X.incrementBy}`,error:_()}}));case"j":case"down":return L(p.NextFrame({state:{...Z,value:Z.value===""||Z.value==="-"?`-${X.decrementBy}`:`${Number.parseFloat(Z.value)-X.decrementBy}`,error:_()}}));case"enter":case"return":return M6(df(Z.value),{onFailure:()=>L(p.NextFrame({state:{...Z,error:D("Must provide a floating point value")}})),onSuccess:(Y)=>R(V8(()=>KE(Y,X.precision)),($)=>q5(X.validate($),{onFailure:(Q)=>p.NextFrame({state:{...Z,error:D(Q)}}),onSuccess:(Q)=>p.Submit({value:Q})}))});default:{let Y=i(J.input,()=>"");return e18(Z,Y)}}}}var lf=(X)=>{let J={min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY,incrementBy:1,decrementBy:1,precision:2,validate:(Z)=>{if(Z<J.min)return x(`${Z} must be greater than or equal to ${J.min}`);if(Z>J.max)return x(`${Z} must be less than or equal to ${J.max}`);return L(Z)},...X};return u9(rf,{render:ZZ8(J),process:YZ8(J),clear:uf(J)})};var $Z8=u8(P5,{style:"pretty"}),QZ8=/\r?\n/;function af(X,J,Z){let Y=(Q)=>d(e(Q),d6),$=j(X,b8);return $4(Z.message.split(QZ8),{onEmpty:()=>V9([$,J]),onNonEmpty:(Q)=>{let G=r(Q,(H)=>Y(H));return $.pipe(j(d9(s0(G),2)),j(b8),j(J),j(b8))}})}function GZ8(X,J,Z,Y,$){let Q=b8;if(Y===Z.startIndex&&Z.startIndex>0)Q=$.arrowUp;else if(Y===Z.endIndex-1&&Z.endIndex<J.length)Q=$.arrowDown;if(J[Y].disabled){let G=c6(d6,B0);return X===Y?$.pointer.pipe(d(G),j(Q)):Q.pipe(j(b8))}return X===Y?$.pointer.pipe(d(V6),j(Q)):Q.pipe(j(b8))}function HZ8(X,J){let Z=e(X.title);if(J)return X.disabled?d(Z,c6(y4,B0)):d(Z,c6(y4,V6));return X.disabled?d(Z,c6(Zp,B0)):Z}function KZ8(X,J){if(!X.disabled&&X.description&&J)return mH("-").pipe(j(b8),j(e(X.description)),d(B0));return c8}function BZ8(X,J,Z){let Y=J.choices,$=Yz(X,Y.length,J.maxPerPage),Q=[];for(let G=$.startIndex;G<$.endIndex;G++){let H=Y[G],K=X===G,V=GZ8(X,Y,$,G,Z),W=HZ8(H,K),N=KZ8(H,K);Q.push(V.pipe(j(W),j(b8),j(N)))}return s0(Q)}function VZ8(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=BZ8(X,J,$),G=d(e("?"),V6),H=d($.pointerSmall,B0),K=af(G,H,J);return VJ.pipe(j(K),j(n0),j(Q),u8({style:"pretty",options:{lineWidth:Y}}))})}function WZ8(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=e(J.choices[X].title),G=d($.tick,g9),H=d($.ellipsis,B0);return af(G,H,J).pipe(j(b8),j(d(Q,x1)),j(n0),u8({style:"pretty",options:{lineWidth:Y}}))})}function UZ8(X,J){if(X===0)return L(p.NextFrame({state:J.length-1}));return L(p.NextFrame({state:X-1}))}function NZ8(X,J){if(X===J.length-1)return L(p.NextFrame({state:0}));return L(p.NextFrame({state:X+1}))}function zZ8(X,J){return L(p.NextFrame({state:(X+1)%J.length}))}function qZ8(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L($Z8),NextFrame:({state:Y})=>VZ8(Y,X),Submit:()=>WZ8(J,X)})}}function OZ8(X){return _8(function*(){let Z=yield*(yield*J0).columns,Y=j(M5,a7),$=`
`.repeat(Math.min(X.choices.length,X.maxPerPage))+X.message;return J4($,Z).pipe(j(Y),C0(j0),u8({style:"pretty",options:{lineWidth:Z}}))})}function DZ8(X){return(J,Z)=>{switch(J.key.name){case"k":case"up":return UZ8(Z,X.choices);case"j":case"down":return NZ8(Z,X.choices);case"tab":return zZ8(Z,X.choices);case"enter":case"return":{let Y=X.choices[Z];if(Y.disabled)return L(p.Beep());return L(p.Submit({value:Y.value}))}default:return L(p.Beep())}}}var W7=(X)=>{let J={maxPerPage:10,...X},Z=0,Y=-1;for(let $=0;$<J.choices.length;$++)if(J.choices[$].selected===!0){if(Y!==-1)throw Error("InvalidArgumentException: only a single choice can be selected by default for Prompt.select");Y=$}if(Y!==-1)Z=Y;return u9(Z,{render:qZ8(J),process:DZ8(J),clear:()=>OZ8(J)})};function HM(X,J){return X.value.length>0?X.value:J.default}var AZ8=u8(P5,{style:"pretty"});function _Z8(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=j(M5,a7),Q=n(X.error,{onNone:()=>c8,onSome:(H)=>HG(WG(H,Y)).pipe(j(J4(`
${H}`,Y)))}),G=J4(J.message,Y);return Q.pipe(j(G),j($),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function sf(X,J,Z){let Y=HM(X,J),$=n(X.error,{onNone:()=>{if(Z)return x1;if(X.value.length===0)return B0;return c6(y4,V6)},onSome:()=>H7});switch(J.type){case"hidden":return c8;case"password":return d(e("*".repeat(Y.length)),$);case"text":return d(e(Y),$)}}function wZ8(X,J){return n(X.error,{onNone:()=>c8,onSome:(Z)=>$4(Z.split(/\r?\n/),{onEmpty:()=>c8,onNonEmpty:(Y)=>{let $=(H)=>e(H).pipe(d(c6(XG,H7))),Q=j(d(J,H7),b8),G=r(Y,(H)=>$(H));return KG.pipe(j(n0),j(Q),j(dY(s0(G))),j(BG))}})})}function tf(X,J,Z,Y,$=!1){let Q=(K)=>d(e(K),d6),G=Y.message.split(/\r?\n/),H=j(J,b8);if(Q8(G)){let K=r(G,(V)=>Q(V));return H.pipe(j(d9(s0(K),2)),j(b8),j(Z),j(b8),j(sf(X,Y,$)))}return V9([H,Z,sf(X,Y,$)])}function LZ8(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d(e("?"),V6),G=d($.pointerSmall,B0),H=tf(X,Q,G,J),K=wZ8(X,$.pointerSmall),V=X.cursor-X.value.length;return H.pipe(j(K),j(ep(V)),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function TZ8(X,J){return _8(function*(){let Y=yield*(yield*J0).columns,$=yield*u6,Q=d($.tick,g9),G=d($.ellipsis,B0);return tf(X,Q,G,J,!0).pipe(j(n0),C0(j0),u8({style:"pretty",options:{lineWidth:Y}}))})}function PZ8(X){if(X.cursor<=0)return L(p.Beep());let J=X.value.slice(0,X.cursor-1),Z=X.value.slice(X.cursor),Y=X.cursor-1,$=`${J}${Z}`;return L(p.NextFrame({state:{...X,cursor:Y,value:$,error:_()}}))}function MZ8(X){if(X.cursor<=0)return L(p.Beep());let J=X.cursor-1;return L(p.NextFrame({state:{...X,cursor:J,error:_()}}))}function FZ8(X){if(X.cursor>=X.value.length)return L(p.Beep());let J=Math.min(X.cursor+1,X.value.length);return L(p.NextFrame({state:{...X,cursor:J,error:_()}}))}function RZ8(X,J){if(X.value===J.default)return L(p.Beep());let Z=HM(X,J),Y=Z.length;return L(p.NextFrame({state:{...X,value:Z,cursor:Y,error:_()}}))}function jZ8(X,J){let Z=J.value.slice(0,J.cursor),Y=J.value.slice(J.cursor),$=`${Z}${X}${Y}`,Q=J.cursor+X.length;return L(p.NextFrame({state:{...J,cursor:Q,value:$,error:_()}}))}var CZ8={cursor:0,value:"",error:_()};function EZ8(X){return(J,Z)=>{return p.$match(Z,{Beep:()=>L(AZ8),NextFrame:({state:Y})=>LZ8(Y,X),Submit:()=>TZ8(J,X)})}}function IZ8(X){return(J,Z)=>{switch(J.key.name){case"backspace":return PZ8(Z);case"left":return MZ8(Z);case"right":return FZ8(Z);case"enter":case"return":{let Y=HM(Z,X);return q5(X.validate(Y),{onFailure:($)=>p.NextFrame({state:{...Z,value:Y,error:D($)}}),onSuccess:($)=>p.Submit({value:$})})}case"tab":return RZ8(Z,X);default:{let Y=i(J.input,()=>"");return jZ8(Y,Z)}}}}function SZ8(X){return(J,Z)=>{return _Z8(J,X)}}function ef(X,J){let Z={default:"",type:J,validate:L,...X};return u9(CZ8,{render:EZ8(Z),process:IZ8(Z),clear:SZ8(Z)})}var KM=(X)=>ef(X,"hidden").pipe(NJ(ON));var Gz=(X)=>ef(X,"text");var vZ8=u8(P5,{style:"pretty"});function kZ8(X){return _8(function*(){let Z=yield*(yield*J0).columns,Y=j(M5,a7);return J4(X.message,Z).pipe(j(Y),C0(j0),u8({style:"pretty",options:{lineWidth:Z}}))})}function Yn(X,J,Z=!1){let Y=d(mH("/"),B0),$=c6(y4,Z?x1:V6),Q=X?e(J.inactive):d(e(J.inactive),$),G=X?d(e(J.active),$):e(J.active);return V9([G,Y,Q])}function $n(X,J,Z,Y){let $=(H)=>d(e(H),d6),Q=Y.message.split(/\r?\n/),G=j(J,b8);if(Q8(Q)){let H=r(Q,(K)=>$(K));return G.pipe(j(d9(s0(H),2)),j(b8),j(Z),j(b8),j(X))}return V9([G,Z,X])}function xZ8(X,J){return _8(function*(){let Z=yield*J0,Y=yield*u6,$=yield*Z.columns,Q=d(e("?"),V6),G=d(Y.pointerSmall,B0),H=Yn(X,J),K=$n(H,Q,G,J);return VJ.pipe(j(K),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}function yZ8(X,J){return _8(function*(){let Z=yield*J0,Y=yield*u6,$=yield*Z.columns,Q=d(Y.tick,g9),G=d(Y.ellipsis,B0),H=Yn(X,J,!0);return $n(H,Q,G,J).pipe(j(n0),C0(j0),u8({style:"pretty",options:{lineWidth:$}}))})}var Jn=L(p.NextFrame({state:!0})),Zn=L(p.NextFrame({state:!1}));function bZ8(X){return(J,Z)=>{switch(Z._tag){case"Beep":return L(vZ8);case"NextFrame":return xZ8(J,X);case"Submit":return yZ8(J,X)}}}function gZ8(X,J){switch(X.key.name){case"0":case"j":case"delete":case"right":case"down":return Zn;case"1":case"k":case"left":case"up":return Jn;case" ":case"tab":return J?Zn:Jn;case"enter":case"return":return L(p.Submit({value:J}));default:return L(p.Beep())}}var Hz=(X)=>{let J={initial:!1,active:"on",inactive:"off",...X};return u9(J.initial,{render:bZ8(J),process:gZ8,clear:()=>kZ8(J)})};var hZ8="@effect/cli/Primitive",Gn=Symbol.for(hZ8),Hn={[Gn]:{_A:(X)=>X},pipe(){return C(this,arguments)}},mZ8=(X)=>typeof X==="object"&&X!=null&&(Gn in X),Kz=(X)=>mZ8(X)&&dZ8(X),dZ8=(X)=>X._tag==="Bool";var cZ8=m6("true","1","y","yes","on"),BM=vQ(cZ8),uZ8=m6("false","0","n","no","off"),VM=vQ(uZ8),Bz=(X)=>{let J=Object.create(Hn);return J._tag="Bool",J.defaultValue=X,J},WM=(X)=>{let J=Object.create(Hn);return J._tag="Choice",J.alternatives=X,J};var fH=(X)=>pZ8(X),Vz=(X)=>fZ8(X),nH=(X)=>oY(X),OG=B(3,(X,J,Z)=>nZ8(X,J,Z)),Wz=B(2,(X,J)=>lZ8(X,J)),pZ8=(X)=>{switch(X._tag){case"Bool":return D("true | false");case"Choice":{let J=U(r(X.alternatives,([Z])=>Z),F8(" | "));return D(J)}case"DateTime":return D("date");case"Float":case"Integer":case"Path":case"Redacted":case"Secret":case"Text":return _()}},fZ8=(X)=>{switch(X._tag){case"Bool":return L8("A true or false value.");case"Choice":{let J=U(r(X.alternatives,([Z])=>Z),F8(", "));return L8(`One of the following: ${J}`)}case"DateTime":return L8("A date without a time-zone in the ISO-8601 format, such as 2007-12-03T10:15:30.");case"Float":return L8("A floating point number.");case"Integer":return L8("An integer.");case"Path":{if(X.pathType==="either"&&X.pathExists==="yes")return L8("An existing file or directory.");if(X.pathType==="file"&&X.pathExists==="yes")return L8("An existing file.");if(X.pathType==="directory"&&X.pathExists==="yes")return L8("An existing directory.");if(X.pathType==="either"&&X.pathExists==="no")return L8("A file or directory that must not exist.");if(X.pathType==="file"&&X.pathExists==="no")return L8("A file that must not exist.");if(X.pathType==="directory"&&X.pathExists==="no")return L8("A directory that must not exist.");if(X.pathType==="either"&&X.pathExists==="either")return L8("A file or directory.");if(X.pathType==="file"&&X.pathExists==="either")return L8("A file.");if(X.pathType==="directory"&&X.pathExists==="either")return L8("A directory.");throw Error(`[BUG]: Path.help - encountered invalid combination of path type ('${X.pathType}') and path existence ('${X.pathExists}')`)}case"Secret":case"Redacted":return L8("A user-defined piece of text that is confidential.");case"Text":return L8("A user-defined piece of text.")}},oY=(X)=>{switch(X._tag){case"Bool":return"boolean";case"Choice":return"choice";case"DateTime":return"date";case"Float":return"float";case"Integer":return"integer";case"Path":{if(X.pathType==="either")return"path";return X.pathType}case"Redacted":return"redacted";case"Secret":return"secret";case"Text":return"text"}},nZ8=(X,J,Z)=>{switch(X._tag){case"Bool":return q0(J,(Y)=>X4(Z,Y)).pipe(n({onNone:()=>NY(X.defaultValue,()=>"Missing default value for boolean parameter"),onSome:(Y)=>BM(Y)?L(!0):VM(Y)?L(!1):x(`Unable to recognize '${Y}' as a valid boolean`)}));case"Choice":return NY(J,()=>"Choice options to not have a default value").pipe(R((Y)=>z$(X.alternatives,([$])=>$===Y)),v9({onFailure:()=>{return`Expected one of the following cases: ${U(r(X.alternatives,([$])=>$),F8(", "))}`},onSuccess:([,Y])=>Y}));case"DateTime":return qG(J,oY(X),r7(sT));case"Float":return qG(J,oY(X),r7(xY));case"Integer":{let Y=Ku(xY,PH);return qG(J,oY(X),r7(Y))}case"Path":return R(l7,(Y)=>{return NY(J,()=>"Path options do not have a default value").pipe(X0((Q)=>d0(Y.exists(Q)).pipe(X0((G)=>oZ8(Q,X.pathExists,G).pipe(B8(rZ8(Q,X.pathType,Y).pipe(J7(()=>X.pathExists!=="no"&&G))))))))});case"Redacted":return qG(J,oY(X),r7(k4)).pipe(k((Y)=>ON(Y)));case"Secret":return qG(J,oY(X),r7(k4)).pipe(k((Y)=>Wf(Y)));case"Text":return qG(J,oY(X),r7(k4))}},qG=(X,J,Z)=>NY(X,()=>`${J} options do not have a default value`).pipe(R((Y)=>NY(Z(Y),()=>`'${Y}' is not a ${J}`))),oZ8=(X,J,Z)=>{if(J==="no"&&Z)return x(`Path '${X}' must not exist`);if(J==="yes"&&!Z)return x(`Path '${X}' must exist`);return o},rZ8=(X,J,Z)=>{switch(J){case"file":{let Y=Z.stat(X).pipe(k(($)=>$.type==="File"),d0);return x(`Expected path '${X}' to be a regular file`).pipe(lW(Y),J9)}case"directory":{let Y=Z.stat(X).pipe(k(($)=>$.type==="Directory"),d0);return x(`Expected path '${X}' to be a directory`).pipe(lW(Y),J9)}case"either":return o}},lZ8=(X,J)=>{switch(X._tag){case"Bool":{let Z=m("Select true or false"),Y=U8(J,Z),$=i(X.defaultValue,()=>!1);return Hz({message:n8(Y).trimEnd(),initial:$,active:"true",inactive:"false"}).pipe(NJ((Q)=>`${Q}`))}case"Choice":{let Z=m("Select one of the following choices"),Y=U8(J,Z);return W7({message:n8(Y).trimEnd(),choices:r(X.alternatives,([$])=>({title:$,value:$}))})}case"DateTime":{let Z=m("Enter a date"),Y=U8(J,Z);return Ff({message:n8(Y).trimEnd()}).pipe(NJ(($)=>$.toISOString()))}case"Float":{let Z=m("Enter a floating point value"),Y=U8(J,Z);return lf({message:n8(Y).trimEnd()}).pipe(NJ(($)=>`${$}`))}case"Integer":{let Z=m("Enter an integer"),Y=U8(J,Z);return zG({message:n8(Y).trimEnd()}).pipe(NJ(($)=>`${$}`))}case"Path":{let Z=m("Select a file system path"),Y=U8(J,Z);return gf({type:X.pathType,message:n8(Y).trimEnd()})}case"Redacted":{let Z=m("Enter some text (value will be redacted)"),Y=U8(J,Z);return KM({message:n8(Y).trimEnd()})}case"Secret":{let Z=m("Enter some text (value will be redacted)"),Y=U8(J,Z);return KM({message:n8(Y).trimEnd()})}case"Text":{let Z=m("Enter some text"),Y=U8(J,Z);return Gz({message:n8(Y).trimEnd()})}}},Kn=(X)=>{switch(X._tag){case"Bool":return'"${cur}"';case"DateTime":case"Float":case"Integer":case"Secret":case"Redacted":case"Text":return'$(compgen -f "${cur}")';case"Path":switch(X.pathType){case"file":return X.pathExists==="yes"||X.pathExists==="either"?'$(compgen -f "${cur}")':"";case"directory":return X.pathExists==="yes"||X.pathExists==="either"?'$(compgen -d "${cur}")':"";case"either":return X.pathExists==="yes"||X.pathExists==="either"?'$(compgen -f "${cur}")':""}case"Choice":return`$(compgen -W "${U(r(X.alternatives,([Z])=>Z),F8(","))}" -- "\${cur}")`}},Uz=(X)=>{switch(X._tag){case"Bool":return t();case"DateTime":case"Float":case"Integer":case"Redacted":case"Secret":case"Text":return x0("-r","-f");case"Path":switch(X.pathType){case"file":return X.pathExists==="yes"||X.pathExists==="either"?x0("-r","-F"):x0("-r");case"directory":return X.pathExists==="yes"||X.pathExists==="either"?x0("-r","-f","-a",'"(__fish_complete_directories (commandline -ct))"'):x0("-r");case"either":return X.pathExists==="yes"||X.pathExists==="either"?x0("-r","-F"):x0("-r")}case"Choice":{let J=U(r(X.alternatives,([Z])=>`${Z}''`),F8(","));return x0("-r","-f","-a",`"{${J}}"`)}}},Nz=(X)=>{switch(X._tag){case"Bool":return"";case"Choice":return`:CHOICE:(${U(r(X.alternatives,([Z])=>Z),F8(" "))})`;case"DateTime":return"";case"Float":return"";case"Integer":return"";case"Path":switch(X.pathType){case"file":return X.pathExists==="yes"||X.pathExists==="either"?":PATH:_files":"";case"directory":return X.pathExists==="yes"||X.pathExists==="either"?":PATH:_files -/":"";case"either":return X.pathExists==="yes"||X.pathExists==="either"?":PATH:_files":""}case"Redacted":case"Secret":case"Text":return""}};var zJ={_tag:"Empty"},UM={_tag:"Empty"},u1=(X,J)=>({_tag:"Named",names:X,acceptedValues:J}),oH=(X)=>({_tag:"Optional",usage:X}),rH=(X)=>({_tag:"Repeated",usage:X}),NM=B(2,(X,J)=>({_tag:"Alternation",left:X,right:J})),$X=B(2,(X,J)=>({_tag:"Concat",left:X,right:J})),zz=(X)=>{let J=zM(X,eN);if(Q8(J)){let Z=a8(J),Y=N6(J);if(Q8(Y))return U(r(J,($)=>m($)),t9(V0,($,Q)=>U8($,Q)));return m(Z)}return V0},zM=B(2,(X,J)=>YX(rY(X,J),J)),rY=(X,J)=>{switch(X._tag){case"Empty":return zJ;case"Mixed":return UM;case"Named":{if(p8(Q4(YX(X,J))))return zJ;return X}case"Optional":{if(X.usage._tag==="Empty")return zJ;let Z=rY(X.usage,J);return Z._tag==="Empty"?zJ:Z._tag==="Optional"?Z:oH(Z)}case"Repeated":{let Z=rY(X.usage,J);return Z._tag==="Empty"?zJ:rH(Z)}case"Alternation":{let Z=rY(X.left,J),Y=rY(X.right,J);return Z._tag==="Empty"?Y:Y._tag==="Empty"?Z:NM(Z,Y)}case"Concat":{let Z=rY(X.left,J),Y=rY(X.right,J);return Z._tag==="Empty"?Y:Y._tag==="Empty"?Z:$X(Z,Y)}}},YX=(X,J)=>{switch(X._tag){case"Empty":return a(L8(""));case"Mixed":return a(L8("<command>"));case"Named":{let Z=J.showTypes?n(X.acceptedValues,{onNone:()=>c9,onSome:(Q)=>e6(W9,L8(Q))}):c9,Y=J.showAllNames?X.names:X.names.length>1?U(GZ(X.names,(Q)=>Q.startsWith("--")),Q4,q0(a),i(()=>X.names)):X.names,$=L8(F8(Y,", "));return J.showAllNames&&X.names.length>1?a(U9([L8("("),$,Z,L8(")")])):a(e6($,Z))}case"Optional":return r(YX(X.usage,J),(Z)=>U9([L8("["),Z,L8("]")]));case"Repeated":return r(YX(X.usage,J),(Z)=>e6(Z,L8("...")));case"Alternation":{if(X.left._tag==="Repeated"||X.right._tag==="Repeated"||X.left._tag==="Concat"||X.right._tag==="Concat")return O8(YX(X.left,J),YX(X.right,J));return J6(YX(X.left,J),(Z)=>r(YX(X.right,J),(Y)=>U9([Z,L8("|"),Y])))}case"Concat":{let Z=YX(X.left,J),Y=YX(X.right,J),$=Q8(Z)&&Q8(Y)?W9:c9;return J6(Z,(Q)=>r(Y,(G)=>U9([Q,$,G])))}}};var qM=Symbol.for("@effect/cli/ValidationError"),U7={[qM]:qM},DG=(X)=>typeof X==="object"&&X!=null&&(qM in X),OM=(X)=>X._tag==="CommandMismatch";var Vn=(X)=>X._tag==="HelpRequested";var DM=(X)=>X._tag==="MultipleValuesDetected";var AM=(X)=>X._tag==="MissingValue";var lY=(X)=>{let J=Object.create(U7);return J._tag="CommandMismatch",J.error=X,J},Wn=(X)=>{let J=Object.create(U7);return J._tag="CorrectedFlag",J.error=X,J},p1=(X)=>{let J=Object.create(U7);return J._tag="InvalidArgument",J.error=X,J},N9=(X)=>{let J=Object.create(U7);return J._tag="InvalidValue",J.error=X,J},_M=(X)=>{let J=Object.create(U7);return J._tag="MissingFlag",J.error=X,J},QX=(X)=>{let J=Object.create(U7);return J._tag="MissingValue",J.error=X,J};var Un=(X,J)=>{let Z=Object.create(U7);return Z._tag="MultipleValuesDetected",Z.error=X,Z.values=J,Z},Nn=(X)=>{let J=Object.create(U7);return J._tag="NoBuiltInMatch",J.error=X,J},wM=(X,J,Z)=>{let Y=Object.create(U7);return Y._tag="UnclusteredFlag",Y.error=X,Y.unclustered=J,Y.rest=Z,Y};var ZY8="@effect/cli/Args",qn=Symbol.for(ZY8),LM={[qn]:{_A:(X)=>X},pipe(){return C(this,arguments)}},TM=(X)=>typeof X==="object"&&X!=null&&(qn in X);var On=(X)=>X._tag==="Empty";var Dn=function(){if(arguments.length===1)if(TM(arguments[0]))return LG(arguments[0],(X)=>[X]);else if(zX(arguments[0]))return zn(arguments[0]);else{let X=Object.entries(arguments[0]),J=LG(X[0][1],(Y)=>({[X[0][0]]:Y}));if(X.length===1)return J;let Z=X.slice(1);for(let[Y,$]of Z)J=LG(Tn(J,$),([Q,G])=>({...Q,[Y]:G}));return J}return zn(arguments[0])};var Dz=(()=>{let X=Object.create(LM);return X._tag="Empty",X})();var An=(X)=>N7(X);var _n=(X)=>AG(X),LG=B(2,(X,J)=>YY8(X,(Z)=>L(J(Z)))),YY8=B(2,(X,J)=>$Y8(X,J));var wn=B(3,(X,J,Z)=>z7(X,J,Z));var Ln=B(2,(X,J)=>iY(X,J)),zn=(X)=>{if(X.length===0)return Dz;if(X.length===1)return LG(X[0],(Z)=>[Z]);let J=LG(X[0],(Z)=>[Z]);for(let Z=1;Z<X.length;Z++){let Y=X[Z];J=LG(Tn(J,Y),([$,Q])=>[...$,Q])}return J},N7=(X)=>{switch(X._tag){case"Empty":return V0;case"Single":return c1([[Gf(X.name),U8(m(Vz(X.primitiveType)),X.description)]]);case"Map":return N7(X.args);case"Both":return U8(N7(X.left),N7(X.right));case"Variadic":{let J=N7(X.args);return XX(J,(Z,Y)=>{let $=_G(X),Q=wG(X),G=L8(H8(X.max)?` ${$} - ${Q}`:$===0?"...":` ${$}+`),H=m(H8(X.max)?`This argument must be repeated at least ${$} times and may be repeated up to ${Q} times.`:$===0?"This argument may be repeated zero or more times.":`This argument must be repeated at least ${$} times.`);return[e6(Z,G),U8(Y,H)]})}case"WithDefault":return XX(N7(X.args),(J,Z)=>{let Y=U$(X.fallback)?n(X.fallback,{onNone:()=>m("This setting is optional."),onSome:($)=>{let Q=t0($)?$:String($),G=O9(Q,0);return m(`This setting is optional. Defaults to: ${G}`)}}):m("This setting is optional.");return[J,U8(Z,Y)]});case"WithFallbackConfig":return XX(N7(X.args),(J,Z)=>[J,U8(Z,m("This argument can be set from environment variables."))])}};var _G=(X)=>{switch(X._tag){case"Empty":case"WithDefault":case"WithFallbackConfig":return 0;case"Single":return 1;case"Map":return _G(X.args);case"Both":{let J=_G(X.left),Z=_G(X.right);return J+Z}case"Variadic":{let J=_G(X.args);return Math.floor(i(X.min,()=>0)*J)}}},wG=(X)=>{switch(X._tag){case"Empty":return 0;case"Single":return 1;case"Map":case"WithDefault":case"WithFallbackConfig":return wG(X.args);case"Both":{let J=wG(X.left),Z=wG(X.right);return J+Z}case"Variadic":{let J=wG(X.args);return Math.floor(i(X.max,()=>Number.MAX_SAFE_INTEGER/2)*J)}}},AG=(X)=>{switch(X._tag){case"Empty":return zJ;case"Single":return u1(a(X.name),fH(X.primitiveType));case"Map":return AG(X.args);case"Both":return $X(AG(X.left),AG(X.right));case"Variadic":return rH(AG(X.args));case"WithDefault":case"WithFallbackConfig":return oH(AG(X.args))}};var $Y8=(X,J)=>{let Z=Object.create(LM);return Z._tag="Map",Z.args=X,Z.f=J,Z},Tn=(X,J)=>{let Z=Object.create(LM);return Z._tag="Both",Z.left=X,Z.right=J,Z};var z7=(X,J,Z)=>{switch(X._tag){case"Empty":return L([J,void 0]);case"Single":return z8(()=>{return n6(J,{onEmpty:()=>{let Y=fH(X.primitiveType);if(H8(X.pseudoName)&&H8(Y))return x(QX(m(`Missing argument <${X.pseudoName.value}> with choices ${Y.value}`)));if(H8(X.pseudoName))return x(QX(m(`Missing argument <${X.pseudoName.value}>`)));if(H8(Y))return x(QX(m(`Missing argument ${nH(X.primitiveType)} with choices ${Y.value}`)));return x(QX(m(`Missing argument ${nH(X.primitiveType)}`)))},onNonEmpty:(Y,$)=>OG(X.primitiveType,D(Y),Z).pipe(v9({onFailure:(Q)=>p1(m(Q)),onSuccess:(Q)=>[$,Q]}))})});case"Map":return z7(X.args,J,Z).pipe(R(([Y,$])=>M6(X.f($),{onFailure:(Q)=>x(p1(Q)),onSuccess:(Q)=>L([Y,Q])})));case"Both":return z7(X.left,J,Z).pipe(R(([Y,$])=>z7(X.right,Y,Z).pipe(k(([Q,G])=>[Q,[$,G]]))));case"Variadic":{let Y=i(X.min,()=>0),$=i(X.max,()=>Number.MAX_SAFE_INTEGER),Q=(G,H)=>{if(H.length>=$)return L([G,H]);return z7(X.args,G,Z).pipe(M6({onFailure:(K)=>H.length>=Y&&X6(G)?L([G,H]):x(K),onSuccess:([K,V])=>Q(K,y0(H,V))}))};return Q(J,t()).pipe(k(([G,H])=>[G,H]))}case"WithDefault":return z7(X.args,J,Z).pipe(S9("MissingValue",()=>L([J,X.fallback])));case"WithFallbackConfig":return z7(X.args,J,Z).pipe(S9("MissingValue",(Y)=>k(a6(X.config,($)=>{if(kK($)){let Q=m(String($)),G=N9(Q);return x(G)}return x(Y)}),($)=>[J,$])))}};var iY=(X,J)=>{switch(X._tag){case"Empty":return L(t());case"Single":{let Z=N7(X);return Wz(X.primitiveType,Z).pipe(N4(w0()),R((Y)=>{let $=a(Y);return z7(X,$,J).pipe(K6($))}))}case"Map":return iY(X.args,J).pipe(X0((Z)=>z7(X.args,Z,J)));case"Both":return z4(iY(X.left,J),iY(X.right,J),(Z,Y)=>O8(Z,Y)).pipe(X0((Z)=>z7(X,Z,J)));case"Variadic":{let Z=m("How many times should this argument should be repeated?"),Y=U(N7(X),U8(Z));return zG({message:n8(Y).trimEnd(),min:_G(X),max:wG(X)}).pipe(N4(w0()),R(($)=>$<=0?L(t()):v6(t()).pipe(R((Q)=>iY(X.args,J).pipe(R((G)=>l5(Q,O8(G))),u3($-1),B8(k6(Q)),X0((G)=>z7(X,G,J)))))))}case"WithDefault":{let Z=m("This argument is optional - use the default?"),Y=U(N7(X.args),U8(Z));return W7({message:n8(Y).trimEnd(),choices:[{title:`Default ['${JSON.stringify(X.fallback)}']`,value:!0},{title:"Custom",value:!1}]}).pipe(N4(w0()),R(($)=>$?L(t()):iY(X.args,J)))}case"WithFallbackConfig":{let Z=m("Try load this option from the environment?"),Y=U(N7(X.args),U8(Z));return W7({message:n8(Y).trimEnd(),choices:[{title:"Use environment variables",value:!0},{title:"Custom",value:!1}]}).pipe(N4(w0()),R(($)=>$?L(t()):iY(X.args,J)))}}},PM=(X)=>{switch(X._tag){case"Empty":case"Both":return"";case"Single":return t7(B7(X.description));case"Map":case"Variadic":case"WithDefault":case"WithFallbackConfig":return PM(X.args)}},lH=(X)=>{switch(X._tag){case"Empty":return t();case"Single":{let J=PM(X);return U(Uz(X.primitiveType),O8(J.length===0?t():a(`-d '${J}'`)),F8(" "),a)}case"Both":return U(lH(X.left),O8(lH(X.right)));case"Map":case"Variadic":case"WithDefault":case"WithFallbackConfig":return lH(X.args)}},f1=(X,J={multiple:!1,optional:!1})=>{switch(X._tag){case"Empty":return t();case"Single":{let Z=J.multiple?"*":"",Y=J.optional?"::":":",$=PM(X),Q=$.length>0?` -- ${$}`:"",G=Nz(X.primitiveType);return G.length===0?t():a(`${Z}${Y}${X.name}${Q}${G}`)}case"Map":return f1(X.args,J);case"Both":{let Z=f1(X.left,J),Y=f1(X.right,J);return O8(Z,Y)}case"Variadic":return H8(X.max)&&X.max.value>1?f1(X.args,{...J,multiple:!0}):f1(X.args,J);case"WithDefault":case"WithFallbackConfig":return f1(X.args,{...J,optional:!0})}};var Mn=(X,J,Z)=>{if(X.length===0&&J.length===0)return 0;if(X.length===0)return J.length;if(J.length===0)return X.length;let Y=X.length,$=J.length,Q=Array(Y),G=X4(Z,X),H=X4(Z,J);for(let K=0;K<=Y;K++)Q[K]=Array($),Q[K][0]=K;for(let K=0;K<=$;K++)Q[0][K]=K;for(let K=1;K<=Y;K++)for(let V=1;V<=$;V++){let W=G.charAt(K-1)===H.charAt(V-1)?0:1;Q[K][V]=Math.min(Q[K][V-1]+1,Math.min(Q[K-1][V]+1,Q[K-1][V-1]+W))}return Q[Y][$]};var Fn=(X)=>Gz(X).pipe(NJ((J)=>J.split(X.delimiter||",")));var HY8="@effect/cli/Options",MM=Symbol.for(HY8),OJ={[MM]:{_A:(X)=>X},pipe(){return C(this,arguments)}},Tz=(X)=>typeof X==="object"&&X!=null&&(MM in X);var Cn=(X)=>X._tag==="Empty",KY8=(X)=>X._tag==="Single";var DJ=function(){if(arguments.length===1)if(Tz(arguments[0]))return O7(arguments[0],(X)=>[X]);else if(zX(arguments[0]))return Rn(arguments[0]);else{let X=Object.entries(arguments[0]),J=O7(X[0][1],(Y)=>({[X[0][0]]:Y}));if(X.length===1)return J;let Z=X.slice(1);for(let[Y,$]of Z)J=O7(EM(J,$),([Q,G])=>({...Q,[Y]:G}));return J}return Rn(arguments[0])},BY8={ifPresent:!0,negationNames:[],aliases:[]},sH=(X,J)=>{let{aliases:Z,ifPresent:Y,negationNames:$}={...BY8,...J},Q=aH(X,Z,Bz(D(Y)));if(Q8($)){let G=a8($),H=N6($),K=aH(G,H,Bz(D(!Y)));return _z(En(Q,K),!Y)}return _z(Q,!Y)};var Pz=(X,J)=>aH(X,t(),WM(J));var tH=(()=>{let X=Object.create(OJ);return X._tag="Empty",X})();var FM=(X)=>n9(X);var RM=(X)=>GX(X),O7=B(2,(X,J)=>vn(X,(Z)=>Z8(J(Z))));var Mz=(X)=>_z(O7(X,D),_()),En=B(2,(X,J)=>In(X,J).pipe(O7(V$))),In=B(2,(X,J)=>kn(X,J));var Fz=B(3,(X,J,Z)=>yn(J,Az(X),Z).pipe(R(([Y,$,Q])=>f9(X,Q,Z).pipe(a6((G)=>n(Y,{onNone:()=>x(G),onSome:(H)=>x(H)})),k((G)=>[Y,$,G])))));var jM=B(2,(X,J)=>qJ(X,(Z)=>{let Y=y0(Z.aliases,J);return aH(Z.name,Y,Z.primitiveType,Z.description,Z.pseudoName)})),_z=B(2,(X,J)=>xn(X,J));var aY=B(2,(X,J)=>qJ(X,(Z)=>{let Y=U8(Z.description,m(J));return aH(Z.name,Z.aliases,Z.primitiveType,Y,Z.pseudoName)}));var CM=B(2,(X,J)=>q7(X,J)),Rn=(X)=>{if(X.length===0)return tH;if(X.length===1)return O7(X[0],(Z)=>[Z]);let J=O7(X[0],(Z)=>[Z]);for(let Z=1;Z<X.length;Z++){let Y=X[Z];J=O7(EM(J,Y),([$,Q])=>[...$,Q])}return J},n9=(X)=>{switch(X._tag){case"Empty":return V0;case"Single":return c1(a([B7(zz(GX(X))),U8(m(Vz(X.primitiveType)),X.description)]));case"KeyValueMap":{let J=cG(KX(X.argumentOption));return XX(n9(X.argumentOption),(Z,Y)=>{let $=m("This setting is a property argument which:"),Q=`${J} key1=value key2=value2`,G=`${J} key1=value ${J} key2=value2`,H=cH([m(`May be specified a single time:  '${Q}'`),m(`May be specified multiple times: '${G}'`)]),K=U(Y,U8($),U8(H));return[Z,K]})}case"Map":return n9(X.options);case"Both":case"OrElse":return U8(n9(X.left),n9(X.right));case"Variadic":{let J=n9(X.argumentOption);return XX(J,(Z,Y)=>{let $=n1(X),Q=o1(X),G=L8(H8(X.max)?` ${$} - ${Q}`:$===0?"...":` ${$}+`),H=m(H8(X.max)?`This option must be repeated at least ${$} times and may be repeated up to ${Q} times.`:$===0?"This option may be repeated zero or more times.":`This option must be repeated at least ${$} times.`);return[e6(Z,G),U8(Y,H)]})}case"WithDefault":return XX(n9(X.options),(J,Z)=>{let Y=U$(X.fallback)?n(X.fallback,{onNone:()=>m("This setting is optional."),onSome:($)=>{let Q=t0($)?$:String($),G=O9(Q,0);return m(`This setting is optional. Defaults to: ${G}`)}}):m("This setting is optional.");return[J,U8(Z,Y)]});case"WithFallback":{let J=hc(X.effect)?m("This option can be set from environment variables."):aP(X.effect)?m("Will prompt the user for input if this option is not provided."):V0;return XX(n9(X.options),(Z,Y)=>[Z,U8(Y,J)])}}},KX=(X)=>{switch(X._tag){case"Empty":return _();case"Single":return D(X.fullName);case"Both":case"OrElse":{let J=RJ([KX(X.left),KX(X.right)]);return $4(J,{onEmpty:()=>_(),onNonEmpty:(Z)=>D(F8(Z,", "))})}case"KeyValueMap":case"Variadic":return KX(X.argumentOption);case"Map":case"WithFallback":case"WithDefault":return KX(X.options)}},n1=(X)=>{switch(X._tag){case"Empty":case"WithDefault":case"WithFallback":return 0;case"Single":case"KeyValueMap":return 1;case"Map":return n1(X.options);case"Both":{let J=n1(X.left),Z=n1(X.right);return J+Z}case"OrElse":{let J=n1(X.left),Z=n1(X.right);return Math.min(J,Z)}case"Variadic":{let J=i(X.min,()=>0),Z=n1(X.argumentOption);return J*Z}}},o1=(X)=>{switch(X._tag){case"Empty":return 0;case"Single":return 1;case"KeyValueMap":return Number.MAX_SAFE_INTEGER;case"Map":case"WithDefault":case"WithFallback":return o1(X.options);case"Both":{let J=o1(X.left),Z=o1(X.right);return J+Z}case"OrElse":{let J=o1(X.left),Z=o1(X.right);return Math.min(J,Z)}case"Variadic":{let J=i(X.max,()=>Number.MAX_SAFE_INTEGER/2),Z=o1(X.argumentOption);return Math.floor(J*Z)}}},GX=(X)=>{switch(X._tag){case"Empty":return zJ;case"Single":{let J=Kz(X.primitiveType)?_():c4(fH(X.primitiveType),()=>D(X.placeholder));return u1(o9(X),J)}case"KeyValueMap":return GX(X.argumentOption);case"Map":return GX(X.options);case"Both":return $X(GX(X.left),GX(X.right));case"OrElse":return NM(GX(X.left),GX(X.right));case"Variadic":return rH(GX(X.argumentOption));case"WithDefault":case"WithFallback":return oH(GX(X.options))}},wz=(X)=>{switch(X._tag){case"Single":return Kz(X.primitiveType);case"Map":return wz(X.options);case"WithDefault":return wz(X.options);default:return!1}},EM=(X,J)=>{let Z=Object.create(OJ);return Z._tag="Both",Z.left=X,Z.right=J,Z},Sn=(X)=>X.length===1?[!0,`-${X}`]:[!1,`--${X}`],VY8=(X)=>{let J=Object.create(OJ);return J._tag="KeyValueMap",J.argumentOption=X,J},vn=(X,J)=>{let Z=Object.create(OJ);return Z._tag="Map",Z.options=X,Z.f=J,Z},kn=(X,J)=>{let Z=Object.create(OJ);return Z._tag="OrElse",Z.left=X,Z.right=J,Z},aH=(X,J,Z,Y=V0,$=_())=>{let Q=Object.create(OJ);return Q._tag="Single",Q.name=X,Q.fullName=Sn(X)[1],Q.placeholder=`${i($,()=>nH(Z))}`,Q.aliases=J,Q.primitiveType=Z,Q.description=Y,Q.pseudoName=$,Q},WY8=(X,J,Z)=>{if(!KY8(X))throw Error("InvalidArgumentException: only single options can be variadic");let Y=Object.create(OJ);return Y._tag="Variadic",Y.argumentOption=X,Y.min=J,Y.max=Z,Y},xn=(X,J)=>{let Z=Object.create(OJ);return Z._tag="WithDefault",Z.options=X,Z.fallback=J,Z},UY8=(X,J)=>{let Z=Object.create(OJ);return Z._tag="WithFallback",Z.options=X,Z.effect=J,Z},qJ=(X,J)=>{switch(X._tag){case"Empty":return tH;case"Single":return J(X);case"KeyValueMap":return VY8(J(X.argumentOption));case"Map":return vn(qJ(X.options,J),X.f);case"Both":return EM(qJ(X.left,J),qJ(X.right,J));case"OrElse":return kn(qJ(X.left,J),qJ(X.right,J));case"Variadic":return WY8(J(X.argumentOption),X.min,X.max);case"WithDefault":return xn(qJ(X.options,J),X.fallback);case"WithFallback":return UY8(qJ(X.options,J),X.effect)}},o9=(X)=>{let J=(Y)=>{switch(Y._tag){case"Empty":return t();case"Single":return u4(Y.aliases,Y.name);case"KeyValueMap":case"Variadic":return J(Y.argumentOption);case"Map":case"WithDefault":case"WithFallback":return J(Y.options);case"Both":case"OrElse":{let $=J(Y.left),Q=J(Y.right);return O8($,Q)}}},Z=YZ(qq,(Y)=>!Y[0]);return U(J(X),r((Y)=>Sn(Y)),p4(Z),r((Y)=>Y[1]))},Az=(X)=>{switch(X._tag){case"Empty":return t();case"Single":case"KeyValueMap":case"Variadic":return a(X);case"Map":case"WithDefault":case"WithFallback":return Az(X.options);case"Both":case"OrElse":return O8(Az(X.left),Az(X.right))}},NY8=/=(.*)/,f9=(X,J,Z)=>{switch(X._tag){case"Empty":return o;case"Single":{let Y=v5(o9(X),(Q)=>zZ(J,Q));if(Q8(Y)){let Q=a8(Y),G=N6(Y);if(X6(G)){if(X6(Q))return OG(X.primitiveType,_(),Z).pipe(s6((K)=>N9(m(K))));if(Q8(Q)&&X6(N6(Q))){let K=a8(Q);return OG(X.primitiveType,D(K),Z).pipe(s6((V)=>N9(m(V))))}return x(Un(V0,Q))}let H=m(`More than one reference to option '${X.fullName}' detected`);return x(N9(H))}let $=m(`Expected to find option: '${X.fullName}'`);return x(QX($))}case"KeyValueMap":{let Y=($)=>{let Q=$.trim().split(NY8,2);if(Q8(Q)&&Q.length===2&&Q[1]!=="")return L(Q);let G=m(`Expected a key/value pair but received '${$}'`);return x(p1(G))};return f9(X.argumentOption,J,Z).pipe(M6({onFailure:($)=>DM($)?F0($.values,(Q)=>Y(Q)).pipe(k(S$)):x($),onSuccess:($)=>Y($).pipe(k(Y2))}))}case"Map":return f9(X.options,J,Z).pipe(R((Y)=>X.f(Y)));case"Both":return f9(X.left,J,Z).pipe(a6((Y)=>f9(X.right,J,Z).pipe(M6({onFailure:($)=>{let Q=U8(Y.error,$.error);return x(QX(Q))},onSuccess:()=>x(Y)}))),Y9(f9(X.right,J,Z)));case"OrElse":return f9(X.left,J,Z).pipe(M6({onFailure:(Y)=>f9(X.right,J,Z).pipe(v9({onFailure:($)=>AM(Y)&&AM($)?QX(U8(Y.error,$.error)):N9(U8(Y.error,$.error)),onSuccess:($)=>Z8($)})),onSuccess:(Y)=>f9(X.right,J,Z).pipe(M6({onFailure:()=>L($8(Y)),onSuccess:()=>{let $=i(KX(X.left),()=>"???"),Q=i(KX(X.right),()=>"???"),G=m(`Collision between two options detected - you can only specify one of either: ['${$}', '${Q}']`);return x(N9(G))}}))}));case"Variadic":{let Y=i(X.min,()=>0),$=i(X.max,()=>Number.MAX_SAFE_INTEGER),Q=v5(o9(X),(H)=>zZ(J,H)),G=(H)=>{if(H.length<Y){let W=X.argumentOption.fullName,N=`Expected at least ${Y} value(s) for option: '${W}'`;return x(N9(m(N)))}if(H.length>$){let W=X.argumentOption.fullName,N=`Expected at most ${$} value(s) for option: '${W}'`;return x(N9(m(N)))}let K=X.argumentOption.primitiveType,V=(W)=>OG(K,D(W),Z).pipe(s6((N)=>N9(m(N))));return F0(H,(W)=>V(W))};if(HR(Q,X6))return G(t());return f9(X.argumentOption,J,Z).pipe(M6({onFailure:(H)=>DM(H)?G(H.values):x(H),onSuccess:(H)=>G(a(H))}))}case"WithDefault":return f9(X.options,J,Z).pipe(S9("MissingValue",()=>L(X.fallback)));case"WithFallback":return f9(X.options,J,Z).pipe(S9("MissingValue",(Y)=>X.effect.pipe(a6(($)=>{if(a9($,"QuitException"))return I9($);if(OR($)&&!kK($)){let Q=m(String($)),G=N9(Q);return x(G)}return x(Y)}))))}},q7=(X,J)=>{switch(X._tag){case"Empty":return L(t());case"Single":{let Z=n9(X);return Wz(X.primitiveType,Z).pipe(R((Y)=>{let $=x0(o9(X)[0],Y);return bn(X,$,J).pipe(K6($))}),N4(w0()))}case"KeyValueMap":{let Z=m("Enter `key=value` pairs separated by spaces");return Fn({message:n8(Z).trim(),delimiter:" "}).pipe(R((Y)=>{let $=i(KX(X),()=>"");return f9(X,Y2([$,Y]),J).pipe(K6(u4(Y,$)))}),N4(w0()))}case"Map":return q7(X.options,J);case"Both":return z4(q7(X.left,J),q7(X.right,J),(Z,Y)=>O8(Z,Y));case"OrElse":{let Z=m("Select which option you would like to use"),Y=U(n9(X),U8(Z)),$=(G,H)=>({title:G,value:H}),Q=RJ([q0(KX(X.left),(G)=>$(G,X.left)),q0(KX(X.right),(G)=>$(G,X.right))]);return W7({message:n8(Y).trimEnd(),choices:Q}).pipe(R((G)=>q7(G,J)))}case"Variadic":{let Z=m("How many times should this argument be repeated?"),Y=U(n9(X),U8(Z));return zG({message:n8(Y).trimEnd(),min:n1(X),max:o1(X)}).pipe(R(($)=>$<=0?L(t()):v6(t()).pipe(R((Q)=>q7(X.argumentOption,J).pipe(R((G)=>l5(Q,O8(G))),u3($-1),B8(k6(Q)))))))}case"WithDefault":{if(wz(X.options))return q7(X.options,J);let Z=m("This option is optional - use the default?"),Y=U(n9(X.options),U8(Z));return W7({message:n8(Y).trimEnd(),choices:[{title:"Yes",value:!0,description:`use the default ${U$(X.fallback)?n(X.fallback,{onNone:()=>"",onSome:($)=>`(${JSON.stringify($)})`}):`(${JSON.stringify(X.fallback)})`}`},{title:"No",value:!1,description:"use a custom value"}]}).pipe(N4(w0()),R(($)=>$?L(t()):q7(X.options,J)))}case"WithFallback":{if(wz(X.options))return q7(X.options,J);if(aP(X.effect))return q7(X.options,J);let Z=m("Try load this option from the environment?"),Y=U(n9(X.options),U8(Z));return W7({message:n8(Y).trimEnd(),choices:[{title:"Use environment variables",value:!0},{title:"Custom",value:!1}]}).pipe(N4(w0()),R(($)=>$?L(t()):q7(X.options,J)))}}},yn=(X,J,Z)=>{if(Q8(J))return iH(X,J,Z).pipe(R(([Y,$,Q])=>{if(v$(Q))return L([_(),X,Q]);return yn(Y,$,Z).pipe(k(([G,H,K])=>[G,H,IM(Q,J8(K))]))}),a6((Y)=>L([D(Y),X,w9()])));return X6(X)?L([_(),t(),w9()]):L([_(),X,w9()])},iH=(X,J,Z)=>n6(J,{onEmpty:()=>L([X,t(),w9()]),onNonEmpty:(Y,$)=>bn(Y,X,Z).pipe(R(({leftover:Q,parsed:G})=>n(G,{onNone:()=>iH(Q,$,Z).pipe(k(([H,K,V])=>[H,u4(K,Y),V])),onSome:({name:H,values:K})=>L([Q,$,Y2([H,K])])})),zw({CorrectedFlag:(Q)=>iH(X,$,Z).pipe(u7(()=>D(x(Q))),R(([G,H,K])=>x(Q).pipe(J7(()=>v$(K)),K6([G,u4(H,Y),K])))),MissingFlag:()=>iH(X,$,Z).pipe(k(([Q,G,H])=>[Q,u4(G,Y),H])),UnclusteredFlag:(Q)=>gn(Q.unclustered,Q.rest,J,Z).pipe(a6(()=>x(Q)))}))}),zY8=/^-{1}([^-]{2,}$)/,jn=/^(--[^=]+)(?:=(.+))?$/,qY8=(X)=>n6(X,{onEmpty:()=>L(t()),onNonEmpty:(J,Z)=>{let Y=J.trim();if(zY8.test(Y)){let $=Y.substring(1).split("").map((Q)=>`-${Q}`);return x(wM(V0,$,Z))}if(jn.test(Y)){let $=jn.exec(Y);if($!==null&&$[2]!==void 0)return L(O8([$[1],$[2]],Z))}return L(X)}}),bn=(X,J,Z)=>{switch(X._tag){case"Single":return qY8(J).pipe(R((Y)=>n6(Y,{onEmpty:()=>{let $=m(`Expected to find option: '${X.fullName}'`);return x(_M($))},onNonEmpty:($,Q)=>{let G=(W)=>X4(Z,W),H=G($),K=r(o9(X),(W)=>G(W));if(I5(K,H)){if(Kz(X.primitiveType))return n6(Q,{onEmpty:()=>{let W=D({name:$,values:t()});return L({parsed:W,leftover:Q})},onNonEmpty:(W,N)=>{if(BM(W)){let q=D({name:$,values:a("true")});return L({parsed:q,leftover:N})}if(VM(W)){let q=D({name:$,values:a("false")});return L({parsed:q,leftover:N})}let z=D({name:$,values:t()});return L({parsed:z,leftover:Q})}});return n6(Q,{onEmpty:()=>{let W=m(`Expected a value following option: '${X.fullName}'`);return x(QX(W))},onNonEmpty:(W,N)=>{let z=D({name:$,values:a(W)});return L({parsed:z,leftover:N})}})}if(X.name.length>Z.autoCorrectLimit+1&&Mn($,X.fullName,Z)<=Z.autoCorrectLimit){let W=m(`The flag '${$}' is not recognized. Did you mean '${X.fullName}'?`);return x(Wn(W))}let V=m(`Expected to find option: '${X.fullName}'`);return x(_M(V))}})));case"KeyValueMap":{let Y=r(o9(X.argumentOption),($)=>X4(Z,$));return n6(J,{onEmpty:()=>L({parsed:_(),leftover:J}),onNonEmpty:($,Q)=>{let G=(K)=>{let V=t(),W=K;while(Q8(W)){let N=a8(W).trim(),z=X4(Z,N);if(W.length>=2&&I5(Y,z)){let q=W[1].trim(),[A,E]=q.split("=");if(A!==void 0&&E!==void 0&&E.length>0){V=y0(V,q),W=W.slice(2);continue}}if(N.includes("=")){let[q,A]=N.split("=");if(q!==void 0&&A!==void 0&&A.length>0){V=y0(V,N),W=W.slice(1);continue}}break}return[V,W]},H=X4(Z,$);if(I5(Y,H)){let[K,V]=G(Q);return L({parsed:D({name:$,values:K}),leftover:V})}return L({parsed:_(),leftover:J})}})}case"Variadic":{let Y=r(o9(X.argumentOption),(V)=>X4(Z,V)),$=void 0,Q=t(),G=J,H=t();while(Q8(G)){let V=a8(G),W=X4(Z,V);if(I5(Y,W)){if($===void 0)$=V;let N=G[1];if(N!==void 0&&N.length>0)Q=y0(Q,N.trim());G=G.slice(2)}else H=y0(H,a8(G)),G=G.slice(1)}let K=Y0($).pipe(c4(()=>D(X.argumentOption.fullName)),q0((V)=>({name:V,values:Q})));return L({parsed:K,leftover:H})}}},gn=(X,J,Z,Y)=>{if(Q8(X)){let $=a8(X),Q=N6(X);return iH(a($),Z,Y).pipe(R(([G,H,K])=>{if(v$(K))return x(wM(V0,t(),J));return gn(Q,J,H,Y).pipe(k(([V,W,N])=>[J,W,IM(K,J8(N))]))}))}return L([J,Z,w9()])},IM=(X,J)=>{if(Q8(J)){let Z=a8(J),Y=N6(J),$=n(zZ(X,Z[0]),{onNone:()=>n4(X,Z[0],Z[1]),onSome:(Q)=>n4(X,Z[0],O8(Q,Z[1]))});return IM($,Y)}return X},OY8=(X)=>X.replaceAll("\\","\\\\").replaceAll("'","'\\''").replaceAll("[","\\[").replaceAll("]","\\]").replaceAll(":","\\:").replaceAll("$","\\$").replaceAll("`","\\`").replaceAll("(","\\(").replaceAll(")","\\)"),Lz=(X)=>{switch(X._tag){case"Empty":case"Both":case"OrElse":return"";case"Single":return t7(B7(X.description));case"KeyValueMap":case"Variadic":return Lz(X.argumentOption);case"Map":case"WithDefault":case"WithFallback":return Lz(X.options)}},TG=(X)=>{switch(X._tag){case"Empty":return t();case"Single":{let J=o9(X),Z=F8(J,"|"),Y=Kn(X.primitiveType);return x0(`${Z})`,`    COMPREPLY=( ${Y} )`,"    return 0","    ;;")}case"KeyValueMap":case"Variadic":return TG(X.argumentOption);case"Map":case"WithDefault":case"WithFallback":return TG(X.options);case"Both":case"OrElse":{let J=TG(X.left),Z=TG(X.right);return O8(J,Z)}}},PG=(X)=>{switch(X._tag){case"Empty":return t();case"Single":{let J=Lz(X),Z=YZ(qq,(Y)=>!Y[0]);return U(u4(X.aliases,X.name),r((Y)=>[Y.length===1,Y]),p4(Z),J6(([Y,$])=>x0(Y?"-s":"-l",$)),O8(Uz(X.primitiveType)),O8(J.length===0?t():a(`-d '${J}'`)),F8(" "),a)}case"KeyValueMap":case"Variadic":return PG(X.argumentOption);case"Map":case"WithDefault":case"WithFallback":return PG(X.options);case"Both":case"OrElse":return U(PG(X.left),O8(PG(X.right)))}},HX=(X,J={conflicts:t(),multiple:!1})=>{switch(X._tag){case"Empty":return t();case"Single":{let Z=o9(X),Y=Lz(X),$=Nz(X.primitiveType),Q=J.multiple?"*":"",G=Q8(J.conflicts)?`(${F8(J.conflicts," ")})`:"";return r(Z,(H)=>`${G}${Q}${H}[${OY8(Y)}]${$}`)}case"KeyValueMap":return HX(X.argumentOption,{...J,multiple:!0});case"Map":case"WithDefault":case"WithFallback":return HX(X.options,J);case"Both":{let Z=HX(X.left,J),Y=HX(X.right,J);return O8(Z,Y)}case"OrElse":{let Z=o9(X.left),Y=o9(X.right),$=HX(X.left,{...J,conflicts:O8(J.conflicts,Y)}),Q=HX(X.right,{...J,conflicts:O8(J.conflicts,Z)});return O8($,Q)}case"Variadic":return H8(X.max)&&X.max.value>1?HX(X.argumentOption,{...J,multiple:!0}):HX(X.argumentOption,J)}};var DY8=(X)=>({_tag:"SetLogLevel",level:X}),AY8=(X)=>({_tag:"ShowCompletions",shellType:X}),MG=(X,J)=>({_tag:"ShowHelp",usage:X,helpDoc:J}),SM=(X)=>({_tag:"ShowWizard",command:X}),_Y8={_tag:"ShowVersion"};var vM=(X)=>X._tag==="ShowHelp",kM=(X)=>X._tag==="ShowWizard";var wY8=Pz("completions",[["sh","bash"],["bash","bash"],["fish","fish"],["zsh","zsh"]]).pipe(Mz,aY("Generate a completion script for a specific shell.")),LY8=Pz("log-level",jI.map((X)=>[X._tag.toLowerCase(),X])).pipe(Mz,aY("Sets the minimum log level for a command.")),TY8=sH("help").pipe(jM("h"),aY("Show the help documentation for a command.")),PY8=sH("version").pipe(aY("Show the version of the application.")),MY8=sH("wizard").pipe(aY("Start wizard mode for a command.")),AJ=DJ({completions:wY8,logLevel:LY8,help:TY8,wizard:MY8,version:PY8}),hn=(X,J,Z)=>O7(AJ,(Y)=>{if(H8(Y.completions))return D(AY8(Y.completions.value));if(H8(Y.logLevel))return D(DY8(Y.logLevel.value));if(Y.help)return D(MG(J,Z));if(Y.wizard)return D(SM(X));if(Y.version)return D(_Y8);return _()});var dn=Lm;var xM=lA;var cn=IA;var un=g;var fn=NQ,nn=_6;var bM=Cb;var gM=m;var hM=DJ;var eH=(X)=>({_tag:"BuiltIn",option:X}),FG=(X,J)=>({_tag:"UserDefined",leftover:X,value:J}),mM=(X)=>X._tag==="BuiltIn",dM=(X)=>X._tag==="UserDefined",an=B(2,(X,J)=>dM(X)?FG(X.leftover,J(X.value)):X);var RY8="@effect/cli/CommandDescriptor",sn=Symbol.for(RY8),sY={[sn]:{_A:(X)=>X},pipe(){return C(this,arguments)}},tn=(X)=>typeof X==="object"&&X!=null&&(sn in X),tY=(X)=>X._tag==="Standard";var en=(X,J=tH,Z=Dz)=>{let Y=Object.create(sY);return Y._tag="Standard",Y.name=X,Y.description=V0,Y.options=J,Y.args=Z,Y},Xo=(X,J)=>{let Z=Object.create(sY);return Z._tag="GetUserInput",Z.name=X,Z.description=V0,Z.prompt=J,Z},Ez=(X,J)=>XK(X,J),jG=(X)=>R$(r1(X)),Iz=(X,J)=>SY8(X,J),Sz=(X,J)=>vY8(X,J),vz=(X,J)=>kY8(X,J),kz=(X)=>S$(JK(X)),xz=(X)=>RG(X),yz=B(2,(X,J)=>Jo(X,(Z)=>Z8(J(Z)))),Jo=B(2,(X,J)=>{let Z=Object.create(sY);return Z._tag="Map",Z.command=X,Z.f=J,Z}),Zo=B(3,(X,J,Z)=>jz(X,J,Z)),Yo=B(2,(X,J)=>cM(X,J)),$o=B(2,(X,J)=>{let Z=Object.create(sY);return Z._tag="Subcommands",Z.parent=X,Z.children=r(J,([Y,$])=>yz($,(Q)=>[Y,Q])),Z}),bz=B(3,(X,J,Z)=>IY8(X,J,Z)),XK=(X,J)=>{switch(X._tag){case"Standard":{let Z=d1(X.description)?V0:U8(V7("DESCRIPTION"),X.description),Y=An(X.args),$=d1(Y)?V0:U8(V7("ARGUMENTS"),Y),Q=J.showBuiltIns?hM([X.options,AJ]):X.options,G=FM(Q),H=d1(G)?V0:U8(V7("OPTIONS"),G);return U8(Z,U8($,H))}case"GetUserInput":return d1(X.description)?V0:U8(V7("DESCRIPTION"),X.description);case"Map":return XK(X.command,J);case"Subcommands":{let Z=($,Q)=>{switch($._tag){case"Standard":case"GetUserInput":{let G=B7(zz(RG($))),H=y0(Q,G),K=o6(H,c9,(W,N)=>fP(W)&&W.value===""?N:fP(N)&&N.value===""?W:U9([W,W9,N])),V=B7($.description);return a([K,V])}case"Map":return Z($.command,Q);case"Subcommands":{let G=Z($.parent,Q);return n(Q4(G),{onNone:()=>J6($.children,(H)=>Z(H,Q)),onSome:([H])=>{let K=J6($.children,(V)=>Z(V,y0(Q,H)));return O8(G,K)}})}}},Y=($)=>{let Q=t9($,0,(H,[K])=>Math.max(uY(K),H)),G=r($,([H,K])=>m(U9([H,L8(" ".repeat(Q-uY(H)+2)),K])));if(Q8(G))return cH(G);throw Error("[BUG]: Subcommands.usage - received empty list of subcommands to print")};return U8(XK(X.parent,J),U8(V7("COMMANDS"),Y(J6(X.children,($)=>Z($,t())))))}}},r1=(X)=>{switch(X._tag){case"Standard":case"GetUserInput":return a(X.name);case"Map":return r1(X.command);case"Subcommands":return r1(X.parent)}},JK=(X)=>{let J=(Z,Y)=>{switch(Z._tag){case"Standard":case"GetUserInput":return a([Z.name,Z]);case"Map":return J(Z.command,Y);case"Subcommands":return Y?J(Z.parent,!1):J6(Z.children,($)=>J($,!0))}};return J(X,!1)},RG=(X)=>{switch(X._tag){case"Standard":return $X(u1(a(X.name),_()),$X(RM(X.options),_n(X.args)));case"GetUserInput":return u1(a(X.name),_());case"Map":return RG(X.command);case"Subcommands":return $X(RG(X.parent),UM)}},jz=(X,J,Z)=>{let Y=($,Q)=>n6(Q,{onEmpty:()=>{let G=m(`Missing command name: '${$.name}'`);return x(lY(G))},onNonEmpty:(G,H)=>{let K=X4(Z,G),V=X4(Z,$.name);return L(H).pipe(J7(()=>K===V),z5,S9("NoSuchElementException",()=>{let W=m(`Missing command name: '${$.name}'`);return x(lY(W))}))}});switch(X._tag){case"Standard":{let $=(H)=>n6(H,{onEmpty:()=>{let K=m(`Missing command name: '${X.name}'`);return x(lY(K))},onNonEmpty:(K)=>{let V=X4(Z,K),W=X4(Z,X.name);if(V===W){let z=XK(X,Z),q=RG(X),A=hn(X,q,z),E=A7(H,1);return Fz(A,E,Z).pipe(R((P)=>P[2]),S9("NoSuchElementException",()=>{let P=m("No built-in option was matched");return x(Nn(P))}),k(eH))}let N=m(`Missing command name: '${X.name}'`);return x(lY(N))}}),Q=(H)=>Y(X,H).pipe(R((K)=>{let[V,W]=jY8(K);return Fz(X.options,V,Z).pipe(R(([N,z,q])=>wn(X.args,O8(z,W),Z).pipe(a6((A)=>n(N,{onNone:()=>x(A),onSome:(E)=>x(E)})),k(([A,E])=>FG(A,{name:X.name,options:q,args:E})))))})),G=(H)=>{if(I5(H,"--help")||I5(H,"-h"))return $(x0(X.name,"--help"));if(I5(H,"--wizard"))return $(x0(X.name,"--wizard"));if(I5(H,"--version"))return $(x0(X.name,"--version"));let K=m(`Missing command name: '${X.name}'`);return x(lY(K))};return $(J).pipe(iX(()=>Q(J)),u7((H)=>{if(DG(H)){if(Z.finalCheckBuiltIn)return D(G(J).pipe(u7((K)=>DG(K)?D(x(H)):_())));return D(x(H))}return _()}))}case"GetUserInput":return Y(X,J).pipe(B8(sP(X.prompt)),S9("QuitException",($)=>I9($)),k(($)=>FG(A7(J,1),{name:X.name,value:$})));case"Map":return jz(X.command,J,Z).pipe(R(($)=>{if(dM($))return X.f($.value).pipe(k((Q)=>FG($.leftover,Q)));return L($)}));case"Subcommands":{let $=r1(X),Q=JK(X),[G,H]=QZ(J,(q)=>!KR(Q,([A])=>A===q)),K=z8(()=>{let q=X.children[Symbol.iterator](),A=(E)=>{return jz(E,H,Z).pipe(Nw(OM,(P)=>{let M=q.next();return M.done?x(P):A(M.value)}))};return A(q.next().value)}),V=V8(()=>{return eH(MG(RG(X),XK(X,Z)))}),W=K.pipe(R((q)=>{if(mM(q)&&vM(q.option)){let A=i(Q4($),()=>""),E=eH(MG($X(u1(a(A),_()),q.option.usage),q.option.helpDoc));return L(E)}return x(p1(V0))})),N=V8(()=>eH(SM(X))),z=K.pipe(R((q)=>{if(mM(q)&&kM(q.option))return L(q);return x(p1(V0))}));return z8(()=>jz(X.parent,G,Z).pipe(R((q)=>{switch(q._tag){case"BuiltIn":{if(vM(q.option))return Q8(H)?iX(W,()=>V):V;if(kM(q.option))return iX(z,()=>N);return L(q)}case"UserDefined":{let A=O8(q.leftover,H);if(Q8(A))return K.pipe(v9({onFailure:(E)=>{if(OM(E)){let P=i(Q4($),()=>""),M=r(Q,([s])=>`'${s}'`),c=M.length===1?"":" one of",y=m(`Invalid subcommand for ${P} - use${c} ${F8(M,", ")}`);return lY(y)}return E},onSuccess:an((E)=>({...q.value,subcommand:D(E)}))}));return L(FG(q.leftover,{...q.value,subcommand:_()}))}}}),u7(()=>X6(J)?D(V):_())))}}},jY8=(X)=>{let[J,Z]=QZ(X,(Y)=>Y!=="--");return[J,A7(Z,1)]},cM=(X,J)=>{switch(X._tag){case"Standard":{let Z=typeof J==="string"?gM(J):J,Y=Object.create(sY);return Y._tag="Standard",Y.name=X.name,Y.description=Z,Y.options=X.options,Y.args=X.args,Y}case"GetUserInput":{let Z=typeof J==="string"?gM(J):J,Y=Object.create(sY);return Y._tag="GetUserInput",Y.name=X.name,Y.description=Z,Y.prompt=X.prompt,Y}case"Map":return Jo(cM(X.command,J),X.f);case"Subcommands":{let Z=Object.create(sY);return Z._tag="Subcommands",Z.parent=cM(X.parent,J),Z.children=X.children.slice(),Z}}},CY8=e7("Args Wizard - "),EY8=e7("Options Wizard - "),IY8=(X,J,Z)=>{let Y=($,Q)=>{switch($._tag){case"GetUserInput":case"Standard":return _8(function*(){let G=k6(Q).pipe(R((H)=>{let K=m(U(tN(m1("COMMAND:",sN)),e6(W9),e6(m1(F8(H," "),uP))));return w0(n8(K))}));if(tY($)){yield*G;let H=m1($.name,uP);if(!Cn($.options)){let K=m(e6(EY8,H));yield*w0(n8(K));let V=yield*CM($.options,Z);yield*rD(Q,O8(V)),yield*G}if(!On($.args)){let K=m(e6(CY8,H));yield*w0(n8(K));let V=yield*Ln($.args,Z);yield*rD(Q,O8(V)),yield*G}}return yield*k6(Q)});case"Map":return Y($.command,Q);case"Subcommands":{let G=m("Select which command you would like to execute"),H=n8(G).trimEnd(),K=(W,N)=>({title:W,value:[W,N]}),V=U(JK($),r(([W],N)=>K(W,N)));return Y($.parent,Q).pipe(B8(W7({message:H,choices:V}).pipe(X0(([W])=>l5(Q,y0(W))),N4(w0()),R(([,W])=>Y($.children[W],Q)))))}}};return v6(J).pipe(R(($)=>Y(X,$).pipe(B8(k6($)))))},uM=(X)=>{switch(X._tag){case"Standard":return t7(B7(X.description));case"GetUserInput":return t7(B7(X.description));case"Map":return uM(X.command);case"Subcommands":return""}},pM=(X,J,Z)=>fn(J).pipe(R((Y)=>{let $=(Q,G,H,K)=>{switch(Q._tag){case"Standard":{let V={command:Q,parentCommands:G,subcommands:H,level:K};return bM(Y,(W)=>Z(W,V))}case"GetUserInput":{let V={command:Q,parentCommands:G,subcommands:H,level:K};return bM(Y,(W)=>Z(W,V))}case"Map":return $(Q.command,G,H,K);case"Subcommands":{let V=r1(Q.parent),W=JK(Q),N=O8(G,V);return $(Q.parent,G,W,K).pipe(B8(F0(Q.children,(z)=>$(z,N,H,K+1))))}}};return z8(()=>$(X,t(),t(),0)).pipe(B8(nn(Y)))})),R5=B(2,(X,J)=>{let Z=NX(J+1).join(" ");return r(X,(Y)=>`${Z}${Y}`)}),SY8=(X,J)=>pM(X,t(),(Z,Y)=>{let $=tY(Y.command)?hM([Y.command.options,AJ]):AJ,Q=o9($),G=tY(Y.command)?TG(Y.command.options):t(),H=U(Y.subcommands,r(([E])=>E),p4(fF)),K=O8(Q,H),V=X6(Y.parentCommands)?a(Y.command.name):U(Y.parentCommands,y0(Y.command.name),r((E)=>E.replace("-","__"))),W=F8(V,","),N=F8(V,"__"),z=X6(Y.parentCommands)?t():[`${W})`,`    cmd="${N}"`,"    ;;"],q=[`${N})`,`    opts="${F8(K," ")}"`,`    if [[ \${cur} == -* || \${COMP_CWORD} -eq ${Y.level+1} ]] ; then`,'        COMPREPLY=( $(compgen -W "${opts}" -- "${cur}") )',"        return 0","    fi",'    case "${prev}" in',...R5(G,8),"    *)","        COMPREPLY=()","        ;;","    esac",'    COMPREPLY=( $(compgen -W "${opts}" -- "${cur}") )',"    return 0","    ;;"],A=y0(Z,[z,q]);return L(A)}).pipe(k((Z)=>{let Y=N$(r1(X),0),$=`_${Y}_bash_completions`,Q=J6(Z,([H])=>H),G=J6(Z,([,H])=>H);return[`function ${$}() {`,"    local i cur prev opts cmd","    COMPREPLY=()",'    cur="${COMP_WORDS[COMP_CWORD]}"','    prev="${COMP_WORDS[COMP_CWORD-1]}"','    cmd=""','    opts=""','    for i in "${COMP_WORDS[@]}"; do','        case "${cmd},${i}" in','            ",$1")',`                cmd="${J}"`,"                ;;",...R5(Q,12),"            *)","                ;;","        esac","    done",'    case "${cmd}" in',...R5(G,8),"    esac","}",`complete -F ${$} -o nosort -o bashdefault -o default ${Y}`]})),vY8=(X,J)=>pM(X,t(),(Z,Y)=>{let $=x0("complete","-c",J),Q=tY(Y.command)?DJ([AJ,Y.command.options]):AJ,G=PG(Q),H=tY(Y.command)?lH(Y.command.args):t(),K=(A)=>U(r(G,(E)=>U($,O8(A),y0(E),F8(" "))),O8(r(H,(E)=>U($,O8(A),y0(E),F8(" "))))),V=(A)=>r(Y.subcommands,([E,P])=>{let M=uM(P);return U($,O8(A),O8(x0("-f","-a",`"${E}"`)),O8(M.length===0?t():x0("-d",`'${M}'`)),F8(" "))});if(X6(Y.parentCommands)){let A=x0("-n",'"__fish_use_subcommand"');return L(U(Z,O8(K(A)),O8(V(A))))}let W=U(Y.parentCommands,A7(1),y0(Y.command.name),r((A)=>`__fish_seen_subcommand_from ${A}`)),N=r(Y.subcommands,([A])=>`not __fish_seen_subcommand_from ${A}`),z=U(O8(W,N),F8("; and ")),q=x0("-n",`"${z}"`);return L(U(Z,O8(K(q)),O8(V(q))))}),kY8=(X,J)=>pM(X,t(),(Z,Y)=>{let $=X6(Y.parentCommands)?a(Y.command.name):U(Y.parentCommands,y0(Y.command.name),r((W)=>W.replace("-","__"))),Q=F8($,"__"),G=F8($," "),H=U(Y.subcommands,r(([W,N])=>{let z=uM(N);return`'${W}:${z}' \\`})),K=X6(H)?"commands=()":`commands=(
${F8(R5(H,8),`
`)}
    )`,V=[`(( $+functions[_${Q}_commands] )) ||`,`_${Q}_commands() {`,`    local commands; ${K}`,`    _describe -t commands '${G} commands' commands "$@"`,"}"];return L(O8(Z,V))}).pipe(k((Z)=>{let Y=N$(r1(X),0),$=Cz(X,t(),t()),Q=`_${Y}_zsh_completions`;return[`#compdef ${J}`,"","autoload -U is-at-least","",`function ${Q}() {`,"    typeset -A opt_args","    typeset -a _arguments_options","    local ret=1","","    if is-at-least 5.2; then","        _arguments_options=(-s -S -C)","    else","        _arguments_options=(-s -C)","    fi","",'    local context curcontext="$curcontext" state line',...R5($,4),"}","",...Z,"",`if [ "$funcstack[1]" = "${Q}" ]; then`,`    ${Q} "$@"`,"else",`    compdef ${Q} ${Y}`,"fi"]})),Cz=(X,J,Z)=>{switch(X._tag){case"Standard":case"GetUserInput":{let Y=tY(X)?DJ([AJ,X.options]):AJ,$=tY(X)?X.args:Dz,Q=U(HX(Y),r((H)=>`'${H}' \\`)),G=U(f1($),r((H)=>`'${H}' \\`));if(X6(J))return['_arguments "${_arguments_options[@]}" \\',...R5(Q,4),...R5(G,4),`    ":: :_${X.name}_commands" \\`,`    "*::: :->${X.name}" \\`,"    && ret=0"];if(X6(Z))return[`(${X.name})`,'_arguments "${_arguments_options[@]}" \\',...R5(Q,4),...R5(G,4),"    && ret=0",";;"];return[`(${X.name})`,'_arguments "${_arguments_options[@]}" \\',...R5(Q,4),...R5(G,4),`    ":: :_${y0(J,X.name).join("__")}_commands" \\`,`    "*::: :->${X.name}" \\`,"    && ret=0"]}case"Map":return Cz(X.command,J,Z);case"Subcommands":{let Y=JK(X),$=r1(X.parent),Q=Cz(X.parent,J,O8(Z,Y)),G=U(X.children,J6((V)=>Cz(V,O8(J,$),Z))),H=U(O8(J,$),F8("-")),K=U($,J6((V)=>["case $state in",`    (${V})`,'    words=($line[1] "${words[@]}")',"    (( CURRENT += 1 ))",`    curcontext="\${curcontext%:*:*}:${H}-command-$line[1]:"`,"    case $line[1] in",...R5(G,8),"    esac","    ;;","esac"]),O8(X6(J)?t():a(";;")));return O8(Q,K)}}},Qo=(X)=>{let J=Object.create(U7);return J._tag="HelpRequested",J.error=V0,J.command=X,J};var xY8={pipe(){return C(this,arguments)}},Ho=(X)=>{let J=Object.create(xY8);return J.name=X.name,J.version=X.version,J.executable=X.executable,J.command=X.command,J.summary=X.summary||c9,J.footer=X.footer||V0,J},gz=B(3,(X,J,Z)=>ww((Y)=>{let $=i(w4(Y,Nf),()=>eN),[Q,G]=yY8(X,J),H=O8(bY8(X.command),G);return M6(Zo(X.command,H,$),{onFailure:(K)=>B8(nM(K.error),x(K)),onSuccess:un((K)=>{switch(K._tag){case"UserDefined":return n6(K.leftover,{onEmpty:()=>Z(K.value).pipe(u7((V)=>DG(V)&&Vn(V)?D(Go(X,Q,G,MG(xz(V.command),Ez(V.command,$)),Z,$)):_())),onNonEmpty:(V)=>{let W=m(`Received unknown argument: '${V}'`);return B8(nM(W),x(N9(W)))}});case"BuiltIn":return Go(X,Q,G,K.option,Z,$).pipe(u7((V)=>DG(V)?D(B8(nM(V.error),x(V))):_()))}})})})),yY8=(X,J)=>{if(X.executable!==void 0)return[X.executable,A7(J,2)];let[[Z,Y],$]=pG(J,2);return[`${Z} ${Y}`,$]},nM=(X)=>lb(n8(X)),Go=(X,J,Z,Y,$,Q)=>{switch(Y._tag){case"SetLogLevel":{let G=J.split(/\s+/);for(let H=0;H<Z.length;H++){if(Z[H]==="--log-level"||Z[H-1]==="--log-level")continue;G.push(Z[H])}return gz(X,G,$).pipe(dn(Y.level))}case"ShowHelp":{let G=V7(e7(X.name)),H=m(U9([L8(`${X.name} ${X.version}`),nP(X.summary)?c9:U9([W9,L8("--"),W9,X.summary])])),K=U8(V7("USAGE"),U(zM(Y.usage,Q),r((W)=>m(e6(L8("$ "),W))),t9(V0,(W,N)=>U8(W,N)))),V=U(G,U8(H),U8(K),U8(Y.helpDoc),U8(X.footer));return w0(n8(V))}case"ShowCompletions":{let G=J8(jG(X.command))[0];switch(Y.shellType){case"bash":return Iz(X.command,G).pipe(R((H)=>w0(F8(H,`
`))));case"fish":return Sz(X.command,G).pipe(R((H)=>w0(F8(H,`
`))));case"zsh":return vz(X.command,G).pipe(R((H)=>w0(F8(H,`
`))))}}case"ShowWizard":{let G=nP(X.summary)?c9:U9([W9,L8("--"),W9,X.summary]),H=U8(m(U9([L8("The wizard mode will assist you with constructing commands for"),W9,e7(`${X.name} (${X.version})`),L8(".")])),m("Please answer all prompts provided by the wizard.")),K=c1([[L8("Instructions"),H]]),V=V7(U9([e7("Wizard Mode for CLI Application:"),W9,e7(X.name),W9,e7(`(${X.version})`),G])),W=U8(V,K),N=n8(W),z=J8(jG(X.command))[0],q=gY8(Y,z,Z);return w0(N).pipe(B8(bz(Y.command,q,Q)),X0((A)=>w0(n8(hY8(A)))),R((A)=>Hz({message:"Would you like to run the command?",initial:!0,active:"yes",inactive:"no"}).pipe(R((E)=>{let P=U(A7(A,1),ZR(J.split(/\s+/)));return E?w0().pipe(B8(gz(X,P,$))):o}))),a6((A)=>{if(qf(A)){let E=m(Qf(`

Quitting wizard mode...`));return w0(n8(E))}return x(A)}))}case"ShowVersion":{let G=m(X.version);return w0(n8(G))}}},bY8=(X)=>{let J=X,Z=t();while(J!==void 0)switch(J._tag){case"Standard":{Z=a(J.name),J=void 0;break}case"GetUserInput":{Z=a(J.name),J=void 0;break}case"Map":{J=J.command;break}case"Subcommands":{J=J.parent;break}}return Z},gY8=(X,J,Z)=>{let Y=kz(X.command),[$,Q]=QZ(Z,(H)=>!Ij(Y,H)),G=n6(Q,{onEmpty:()=>GZ($,(H)=>H!=="--wizard"),onNonEmpty:(H)=>y0($,H)});return O8(J.split(/\s+/),G)},hY8=(X)=>{let J=U(GZ(X,(Y)=>Y.length>0),F8(" ")),Z=L8("You may now execute your command directly with the following options and arguments:");return oP([m(tN(e7("Wizard Mode Complete!"))),m(Z),m(e6(L8("    "),m1(J,sN)))])};var _J={};QK(_J,{wizard:()=>W$8,withSubcommands:()=>V$8,withHandler:()=>B$8,withDescription:()=>K$8,transformHandler:()=>H$8,run:()=>U$8,provideSync:()=>G$8,provideEffectDiscard:()=>Q$8,provideEffect:()=>$$8,provide:()=>Y$8,prompt:()=>Z$8,make:()=>J$8,getZshCompletions:()=>tY8,getUsage:()=>X$8,getSubcommands:()=>eY8,getNames:()=>iY8,getHelp:()=>lY8,getFishCompletions:()=>sY8,getBashCompletions:()=>aY8,fromDescriptor:()=>rY8,TypeId:()=>oY8});var Ko=Qo;var dY8="@effect/cli/Command",hz=Symbol.for(dY8),cY8=(X)=>{let J=[],Z=0,Y=[],$=0;function Q(H){let K={};for(let V in H)K[V]=G(H[V]);return K}function G(H){if(zX(H))return{_tag:"Array",children:r(H,G)};else if(TM(H))return J.push(H),{_tag:"Args",index:Z++};else if(Tz(H))return Y.push(H),{_tag:"Options",index:$++};else return{_tag:"ParsedConfig",tree:Q(H)}}return{args:J,options:Y,tree:Q(X)}},Vo=(X,J,Z)=>{let Y={};for(let Q in X)Y[Q]=$(X[Q]);return Y;function $(Q){if(Q._tag==="Args")return J[Q.index];else if(Q._tag==="Options")return Z[Q.index];else if(Q._tag==="Array")return r(Q.children,$);else return Vo(Q.tree,J,Z)}},Wo={...pZ,[hz]:hz,commit(){return this.tag},pipe(){return C(this,arguments)}},oM=X8("@effect/cli/Command/registeredDescriptors",()=>new WeakMap),uY8=(X)=>oM.get(X.tag)??X.descriptor,Uo=(X,J,Z,Y=g)=>{let $=Object.create(Wo);return $.descriptor=X,$.handler=J,$.transform=Y,$.tag=Z,$},l1=(X,J)=>{let Z=Object.create(Wo);return Z.descriptor=J.descriptor??X.descriptor,Z.handler=J.handler??X.handler,Z.transform=J.transform?(Y,$)=>J.transform(X.transform(Y,$),$):X.transform,Z.tag=X.tag,Z},rM=B((X)=>tn(X[0]),(X,J)=>{let Z=Uo(X,J??((Y)=>dW(()=>Ko(uY8(Z)))),o8(`@effect/cli/Command/(${J8(jG(X)).join("|")})`));return Z}),pY8=(X,J)=>{let{args:Z,options:Y,tree:$}=cY8(J);return yz(en(X,DJ(Y),Dn(Z)),({args:Q,options:G})=>Vo($,Q,G))},No=(X,J={},Z)=>rM(pY8(X,J),Z),zo=(X,J)=>Ez(X.descriptor,J),qo=(X)=>jG(X.descriptor),Oo=(X,J)=>Iz(X.descriptor,J),Do=(X,J)=>Sz(X.descriptor,J),Ao=(X,J)=>vz(X.descriptor,J),_o=(X)=>kz(X.descriptor),wo=(X)=>xz(X.descriptor),fY8=B(2,(X,J)=>l1(X,{descriptor:J(X.descriptor)})),Lo=(X,J,Z)=>Uo(yz(Xo(X,J),(Y)=>Y.value),Z,o8(`@effect/cli/Prompt/${X}`)),To=B(2,(X,J)=>l1(X,{handler:J,transform:g})),Po=B(2,(X,J)=>l1(X,{transform:J})),Mo=B(2,(X,J)=>l1(X,{transform:(Z,Y)=>L1(Z,typeof J==="function"?J(Y):J)})),Fo=B(3,(X,J,Z)=>l1(X,{transform:(Y,$)=>{let Q=typeof Z==="function"?Z($):Z;return oW(Y,J,Q)}})),Ro=B(2,(X,J)=>l1(X,{transform:(Z,Y)=>{let $=typeof J==="function"?J(Y):J;return B8($,Z)}})),jo=B(3,(X,J,Z)=>l1(X,{transform:(Y,$)=>{let Q=typeof Z==="function"?Z($):Z;return PQ(Y,J,Q)}})),Co=B(2,(X,J)=>fY8(X,Yo(J))),Eo=B(2,(X,J)=>{let Z=$o(X.descriptor,r(J,(Q)=>[Q.tag,Q.descriptor])),Y=o6(J,new Map,(Q,G)=>{return Q.set(G.tag,G),oM.set(G.tag,G.descriptor),Q});function $(Q){if(Q.subcommand._tag==="Some"){let[G,H]=Q.subcommand.value,K=Y.get(G),V=K.transform(K.handler(H),H);return PQ(V,X.tag,Q)}return X.handler(Q)}return l1(X,{descriptor:Z,handler:$})}),Io=B(3,(X,J,Z)=>bz(X.descriptor,J,Z)),So=B(2,(X,J)=>{let Z=Ho({...J,command:X.descriptor});oM.set(X.tag,X.descriptor);let Y=($)=>X.transform(X.handler($),$);return($)=>gz(Z,$,Y)});var oY8=hz,rY8=rM,lY8=zo,iY8=qo,aY8=Oo,sY8=Do,tY8=Ao,eY8=_o,X$8=wo,J$8=No,Z$8=Lo,Y$8=Mo,$$8=Fo,Q$8=Ro,G$8=jo,H$8=Po,K$8=Co,B$8=To,V$8=Eo,W$8=Io,U$8=So;var lM=Symbol.for("effect/FiberSet"),N$8=(X)=>v(X,lM),z$8={[lM]:lM,[Symbol.iterator](){if(this.state._tag==="Closed")return XR();return this.state.backing[Symbol.iterator]()},toString(){return S8(this.toJSON())},toJSON(){return{_id:"FiberMap",state:this.state}},[T8](){return this.toJSON()},pipe(){return C(this,arguments)}},q$8=(X,J)=>{let Z=Object.create(z$8);return Z.state={_tag:"Open",backing:X},Z.deferred=J,Z},vo=()=>P6(k(K0(),(X)=>q$8(new Set,X)),(X)=>w1((J)=>{let Z=X.state;if(Z._tag==="Closed")return o;X.state={_tag:"Closed"};let Y=Z.backing;return Nb(Y,I$(J.id(),xo)).pipe(MQ(X.deferred))}));var ko=-1,xo=Cj(ko,0),O$8=Hy(void 0,{emptyCase:W6,failCase:W6,dieCase:W6,interruptCase:(X,J)=>j$(Z2(J),ko),sequentialCase:(X,J,Z)=>J||Z,parallelCase:(X,J,Z)=>J||Z}),yo=B((X)=>N$8(X[0]),(X,J,Z)=>{if(X.state._tag==="Closed"){J.unsafeInterruptAsFork(I$(Z?.interruptAs??I6,xo));return}else if(X.state.backing.has(J))return;X.state.backing.add(J),J.addObserver((Y)=>{if(X.state._tag==="Closed")return;if(X.state.backing.delete(J),V5(Y)&&(Z?.propagateInterruption===!0?!O$8(Y.cause):!q3(Y.cause)))N5(X.deferred,Y)})});var bo=(X)=>k8(X.deferred);var cz=Symbol.for("effect/Mailbox"),iM=Symbol.for("effect/Mailbox/ReadonlyMailbox");var eY=e8(),ho=m8(eY),mz=m8(!1),dz=m8(!0),mo=[eY,!0];class co extends a4{scheduler;capacity;strategy;[cz]=cz;[iM]=iM;state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set};messages=[];messagesChunk=e8();constructor(X,J,Z){super();this.scheduler=X,this.capacity=J,this.strategy=Z}offer(X){return h(()=>{if(this.state._tag!=="Open")return mz;else if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return mz;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(X),this.releaseTaker(),dz;return this.offerRemainingSingle(X);case"sliding":return this.unsafeTake(),this.messages.push(X),dz}return this.messages.push(X),this.scheduleReleaseTaker(),dz})}unsafeOffer(X){if(this.state._tag!=="Open")return!1;else if(this.messages.length+this.messagesChunk.length>=this.capacity){if(this.strategy==="sliding")return this.unsafeTake(),this.messages.push(X),!0;else if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(X),this.releaseTaker(),!0;return!1}return this.messages.push(X),this.scheduleReleaseTaker(),!0}offerAll(X){return h(()=>{if(this.state._tag!=="Open")return w(H4(X));let J=this.unsafeOfferAllArray(X);if(J.length===0)return ho;else if(this.strategy==="dropping")return w(b0(J));return this.offerRemainingArray(J)})}unsafeOfferAll(X){return b0(this.unsafeOfferAllArray(X))}unsafeOfferAllArray(X){if(this.state._tag!=="Open")return J8(X);else if(this.capacity===Number.POSITIVE_INFINITY||this.strategy==="sliding"){if(this.messages.length>0)this.messagesChunk=t8(this.messagesChunk,b0(this.messages));if(this.strategy==="sliding")this.messagesChunk=this.messagesChunk.pipe(t8(H4(X)),bq(this.capacity));else if(rG(X))this.messagesChunk=t8(this.messagesChunk,X);else this.messages=J8(X);return this.scheduleReleaseTaker(),[]}let J=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(J===0)return J8(X);let Z=[],Y=0;for(let $ of X){if(Y<J)this.messages.push($);else Z.push($);Y++}return this.scheduleReleaseTaker(),Z}fail(X){return this.done(vX(X))}failCause(X){return this.done(g8(X))}unsafeDone(X){if(this.state._tag!=="Open")return!1;else if(this.state.offers.size===0&&this.messages.length===0&&this.messagesChunk.length===0)return this.finalize(X),!0;return this.state={...this.state,_tag:"Closing",exit:X},!0}shutdown=T(()=>{if(this.state._tag==="Done")return!0;this.messages=[],this.messagesChunk=eY;let X=this.state.offers;if(this.finalize(this.state._tag==="Open"?M0:this.state.exit),X.size>0){for(let J of X)if(J._tag==="Single")J.resume(mz);else J.resume(m8(b0(J.remaining.slice(J.offset))));X.clear()}return!0});done(X){return T(()=>this.unsafeDone(X))}end=this.done(M0);clear=h(()=>{if(this.state._tag==="Done")return f$(this.state.exit,eY);let X=this.unsafeTakeAll();return this.releaseCapacity(),w(X)});takeAll=h(()=>{if(this.state._tag==="Done")return f$(this.state.exit,mo);let X=this.unsafeTakeAll();if(X.length===0)return j8(this.awaitTake,this.takeAll);return w([X,this.releaseCapacity()])});takeN(X){return h(()=>{if(this.state._tag==="Done")return f$(this.state.exit,mo);else if(X<=0)return w([eY,!1]);X=Math.min(X,this.capacity);let J;if(X<=this.messagesChunk.length)J=A$(this.messagesChunk,X),this.messagesChunk=b5(this.messagesChunk,X);else if(X<=this.messages.length+this.messagesChunk.length)this.messagesChunk=t8(this.messagesChunk,b0(this.messages)),this.messages=[],J=A$(this.messagesChunk,X),this.messagesChunk=b5(this.messagesChunk,X);else return j8(this.awaitTake,this.takeN(X));return w([J,this.releaseCapacity()])})}unsafeTake(){if(this.state._tag==="Done")return nB(this.state.exit,vX(new Ky));let X;if(this.messagesChunk.length>0)X=lG(this.messagesChunk),this.messagesChunk=b5(this.messagesChunk,1);else if(this.messages.length>0)X=this.messages[0],this.messagesChunk=b5(b0(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?m8(this.messages.pop()):void 0;else return;return this.releaseCapacity(),m8(X)}take=h(()=>this.unsafeTake()??j8(this.awaitTake,this.take));await=M7((X)=>{if(this.state._tag==="Done")return X(this.state.exit);return this.state.awaiters.add(X),T(()=>{if(this.state._tag!=="Done")this.state.awaiters.delete(X)})});unsafeSize(){let X=this.messages.length+this.messagesChunk.length;return this.state._tag==="Done"?_():D(X)}size=T(()=>this.unsafeSize());commit(){return this.takeAll}pipe(){return C(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return S8(this)}[T8](){return S8(this)}offerRemainingSingle(X){return M7((J)=>{if(this.state._tag!=="Open")return J(mz);let Z={_tag:"Single",message:X,resume:J};return this.state.offers.add(Z),T(()=>{if(this.state._tag==="Open")this.state.offers.delete(Z)})})}offerRemainingArray(X){return M7((J)=>{if(this.state._tag!=="Open")return J(m8(b0(X)));let Z={_tag:"Array",remaining:X,offset:0,resume:J};return this.state.offers.add(Z),T(()=>{if(this.state._tag==="Open")this.state.offers.delete(Z)})})}releaseCapacity(){if(this.state._tag==="Done")return this.state.exit._tag==="Success";else if(this.state.offers.size===0){if(this.state._tag==="Closing"&&this.messages.length===0&&this.messagesChunk.length===0)return this.finalize(this.state.exit),this.state.exit._tag==="Success";return!1}let X=this.capacity-this.messages.length-this.messagesChunk.length;for(let J of this.state.offers)if(X===0)return!1;else if(J._tag==="Single")this.messages.push(J.message),X--,J.resume(dz),this.state.offers.delete(J);else{for(;J.offset<J.remaining.length;J.offset++){if(X===0)return!1;this.messages.push(J.remaining[J.offset]),X--}J.resume(ho),this.state.offers.delete(J)}return!1}awaitTake=M7((X)=>{if(this.state._tag==="Done")return X(this.state.exit);return this.state.takers.add(X),T(()=>{if(this.state._tag!=="Done")this.state.takers.delete(X)})});scheduleRunning=!1;scheduleReleaseTaker(){if(this.scheduleRunning)return;this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0)}releaseTaker=()=>{if(this.scheduleRunning=!1,this.state._tag==="Done")return;else if(this.state.takers.size===0)return;let X=Aq(this.state.takers);this.state.takers.delete(X),X(M0)};unsafeTakeAll(){if(this.messagesChunk.length>0){let X=this.messages.length>0?t8(this.messagesChunk,b0(this.messages)):this.messagesChunk;return this.messagesChunk=eY,this.messages=[],X}else if(this.messages.length>0){let X=b0(this.messages);return this.messages=[],X}else if(this.state._tag!=="Done"&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,I8(this.messages.pop());return eY}finalize(X){if(this.state._tag==="Done")return;let J=this.state;this.state={_tag:"Done",exit:X};for(let Z of J.takers)Z(X);J.takers.clear();for(let Z of J.awaiters)Z(X);J.awaiters.clear()}}var uo=(X)=>A8((J)=>w(new co(J.currentScheduler,typeof X==="number"?X:X?.capacity??Number.POSITIVE_INFINITY,typeof X==="number"?"suspend":X?.strategy??"suspend")));var po=(X)=>{let J=M8(X.takeAll,([Z,Y])=>Y?Z.length===0?t6:d8(Z):QJ(d8(Z),J));return J};var A$8=cz;var fo=(X)=>v(X,A$8);var uz=uo;var no=po;class pz extends xK("@effect/platform/Transferable/Collector")(){}var oo=()=>{let X=[],J=($)=>{X.push(...$)},Z=()=>X,Y=()=>{let $=X;return X=[],$};return pz.of({unsafeAddAll:J,addAll:($)=>V8(()=>J($)),unsafeRead:Z,read:V8(Z),unsafeClear:Y,clear:V8(Y)})};var ro=Symbol.for("@effect/platform/WorkerError");var lo=ro;class wJ extends jH()("WorkerError",{reason:m6("spawn","decode","send","unknown","encode"),cause:yY}){[lo]=lo;static Cause=Ou({error:this,defect:yY});static encodeCause=LL(this.Cause);static decodeCause=wL(this.Cause);get message(){switch(this.reason){case"send":return"An error occurred calling .postMessage";case"spawn":return"An error occurred while spawning a worker";case"decode":return"An error occurred during decoding";case"encode":return"An error occurred during encoding";case"unknown":return"An unexpected error occurred"}}}var sM=Symbol.for("@effect/platform/Worker/PlatformWorker"),fz=o8("@effect/platform/Worker/PlatformWorker"),tM=Symbol.for("@effect/platform/Worker/WorkerManager"),eM=o8("@effect/platform/Worker/WorkerManager"),io=o8("@effect/platform/Worker/Spawner"),ao=_8(function*(){let X=yield*fz,J=0;return eM.of({[tM]:tM,spawn({encode:Z,initialMessage:Y}){return _8(function*(){let $=J++,Q=0,G=new Map,H=oo(),K=Z?(P)=>B8(H.clear,PQ(Z(P),pz,H)):L,V=yield*K0(),W=yield*X.spawn($);yield*W.run((P)=>{if(P[0]===0)return vW(V,o);return N(P[1])}).pipe(g3((P)=>F0(G.values(),(M)=>(D1 in M)?d7(M,P):M.failCause(P))),lX(Tw),qw(nd(1000)),Mw({package:"@effect/platform",module:"Worker"}),g6,TQ),yield*b3(()=>B8(F0(G.values(),(P)=>(D1 in P)?x3(P):P.end,{discard:!0}),V8(()=>G.clear())));let N=(P)=>z8(()=>{let M=G.get(P[0]);if(!M)return o;switch(P[1]){case 0:return D1 in M?b6(M,P[2][0]):M.offerAll(P[2]);case 1:{if(P.length===2)return D1 in M?x3(M):M.end;return D1 in M?b6(M,P[2][0]):B8(M.offerAll(P[2]),M.end)}case 2:case 3:{if(P[1]===2)return D1 in M?Yw(M,P[2]):M.fail(P[2]);let c=wJ.decodeCause(P[2]);return D1 in M?d7(M,c):M.failCause(c)}}}),z=(P,M)=>w1((c)=>{let y=c.getFiberRef(wm),s=w4(y,XS).pipe(Dq((l)=>l._tag==="Span")),Y8=Q++;return M.pipe(X0((l)=>{return G.set(Y8,l),K(P).pipe(X0((G8)=>W.send([Y8,0,G8,s._tag==="Some"?[s.value.traceId,s.value.spanId,s.value.sampled]:void 0],H.unsafeRead())),c7((G8)=>fo(l)?l.failCause(G8):d7(l,G8)))}),k((l)=>({id:Y8,mailbox:l})))}),q=({id:P},M)=>{let c=V8(()=>G.delete(P));return V5(M)?B8(d0(W.send([P,1])),c):c},A=(P)=>nQ(Oc(z(P,uz()),({mailbox:M})=>no(M),q)),E=(P)=>LQ(z(P,K0()),({mailbox:M})=>k8(M),q);if(yield*k8(V),Y)yield*V8(Y).pipe(R(E),s6((P)=>new wJ({reason:"spawn",cause:P})));return{id:$,execute:A,executeEffect:E}})}})}),so=kQ(eM,ao);var to=()=>(X)=>fz.of({[sM]:sM,spawn(J){return _8(function*(){let Z=yield*io,Y,$=[];return{run:(H)=>WY((K)=>_8(function*(){let V=yield*h3,W=yield*X.setup({worker:Z(J),scope:V});Y=W,yield*fX(V,V8(()=>{Y=void 0}));let N=(yield*aX()).pipe(fd(SR(by))),z=yield*vo(),q=AT(N);if(yield*X.listen({port:W,scope:V,emit(A){yo(z,q(H(A)))},deferred:z.deferred}),$.length>0){for(let[A,E]of $)W.postMessage([0,A],E);$.length=0}return yield*K(bo(z))}).pipe(k9)),send:(H,K)=>p7({try:()=>{if(Y===void 0)$.push([H,K]);else Y.postMessage([0,H],K)},catch:(V)=>new wJ({reason:"send",cause:V})})}})}});var eo=to,Xr=fz;var Jr=so;var XF=(X,J,Z)=>nQ(P$8(X,J,Z));var P$8=(X,J,Z)=>ET(()=>F$8(X(),J,f4(void 0),Z)),Zr=(X,J,{encoding:Z,endOnDone:Y=!0}={},$=o)=>{let Q=M$8(X,Z),G=Y?j4((H)=>{if("closed"in X&&X.closed)H(o);else X.once("finish",()=>H(o)),X.end()}):o;return{awaitRead:()=>o,emit:Q,error:(H)=>B8(G,J(H)),done:(H)=>B8(G,$)}},M$8=(X,J)=>(Z)=>Z.length===0?o:j4((Y)=>{let $=Z[Symbol.iterator](),Q=$.next();function G(){let H=Q;Q=$.next();let K=X.write(H.value,J);if(Q.done)Y(o);else if(K)G();else X.once("drain",G)}G()}),F$8=(X,J,Z,Y)=>{if(!X.readable)return AH;let $=sW(!1);function Q(){$.unsafeOpen()}function G(W){Z.current=W1(J(W)),$.unsafeOpen()}function H(){Z.current=b7,$.unsafeOpen()}X.on("readable",Q),X.on("error",G),X.on("end",H);let K=Y?.chunkSize?Number(Y.chunkSize):void 0,V=ET(function W(){let N=X.read(K);if(N===null){if(Z.current)return Ac(Z.current);return $.unsafeClose(),v1($.await,W)}let z=[N];while(!0){if(N=X.read(K),N===null)return v1(zN(b0(z)),W);z.push(N)}});return Dc(V,V8(()=>{if(X.off("readable",Q),X.off("error",G),X.off("end",H),Y?.closeOnDone!==!1&&"closed"in X&&!X.closed)X.destroy()}))};var Yr=(X,J,Z)=>Tc(R$8(X,J,Z)),R$8=(X,J,Z)=>v1(Y9(V8(()=>X()),K0()),([Y,$])=>CT(j$8(Y,$,J),Zr(Y,(Q)=>d7($,Q),Z,vW($,o)))),j$8=(X,J,Z)=>z8(()=>{function Y($){N5(J,x(Z($)))}return X.on("error",Y),Z9(k8(J),V8(()=>{X.removeListener("error",Y)}))});var lz={};QK(lz,{layer:()=>MQ8});var JF=Symbol.for("@effect/platform/CommandExecutor"),$r=Symbol.for("@effect/platform/Process"),Qr=ZH(),Gr=ZH(),Hr=o8("@effect/platform/CommandExecutor"),Kr=(X)=>{let J=(Y)=>k1(k(X(Y),($)=>$.stdout)),Z=(Y,$)=>{let Q=new TextDecoder($);return Cc(Rc(J(Y),BZ((G)=>Q.decode(G))))};return{[JF]:JF,start:X,exitCode:(Y)=>k9(R(X(Y),($)=>$.exitCode)),stream:J,string:(Y,$="utf-8")=>{let Q=new TextDecoder($);return U(X(Y),R((G)=>qN(G.stdout,C$8)),k((G)=>Q.decode(G)),k9)},lines:(Y,$="utf-8")=>{return U(Z(Y,$),jc,k(xR))},streamLines:Z}},C$8=wc(new Uint8Array,(X,J)=>iG(J,X,(Z,Y)=>{let $=new Uint8Array(Z.length+Y.length);return $.set(Z),$.set(Y,Z.length),$}));var ZF=Symbol.for("@effect/platform/Command");var Br=(X)=>Array.from(YF(X)),YF=(X)=>{switch(X._tag){case"StandardCommand":return I8(X);case"PipedCommand":return t8(YF(X.left),YF(X.right))}};var Vr={[ZF]:ZF,pipe(){return C(this,arguments)},...WK},I$8={...Vr,_tag:"StandardCommand",toJSON(){return{_id:"@effect/platform/Command",_tag:this._tag,command:this.command,args:this.args,env:Object.fromEntries(this.env),cwd:this.cwd.toJSON(),shell:this.shell,gid:this.gid.toJSON(),uid:this.uid.toJSON()}}},S$8=(X)=>Object.assign(Object.create(I$8),X),v$8={...Vr,_tag:"PipedCommand",toJSON(){return{_id:"@effect/platform/Command",_tag:this._tag,left:this.left.toJSON(),right:this.right.toJSON()}}},k$8=(X)=>Object.assign(Object.create(v$8),X);var $F=B(2,(X,J)=>{switch(X._tag){case"StandardCommand":return S$8({...X,stdin:J});case"PipedCommand":return k$8({...X,left:$F(X.left,J)})}});var QF=Br;var GF=$F;var Wr=Hr,HF=$r,Ur=Qr,Nr=Gr,zr=Kr;import*as nz from"node:child_process";var Z0=(X,J)=>(Z,[Y])=>{let $="Unknown";switch(Z.code){case"ENOENT":$="NotFound";break;case"EACCES":$="PermissionDenied";break;case"EEXIST":$="AlreadyExists";break;case"EISDIR":$="BadResource";break;case"ENOTDIR":$="BadResource";break;case"EBUSY":$="Busy";break;case"ELOOP":$="BadResource";break}return new bY({reason:$,module:X,method:J,pathOrDescriptor:Y,syscall:Z.syscall,description:Z.message,cause:Z})};var g$8=(X)=>typeof X==="string"?X:"pipe",qr=(X)=>typeof X==="string"?X:"pipe",ZK=(X)=>X instanceof globalThis.Error?X:new globalThis.Error(String(X)),i1=(X,J,Z)=>{let Y=QF(Z).reduce(($,Q)=>{let G=`${Q.command} ${Q.args.join(" ")}`;return $.length===0?G:`${$} | ${G}`},"");return Z0("Command",X)(J,[Y])},h$8={[HF]:HF,...WK,toJSON(){return{_id:"@effect/platform/CommandExecutor/Process",pid:this.pid}}},YK=(X)=>(J)=>{switch(J._tag){case"StandardCommand":{let Z=R(K0(),(Q)=>j4((G)=>{let H=nz.spawn(J.command,J.args,{stdio:[g$8(J.stdin),qr(J.stdout),qr(J.stderr)],cwd:i(J.cwd,J$),shell:J.shell,env:{...process.env,...Object.fromEntries(J.env)},detached:process.platform!=="win32"});return H.on("error",(K)=>{G(x(i1("spawn",K,J)))}),H.on("exit",(...K)=>{N5(Q,L(K))}),H.on("spawn",()=>{G(L([H,Q]))}),V8(()=>{H.kill("SIGTERM")})})),Y=process.platform==="win32"?(Q,G)=>j4((H)=>{nz.exec(`taskkill /pid ${Q.pid} /T /F`,(K)=>{if(K)H(x(i1("kill",ZK(K),J)));else H(o)})}):(Q,G)=>p7({try:()=>process.kill(-Q.pid,G),catch:(H)=>i1("kill",ZK(H),J)}),$=(Q,G)=>z8(()=>Q.kill(G)?o:x(i1("kill",new globalThis.Error("Failed to kill process"),J)));return U(n(J.cwd,{onNone:()=>o,onSome:(Q)=>X.access(Q)}),B8(P6(Z,([Q,G])=>R(A1(G),(H)=>{if(!H)return Y(Q,"SIGTERM").pipe(iX(()=>$(Q,"SIGTERM")),B8(k8(G)),wQ);return R(k8(G),([K])=>{if(K!==0&&K!==null)return Y(Q,"SIGTERM").pipe(wQ);return o})}))),k(([Q,G])=>{let H=_c;if(Q.stdin!==null)H=Yr(()=>Q.stdin,(A)=>i1("toWritable",ZK(A),J));let K=R(k8(G),([A,E])=>{if(A!==null)return L(Ur(A));return x(i1("exitCode",new globalThis.Error(`Process interrupted due to receipt of signal: ${E}`),J))}),V=Dw(A1(G)),W=(A="SIGTERM")=>Y(Q,A).pipe(iX(()=>$(Q,A)),B8(J9(k8(G)))),N=Nr(Q.pid),z=XF(()=>Q.stderr,(A)=>i1("fromReadable(stderr)",ZK(A),J)),q=XF(()=>Q.stdout,(A)=>i1("fromReadable(stdout)",ZK(A),J));if(typeof J.stdout!=="string")q=Ec(q,J.stdout);return Object.assign(Object.create(h$8),{pid:N,exitCode:K,isRunning:V,kill:W,stdin:H,stderr:z,stdout:q})}),typeof J.stdin==="string"?g:X0((Q)=>UY(qN(J.stdin,Q.stdin))))}case"PipedCommand":{let Z=QF(J);if(Z.length===1)return U(Z[0],YK(X));let Y=Z[0],$=Z.slice(1),Q=$.slice(0,$.length-1),G=$[$.length-1],H=Q.reduce((K,V)=>U(GF(V,K),YK(X),k((W)=>W.stdout),k1),U(YK(X)(Y),k((K)=>K.stdout),k1));return U(GF(G,H),YK(X))}}},Or=kQ(Wr,U(l7,k((X)=>zr(YK(X)))));var Dr=Or;var Ar=(X,J,Z)=>(...Y)=>j4(($)=>{try{X(...Y,(Q,G)=>{if(Q)$(x(J?J(Q,Y):Q));else $(L(G))})}catch(Q){$(Z?x(Z(Q,Y)):I9(Q))}});var E0=Ar;import*as _r from"node:crypto";import*as W8 from"node:fs";import*as wr from"node:os";import*as CG from"node:path";var L0=(X)=>(J)=>new x4({module:"FileSystem",method:X,cause:J}),u$8=(()=>{let X=E0(W8.access,Z0("FileSystem","access"),L0("access"));return(J,Z)=>{let Y=W8.constants.F_OK;if(Z?.readable)Y|=W8.constants.R_OK;if(Z?.writable)Y|=W8.constants.W_OK;return X(J,Y)}})(),p$8=(()=>{let X=E0(W8.cp,Z0("FileSystem","copy"),L0("copy"));return(J,Z,Y)=>X(J,Z,{force:Y?.overwrite??!1,preserveTimestamps:Y?.preserveTimestamps??!1,recursive:!0})})(),f$8=(()=>{let X=E0(W8.copyFile,Z0("FileSystem","copyFile"),L0("copyFile"));return(J,Z)=>X(J,Z)})(),n$8=(()=>{let X=E0(W8.chmod,Z0("FileSystem","chmod"),L0("chmod"));return(J,Z)=>X(J,Z)})(),o$8=(()=>{let X=E0(W8.chown,Z0("FileSystem","chown"),L0("chown"));return(J,Z,Y)=>X(J,Z,Y)})(),r$8=(()=>{let X=E0(W8.link,Z0("FileSystem","link"),L0("link"));return(J,Z)=>X(J,Z)})(),l$8=(()=>{let X=E0(W8.mkdir,Z0("FileSystem","makeDirectory"),L0("makeDirectory"));return(J,Z)=>X(J,{recursive:Z?.recursive??!1,mode:Z?.mode})})(),KF=(X)=>{let J=E0(W8.mkdtemp,Z0("FileSystem",X),L0(X));return(Z)=>z8(()=>{let Y=Z?.prefix??"",$=typeof Z?.directory==="string"?CG.join(Z.directory,"."):wr.tmpdir();return J(Y?CG.join($,Y):$+"/")})},i$8=KF("makeTempDirectory"),BF=(X)=>{let J=E0(W8.rm,Z0("FileSystem",X),L0(X));return(Z,Y)=>J(Z,{recursive:Y?.recursive??!1,force:Y?.force??!1})},a$8=BF("remove"),s$8=(()=>{let X=KF("makeTempDirectoryScoped"),J=BF("makeTempDirectoryScoped");return(Z)=>P6(X(Z),(Y)=>d0(J(Y,{recursive:!0})))})(),Lr=(X)=>{let J=E0(W8.open,Z0("FileSystem",X),L0(X)),Z=E0(W8.close,Z0("FileSystem",X),L0(X));return(Y,$)=>U(P6(J(Y,$?.flag??"r",$?.mode),(Q)=>d0(Z(Q))),k((Q)=>e$8(wu(Q),$?.flag?.startsWith("a")??!1)))},t$8=Lr("open"),e$8=(()=>{let X=(W)=>E0(W8.read,Z0("FileSystem",W),L0(W)),J=X("read"),Z=X("readAlloc"),Y=E0(W8.fstat,Z0("FileSystem","stat"),L0("stat")),$=E0(W8.ftruncate,Z0("FileSystem","truncate"),L0("truncate")),Q=E0(W8.fsync,Z0("FileSystem","sync"),L0("sync")),G=(W)=>E0(W8.write,Z0("FileSystem",W),L0(W)),H=G("write"),K=G("writeAll");class V{fd;append;[CN];semaphore=Fw(1);position=0n;constructor(W,N){this.fd=W,this.append=N,this[CN]=CN}get stat(){return k(Y(this.fd),Pr)}get sync(){return Q(this.fd)}seek(W,N){let z=aQ(W);return this.semaphore.withPermits(1)(V8(()=>{if(N==="start")this.position=z;else if(N==="current")this.position=this.position+z;return this.position}))}read(W){return this.semaphore.withPermits(1)(k(z8(()=>J(this.fd,{buffer:W,position:this.position})),(N)=>{let z=aQ(N);return this.position=this.position+z,z}))}readAlloc(W){let N=Number(W);return this.semaphore.withPermits(1)(R(V8(()=>Buffer.allocUnsafeSlow(N)),(z)=>k(Z(this.fd,{buffer:z,position:this.position}),(q)=>{if(q===0)return _();if(this.position=this.position+BigInt(q),q===N)return D(z);let A=Buffer.allocUnsafeSlow(q);return z.copy(A,0,0,q),D(A)})))}truncate(W){return this.semaphore.withPermits(1)(k($(this.fd,W?Number(W):void 0),()=>{if(!this.append){let N=BigInt(W??0);if(this.position>N)this.position=N}}))}write(W){return this.semaphore.withPermits(1)(k(z8(()=>H(this.fd,W,void 0,void 0,this.append?void 0:Number(this.position))),(N)=>{let z=aQ(N);if(!this.append)this.position=this.position+z;return z}))}writeAllChunk(W){return R(z8(()=>K(this.fd,W,void 0,void 0,this.append?void 0:Number(this.position))),(N)=>{if(N===0)return x(new bY({module:"FileSystem",method:"writeAll",reason:"WriteZero",pathOrDescriptor:this.fd,description:"write returned 0 bytes written"}));if(!this.append)this.position=this.position+BigInt(N);return N<W.length?this.writeAllChunk(W.subarray(N)):o})}writeAll(W){return this.semaphore.withPermits(1)(this.writeAllChunk(W))}}return(W,N)=>new V(W,N)})(),Tr=(X)=>{let J=KF(X),Z=Lr(X),Y=($)=>V8(()=>_r.randomBytes($).toString("hex"));return($)=>U(Y9(J($),Y(6)),k(([Q,G])=>CG.join(Q,G+($?.suffix??""))),X0((Q)=>k9(Z(Q,{flag:"w+"}))))},XQ8=Tr("makeTempFile"),JQ8=(()=>{let X=Tr("makeTempFileScoped"),J=BF("makeTempFileScoped");return(Z)=>P6(X(Z),(Y)=>d0(J(CG.dirname(Y),{recursive:!0})))})(),ZQ8=(X,J)=>pW({try:()=>W8.promises.readdir(X,J),catch:(Z)=>Z0("FileSystem","readDirectory")(Z,[X])}),YQ8=(X)=>j4((J,Z)=>{try{W8.readFile(X,{signal:Z},(Y,$)=>{if(Y)J(x(Z0("FileSystem","readFile")(Y,[X])));else J(L($))})}catch(Y){J(x(L0("readFile")(Y)))}}),$Q8=(()=>{let X=E0(W8.readlink,Z0("FileSystem","readLink"),L0("readLink"));return(J)=>X(J)})(),QQ8=(()=>{let X=E0(W8.realpath,Z0("FileSystem","realPath"),L0("realPath"));return(J)=>X(J)})(),GQ8=(()=>{let X=E0(W8.rename,Z0("FileSystem","rename"),L0("rename"));return(J,Z)=>X(J,Z)})(),Pr=(X)=>({type:X.isFile()?"File":X.isDirectory()?"Directory":X.isSymbolicLink()?"SymbolicLink":X.isBlockDevice()?"BlockDevice":X.isCharacterDevice()?"CharacterDevice":X.isFIFO()?"FIFO":X.isSocket()?"Socket":"Unknown",mtime:Y0(X.mtime),atime:Y0(X.atime),birthtime:Y0(X.birthtime),dev:X.dev,rdev:Y0(X.rdev),ino:Y0(X.ino),mode:X.mode,nlink:Y0(X.nlink),uid:Y0(X.uid),gid:Y0(X.gid),size:aQ(X.size),blksize:q0(Y0(X.blksize),aQ),blocks:Y0(X.blocks)}),VF=(()=>{let X=E0(W8.stat,Z0("FileSystem","stat"),L0("stat"));return(J)=>k(X(J),Pr)})(),HQ8=(()=>{let X=E0(W8.symlink,Z0("FileSystem","symlink"),L0("symlink"));return(J,Z)=>X(J,Z)})(),KQ8=(()=>{let X=E0(W8.truncate,Z0("FileSystem","truncate"),L0("truncate"));return(J,Z)=>X(J,Z!==void 0?Number(Z):void 0)})(),BQ8=(()=>{let X=E0(W8.utimes,Z0("FileSystem","utime"),L0("utime"));return(J,Z,Y)=>X(J,Z,Y)})(),VQ8=(X,J)=>Mc((Z)=>P6(V8(()=>{let Y=W8.watch(X,{recursive:J?.recursive},($,Q)=>{if(!Q)return;switch($){case"rename":{Z.fromEffect(M6(VF(Q),{onSuccess:(G)=>L(Lu({path:Q})),onFailure:(G)=>G._tag==="SystemError"&&G.reason==="NotFound"?L(Pu({path:Q})):x(G)}));return}case"change":{Z.single(Tu({path:Q}));return}}});return Y.on("error",($)=>{Z.fail(new bY({module:"FileSystem",reason:"Unknown",method:"watch",pathOrDescriptor:X,cause:$}))}),Y.on("close",()=>{Z.end()}),Y}),(Y)=>V8(()=>Y.close()))),WQ8=(X,J,Z)=>VF(J).pipe(k((Y)=>X.pipe(C6(($)=>$.register(J,Y,Z)),i(()=>VQ8(J,Z)))),Ic),UQ8=(X,J,Z)=>j4((Y,$)=>{try{W8.writeFile(X,J,{signal:$,flag:Z?.flag,mode:Z?.mode},(Q)=>{if(Q)Y(x(Z0("FileSystem","writeFile")(Q,[X])));else Y(o)})}catch(Q){Y(x(L0("writeFile")(Q)))}}),NQ8=k(rW(ZP),(X)=>_u({access:u$8,chmod:n$8,chown:o$8,copy:p$8,copyFile:f$8,link:r$8,makeDirectory:l$8,makeTempDirectory:i$8,makeTempDirectoryScoped:s$8,makeTempFile:XQ8,makeTempFileScoped:JQ8,open:t$8,readDirectory:ZQ8,readFile:YQ8,readLink:$Q8,realPath:QQ8,remove:a$8,rename:GQ8,stat:VF,symlink:HQ8,truncate:KQ8,utimes:BQ8,watch(J,Z){return WQ8(X,J,Z)},writeFile:UQ8})),Mr=kQ(l7,NQ8);var Fr=Mr;import*as $K from"node:path";import*as oz from"node:url";var WF=(X)=>p7({try:()=>oz.fileURLToPath(X),catch:(J)=>new x4({module:"Path",method:"fromFileUrl",description:`Invalid file URL: ${X}`,cause:J})}),UF=(X)=>p7({try:()=>oz.pathToFileURL(X),catch:(J)=>new x4({module:"Path",method:"toFileUrl",description:`Invalid path: ${X}`,cause:J})}),OQ8=wY(p9,p9.of({[nY]:nY,...$K.posix,fromFileUrl:WF,toFileUrl:UF})),DQ8=wY(p9,p9.of({[nY]:nY,...$K.win32,fromFileUrl:WF,toFileUrl:UF})),Rr=wY(p9,p9.of({[nY]:nY,...$K,fromFileUrl:WF,toFileUrl:UF}));var jr=Rr;import*as rz from"node:readline";var Cr=(X)=>X.key.ctrl&&(X.key.name==="c"||X.key.name==="d"),Er=FQ(function*(X=Cr){let{stdin:J,stdout:Z}=process,Y=yield*cd({acquire:P6(V8(()=>{let K=rz.createInterface({input:J,escapeCodeTimeout:50});if(rz.emitKeypressEvents(J,K),J.isTTY)J.setRawMode(!0);return K}),(K)=>V8(()=>{if(J.isTTY)J.setRawMode(!1);K.close()}))}),$=V8(()=>Z.columns??0),Q=_8(function*(){yield*DT(Y);let K=yield*uz(),V=(W,N)=>{let z={input:Y0(W),key:{name:N.name??"",ctrl:!!N.ctrl,meta:!!N.meta,shift:!!N.shift}};if(K.unsafeOffer(z),X(z))K.unsafeDone(b7)};return yield*b3(()=>V8(()=>J.off("keypress",V))),J.on("keypress",V),K}),G=DT(Y).pipe(R((K)=>j4((V)=>{let W=(N)=>V(L(N));return K.once("line",W),V8(()=>K.off("line",W))})),k9),H=(K)=>e5(j4((V)=>{Z.write(K,(W)=>W?V(x(new x4({module:"Terminal",method:"display",description:"Failed to write prompt to stdout",cause:W}))):V(o))}));return J0.of({columns:$,readInput:Q,readLine:G,display:H})}),Ir=RL(J0,Er(Cr));var Sr=Ir;var TQ8=eo()({setup({scope:X,worker:J}){return R(K0(),(Z)=>{let Y="postMessage"in J?{postMessage($,Q){J.postMessage($,Q)},kill:()=>J.terminate(),worker:J}:{postMessage($,Q){J.send($)},kill:()=>J.kill("SIGKILL"),worker:J};return J.on("exit",()=>{N5(Z,b7)}),K6(fX(X,z8(()=>{return Y.postMessage([1]),k8(Z)}).pipe(g6,_w(5000),c7(()=>V8(()=>Y.kill())))),Y)})},listen({deferred:X,emit:J,port:Z}){return Z.worker.on("message",(Y)=>{J(Y)}),Z.worker.on("messageerror",(Y)=>{N5(X,new wJ({reason:"decode",cause:Y}))}),Z.worker.on("error",(Y)=>{N5(X,new wJ({reason:"unknown",cause:Y}))}),Z.worker.on("exit",(Y)=>{N5(X,new wJ({reason:"unknown",cause:Error(`exited with code ${Y}`)}))}),o}}),vr=wY(Xr,TQ8),kr=Pm(Jr,vr);var xr=kr;var MQ8=U(Tm(jr,Dr,Sr,xr),Mm(Fr));var iz={};QK(iz,{runMain:()=>CQ8});var FQ8=(X,J)=>{J(V5(X)&&!q3(X.cause)?1:0)},br=(X,J)=>{let Z=nZ(X,ML);if(!j$(Z,xM))return X;return PD(X,{fiberId:J,fiberRef:ML,value:Z.pipe(eG(xM),TX(cn))})},gr=(X)=>B((J)=>T6(J[0]),(J,Z)=>{let Y=Z?.disableErrorReporting===!0?sX(J,{updateRefs:Z?.disablePrettyLogger===!0?void 0:br}):sX(lX(J,(Q)=>{if(q3(Q))return o;return Pw(Q)}),{updateRefs:Z?.disablePrettyLogger===!0?void 0:br}),$=Z?.teardown??FQ8;return X({fiber:Y,teardown:$})});var hr=gr(({fiber:X,teardown:J})=>{let Z=setInterval(Y4,2147483647),Y=!1;X.addObserver((Q)=>{if(!Y)process.removeListener("SIGINT",$),process.removeListener("SIGTERM",$);clearInterval(Z),J(Q,(G)=>{if(Y||G!==0)process.exit(G)})});function $(){Y=!0,process.removeListener("SIGINT",$),process.removeListener("SIGTERM",$),X.unsafeInterruptAsFork(X.id())}process.on("SIGINT",$),process.on("SIGTERM",$)});var mr=hr;var CQ8=mr;var EQ8=_J.make("tui").pipe(_J.withDescription("Launch interactive Sylphx Flow TUI")),IQ8=_J.make("sylphx-flow").pipe(_J.withDescription("Sylphx Flow - Type-safe development flow CLI"),_J.withSubcommands([EQ8]));function dr(){let X=_J.run(IQ8,{name:"sylphx-flow",version:"1.0.0"}),J=lz.layer;w8.suspend(()=>X(process.argv)).pipe(w8.provide(J),w8.tapErrorCause(w8.logError),iz.runMain)}dr();
