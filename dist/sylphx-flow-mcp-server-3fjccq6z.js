import{t as nP,v as Av}from"./index-594hd6mp.js";import"./index-2th2r979.js";import{y as oP}from"./embeddings-8mp3gwvs.js";import"./index-h5pvnw0h.js";import{K as sP}from"./paths-0cn30jrg.js";import{N as bP,O as _,P,Q as Ef,S as Lf,V as iP}from"./index-fgf3ne5w.js";import{W as fP,X as T,Z as r0}from"./index-b8xrx8ea.js";var fh=T((tr,ah)=>{(function(a,v){typeof tr==="object"&&typeof ah<"u"?v(tr):typeof define==="function"&&define.amd?define(["exports"],v):v(a.URI=a.URI||{})})(tr,function(a){function v(){for(var W=arguments.length,Z=Array(W),Y=0;Y<W;Y++)Z[Y]=arguments[Y];if(Z.length>1){Z[0]=Z[0].slice(0,-1);var E=Z.length-1;for(var L=1;L<E;++L)Z[L]=Z[L].slice(1,-1);return Z[E]=Z[E].slice(1),Z.join("")}else return Z[0]}function f(W){return"(?:"+W+")"}function h(W){return W===void 0?"undefined":W===null?"null":Object.prototype.toString.call(W).split(" ").pop().split("]").shift().toLowerCase()}function r(W){return W.toUpperCase()}function l(W){return W!==void 0&&W!==null?W instanceof Array?W:typeof W.length!=="number"||W.split||W.setInterval||W.call?[W]:Array.prototype.slice.call(W):[]}function y(W,Z){var Y=W;if(Z)for(var E in Z)Y[E]=Z[E];return Y}function u(W){var Z="[A-Za-z]",Y="[\\x0D]",E="[0-9]",L="[\\x22]",M=v(E,"[A-Fa-f]"),C="[\\x0A]",i="[\\x20]",o=f(f("%[EFef]"+M+"%"+M+M+"%"+M+M)+"|"+f("%[89A-Fa-f]"+M+"%"+M+M)+"|"+f("%"+M+M)),Bv="[\\:\\/\\?\\#\\[\\]\\@]",m="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",yv=v(Bv,m),Kv=W?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",lv=W?"[\\uE000-\\uF8FF]":"[]",t=v(Z,E,"[\\-\\.\\_\\~]",Kv),uv=f(Z+v(Z,E,"[\\+\\-\\.]")+"*"),rv=f(f(o+"|"+v(t,m,"[\\:]"))+"*"),fr=f(f("25[0-5]")+"|"+f("2[0-4]"+E)+"|"+f("1"+E+E)+"|"+f("[1-9]"+E)+"|"+E),gv=f(f("25[0-5]")+"|"+f("2[0-4]"+E)+"|"+f("1"+E+E)+"|"+f("0?[1-9]"+E)+"|0?0?"+E),Mv=f(gv+"\\."+gv+"\\."+gv+"\\."+gv),av=f(M+"{1,4}"),Vv=f(f(av+"\\:"+av)+"|"+Mv),jv=f(f(av+"\\:")+"{6}"+Vv),Tv=f("\\:\\:"+f(av+"\\:")+"{5}"+Vv),hr=f(f(av)+"?\\:\\:"+f(av+"\\:")+"{4}"+Vv),cv=f(f(f(av+"\\:")+"{0,1}"+av)+"?\\:\\:"+f(av+"\\:")+"{3}"+Vv),Fr=f(f(f(av+"\\:")+"{0,2}"+av)+"?\\:\\:"+f(av+"\\:")+"{2}"+Vv),Mr=f(f(f(av+"\\:")+"{0,3}"+av)+"?\\:\\:"+av+"\\:"+Vv),jr=f(f(f(av+"\\:")+"{0,4}"+av)+"?\\:\\:"+Vv),wr=f(f(f(av+"\\:")+"{0,5}"+av)+"?\\:\\:"+av),Wr=f(f(f(av+"\\:")+"{0,6}"+av)+"?\\:\\:"),dv=f([jv,Tv,hr,cv,Fr,Mr,jr,wr,Wr].join("|")),Jr=f(f(t+"|"+o)+"+"),Ua=f(dv+"\\%25"+Jr),lr=f(dv+f("\\%25|\\%(?!"+M+"{2})")+Jr),Wy=f("[vV]"+M+"+\\."+v(t,m,"[\\:]")+"+"),Jy=f("\\["+f(lr+"|"+dv+"|"+Wy)+"\\]"),Mf=f(f(o+"|"+v(t,m))+"*"),Gr=f(Jy+"|"+Mv+"(?!"+Mf+")|"+Mf),Er=f(E+"*"),jf=f(f(rv+"@")+"?"+Gr+f("\\:"+Er)+"?"),Lr=f(o+"|"+v(t,m,"[\\:\\@]")),By=f(Lr+"*"),$f=f(Lr+"+"),Ky=f(f(o+"|"+v(t,m,"[\\@]"))+"+"),pv=f(f("\\/"+By)+"*"),Br=f("\\/"+f($f+pv)+"?"),qa=f(Ky+pv),$r=f($f+pv),Kr="(?!"+Lr+")",N0=f(pv+"|"+Br+"|"+qa+"|"+$r+"|"+Kr),Yr=f(f(Lr+"|"+v("[\\/\\?]",lv))+"*"),zr=f(f(Lr+"|[\\/\\?]")+"*"),kf=f(f("\\/\\/"+jf+pv)+"|"+Br+"|"+$r+"|"+Kr),Yy=f(uv+"\\:"+kf+f("\\?"+Yr)+"?"+f("\\#"+zr)+"?"),Xy=f(f("\\/\\/"+jf+pv)+"|"+Br+"|"+qa+"|"+Kr),Dy=f(Xy+f("\\?"+Yr)+"?"+f("\\#"+zr)+"?"),U0=f(Yy+"|"+Dy),q0=f(uv+"\\:"+kf+f("\\?"+Yr)+"?"),g0="^("+uv+")\\:"+f(f("\\/\\/("+f("("+rv+")@")+"?("+Gr+")"+f("\\:("+Er+")")+"?)")+"?("+pv+"|"+Br+"|"+$r+"|"+Kr+")")+f("\\?("+Yr+")")+"?"+f("\\#("+zr+")")+"?$",V0="^(){0}"+f(f("\\/\\/("+f("("+rv+")@")+"?("+Gr+")"+f("\\:("+Er+")")+"?)")+"?("+pv+"|"+Br+"|"+qa+"|"+Kr+")")+f("\\?("+Yr+")")+"?"+f("\\#("+zr+")")+"?$",A0="^("+uv+")\\:"+f(f("\\/\\/("+f("("+rv+")@")+"?("+Gr+")"+f("\\:("+Er+")")+"?)")+"?("+pv+"|"+Br+"|"+$r+"|"+Kr+")")+f("\\?("+Yr+")")+"?$",H0="^"+f("\\#("+zr+")")+"?$",M0="^"+f("("+rv+")@")+"?("+Gr+")"+f("\\:("+Er+")")+"?$";return{NOT_SCHEME:new RegExp(v("[^]",Z,E,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(v("[^\\%\\:]",t,m),"g"),NOT_HOST:new RegExp(v("[^\\%\\[\\]\\:]",t,m),"g"),NOT_PATH:new RegExp(v("[^\\%\\/\\:\\@]",t,m),"g"),NOT_PATH_NOSCHEME:new RegExp(v("[^\\%\\/\\@]",t,m),"g"),NOT_QUERY:new RegExp(v("[^\\%]",t,m,"[\\:\\@\\/\\?]",lv),"g"),NOT_FRAGMENT:new RegExp(v("[^\\%]",t,m,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(v("[^]",t,m),"g"),UNRESERVED:new RegExp(t,"g"),OTHER_CHARS:new RegExp(v("[^\\%]",t,yv),"g"),PCT_ENCODED:new RegExp(o,"g"),IPV4ADDRESS:new RegExp("^("+Mv+")$"),IPV6ADDRESS:new RegExp("^\\[?("+dv+")"+f(f("\\%25|\\%(?!"+M+"{2})")+"("+Jr+")")+"?\\]?$")}}var w=u(!1),K=u(!0),X=function(){function W(Z,Y){var E=[],L=!0,M=!1,C=void 0;try{for(var i=Z[Symbol.iterator](),o;!(L=(o=i.next()).done);L=!0)if(E.push(o.value),Y&&E.length===Y)break}catch(Bv){M=!0,C=Bv}finally{try{if(!L&&i.return)i.return()}finally{if(M)throw C}}return E}return function(Z,Y){if(Array.isArray(Z))return Z;else if(Symbol.iterator in Object(Z))return W(Z,Y);else throw TypeError("Invalid attempt to destructure non-iterable instance")}}(),D=function(W){if(Array.isArray(W)){for(var Z=0,Y=Array(W.length);Z<W.length;Z++)Y[Z]=W[Z];return Y}else return Array.from(W)},F=2147483647,Q=36,J=1,G=26,B=38,z=700,N=72,O=128,U="-",g=/^xn--/,V=/[^\0-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,j={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=Q-J,b=Math.floor,x=String.fromCharCode;function $(W){throw RangeError(j[W])}function q(W,Z){var Y=[],E=W.length;while(E--)Y[E]=Z(W[E]);return Y}function H(W,Z){var Y=W.split("@"),E="";if(Y.length>1)E=Y[0]+"@",W=Y[1];W=W.replace(S,".");var L=W.split("."),M=q(L,Z).join(".");return E+M}function k(W){var Z=[],Y=0,E=W.length;while(Y<E){var L=W.charCodeAt(Y++);if(L>=55296&&L<=56319&&Y<E){var M=W.charCodeAt(Y++);if((M&64512)==56320)Z.push(((L&1023)<<10)+(M&1023)+65536);else Z.push(L),Y--}else Z.push(L)}return Z}var vv=function(Z){return String.fromCodePoint.apply(String,D(Z))},c=function(Z){if(Z-48<10)return Z-22;if(Z-65<26)return Z-65;if(Z-97<26)return Z-97;return Q},p=function(Z,Y){return Z+22+75*(Z<26)-((Y!=0)<<5)},n=function(Z,Y,E){var L=0;Z=E?b(Z/z):Z>>1,Z+=b(Z/Y);for(;Z>A*G>>1;L+=Q)Z=b(Z/A);return b(L+(A+1)*Z/(Z+B))},I=function(Z){var Y=[],E=Z.length,L=0,M=O,C=N,i=Z.lastIndexOf(U);if(i<0)i=0;for(var o=0;o<i;++o){if(Z.charCodeAt(o)>=128)$("not-basic");Y.push(Z.charCodeAt(o))}for(var Bv=i>0?i+1:0;Bv<E;){var m=L;for(var yv=1,Kv=Q;;Kv+=Q){if(Bv>=E)$("invalid-input");var lv=c(Z.charCodeAt(Bv++));if(lv>=Q||lv>b((F-L)/yv))$("overflow");L+=lv*yv;var t=Kv<=C?J:Kv>=C+G?G:Kv-C;if(lv<t)break;var uv=Q-t;if(yv>b(F/uv))$("overflow");yv*=uv}var rv=Y.length+1;if(C=n(L-m,rv,m==0),b(L/rv)>F-M)$("overflow");M+=b(L/rv),L%=rv,Y.splice(L++,0,M)}return String.fromCodePoint.apply(String,Y)},Qv=function(Z){var Y=[];Z=k(Z);var E=Z.length,L=O,M=0,C=N,i=!0,o=!1,Bv=void 0;try{for(var m=Z[Symbol.iterator](),yv;!(i=(yv=m.next()).done);i=!0){var Kv=yv.value;if(Kv<128)Y.push(x(Kv))}}catch(lr){o=!0,Bv=lr}finally{try{if(!i&&m.return)m.return()}finally{if(o)throw Bv}}var lv=Y.length,t=lv;if(lv)Y.push(U);while(t<E){var uv=F,rv=!0,fr=!1,gv=void 0;try{for(var Mv=Z[Symbol.iterator](),av;!(rv=(av=Mv.next()).done);rv=!0){var Vv=av.value;if(Vv>=L&&Vv<uv)uv=Vv}}catch(lr){fr=!0,gv=lr}finally{try{if(!rv&&Mv.return)Mv.return()}finally{if(fr)throw gv}}var jv=t+1;if(uv-L>b((F-M)/jv))$("overflow");M+=(uv-L)*jv,L=uv;var Tv=!0,hr=!1,cv=void 0;try{for(var Fr=Z[Symbol.iterator](),Mr;!(Tv=(Mr=Fr.next()).done);Tv=!0){var jr=Mr.value;if(jr<L&&++M>F)$("overflow");if(jr==L){var wr=M;for(var Wr=Q;;Wr+=Q){var dv=Wr<=C?J:Wr>=C+G?G:Wr-C;if(wr<dv)break;var Jr=wr-dv,Ua=Q-dv;Y.push(x(p(dv+Jr%Ua,0))),wr=b(Jr/Ua)}Y.push(x(p(wr,0))),C=n(M,jv,t==lv),M=0,++t}}}catch(lr){hr=!0,cv=lr}finally{try{if(!Tv&&Fr.return)Fr.return()}finally{if(hr)throw cv}}++M,++L}return Y.join("")},Dv=function(Z){return H(Z,function(Y){return g.test(Y)?I(Y.slice(4).toLowerCase()):Y})},Gv=function(Z){return H(Z,function(Y){return V.test(Y)?"xn--"+Qv(Y):Y})},s={version:"2.1.0",ucs2:{decode:k,encode:vv},decode:I,encode:Qv,toASCII:Gv,toUnicode:Dv},Wv={};function Yv(W){var Z=W.charCodeAt(0),Y=void 0;if(Z<16)Y="%0"+Z.toString(16).toUpperCase();else if(Z<128)Y="%"+Z.toString(16).toUpperCase();else if(Z<2048)Y="%"+(Z>>6|192).toString(16).toUpperCase()+"%"+(Z&63|128).toString(16).toUpperCase();else Y="%"+(Z>>12|224).toString(16).toUpperCase()+"%"+(Z>>6&63|128).toString(16).toUpperCase()+"%"+(Z&63|128).toString(16).toUpperCase();return Y}function Ev(W){var Z="",Y=0,E=W.length;while(Y<E){var L=parseInt(W.substr(Y+1,2),16);if(L<128)Z+=String.fromCharCode(L),Y+=3;else if(L>=194&&L<224){if(E-Y>=6){var M=parseInt(W.substr(Y+4,2),16);Z+=String.fromCharCode((L&31)<<6|M&63)}else Z+=W.substr(Y,6);Y+=6}else if(L>=224){if(E-Y>=9){var C=parseInt(W.substr(Y+4,2),16),i=parseInt(W.substr(Y+7,2),16);Z+=String.fromCharCode((L&15)<<12|(C&63)<<6|i&63)}else Z+=W.substr(Y,9);Y+=9}else Z+=W.substr(Y,3),Y+=3}return Z}function iv(W,Z){function Y(E){var L=Ev(E);return!L.match(Z.UNRESERVED)?E:L}if(W.scheme)W.scheme=String(W.scheme).replace(Z.PCT_ENCODED,Y).toLowerCase().replace(Z.NOT_SCHEME,"");if(W.userinfo!==void 0)W.userinfo=String(W.userinfo).replace(Z.PCT_ENCODED,Y).replace(Z.NOT_USERINFO,Yv).replace(Z.PCT_ENCODED,r);if(W.host!==void 0)W.host=String(W.host).replace(Z.PCT_ENCODED,Y).toLowerCase().replace(Z.NOT_HOST,Yv).replace(Z.PCT_ENCODED,r);if(W.path!==void 0)W.path=String(W.path).replace(Z.PCT_ENCODED,Y).replace(W.scheme?Z.NOT_PATH:Z.NOT_PATH_NOSCHEME,Yv).replace(Z.PCT_ENCODED,r);if(W.query!==void 0)W.query=String(W.query).replace(Z.PCT_ENCODED,Y).replace(Z.NOT_QUERY,Yv).replace(Z.PCT_ENCODED,r);if(W.fragment!==void 0)W.fragment=String(W.fragment).replace(Z.PCT_ENCODED,Y).replace(Z.NOT_FRAGMENT,Yv).replace(Z.PCT_ENCODED,r);return W}function Cv(W){return W.replace(/^0*(.*)/,"$1")||"0"}function Jv(W,Z){var Y=W.match(Z.IPV4ADDRESS)||[],E=X(Y,2),L=E[1];if(L)return L.split(".").map(Cv).join(".");else return W}function Zv(W,Z){var Y=W.match(Z.IPV6ADDRESS)||[],E=X(Y,3),L=E[1],M=E[2];if(L){var C=L.toLowerCase().split("::").reverse(),i=X(C,2),o=i[0],Bv=i[1],m=Bv?Bv.split(":").map(Cv):[],yv=o.split(":").map(Cv),Kv=Z.IPV4ADDRESS.test(yv[yv.length-1]),lv=Kv?7:8,t=yv.length-lv,uv=Array(lv);for(var rv=0;rv<lv;++rv)uv[rv]=m[rv]||yv[t+rv]||"";if(Kv)uv[lv-1]=Jv(uv[lv-1],Z);var fr=uv.reduce(function(jv,Tv,hr){if(!Tv||Tv==="0"){var cv=jv[jv.length-1];if(cv&&cv.index+cv.length===hr)cv.length++;else jv.push({index:hr,length:1})}return jv},[]),gv=fr.sort(function(jv,Tv){return Tv.length-jv.length})[0],Mv=void 0;if(gv&&gv.length>1){var av=uv.slice(0,gv.index),Vv=uv.slice(gv.index+gv.length);Mv=av.join(":")+"::"+Vv.join(":")}else Mv=uv.join(":");if(M)Mv+="%"+M;return Mv}else return W}var vr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Fv="".match(/(){0}/)[1]===void 0;function e(W){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y={},E=Z.iri!==!1?K:w;if(Z.reference==="suffix")W=(Z.scheme?Z.scheme+":":"")+"//"+W;var L=W.match(vr);if(L){if(Fv){if(Y.scheme=L[1],Y.userinfo=L[3],Y.host=L[4],Y.port=parseInt(L[5],10),Y.path=L[6]||"",Y.query=L[7],Y.fragment=L[8],isNaN(Y.port))Y.port=L[5]}else if(Y.scheme=L[1]||void 0,Y.userinfo=W.indexOf("@")!==-1?L[3]:void 0,Y.host=W.indexOf("//")!==-1?L[4]:void 0,Y.port=parseInt(L[5],10),Y.path=L[6]||"",Y.query=W.indexOf("?")!==-1?L[7]:void 0,Y.fragment=W.indexOf("#")!==-1?L[8]:void 0,isNaN(Y.port))Y.port=W.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?L[4]:void 0;if(Y.host)Y.host=Zv(Jv(Y.host,E),E);if(Y.scheme===void 0&&Y.userinfo===void 0&&Y.host===void 0&&Y.port===void 0&&!Y.path&&Y.query===void 0)Y.reference="same-document";else if(Y.scheme===void 0)Y.reference="relative";else if(Y.fragment===void 0)Y.reference="absolute";else Y.reference="uri";if(Z.reference&&Z.reference!=="suffix"&&Z.reference!==Y.reference)Y.error=Y.error||"URI is not a "+Z.reference+" reference.";var M=Wv[(Z.scheme||Y.scheme||"").toLowerCase()];if(!Z.unicodeSupport&&(!M||!M.unicodeSupport)){if(Y.host&&(Z.domainHost||M&&M.domainHost))try{Y.host=s.toASCII(Y.host.replace(E.PCT_ENCODED,Ev).toLowerCase())}catch(C){Y.error=Y.error||"Host's domain name can not be converted to ASCII via punycode: "+C}iv(Y,w)}else iv(Y,E);if(M&&M.parse)M.parse(Y,Z)}else Y.error=Y.error||"URI can not be parsed.";return Y}function sv(W,Z){var Y=Z.iri!==!1?K:w,E=[];if(W.userinfo!==void 0)E.push(W.userinfo),E.push("@");if(W.host!==void 0)E.push(Zv(Jv(String(W.host),Y),Y).replace(Y.IPV6ADDRESS,function(L,M,C){return"["+M+(C?"%25"+C:"")+"]"}));if(typeof W.port==="number"||typeof W.port==="string")E.push(":"),E.push(String(W.port));return E.length?E.join(""):void 0}var nv=/^\.\.?\//,rr=/^\/\.(\/|$)/,ar=/^\/\.\.(\/|$)/,Xv=/^\/?(?:.|\n)*?(?=\/|$)/;function Hv(W){var Z=[];while(W.length)if(W.match(nv))W=W.replace(nv,"");else if(W.match(rr))W=W.replace(rr,"/");else if(W.match(ar))W=W.replace(ar,"/"),Z.pop();else if(W==="."||W==="..")W="";else{var Y=W.match(Xv);if(Y){var E=Y[0];W=W.slice(E.length),Z.push(E)}else throw Error("Unexpected dot segment condition")}return Z.join("")}function Ov(W){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y=Z.iri?K:w,E=[],L=Wv[(Z.scheme||W.scheme||"").toLowerCase()];if(L&&L.serialize)L.serialize(W,Z);if(W.host){if(Y.IPV6ADDRESS.test(W.host));else if(Z.domainHost||L&&L.domainHost)try{W.host=!Z.iri?s.toASCII(W.host.replace(Y.PCT_ENCODED,Ev).toLowerCase()):s.toUnicode(W.host)}catch(i){W.error=W.error||"Host's domain name can not be converted to "+(!Z.iri?"ASCII":"Unicode")+" via punycode: "+i}}if(iv(W,Y),Z.reference!=="suffix"&&W.scheme)E.push(W.scheme),E.push(":");var M=sv(W,Z);if(M!==void 0){if(Z.reference!=="suffix")E.push("//");if(E.push(M),W.path&&W.path.charAt(0)!=="/")E.push("/")}if(W.path!==void 0){var C=W.path;if(!Z.absolutePath&&(!L||!L.absolutePath))C=Hv(C);if(M===void 0)C=C.replace(/^\/\//,"/%2F");E.push(C)}if(W.query!==void 0)E.push("?"),E.push(W.query);if(W.fragment!==void 0)E.push("#"),E.push(W.fragment);return E.join("")}function Lv(W,Z){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments[3],L={};if(!E)W=e(Ov(W,Y),Y),Z=e(Ov(Z,Y),Y);if(Y=Y||{},!Y.tolerant&&Z.scheme)L.scheme=Z.scheme,L.userinfo=Z.userinfo,L.host=Z.host,L.port=Z.port,L.path=Hv(Z.path||""),L.query=Z.query;else{if(Z.userinfo!==void 0||Z.host!==void 0||Z.port!==void 0)L.userinfo=Z.userinfo,L.host=Z.host,L.port=Z.port,L.path=Hv(Z.path||""),L.query=Z.query;else{if(!Z.path)if(L.path=W.path,Z.query!==void 0)L.query=Z.query;else L.query=W.query;else{if(Z.path.charAt(0)==="/")L.path=Hv(Z.path);else{if((W.userinfo!==void 0||W.host!==void 0||W.port!==void 0)&&!W.path)L.path="/"+Z.path;else if(!W.path)L.path=Z.path;else L.path=W.path.slice(0,W.path.lastIndexOf("/")+1)+Z.path;L.path=Hv(L.path)}L.query=Z.query}L.userinfo=W.userinfo,L.host=W.host,L.port=W.port}L.scheme=W.scheme}return L.fragment=Z.fragment,L}function Iv(W,Z,Y){var E=y({scheme:"null"},Y);return Ov(Lv(e(W,E),e(Z,E),E,!0),E)}function qv(W,Z){if(typeof W==="string")W=Ov(e(W,Z),Z);else if(h(W)==="object")W=e(Ov(W,Z),Z);return W}function Hr(W,Z,Y){if(typeof W==="string")W=Ov(e(W,Y),Y);else if(h(W)==="object")W=Ov(W,Y);if(typeof Z==="string")Z=Ov(e(Z,Y),Y);else if(h(Z)==="object")Z=Ov(Z,Y);return W===Z}function Oa(W,Z){return W&&W.toString().replace(!Z||!Z.iri?w.ESCAPE:K.ESCAPE,Yv)}function xv(W,Z){return W&&W.toString().replace(!Z||!Z.iri?w.PCT_ENCODED:K.PCT_ENCODED,Ev)}var Xr={scheme:"http",domainHost:!0,parse:function(Z,Y){if(!Z.host)Z.error=Z.error||"HTTP URIs must have a host.";return Z},serialize:function(Z,Y){var E=String(Z.scheme).toLowerCase()==="https";if(Z.port===(E?443:80)||Z.port==="")Z.port=void 0;if(!Z.path)Z.path="/";return Z}},Of={scheme:"https",domainHost:Xr.domainHost,parse:Xr.parse,serialize:Xr.serialize};function Nf(W){return typeof W.secure==="boolean"?W.secure:String(W.scheme).toLowerCase()==="wss"}var Dr={scheme:"ws",domainHost:!0,parse:function(Z,Y){var E=Z;return E.secure=Nf(E),E.resourceName=(E.path||"/")+(E.query?"?"+E.query:""),E.path=void 0,E.query=void 0,E},serialize:function(Z,Y){if(Z.port===(Nf(Z)?443:80)||Z.port==="")Z.port=void 0;if(typeof Z.secure==="boolean")Z.scheme=Z.secure?"wss":"ws",Z.secure=void 0;if(Z.resourceName){var E=Z.resourceName.split("?"),L=X(E,2),M=L[0],C=L[1];Z.path=M&&M!=="/"?M:void 0,Z.query=C,Z.resourceName=void 0}return Z.fragment=void 0,Z}},Uf={scheme:"wss",domainHost:Dr.domainHost,parse:Dr.parse,serialize:Dr.serialize},vy={},ry=!0,qf="[A-Za-z0-9\\-\\.\\_\\~"+(ry?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",Rv="[0-9A-Fa-f]",ay=f(f("%[EFef]"+Rv+"%"+Rv+Rv+"%"+Rv+Rv)+"|"+f("%[89A-Fa-f]"+Rv+"%"+Rv+Rv)+"|"+f("%"+Rv+Rv)),fy="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",hy="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",ly=v(hy,"[\\\"\\\\]"),Py="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",yy=new RegExp(qf,"g"),Zr=new RegExp(ay,"g"),uy=new RegExp(v("[^]",fy,"[\\.]","[\\\"]",ly),"g"),gf=new RegExp(v("[^]",qf,Py),"g"),Qy=gf;function Na(W){var Z=Ev(W);return!Z.match(yy)?W:Z}var Vf={scheme:"mailto",parse:function(Z,Y){var E=Z,L=E.to=E.path?E.path.split(","):[];if(E.path=void 0,E.query){var M=!1,C={},i=E.query.split("&");for(var o=0,Bv=i.length;o<Bv;++o){var m=i[o].split("=");switch(m[0]){case"to":var yv=m[1].split(",");for(var Kv=0,lv=yv.length;Kv<lv;++Kv)L.push(yv[Kv]);break;case"subject":E.subject=xv(m[1],Y);break;case"body":E.body=xv(m[1],Y);break;default:M=!0,C[xv(m[0],Y)]=xv(m[1],Y);break}}if(M)E.headers=C}E.query=void 0;for(var t=0,uv=L.length;t<uv;++t){var rv=L[t].split("@");if(rv[0]=xv(rv[0]),!Y.unicodeSupport)try{rv[1]=s.toASCII(xv(rv[1],Y).toLowerCase())}catch(fr){E.error=E.error||"Email address's domain name can not be converted to ASCII via punycode: "+fr}else rv[1]=xv(rv[1],Y).toLowerCase();L[t]=rv.join("@")}return E},serialize:function(Z,Y){var E=Z,L=l(Z.to);if(L){for(var M=0,C=L.length;M<C;++M){var i=String(L[M]),o=i.lastIndexOf("@"),Bv=i.slice(0,o).replace(Zr,Na).replace(Zr,r).replace(uy,Yv),m=i.slice(o+1);try{m=!Y.iri?s.toASCII(xv(m,Y).toLowerCase()):s.toUnicode(m)}catch(t){E.error=E.error||"Email address's domain name can not be converted to "+(!Y.iri?"ASCII":"Unicode")+" via punycode: "+t}L[M]=Bv+"@"+m}E.path=L.join(",")}var yv=Z.headers=Z.headers||{};if(Z.subject)yv.subject=Z.subject;if(Z.body)yv.body=Z.body;var Kv=[];for(var lv in yv)if(yv[lv]!==vy[lv])Kv.push(lv.replace(Zr,Na).replace(Zr,r).replace(gf,Yv)+"="+yv[lv].replace(Zr,Na).replace(Zr,r).replace(Qy,Yv));if(Kv.length)E.query=Kv.join("&");return E}},Zy=/^([^\:]+)\:(.*)/,Af={scheme:"urn",parse:function(Z,Y){var E=Z.path&&Z.path.match(Zy),L=Z;if(E){var M=Y.scheme||L.scheme||"urn",C=E[1].toLowerCase(),i=E[2],o=M+":"+(Y.nid||C),Bv=Wv[o];if(L.nid=C,L.nss=i,L.path=void 0,Bv)L=Bv.parse(L,Y)}else L.error=L.error||"URN can not be parsed.";return L},serialize:function(Z,Y){var E=Y.scheme||Z.scheme||"urn",L=Z.nid,M=E+":"+(Y.nid||L),C=Wv[M];if(C)Z=C.serialize(Z,Y);var i=Z,o=Z.nss;return i.path=(L||Y.nid)+":"+o,i}},wy=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Hf={scheme:"urn:uuid",parse:function(Z,Y){var E=Z;if(E.uuid=E.nss,E.nss=void 0,!Y.tolerant&&(!E.uuid||!E.uuid.match(wy)))E.error=E.error||"UUID is not valid.";return E},serialize:function(Z,Y){var E=Z;return E.nss=(Z.uuid||"").toLowerCase(),E}};Wv[Xr.scheme]=Xr,Wv[Of.scheme]=Of,Wv[Dr.scheme]=Dr,Wv[Uf.scheme]=Uf,Wv[Vf.scheme]=Vf,Wv[Af.scheme]=Af,Wv[Hf.scheme]=Hf,a.SCHEMES=Wv,a.pctEncChar=Yv,a.pctDecChars=Ev,a.parse=e,a.removeDotSegments=Hv,a.serialize=Ov,a.resolveComponents=Lv,a.resolve=Iv,a.normalize=qv,a.equal=Hr,a.escapeComponent=Oa,a.unescapeComponent=xv,Object.defineProperty(a,"__esModule",{value:!0})})});var er=T((n0,hh)=>{hh.exports=function a(v,f){if(v===f)return!0;if(v&&f&&typeof v=="object"&&typeof f=="object"){if(v.constructor!==f.constructor)return!1;var h,r,l;if(Array.isArray(v)){if(h=v.length,h!=f.length)return!1;for(r=h;r--!==0;)if(!a(v[r],f[r]))return!1;return!0}if(v.constructor===RegExp)return v.source===f.source&&v.flags===f.flags;if(v.valueOf!==Object.prototype.valueOf)return v.valueOf()===f.valueOf();if(v.toString!==Object.prototype.toString)return v.toString()===f.toString();if(l=Object.keys(v),h=l.length,h!==Object.keys(f).length)return!1;for(r=h;r--!==0;)if(!Object.prototype.hasOwnProperty.call(f,l[r]))return!1;for(r=h;r--!==0;){var y=l[r];if(!a(v[y],f[y]))return!1}return!0}return v!==v&&f!==f}});var Ph=T((c0,lh)=>{lh.exports=function(v){var f=0,h=v.length,r=0,l;while(r<h)if(f++,l=v.charCodeAt(r++),l>=55296&&l<=56319&&r<h){if(l=v.charCodeAt(r),(l&64512)==56320)r++}return f}});var Pr=T((d0,Qh)=>{Qh.exports={copy:Qu,checkDataType:Ta,checkDataTypes:Zu,coerceToTypes:wu,toHash:Ca,getProperty:na,escapeQuotes:ca,equal:er(),ucs2length:Ph(),varOccurences:Bu,varReplace:Ku,schemaHasRules:Yu,schemaHasRulesExcept:Xu,schemaUnknownRules:Du,toQuotedString:_a,getPathExpr:Fu,getPath:Gu,getData:zu,unescapeFragment:Ou,unescapeJsonPointer:pa,escapeFragment:Nu,escapeJsonPointer:da};function Qu(a,v){v=v||{};for(var f in a)v[f]=a[f];return v}function Ta(a,v,f,h){var r=h?" !== ":" === ",l=h?" || ":" && ",y=h?"!":"",u=h?"":"!";switch(a){case"null":return v+r+"null";case"array":return y+"Array.isArray("+v+")";case"object":return"("+y+v+l+"typeof "+v+r+'"object"'+l+u+"Array.isArray("+v+"))";case"integer":return"(typeof "+v+r+'"number"'+l+u+"("+v+" % 1)"+l+v+r+v+(f?l+y+"isFinite("+v+")":"")+")";case"number":return"(typeof "+v+r+'"'+a+'"'+(f?l+y+"isFinite("+v+")":"")+")";default:return"typeof "+v+r+'"'+a+'"'}}function Zu(a,v,f){switch(a.length){case 1:return Ta(a[0],v,f,!0);default:var h="",r=Ca(a);if(r.array&&r.object)h=r.null?"(":"(!"+v+" || ",h+="typeof "+v+' !== "object")',delete r.null,delete r.array,delete r.object;if(r.number)delete r.integer;for(var l in r)h+=(h?" && ":"")+Ta(l,v,f,!0);return h}}var yh=Ca(["string","number","integer","boolean","null"]);function wu(a,v){if(Array.isArray(v)){var f=[];for(var h=0;h<v.length;h++){var r=v[h];if(yh[r])f[f.length]=r;else if(a==="array"&&r==="array")f[f.length]=r}if(f.length)return f}else if(yh[v])return[v];else if(a==="array"&&v==="array")return["array"]}function Ca(a){var v={};for(var f=0;f<a.length;f++)v[a[f]]=!0;return v}var Wu=/^[a-z$_][a-z$_0-9]*$/i,Ju=/'|\\/g;function na(a){return typeof a=="number"?"["+a+"]":Wu.test(a)?"."+a:"['"+ca(a)+"']"}function ca(a){return a.replace(Ju,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Bu(a,v){v+="[^0-9]";var f=a.match(new RegExp(v,"g"));return f?f.length:0}function Ku(a,v,f){return v+="([^0-9])",f=f.replace(/\$/g,"$$$$"),a.replace(new RegExp(v,"g"),f+"$1")}function Yu(a,v){if(typeof a=="boolean")return!a;for(var f in a)if(v[f])return!0}function Xu(a,v,f){if(typeof a=="boolean")return!a&&f!="not";for(var h in a)if(h!=f&&v[h])return!0}function Du(a,v){if(typeof a=="boolean")return;for(var f in a)if(!v[f])return f}function _a(a){return"'"+ca(a)+"'"}function Fu(a,v,f,h){var r=f?"'/' + "+v+(h?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):h?"'[' + "+v+" + ']'":"'[\\'' + "+v+" + '\\']'";return uh(a,r)}function Gu(a,v,f){var h=f?_a("/"+da(v)):_a(na(v));return uh(a,h)}var Eu=/^\/(?:[^~]|~0|~1)*$/,Lu=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function zu(a,v,f){var h,r,l,y;if(a==="")return"rootData";if(a[0]=="/"){if(!Eu.test(a))throw Error("Invalid JSON-pointer: "+a);r=a,l="rootData"}else{if(y=a.match(Lu),!y)throw Error("Invalid JSON-pointer: "+a);if(h=+y[1],r=y[2],r=="#"){if(h>=v)throw Error("Cannot access property/index "+h+" levels up, current level is "+v);return f[v-h]}if(h>v)throw Error("Cannot access data "+h+" levels up, current level is "+v);if(l="data"+(v-h||""),!r)return l}var u=l,w=r.split("/");for(var K=0;K<w.length;K++){var X=w[K];if(X)l+=na(pa(X)),u+=" && "+l}return u}function uh(a,v){if(a=='""')return v;return(a+" + "+v).replace(/([^\\])' \+ '/g,"$1")}function Ou(a){return pa(decodeURIComponent(a))}function Nu(a){return encodeURIComponent(da(a))}function da(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}function pa(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}});var ma=T((p0,Zh)=>{var Uu=Pr();Zh.exports=qu;function qu(a){Uu.copy(a,this)}});var Wh=T((m0,wh)=>{var tv=wh.exports=function(a,v,f){if(typeof v=="function")f=v,v={};f=v.cb||f;var h=typeof f=="function"?f:f.pre||function(){},r=f.post||function(){};or(v,h,r,a,"",a)};tv.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};tv.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};tv.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};tv.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function or(a,v,f,h,r,l,y,u,w,K){if(h&&typeof h=="object"&&!Array.isArray(h)){v(h,r,l,y,u,w,K);for(var X in h){var D=h[X];if(Array.isArray(D)){if(X in tv.arrayKeywords)for(var F=0;F<D.length;F++)or(a,v,f,D[F],r+"/"+X+"/"+F,l,r,X,h,F)}else if(X in tv.propsKeywords){if(D&&typeof D=="object")for(var Q in D)or(a,v,f,D[Q],r+"/"+X+"/"+gu(Q),l,r,X,h,Q)}else if(X in tv.keywords||a.allKeys&&!(X in tv.skipKeywords))or(a,v,f,D,r+"/"+X,l,r,X,h)}f(h,r,l,y,u,w,K)}}function gu(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}});var la=T((i0,Yh)=>{var gr=fh(),Jh=er(),fa=Pr(),va=ma(),Vu=Wh();Yh.exports=ov;ov.normalizeId=ev;ov.fullPath=ra;ov.url=aa;ov.ids=$u;ov.inlineRef=ia;ov.schema=ha;function ov(a,v,f){var h=this._refs[f];if(typeof h=="string")if(this._refs[h])h=this._refs[h];else return ov.call(this,a,v,h);if(h=h||this._schemas[f],h instanceof va)return ia(h.schema,this._opts.inlineRefs)?h.schema:h.validate||this._compile(h);var r=ha.call(this,v,f),l,y,u;if(r)l=r.schema,v=r.root,u=r.baseId;if(l instanceof va)y=l.validate||a.call(this,l.schema,v,void 0,u);else if(l!==void 0)y=ia(l,this._opts.inlineRefs)?l:a.call(this,l,v,void 0,u);return y}function ha(a,v){var f=gr.parse(v),h=Kh(f),r=ra(this._getId(a.schema));if(Object.keys(a.schema).length===0||h!==r){var l=ev(h),y=this._refs[l];if(typeof y=="string")return Au.call(this,a,y,f);else if(y instanceof va){if(!y.validate)this._compile(y);a=y}else if(y=this._schemas[l],y instanceof va){if(!y.validate)this._compile(y);if(l==ev(v))return{schema:y,root:a,baseId:r};a=y}else return;if(!a.schema)return;r=ra(this._getId(a.schema))}return Bh.call(this,f,r,a.schema,a)}function Au(a,v,f){var h=ha.call(this,a,v);if(h){var{schema:r,baseId:l}=h;a=h.root;var y=this._getId(r);if(y)l=aa(l,y);return Bh.call(this,f,l,r,a)}}var Hu=fa.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function Bh(a,v,f,h){if(a.fragment=a.fragment||"",a.fragment.slice(0,1)!="/")return;var r=a.fragment.split("/");for(var l=1;l<r.length;l++){var y=r[l];if(y){if(y=fa.unescapeFragment(y),f=f[y],f===void 0)break;var u;if(!Hu[y]){if(u=this._getId(f),u)v=aa(v,u);if(f.$ref){var w=aa(v,f.$ref),K=ha.call(this,h,w);if(K)f=K.schema,h=K.root,v=K.baseId}}}}if(f!==void 0&&f!==h.schema)return{schema:f,root:h,baseId:v}}var Mu=fa.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function ia(a,v){if(v===!1)return!1;if(v===void 0||v===!0)return sa(a);else if(v)return ta(a)<=v}function sa(a){var v;if(Array.isArray(a)){for(var f=0;f<a.length;f++)if(v=a[f],typeof v=="object"&&!sa(v))return!1}else for(var h in a){if(h=="$ref")return!1;if(v=a[h],typeof v=="object"&&!sa(v))return!1}return!0}function ta(a){var v=0,f;if(Array.isArray(a))for(var h=0;h<a.length;h++){if(f=a[h],typeof f=="object")v+=ta(f);if(v==1/0)return 1/0}else for(var r in a){if(r=="$ref")return 1/0;if(Mu[r])v++;else{if(f=a[r],typeof f=="object")v+=ta(f)+1;if(v==1/0)return 1/0}}return v}function ra(a,v){if(v!==!1)a=ev(a);var f=gr.parse(a);return Kh(f)}function Kh(a){return gr.serialize(a).split("#")[0]+"#"}var ju=/#\/?$/;function ev(a){return a?a.replace(ju,""):""}function aa(a,v){return v=ev(v),gr.resolve(a,v)}function $u(a){var v=ev(this._getId(a)),f={"":v},h={"":ra(v,!1)},r={},l=this;return Vu(a,{allKeys:!0},function(y,u,w,K,X,D,F){if(u==="")return;var Q=l._getId(y),J=f[K],G=h[K]+"/"+X;if(F!==void 0)G+="/"+(typeof F=="number"?F:fa.escapeFragment(F));if(typeof Q=="string"){Q=J=ev(J?gr.resolve(J,Q):Q);var B=l._refs[Q];if(typeof B=="string")B=l._refs[B];if(B&&B.schema){if(!Jh(y,B.schema))throw Error('id "'+Q+'" resolves to more than one schema')}else if(Q!=ev(G))if(Q[0]=="#"){if(r[Q]&&!Jh(y,r[Q]))throw Error('id "'+Q+'" resolves to more than one schema');r[Q]=y}else l._refs[Q]=G}f[u]=J,h[u]=G}),r}});var Pa=T((s0,Dh)=>{var ea=la();Dh.exports={Validation:Xh(ku),MissingRef:Xh(oa)};function ku(a){this.message="validation failed",this.errors=a,this.ajv=this.validation=!0}oa.message=function(a,v){return"can't resolve reference "+v+" from id "+a};function oa(a,v,f){this.message=f||oa.message(a,v),this.missingRef=ea.url(a,v),this.missingSchema=ea.normalizeId(ea.fullPath(this.missingRef))}function Xh(a){return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}});var vf=T((t0,Fh)=>{Fh.exports=function(a,v){if(!v)v={};if(typeof v==="function")v={cmp:v};var f=typeof v.cycles==="boolean"?v.cycles:!1,h=v.cmp&&function(l){return function(y){return function(u,w){var K={key:u,value:y[u]},X={key:w,value:y[w]};return l(K,X)}}}(v.cmp),r=[];return function l(y){if(y&&y.toJSON&&typeof y.toJSON==="function")y=y.toJSON();if(y===void 0)return;if(typeof y=="number")return isFinite(y)?""+y:"null";if(typeof y!=="object")return JSON.stringify(y);var u,w;if(Array.isArray(y)){w="[";for(u=0;u<y.length;u++){if(u)w+=",";w+=l(y[u])||"null"}return w+"]"}if(y===null)return"null";if(r.indexOf(y)!==-1){if(f)return JSON.stringify("__cycle__");throw TypeError("Converting circular structure to JSON")}var K=r.push(y)-1,X=Object.keys(y).sort(h&&h(y));w="";for(u=0;u<X.length;u++){var D=X[u],F=l(y[D]);if(!F)continue;if(w)w+=",";w+=JSON.stringify(D)+":"+F}return r.splice(K,1),"{"+w+"}"}(a)}});var rf=T((e0,Gh)=>{Gh.exports=function(v,f,h){var r="",l=v.schema.$async===!0,y=v.util.schemaHasRulesExcept(v.schema,v.RULES.all,"$ref"),u=v.self._getId(v.schema);if(v.opts.strictKeywords){var w=v.util.schemaUnknownRules(v.schema,v.RULES.keywords);if(w){var K="unknown keyword: "+w;if(v.opts.strictKeywords==="log")v.logger.warn(K);else throw Error(K)}}if(v.isTop){if(r+=" var validate = ",l)v.async=!0,r+="async ";if(r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",u&&(v.opts.sourceCode||v.opts.processCode))r+=" "+("/*# sourceURL="+u+" */")+" "}if(typeof v.schema=="boolean"||!(y||v.schema.$ref)){var f="false schema",X=v.level,D=v.dataLevel,F=v.schema[f],Q=v.schemaPath+v.util.getProperty(f),J=v.errSchemaPath+"/"+f,g=!v.opts.allErrors,j,G="data"+(D||""),U="valid"+X;if(v.schema===!1){if(v.isTop)g=!0;else r+=" var "+U+" = false; ";var B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(j||"false schema")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(J)+" , params: {} ",v.opts.messages!==!1)r+=" , message: 'boolean schema is false' ";if(v.opts.verbose)r+=" , schema: false , parentSchema: validate.schema"+v.schemaPath+" , data: "+G+" ";r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&g)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else if(v.isTop)if(l)r+=" return data; ";else r+=" validate.errors = null; return true; ";else r+=" var "+U+" = true; ";if(v.isTop)r+=" }; return validate; ";return r}if(v.isTop){var N=v.isTop,X=v.level=0,D=v.dataLevel=0,G="data";if(v.rootId=v.resolve.fullPath(v.self._getId(v.root.schema)),v.baseId=v.baseId||v.rootId,delete v.isTop,v.dataPathArr=[""],v.schema.default!==void 0&&v.opts.useDefaults&&v.opts.strictDefaults){var O="default is ignored in the schema root";if(v.opts.strictDefaults==="log")v.logger.warn(O);else throw Error(O)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{var{level:X,dataLevel:D}=v,G="data"+(D||"");if(u)v.baseId=v.resolve.url(v.baseId,u);if(l&&!v.async)throw Error("async schema in sync schema");r+=" var errs_"+X+" = errors;"}var U="valid"+X,g=!v.opts.allErrors,V="",S="",j,A=v.schema.type,b=Array.isArray(A);if(A&&v.opts.nullable&&v.schema.nullable===!0){if(b){if(A.indexOf("null")==-1)A=A.concat("null")}else if(A!="null")A=[A,"null"],b=!0}if(b&&A.length==1)A=A[0],b=!1;if(v.schema.$ref&&y){if(v.opts.extendRefs=="fail")throw Error('$ref: validation keywords used in schema at path "'+v.errSchemaPath+'" (see option extendRefs)');else if(v.opts.extendRefs!==!0)y=!1,v.logger.warn('$ref: keywords ignored in schema at path "'+v.errSchemaPath+'"')}if(v.schema.$comment&&v.opts.$comment)r+=" "+v.RULES.all.$comment.code(v,"$comment");if(A){if(v.opts.coerceTypes)var x=v.util.coerceToTypes(v.opts.coerceTypes,A);var $=v.RULES.types[A];if(x||b||$===!0||$&&!Xv($)){var Q=v.schemaPath+".type",J=v.errSchemaPath+"/type",Q=v.schemaPath+".type",J=v.errSchemaPath+"/type",q=b?"checkDataTypes":"checkDataType";if(r+=" if ("+v.util[q](A,G,v.opts.strictNumbers,!0)+") { ",x){var H="dataType"+X,k="coerced"+X;if(r+=" var "+H+" = typeof "+G+"; var "+k+" = undefined; ",v.opts.coerceTypes=="array")r+=" if ("+H+" == 'object' && Array.isArray("+G+") && "+G+".length == 1) { "+G+" = "+G+"[0]; "+H+" = typeof "+G+"; if ("+v.util.checkDataType(v.schema.type,G,v.opts.strictNumbers)+") "+k+" = "+G+"; } ";r+=" if ("+k+" !== undefined) ; ";var vv=x;if(vv){var c,p=-1,n=vv.length-1;while(p<n)if(c=vv[p+=1],c=="string")r+=" else if ("+H+" == 'number' || "+H+" == 'boolean') "+k+" = '' + "+G+"; else if ("+G+" === null) "+k+" = ''; ";else if(c=="number"||c=="integer"){if(r+=" else if ("+H+" == 'boolean' || "+G+" === null || ("+H+" == 'string' && "+G+" && "+G+" == +"+G+" ",c=="integer")r+=" && !("+G+" % 1)";r+=")) "+k+" = +"+G+"; "}else if(c=="boolean")r+=" else if ("+G+" === 'false' || "+G+" === 0 || "+G+" === null) "+k+" = false; else if ("+G+" === 'true' || "+G+" === 1) "+k+" = true; ";else if(c=="null")r+=" else if ("+G+" === '' || "+G+" === 0 || "+G+" === false) "+k+" = null; ";else if(v.opts.coerceTypes=="array"&&c=="array")r+=" else if ("+H+" == 'string' || "+H+" == 'number' || "+H+" == 'boolean' || "+G+" == null) "+k+" = ["+G+"]; "}r+=" else {   ";var B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(j||"type")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(J)+" , params: { type: '",b)r+=""+A.join(",");else r+=""+A;if(r+="' } ",v.opts.messages!==!1){if(r+=" , message: 'should be ",b)r+=""+A.join(",");else r+=""+A;r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+Q+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+G+" ";r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&g)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";r+=" } if ("+k+" !== undefined) {  ";var I=D?"data"+(D-1||""):"parentData",Qv=D?v.dataPathArr[D]:"parentDataProperty";if(r+=" "+G+" = "+k+"; ",!D)r+="if ("+I+" !== undefined)";r+=" "+I+"["+Qv+"] = "+k+"; } "}else{var B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(j||"type")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(J)+" , params: { type: '",b)r+=""+A.join(",");else r+=""+A;if(r+="' } ",v.opts.messages!==!1){if(r+=" , message: 'should be ",b)r+=""+A.join(",");else r+=""+A;r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+Q+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+G+" ";r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&g)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(v.schema.$ref&&!y){if(r+=" "+v.RULES.all.$ref.code(v,"$ref")+" ",g){if(r+=" } if (errors === ",N)r+="0";else r+="errs_"+X;r+=") { ",S+="}"}}else{var Dv=v.RULES;if(Dv){var $,Gv=-1,s=Dv.length-1;while(Gv<s)if($=Dv[Gv+=1],Xv($)){if($.type)r+=" if ("+v.util.checkDataType($.type,G,v.opts.strictNumbers)+") { ";if(v.opts.useDefaults){if($.type=="object"&&v.schema.properties){var F=v.schema.properties,Wv=Object.keys(F),Yv=Wv;if(Yv){var Ev,iv=-1,Cv=Yv.length-1;while(iv<Cv){Ev=Yv[iv+=1];var Jv=F[Ev];if(Jv.default!==void 0){var Zv=G+v.util.getProperty(Ev);if(v.compositeRule){if(v.opts.strictDefaults){var O="default is ignored for: "+Zv;if(v.opts.strictDefaults==="log")v.logger.warn(O);else throw Error(O)}}else{if(r+=" if ("+Zv+" === undefined ",v.opts.useDefaults=="empty")r+=" || "+Zv+" === null || "+Zv+" === '' ";if(r+=" ) "+Zv+" = ",v.opts.useDefaults=="shared")r+=" "+v.useDefault(Jv.default)+" ";else r+=" "+JSON.stringify(Jv.default)+" ";r+="; "}}}}}else if($.type=="array"&&Array.isArray(v.schema.items)){var vr=v.schema.items;if(vr){var Jv,p=-1,Fv=vr.length-1;while(p<Fv)if(Jv=vr[p+=1],Jv.default!==void 0){var Zv=G+"["+p+"]";if(v.compositeRule){if(v.opts.strictDefaults){var O="default is ignored for: "+Zv;if(v.opts.strictDefaults==="log")v.logger.warn(O);else throw Error(O)}}else{if(r+=" if ("+Zv+" === undefined ",v.opts.useDefaults=="empty")r+=" || "+Zv+" === null || "+Zv+" === '' ";if(r+=" ) "+Zv+" = ",v.opts.useDefaults=="shared")r+=" "+v.useDefault(Jv.default)+" ";else r+=" "+JSON.stringify(Jv.default)+" ";r+="; "}}}}}var e=$.rules;if(e){var sv,nv=-1,rr=e.length-1;while(nv<rr)if(sv=e[nv+=1],Hv(sv)){var ar=sv.code(v,sv.keyword,$.type);if(ar){if(r+=" "+ar+" ",g)V+="}"}}}if(g)r+=" "+V+" ",V="";if($.type){if(r+=" } ",A&&A===$.type&&!x){r+=" else { ";var Q=v.schemaPath+".type",J=v.errSchemaPath+"/type",B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(j||"type")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(J)+" , params: { type: '",b)r+=""+A.join(",");else r+=""+A;if(r+="' } ",v.opts.messages!==!1){if(r+=" , message: 'should be ",b)r+=""+A.join(",");else r+=""+A;r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+Q+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+G+" ";r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&g)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";r+=" } "}}if(g){if(r+=" if (errors === ",N)r+="0";else r+="errs_"+X;r+=") { ",S+="}"}}}}if(g)r+=" "+S+" ";if(N){if(l)r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; ",r+=" return errors === 0;       ";r+=" }; return validate;"}else r+=" var "+U+" = errors === errs_"+X+";";function Xv(Lv){var Iv=Lv.rules;for(var qv=0;qv<Iv.length;qv++)if(Hv(Iv[qv]))return!0}function Hv(Lv){return v.schema[Lv.keyword]!==void 0||Lv.implements&&Ov(Lv)}function Ov(Lv){var Iv=Lv.implements;for(var qv=0;qv<Iv.length;qv++)if(v.schema[Iv[qv]]!==void 0)return!0}return r}});var Nh=T((o0,Oh)=>{var ya=la(),Qa=Pr(),Lh=Pa(),xu=vf(),Eh=rf(),bu=Qa.ucs2length,Su=er(),Iu=Lh.Validation;Oh.exports=af;function af(a,v,f,h){var r=this,l=this._opts,y=[void 0],u={},w=[],K={},X=[],D={},F=[];v=v||{schema:a,refVal:y,refs:u};var Q=Ru.call(this,a,v,h),J=this._compilations[Q.index];if(Q.compiling)return J.callValidate=O;var G=this._formats,B=this.RULES;try{var z=U(a,v,f,h);J.validate=z;var N=J.callValidate;if(N){if(N.schema=z.schema,N.errors=null,N.refs=z.refs,N.refVal=z.refVal,N.root=z.root,N.$async=z.$async,l.sourceCode)N.source=z.source}return z}finally{Tu.call(this,a,v,h)}function O(){var q=J.validate,H=q.apply(this,arguments);return O.errors=q.errors,H}function U(q,H,k,vv){var c=!H||H&&H.schema==q;if(H.schema!=v.schema)return af.call(r,q,H,k,vv);var p=q.$async===!0,n=Eh({isTop:!0,schema:q,isRoot:c,baseId:vv,root:H,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:Lh.MissingRef,RULES:B,validate:Eh,util:Qa,resolve:ya,resolveRef:g,usePattern:b,useDefault:x,useCustomRule:$,opts:l,formats:G,logger:r.logger,self:r});if(n=ua(y,nu)+ua(w,_u)+ua(X,Cu)+ua(F,cu)+n,l.processCode)n=l.processCode(n,q);var I;try{var Qv=Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",n);I=Qv(r,B,G,v,y,X,F,Su,bu,Iu),y[0]=I}catch(Dv){throw r.logger.error("Error compiling schema, function code:",n),Dv}if(I.schema=q,I.errors=null,I.refs=u,I.refVal=y,I.root=c?I:H,p)I.$async=!0;if(l.sourceCode===!0)I.source={code:n,patterns:w,defaults:X};return I}function g(q,H,k){H=ya.url(q,H);var vv=u[H],c,p;if(vv!==void 0)return c=y[vv],p="refVal["+vv+"]",A(c,p);if(!k&&v.refs){var n=v.refs[H];if(n!==void 0)return c=v.refVal[n],p=V(H,c),A(c,p)}p=V(H);var I=ya.call(r,U,v,H);if(I===void 0){var Qv=f&&f[H];if(Qv)I=ya.inlineRef(Qv,l.inlineRefs)?Qv:af.call(r,Qv,v,f,q)}if(I===void 0)S(H);else return j(H,I),A(I,p)}function V(q,H){var k=y.length;return y[k]=H,u[q]=k,"refVal"+k}function S(q){delete u[q]}function j(q,H){var k=u[q];y[k]=H}function A(q,H){return typeof q=="object"||typeof q=="boolean"?{code:H,schema:q,inline:!0}:{code:H,$async:q&&!!q.$async}}function b(q){var H=K[q];if(H===void 0)H=K[q]=w.length,w[H]=q;return"pattern"+H}function x(q){switch(typeof q){case"boolean":case"number":return""+q;case"string":return Qa.toQuotedString(q);case"object":if(q===null)return"null";var H=xu(q),k=D[H];if(k===void 0)k=D[H]=X.length,X[k]=q;return"default"+k}}function $(q,H,k,vv){if(r._opts.validateSchema!==!1){var c=q.definition.dependencies;if(c&&!c.every(function(Yv){return Object.prototype.hasOwnProperty.call(k,Yv)}))throw Error("parent schema must have all required keywords: "+c.join(","));var p=q.definition.validateSchema;if(p){var n=p(H);if(!n){var I="keyword schema is invalid: "+r.errorsText(p.errors);if(r._opts.validateSchema=="log")r.logger.error(I);else throw Error(I)}}}var Qv=q.definition.compile,Dv=q.definition.inline,Gv=q.definition.macro,s;if(Qv)s=Qv.call(r,H,k,vv);else if(Gv){if(s=Gv.call(r,H,k,vv),l.validateSchema!==!1)r.validateSchema(s,!0)}else if(Dv)s=Dv.call(r,vv,q.keyword,H,k);else if(s=q.definition.validate,!s)return;if(s===void 0)throw Error('custom keyword "'+q.keyword+'"failed to compile');var Wv=F.length;return F[Wv]=s,{code:"customRule"+Wv,validate:s}}}function Ru(a,v,f){var h=zh.call(this,a,v,f);if(h>=0)return{index:h,compiling:!0};return h=this._compilations.length,this._compilations[h]={schema:a,root:v,baseId:f},{index:h,compiling:!1}}function Tu(a,v,f){var h=zh.call(this,a,v,f);if(h>=0)this._compilations.splice(h,1)}function zh(a,v,f){for(var h=0;h<this._compilations.length;h++){var r=this._compilations[h];if(r.schema==a&&r.root==v&&r.baseId==f)return h}return-1}function _u(a,v){return"var pattern"+a+" = new RegExp("+Qa.toQuotedString(v[a])+");"}function Cu(a){return"var default"+a+" = defaults["+a+"];"}function nu(a,v){return v[a]===void 0?"":"var refVal"+a+" = refVal["+a+"];"}function cu(a){return"var customRule"+a+" = customRules["+a+"];"}function ua(a,v){if(!a.length)return"";var f="";for(var h=0;h<a.length;h++)f+=v(h,a);return f}});var qh=T((vQ,Uh)=>{var Za=Uh.exports=function(){this._cache={}};Za.prototype.put=function(v,f){this._cache[v]=f};Za.prototype.get=function(v){return this._cache[v]};Za.prototype.del=function(v){delete this._cache[v]};Za.prototype.clear=function(){this._cache={}}});var Ih=T((rQ,Sh)=>{var du=Pr(),pu=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,mu=[0,31,28,31,30,31,30,31,31,30,31,30,31],iu=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,gh=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,su=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,tu=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Vh=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Ah=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,Hh=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Mh=/^(?:\/(?:[^~/]|~0|~1)*)*$/,jh=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,$h=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Sh.exports=wa;function wa(a){return a=a=="full"?"full":"fast",du.copy(wa[a])}wa.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":Vh,url:Ah,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:gh,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:bh,uuid:Hh,"json-pointer":Mh,"json-pointer-uri-fragment":jh,"relative-json-pointer":$h};wa.full={date:kh,time:xh,"date-time":v1,uri:a1,"uri-reference":tu,"uri-template":Vh,url:Ah,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:gh,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:bh,uuid:Hh,"json-pointer":Mh,"json-pointer-uri-fragment":jh,"relative-json-pointer":$h};function eu(a){return a%4===0&&(a%100!==0||a%400===0)}function kh(a){var v=a.match(pu);if(!v)return!1;var f=+v[1],h=+v[2],r=+v[3];return h>=1&&h<=12&&r>=1&&r<=(h==2&&eu(f)?29:mu[h])}function xh(a,v){var f=a.match(iu);if(!f)return!1;var h=f[1],r=f[2],l=f[3],y=f[5];return(h<=23&&r<=59&&l<=59||h==23&&r==59&&l==60)&&(!v||y)}var ou=/t|\s/i;function v1(a){var v=a.split(ou);return v.length==2&&kh(v[0])&&xh(v[1],!0)}var r1=/\/|:/;function a1(a){return r1.test(a)&&su.test(a)}var f1=/[^\\]\\Z/;function bh(a){if(f1.test(a))return!1;try{return new RegExp(a),!0}catch(v){return!1}}});var Th=T((aQ,Rh)=>{Rh.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.errSchemaPath+"/"+f,K=!v.opts.allErrors,X="data"+(y||""),D="valid"+l,F,Q;if(u=="#"||u=="#/")if(v.isRoot)F=v.async,Q="validate";else F=v.root.schema.$async===!0,Q="root.refVal[0]";else{var J=v.resolveRef(v.baseId,u,v.isRoot);if(J===void 0){var G=v.MissingRefError.message(v.baseId,u);if(v.opts.missingRefs=="fail"){v.logger.error(G);var B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(w)+" , params: { ref: '"+v.util.escapeQuotes(u)+"' } ",v.opts.messages!==!1)r+=" , message: 'can\\'t resolve reference "+v.util.escapeQuotes(u)+"' ";if(v.opts.verbose)r+=" , schema: "+v.util.toQuotedString(u)+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+X+" ";r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&K)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(K)r+=" if (false) { "}else if(v.opts.missingRefs=="ignore"){if(v.logger.warn(G),K)r+=" if (true) { "}else throw new v.MissingRefError(v.baseId,u,G)}else if(J.inline){var N=v.util.copy(v);N.level++;var O="valid"+N.level;N.schema=J.schema,N.schemaPath="",N.errSchemaPath=u;var U=v.validate(N).replace(/validate\.schema/g,J.code);if(r+=" "+U+" ",K)r+=" if ("+O+") { "}else F=J.$async===!0||v.async&&J.$async!==!1,Q=J.code}if(Q){var B=B||[];if(B.push(r),r="",v.opts.passContext)r+=" "+Q+".call(this, ";else r+=" "+Q+"( ";if(r+=" "+X+", (dataPath || '')",v.errorPath!='""')r+=" + "+v.errorPath;var g=y?"data"+(y-1||""):"parentData",V=y?v.dataPathArr[y]:"parentDataProperty";r+=" , "+g+" , "+V+", rootData)  ";var S=r;if(r=B.pop(),F){if(!v.async)throw Error("async schema referenced by sync schema");if(K)r+=" var "+D+"; ";if(r+=" try { await "+S+"; ",K)r+=" "+D+" = true; ";if(r+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",K)r+=" "+D+" = false; ";if(r+=" } ",K)r+=" if ("+D+") { "}else if(r+=" if (!"+S+") { if (vErrors === null) vErrors = "+Q+".errors; else vErrors = vErrors.concat("+Q+".errors); errors = vErrors.length; } ",K)r+=" else { "}return r}});var Ch=T((fQ,_h)=>{_h.exports=function(v,f,h){var r=" ",l=v.schema[f],y=v.schemaPath+v.util.getProperty(f),u=v.errSchemaPath+"/"+f,w=!v.opts.allErrors,K=v.util.copy(v),X="";K.level++;var D="valid"+K.level,F=K.baseId,Q=!0,J=l;if(J){var G,B=-1,z=J.length-1;while(B<z)if(G=J[B+=1],v.opts.strictKeywords?typeof G=="object"&&Object.keys(G).length>0||G===!1:v.util.schemaHasRules(G,v.RULES.all)){if(Q=!1,K.schema=G,K.schemaPath=y+"["+B+"]",K.errSchemaPath=u+"/"+B,r+="  "+v.validate(K)+" ",K.baseId=F,w)r+=" if ("+D+") { ",X+="}"}}if(w)if(Q)r+=" if (true) { ";else r+=" "+X.slice(0,-1)+" ";return r}});var ch=T((hQ,nh)=>{nh.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q="errs__"+l,J=v.util.copy(v),G="";J.level++;var B="valid"+J.level,z=u.every(function(j){return v.opts.strictKeywords?typeof j=="object"&&Object.keys(j).length>0||j===!1:v.util.schemaHasRules(j,v.RULES.all)});if(z){var N=J.baseId;r+=" var "+Q+" = errors; var "+F+" = false;  ";var O=v.compositeRule;v.compositeRule=J.compositeRule=!0;var U=u;if(U){var g,V=-1,S=U.length-1;while(V<S)g=U[V+=1],J.schema=g,J.schemaPath=w+"["+V+"]",J.errSchemaPath=K+"/"+V,r+="  "+v.validate(J)+" ",J.baseId=N,r+=" "+F+" = "+F+" || "+B+"; if (!"+F+") { ",G+="}"}if(v.compositeRule=J.compositeRule=O,r+=" "+G+" if (!"+F+") {   var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: {} ",v.opts.messages!==!1)r+=" , message: 'should match some schema in anyOf' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; return false; ";if(r+=" } else {  errors = "+Q+"; if (vErrors !== null) { if ("+Q+") vErrors.length = "+Q+"; else vErrors = null; } ",v.opts.allErrors)r+=" } "}else if(X)r+=" if (true) { ";return r}});var ph=T((lQ,dh)=>{dh.exports=function(v,f,h){var r=" ",l=v.schema[f],y=v.errSchemaPath+"/"+f,u=!v.opts.allErrors,w=v.util.toQuotedString(l);if(v.opts.$comment===!0)r+=" console.log("+w+");";else if(typeof v.opts.$comment=="function")r+=" self._opts.$comment("+w+", "+v.util.toQuotedString(y)+", validate.root.schema);";return r}});var ih=T((PQ,mh)=>{mh.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q=v.opts.$data&&u&&u.$data,J;if(Q)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",J="schema"+l;else J=u;if(!Q)r+=" var schema"+l+" = validate.schema"+w+";";r+="var "+F+" = equal("+D+", schema"+l+"); if (!"+F+") {   ";var G=G||[];if(G.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { allowedValue: schema"+l+" } ",v.opts.messages!==!1)r+=" , message: 'should be equal to constant' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var B=r;if(r=G.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+B+"]); ";else r+=" validate.errors = ["+B+"]; return false; ";else r+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" }",X)r+=" else { ";return r}});var th=T((yQ,sh)=>{sh.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q="errs__"+l,J=v.util.copy(v),G="";J.level++;var B="valid"+J.level,z="i"+l,N=J.dataLevel=v.dataLevel+1,O="data"+N,U=v.baseId,g=v.opts.strictKeywords?typeof u=="object"&&Object.keys(u).length>0||u===!1:v.util.schemaHasRules(u,v.RULES.all);if(r+="var "+Q+" = errors;var "+F+";",g){var V=v.compositeRule;v.compositeRule=J.compositeRule=!0,J.schema=u,J.schemaPath=w,J.errSchemaPath=K,r+=" var "+B+" = false; for (var "+z+" = 0; "+z+" < "+D+".length; "+z+"++) { ",J.errorPath=v.util.getPathExpr(v.errorPath,z,v.opts.jsonPointers,!0);var S=D+"["+z+"]";J.dataPathArr[N]=z;var j=v.validate(J);if(J.baseId=U,v.util.varOccurences(j,O)<2)r+=" "+v.util.varReplace(j,O,S)+" ";else r+=" var "+O+" = "+S+"; "+j+" ";r+=" if ("+B+") break; }  ",v.compositeRule=J.compositeRule=V,r+=" "+G+" if (!"+B+") {"}else r+=" if ("+D+".length == 0) {";var A=A||[];if(A.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: {} ",v.opts.messages!==!1)r+=" , message: 'should contain a valid item' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var b=r;if(r=A.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+b+"]); ";else r+=" validate.errors = ["+b+"]; return false; ";else r+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } else { ",g)r+="  errors = "+Q+"; if (vErrors !== null) { if ("+Q+") vErrors.length = "+Q+"; else vErrors = null; } ";if(v.opts.allErrors)r+=" } ";return r}});var oh=T((uQ,eh)=>{eh.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="errs__"+l,Q=v.util.copy(v),J="";Q.level++;var G="valid"+Q.level,B={},z={},N=v.opts.ownProperties;for(V in u){if(V=="__proto__")continue;var O=u[V],U=Array.isArray(O)?z:B;U[V]=O}r+="var "+F+" = errors;";var g=v.errorPath;r+="var missing"+l+";";for(var V in z)if(U=z[V],U.length){if(r+=" if ( "+D+v.util.getProperty(V)+" !== undefined ",N)r+=" && Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(V)+"') ";if(X){r+=" && ( ";var S=U;if(S){var j,A=-1,b=S.length-1;while(A<b){if(j=S[A+=1],A)r+=" || ";var x=v.util.getProperty(j),$=D+x;if(r+=" ( ( "+$+" === undefined ",N)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(j)+"') ";r+=") && (missing"+l+" = "+v.util.toQuotedString(v.opts.jsonPointers?j:x)+") ) "}}r+=")) {  ";var q="missing"+l,H="' + "+q+" + '";if(v.opts._errorDataPathProperty)v.errorPath=v.opts.jsonPointers?v.util.getPathExpr(g,q,!0):g+" + "+q;var k=k||[];if(k.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { property: '"+v.util.escapeQuotes(V)+"', missingProperty: '"+H+"', depsCount: "+U.length+", deps: '"+v.util.escapeQuotes(U.length==1?U[0]:U.join(", "))+"' } ",v.opts.messages!==!1){if(r+=" , message: 'should have ",U.length==1)r+="property "+v.util.escapeQuotes(U[0]);else r+="properties "+v.util.escapeQuotes(U.join(", "));r+=" when property "+v.util.escapeQuotes(V)+" is present' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var vv=r;if(r=k.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+vv+"]); ";else r+=" validate.errors = ["+vv+"]; return false; ";else r+=" var err = "+vv+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var c=U;if(c){var j,p=-1,n=c.length-1;while(p<n){j=c[p+=1];var x=v.util.getProperty(j),H=v.util.escapeQuotes(j),$=D+x;if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPath(g,j,v.opts.jsonPointers);if(r+=" if ( "+$+" === undefined ",N)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(j)+"') ";if(r+=") {  var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { property: '"+v.util.escapeQuotes(V)+"', missingProperty: '"+H+"', depsCount: "+U.length+", deps: '"+v.util.escapeQuotes(U.length==1?U[0]:U.join(", "))+"' } ",v.opts.messages!==!1){if(r+=" , message: 'should have ",U.length==1)r+="property "+v.util.escapeQuotes(U[0]);else r+="properties "+v.util.escapeQuotes(U.join(", "));r+=" when property "+v.util.escapeQuotes(V)+" is present' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}}if(r+=" }   ",X)J+="}",r+=" else { "}v.errorPath=g;var I=Q.baseId;for(var V in B){var O=B[V];if(v.opts.strictKeywords?typeof O=="object"&&Object.keys(O).length>0||O===!1:v.util.schemaHasRules(O,v.RULES.all)){if(r+=" "+G+" = true; if ( "+D+v.util.getProperty(V)+" !== undefined ",N)r+=" && Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(V)+"') ";if(r+=") { ",Q.schema=O,Q.schemaPath=w+v.util.getProperty(V),Q.errSchemaPath=K+"/"+v.util.escapeFragment(V),r+="  "+v.validate(Q)+" ",Q.baseId=I,r+=" }  ",X)r+=" if ("+G+") { ",J+="}"}}if(X)r+="   "+J+" if ("+F+" == errors) {";return r}});var rl=T((QQ,vl)=>{vl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q=v.opts.$data&&u&&u.$data,J;if(Q)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",J="schema"+l;else J=u;var G="i"+l,B="schema"+l;if(!Q)r+=" var "+B+" = validate.schema"+w+";";if(r+="var "+F+";",Q)r+=" if (schema"+l+" === undefined) "+F+" = true; else if (!Array.isArray(schema"+l+")) "+F+" = false; else {";if(r+=""+F+" = false;for (var "+G+"=0; "+G+"<"+B+".length; "+G+"++) if (equal("+D+", "+B+"["+G+"])) { "+F+" = true; break; }",Q)r+="  }  ";r+=" if (!"+F+") {   ";var z=z||[];if(z.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { allowedValues: schema"+l+" } ",v.opts.messages!==!1)r+=" , message: 'should be equal to one of the allowed values' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var N=r;if(r=z.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+N+"]); ";else r+=" validate.errors = ["+N+"]; return false; ";else r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" }",X)r+=" else { ";return r}});var fl=T((ZQ,al)=>{al.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||"");if(v.opts.format===!1){if(X)r+=" if (true) { ";return r}var F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;var J=v.opts.unknownFormats,G=Array.isArray(J);if(F){var B="format"+l,z="isObject"+l,N="formatType"+l;if(r+=" var "+B+" = formats["+Q+"]; var "+z+" = typeof "+B+" == 'object' && !("+B+" instanceof RegExp) && "+B+".validate; var "+N+" = "+z+" && "+B+".type || 'string'; if ("+z+") { ",v.async)r+=" var async"+l+" = "+B+".async; ";if(r+=" "+B+" = "+B+".validate; } if (  ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'string') || ";if(r+=" (",J!="ignore"){if(r+=" ("+Q+" && !"+B+" ",G)r+=" && self._opts.unknownFormats.indexOf("+Q+") == -1 ";r+=") || "}if(r+=" ("+B+" && "+N+" == '"+h+"' && !(typeof "+B+" == 'function' ? ",v.async)r+=" (async"+l+" ? await "+B+"("+D+") : "+B+"("+D+")) ";else r+=" "+B+"("+D+") ";r+=" : "+B+".test("+D+"))))) {"}else{var B=v.formats[u];if(!B)if(J=="ignore"){if(v.logger.warn('unknown format "'+u+'" ignored in schema at path "'+v.errSchemaPath+'"'),X)r+=" if (true) { ";return r}else if(G&&J.indexOf(u)>=0){if(X)r+=" if (true) { ";return r}else throw Error('unknown format "'+u+'" is used in schema at path "'+v.errSchemaPath+'"');var z=typeof B=="object"&&!(B instanceof RegExp)&&B.validate,N=z&&B.type||"string";if(z){var O=B.async===!0;B=B.validate}if(N!=h){if(X)r+=" if (true) { ";return r}if(O){if(!v.async)throw Error("async format in sync schema");var U="formats"+v.util.getProperty(u)+".validate";r+=" if (!(await "+U+"("+D+"))) { "}else{r+=" if (! ";var U="formats"+v.util.getProperty(u);if(z)U+=".validate";if(typeof B=="function")r+=" "+U+"("+D+") ";else r+=" "+U+".test("+D+") ";r+=") { "}}var g=g||[];if(g.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { format:  ",F)r+=""+Q;else r+=""+v.util.toQuotedString(u);if(r+="  } ",v.opts.messages!==!1){if(r+=` , message: 'should match format "`,F)r+="' + "+Q+" + '";else r+=""+v.util.escapeQuotes(u);r+=`"' `}if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+v.util.toQuotedString(u);r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var V=r;if(r=g.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+V+"]); ";else r+=" validate.errors = ["+V+"]; return false; ";else r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } ",X)r+=" else { ";return r}});var ll=T((wQ,hl)=>{hl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q="errs__"+l,J=v.util.copy(v);J.level++;var G="valid"+J.level,B=v.schema.then,z=v.schema.else,N=B!==void 0&&(v.opts.strictKeywords?typeof B=="object"&&Object.keys(B).length>0||B===!1:v.util.schemaHasRules(B,v.RULES.all)),O=z!==void 0&&(v.opts.strictKeywords?typeof z=="object"&&Object.keys(z).length>0||z===!1:v.util.schemaHasRules(z,v.RULES.all)),U=J.baseId;if(N||O){var g;J.createErrors=!1,J.schema=u,J.schemaPath=w,J.errSchemaPath=K,r+=" var "+Q+" = errors; var "+F+" = true;  ";var V=v.compositeRule;if(v.compositeRule=J.compositeRule=!0,r+="  "+v.validate(J)+" ",J.baseId=U,J.createErrors=!0,r+="  errors = "+Q+"; if (vErrors !== null) { if ("+Q+") vErrors.length = "+Q+"; else vErrors = null; }  ",v.compositeRule=J.compositeRule=V,N){if(r+=" if ("+G+") {  ",J.schema=v.schema.then,J.schemaPath=v.schemaPath+".then",J.errSchemaPath=v.errSchemaPath+"/then",r+="  "+v.validate(J)+" ",J.baseId=U,r+=" "+F+" = "+G+"; ",N&&O)g="ifClause"+l,r+=" var "+g+" = 'then'; ";else g="'then'";if(r+=" } ",O)r+=" else { "}else r+=" if (!"+G+") { ";if(O){if(J.schema=v.schema.else,J.schemaPath=v.schemaPath+".else",J.errSchemaPath=v.errSchemaPath+"/else",r+="  "+v.validate(J)+" ",J.baseId=U,r+=" "+F+" = "+G+"; ",N&&O)g="ifClause"+l,r+=" var "+g+" = 'else'; ";else g="'else'";r+=" } "}if(r+=" if (!"+F+") {   var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { failingKeyword: "+g+" } ",v.opts.messages!==!1)r+=` , message: 'should match "' + `+g+` + '" schema' `;if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; return false; ";if(r+=" }   ",X)r+=" else { "}else if(X)r+=" if (true) { ";return r}});var yl=T((WQ,Pl)=>{Pl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q="errs__"+l,J=v.util.copy(v),G="";J.level++;var B="valid"+J.level,z="i"+l,N=J.dataLevel=v.dataLevel+1,O="data"+N,U=v.baseId;if(r+="var "+Q+" = errors;var "+F+";",Array.isArray(u)){var g=v.schema.additionalItems;if(g===!1){r+=" "+F+" = "+D+".length <= "+u.length+"; ";var V=K;K=v.errSchemaPath+"/additionalItems",r+="  if (!"+F+") {   ";var S=S||[];if(S.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { limit: "+u.length+" } ",v.opts.messages!==!1)r+=" , message: 'should NOT have more than "+u.length+" items' ";if(v.opts.verbose)r+=" , schema: false , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var j=r;if(r=S.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+j+"]); ";else r+=" validate.errors = ["+j+"]; return false; ";else r+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } ",K=V,X)G+="}",r+=" else { "}var A=u;if(A){var b,x=-1,$=A.length-1;while(x<$)if(b=A[x+=1],v.opts.strictKeywords?typeof b=="object"&&Object.keys(b).length>0||b===!1:v.util.schemaHasRules(b,v.RULES.all)){r+=" "+B+" = true; if ("+D+".length > "+x+") { ";var q=D+"["+x+"]";J.schema=b,J.schemaPath=w+"["+x+"]",J.errSchemaPath=K+"/"+x,J.errorPath=v.util.getPathExpr(v.errorPath,x,v.opts.jsonPointers,!0),J.dataPathArr[N]=x;var H=v.validate(J);if(J.baseId=U,v.util.varOccurences(H,O)<2)r+=" "+v.util.varReplace(H,O,q)+" ";else r+=" var "+O+" = "+q+"; "+H+" ";if(r+=" }  ",X)r+=" if ("+B+") { ",G+="}"}}if(typeof g=="object"&&(v.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:v.util.schemaHasRules(g,v.RULES.all))){J.schema=g,J.schemaPath=v.schemaPath+".additionalItems",J.errSchemaPath=v.errSchemaPath+"/additionalItems",r+=" "+B+" = true; if ("+D+".length > "+u.length+") {  for (var "+z+" = "+u.length+"; "+z+" < "+D+".length; "+z+"++) { ",J.errorPath=v.util.getPathExpr(v.errorPath,z,v.opts.jsonPointers,!0);var q=D+"["+z+"]";J.dataPathArr[N]=z;var H=v.validate(J);if(J.baseId=U,v.util.varOccurences(H,O)<2)r+=" "+v.util.varReplace(H,O,q)+" ";else r+=" var "+O+" = "+q+"; "+H+" ";if(X)r+=" if (!"+B+") break; ";if(r+=" } }  ",X)r+=" if ("+B+") { ",G+="}"}}else if(v.opts.strictKeywords?typeof u=="object"&&Object.keys(u).length>0||u===!1:v.util.schemaHasRules(u,v.RULES.all)){J.schema=u,J.schemaPath=w,J.errSchemaPath=K,r+="  for (var "+z+" = 0; "+z+" < "+D+".length; "+z+"++) { ",J.errorPath=v.util.getPathExpr(v.errorPath,z,v.opts.jsonPointers,!0);var q=D+"["+z+"]";J.dataPathArr[N]=z;var H=v.validate(J);if(J.baseId=U,v.util.varOccurences(H,O)<2)r+=" "+v.util.varReplace(H,O,q)+" ";else r+=" var "+O+" = "+q+"; "+H+" ";if(X)r+=" if (!"+B+") break; ";r+=" }"}if(X)r+=" "+G+" if ("+Q+" == errors) {";return r}});var ff=T((JQ,ul)=>{ul.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,U,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;var J=f=="maximum",G=J?"exclusiveMaximum":"exclusiveMinimum",B=v.schema[G],z=v.opts.$data&&B&&B.$data,N=J?"<":">",O=J?">":"<",U=void 0;if(!(F||typeof u=="number"||u===void 0))throw Error(f+" must be number");if(!(z||B===void 0||typeof B=="number"||typeof B=="boolean"))throw Error(G+" must be number or boolean");if(z){var g=v.util.getData(B.$data,y,v.dataPathArr),V="exclusive"+l,S="exclType"+l,j="exclIsNumber"+l,A="op"+l,b="' + "+A+" + '";r+=" var schemaExcl"+l+" = "+g+"; ",g="schemaExcl"+l,r+=" var "+V+"; var "+S+" = typeof "+g+"; if ("+S+" != 'boolean' && "+S+" != 'undefined' && "+S+" != 'number') { ";var U=G,x=x||[];if(x.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(U||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: {} ",v.opts.messages!==!1)r+=" , message: '"+G+" should be boolean' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var $=r;if(r=x.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+$+"]); ";else r+=" validate.errors = ["+$+"]; return false; ";else r+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } else if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";if(r+=" "+S+" == 'number' ? ( ("+V+" = "+Q+" === undefined || "+g+" "+N+"= "+Q+") ? "+D+" "+O+"= "+g+" : "+D+" "+O+" "+Q+" ) : ( ("+V+" = "+g+" === true) ? "+D+" "+O+"= "+Q+" : "+D+" "+O+" "+Q+" ) || "+D+" !== "+D+") { var op"+l+" = "+V+" ? '"+N+"' : '"+N+"='; ",u===void 0)U=G,K=v.errSchemaPath+"/"+G,Q=g,F=z}else{var j=typeof B=="number",b=N;if(j&&F){var A="'"+b+"'";if(r+=" if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";r+=" ( "+Q+" === undefined || "+B+" "+N+"= "+Q+" ? "+D+" "+O+"= "+B+" : "+D+" "+O+" "+Q+" ) || "+D+" !== "+D+") { "}else{if(j&&u===void 0)V=!0,U=G,K=v.errSchemaPath+"/"+G,Q=B,O+="=";else{if(j)Q=Math[J?"min":"max"](B,u);if(B===(j?Q:!0))V=!0,U=G,K=v.errSchemaPath+"/"+G,O+="=";else V=!1,b+="="}var A="'"+b+"'";if(r+=" if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";r+=" "+D+" "+O+" "+Q+" || "+D+" !== "+D+") { "}}U=U||f;var x=x||[];if(x.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(U||"_limit")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { comparison: "+A+", limit: "+Q+", exclusive: "+V+" } ",v.opts.messages!==!1)if(r+=" , message: 'should be "+b+" ",F)r+="' + "+Q;else r+=""+Q+"'";if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var $=r;if(r=x.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+$+"]); ";else r+=" validate.errors = ["+$+"]; return false; ";else r+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } ",X)r+=" else { ";return r}});var hf=T((BQ,Ql)=>{Ql.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,G,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;if(!(F||typeof u=="number"))throw Error(f+" must be number");var J=f=="maxItems"?">":"<";if(r+="if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";r+=" "+D+".length "+J+" "+Q+") { ";var G=f,B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(G||"_limitItems")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { limit: "+Q+" } ",v.opts.messages!==!1){if(r+=" , message: 'should NOT have ",f=="maxItems")r+="more";else r+="fewer";if(r+=" than ",F)r+="' + "+Q+" + '";else r+=""+u;r+=" items' "}if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+="} ",X)r+=" else { ";return r}});var lf=T((KQ,Zl)=>{Zl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,G,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;if(!(F||typeof u=="number"))throw Error(f+" must be number");var J=f=="maxLength"?">":"<";if(r+="if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";if(v.opts.unicode===!1)r+=" "+D+".length ";else r+=" ucs2length("+D+") ";r+=" "+J+" "+Q+") { ";var G=f,B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(G||"_limitLength")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { limit: "+Q+" } ",v.opts.messages!==!1){if(r+=" , message: 'should NOT be ",f=="maxLength")r+="longer";else r+="shorter";if(r+=" than ",F)r+="' + "+Q+" + '";else r+=""+u;r+=" characters' "}if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+="} ",X)r+=" else { ";return r}});var Pf=T((YQ,wl)=>{wl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,G,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;if(!(F||typeof u=="number"))throw Error(f+" must be number");var J=f=="maxProperties"?">":"<";if(r+="if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'number') || ";r+=" Object.keys("+D+").length "+J+" "+Q+") { ";var G=f,B=B||[];if(B.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(G||"_limitProperties")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { limit: "+Q+" } ",v.opts.messages!==!1){if(r+=" , message: 'should NOT have ",f=="maxProperties")r+="more";else r+="fewer";if(r+=" than ",F)r+="' + "+Q+" + '";else r+=""+u;r+=" properties' "}if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var z=r;if(r=B.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+z+"]); ";else r+=" validate.errors = ["+z+"]; return false; ";else r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+="} ",X)r+=" else { ";return r}});var Jl=T((XQ,Wl)=>{Wl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;if(!(F||typeof u=="number"))throw Error(f+" must be number");if(r+="var division"+l+";if (",F)r+=" "+Q+" !== undefined && ( typeof "+Q+" != 'number' || ";if(r+=" (division"+l+" = "+D+" / "+Q+", ",v.opts.multipleOfPrecision)r+=" Math.abs(Math.round(division"+l+") - division"+l+") > 1e-"+v.opts.multipleOfPrecision+" ";else r+=" division"+l+" !== parseInt(division"+l+") ";if(r+=" ) ",F)r+="  )  ";r+=" ) {   ";var J=J||[];if(J.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { multipleOf: "+Q+" } ",v.opts.messages!==!1)if(r+=" , message: 'should be multiple of ",F)r+="' + "+Q;else r+=""+Q+"'";if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var G=r;if(r=J.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+G+"]); ";else r+=" validate.errors = ["+G+"]; return false; ";else r+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+="} ",X)r+=" else { ";return r}});var Kl=T((DQ,Bl)=>{Bl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="errs__"+l,Q=v.util.copy(v);Q.level++;var J="valid"+Q.level;if(v.opts.strictKeywords?typeof u=="object"&&Object.keys(u).length>0||u===!1:v.util.schemaHasRules(u,v.RULES.all)){Q.schema=u,Q.schemaPath=w,Q.errSchemaPath=K,r+=" var "+F+" = errors;  ";var G=v.compositeRule;v.compositeRule=Q.compositeRule=!0,Q.createErrors=!1;var B;if(Q.opts.allErrors)B=Q.opts.allErrors,Q.opts.allErrors=!1;if(r+=" "+v.validate(Q)+" ",Q.createErrors=!0,B)Q.opts.allErrors=B;v.compositeRule=Q.compositeRule=G,r+=" if ("+J+") {   ";var z=z||[];if(z.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: {} ",v.opts.messages!==!1)r+=" , message: 'should NOT be valid' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var N=r;if(r=z.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+N+"]); ";else r+=" validate.errors = ["+N+"]; return false; ";else r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } else {  errors = "+F+"; if (vErrors !== null) { if ("+F+") vErrors.length = "+F+"; else vErrors = null; } ",v.opts.allErrors)r+=" } "}else{if(r+="  var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: {} ",v.opts.messages!==!1)r+=" , message: 'should NOT be valid' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",X)r+=" if (false) { "}return r}});var Xl=T((FQ,Yl)=>{Yl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q="errs__"+l,J=v.util.copy(v),G="";J.level++;var B="valid"+J.level,z=J.baseId,N="prevValid"+l,O="passingSchemas"+l;r+="var "+Q+" = errors , "+N+" = false , "+F+" = false , "+O+" = null; ";var U=v.compositeRule;v.compositeRule=J.compositeRule=!0;var g=u;if(g){var V,S=-1,j=g.length-1;while(S<j){if(V=g[S+=1],v.opts.strictKeywords?typeof V=="object"&&Object.keys(V).length>0||V===!1:v.util.schemaHasRules(V,v.RULES.all))J.schema=V,J.schemaPath=w+"["+S+"]",J.errSchemaPath=K+"/"+S,r+="  "+v.validate(J)+" ",J.baseId=z;else r+=" var "+B+" = true; ";if(S)r+=" if ("+B+" && "+N+") { "+F+" = false; "+O+" = ["+O+", "+S+"]; } else { ",G+="}";r+=" if ("+B+") { "+F+" = "+N+" = true; "+O+" = "+S+"; }"}}if(v.compositeRule=J.compositeRule=U,r+=""+G+"if (!"+F+") {   var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { passingSchemas: "+O+" } ",v.opts.messages!==!1)r+=" , message: 'should match exactly one schema in oneOf' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; return false; ";if(r+="} else {  errors = "+Q+"; if (vErrors !== null) { if ("+Q+") vErrors.length = "+Q+"; else vErrors = null; }",v.opts.allErrors)r+=" } ";return r}});var Fl=T((GQ,Dl)=>{Dl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F=v.opts.$data&&u&&u.$data,Q;if(F)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",Q="schema"+l;else Q=u;var J=F?"(new RegExp("+Q+"))":v.usePattern(u);if(r+="if ( ",F)r+=" ("+Q+" !== undefined && typeof "+Q+" != 'string') || ";r+=" !"+J+".test("+D+") ) {   ";var G=G||[];if(G.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { pattern:  ",F)r+=""+Q;else r+=""+v.util.toQuotedString(u);if(r+="  } ",v.opts.messages!==!1){if(r+=` , message: 'should match pattern "`,F)r+="' + "+Q+" + '";else r+=""+v.util.escapeQuotes(u);r+=`"' `}if(v.opts.verbose){if(r+=" , schema:  ",F)r+="validate.schema"+w;else r+=""+v.util.toQuotedString(u);r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var B=r;if(r=G.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+B+"]); ";else r+=" validate.errors = ["+B+"]; return false; ";else r+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+="} ",X)r+=" else { ";return r}});var El=T((EQ,Gl)=>{Gl.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="errs__"+l,Q=v.util.copy(v),J="";Q.level++;var G="valid"+Q.level,B="key"+l,z="idx"+l,N=Q.dataLevel=v.dataLevel+1,O="data"+N,U="dataProperties"+l,g=Object.keys(u||{}).filter(p),V=v.schema.patternProperties||{},S=Object.keys(V).filter(p),j=v.schema.additionalProperties,A=g.length||S.length,b=j===!1,x=typeof j=="object"&&Object.keys(j).length,$=v.opts.removeAdditional,q=b||x||$,H=v.opts.ownProperties,k=v.baseId,vv=v.schema.required;if(vv&&!(v.opts.$data&&vv.$data)&&vv.length<v.opts.loopRequired)var c=v.util.toHash(vv);function p(xv){return xv!=="__proto__"}if(r+="var "+F+" = errors;var "+G+" = true;",H)r+=" var "+U+" = undefined;";if(q){if(H)r+=" "+U+" = "+U+" || Object.keys("+D+"); for (var "+z+"=0; "+z+"<"+U+".length; "+z+"++) { var "+B+" = "+U+"["+z+"]; ";else r+=" for (var "+B+" in "+D+") { ";if(A){if(r+=" var isAdditional"+l+" = !(false ",g.length)if(g.length>8)r+=" || validate.schema"+w+".hasOwnProperty("+B+") ";else{var n=g;if(n){var I,Qv=-1,Dv=n.length-1;while(Qv<Dv)I=n[Qv+=1],r+=" || "+B+" == "+v.util.toQuotedString(I)+" "}}if(S.length){var Gv=S;if(Gv){var s,Wv=-1,Yv=Gv.length-1;while(Wv<Yv)s=Gv[Wv+=1],r+=" || "+v.usePattern(s)+".test("+B+") "}}r+=" ); if (isAdditional"+l+") { "}if($=="all")r+=" delete "+D+"["+B+"]; ";else{var Ev=v.errorPath,iv="' + "+B+" + '";if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPathExpr(v.errorPath,B,v.opts.jsonPointers);if(b)if($)r+=" delete "+D+"["+B+"]; ";else{r+=" "+G+" = false; ";var Cv=K;K=v.errSchemaPath+"/additionalProperties";var Jv=Jv||[];if(Jv.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { additionalProperty: '"+iv+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is an invalid additional property";else r+="should NOT have additional properties";r+="' "}if(v.opts.verbose)r+=" , schema: false , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var Zv=r;if(r=Jv.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+Zv+"]); ";else r+=" validate.errors = ["+Zv+"]; return false; ";else r+=" var err = "+Zv+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(K=Cv,X)r+=" break; "}else if(x)if($=="failing"){r+=" var "+F+" = errors;  ";var vr=v.compositeRule;v.compositeRule=Q.compositeRule=!0,Q.schema=j,Q.schemaPath=v.schemaPath+".additionalProperties",Q.errSchemaPath=v.errSchemaPath+"/additionalProperties",Q.errorPath=v.opts._errorDataPathProperty?v.errorPath:v.util.getPathExpr(v.errorPath,B,v.opts.jsonPointers);var Fv=D+"["+B+"]";Q.dataPathArr[N]=B;var e=v.validate(Q);if(Q.baseId=k,v.util.varOccurences(e,O)<2)r+=" "+v.util.varReplace(e,O,Fv)+" ";else r+=" var "+O+" = "+Fv+"; "+e+" ";r+=" if (!"+G+") { errors = "+F+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+D+"["+B+"]; }  ",v.compositeRule=Q.compositeRule=vr}else{Q.schema=j,Q.schemaPath=v.schemaPath+".additionalProperties",Q.errSchemaPath=v.errSchemaPath+"/additionalProperties",Q.errorPath=v.opts._errorDataPathProperty?v.errorPath:v.util.getPathExpr(v.errorPath,B,v.opts.jsonPointers);var Fv=D+"["+B+"]";Q.dataPathArr[N]=B;var e=v.validate(Q);if(Q.baseId=k,v.util.varOccurences(e,O)<2)r+=" "+v.util.varReplace(e,O,Fv)+" ";else r+=" var "+O+" = "+Fv+"; "+e+" ";if(X)r+=" if (!"+G+") break; "}v.errorPath=Ev}if(A)r+=" } ";if(r+=" }  ",X)r+=" if ("+G+") { ",J+="}"}var sv=v.opts.useDefaults&&!v.compositeRule;if(g.length){var nv=g;if(nv){var I,rr=-1,ar=nv.length-1;while(rr<ar){I=nv[rr+=1];var Xv=u[I];if(v.opts.strictKeywords?typeof Xv=="object"&&Object.keys(Xv).length>0||Xv===!1:v.util.schemaHasRules(Xv,v.RULES.all)){var Hv=v.util.getProperty(I),Fv=D+Hv,Ov=sv&&Xv.default!==void 0;Q.schema=Xv,Q.schemaPath=w+Hv,Q.errSchemaPath=K+"/"+v.util.escapeFragment(I),Q.errorPath=v.util.getPath(v.errorPath,I,v.opts.jsonPointers),Q.dataPathArr[N]=v.util.toQuotedString(I);var e=v.validate(Q);if(Q.baseId=k,v.util.varOccurences(e,O)<2){e=v.util.varReplace(e,O,Fv);var Lv=Fv}else{var Lv=O;r+=" var "+O+" = "+Fv+"; "}if(Ov)r+=" "+e+" ";else{if(c&&c[I]){if(r+=" if ( "+Lv+" === undefined ",H)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(I)+"') ";r+=") { "+G+" = false; ";var Ev=v.errorPath,Cv=K,Iv=v.util.escapeQuotes(I);if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPath(Ev,I,v.opts.jsonPointers);K=v.errSchemaPath+"/required";var Jv=Jv||[];if(Jv.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+Iv+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+Iv+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var Zv=r;if(r=Jv.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+Zv+"]); ";else r+=" validate.errors = ["+Zv+"]; return false; ";else r+=" var err = "+Zv+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";K=Cv,v.errorPath=Ev,r+=" } else { "}else if(X){if(r+=" if ( "+Lv+" === undefined ",H)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(I)+"') ";r+=") { "+G+" = true; } else { "}else{if(r+=" if ("+Lv+" !== undefined ",H)r+=" &&   Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(I)+"') ";r+=" ) { "}r+=" "+e+" } "}}if(X)r+=" if ("+G+") { ",J+="}"}}}if(S.length){var qv=S;if(qv){var s,Hr=-1,Oa=qv.length-1;while(Hr<Oa){s=qv[Hr+=1];var Xv=V[s];if(v.opts.strictKeywords?typeof Xv=="object"&&Object.keys(Xv).length>0||Xv===!1:v.util.schemaHasRules(Xv,v.RULES.all)){if(Q.schema=Xv,Q.schemaPath=v.schemaPath+".patternProperties"+v.util.getProperty(s),Q.errSchemaPath=v.errSchemaPath+"/patternProperties/"+v.util.escapeFragment(s),H)r+=" "+U+" = "+U+" || Object.keys("+D+"); for (var "+z+"=0; "+z+"<"+U+".length; "+z+"++) { var "+B+" = "+U+"["+z+"]; ";else r+=" for (var "+B+" in "+D+") { ";r+=" if ("+v.usePattern(s)+".test("+B+")) { ",Q.errorPath=v.util.getPathExpr(v.errorPath,B,v.opts.jsonPointers);var Fv=D+"["+B+"]";Q.dataPathArr[N]=B;var e=v.validate(Q);if(Q.baseId=k,v.util.varOccurences(e,O)<2)r+=" "+v.util.varReplace(e,O,Fv)+" ";else r+=" var "+O+" = "+Fv+"; "+e+" ";if(X)r+=" if (!"+G+") break; ";if(r+=" } ",X)r+=" else "+G+" = true; ";if(r+=" }  ",X)r+=" if ("+G+") { ",J+="}"}}}}if(X)r+=" "+J+" if ("+F+" == errors) {";return r}});var zl=T((LQ,Ll)=>{Ll.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="errs__"+l,Q=v.util.copy(v),J="";Q.level++;var G="valid"+Q.level;if(r+="var "+F+" = errors;",v.opts.strictKeywords?typeof u=="object"&&Object.keys(u).length>0||u===!1:v.util.schemaHasRules(u,v.RULES.all)){Q.schema=u,Q.schemaPath=w,Q.errSchemaPath=K;var B="key"+l,z="idx"+l,N="i"+l,O="' + "+B+" + '",U=Q.dataLevel=v.dataLevel+1,g="data"+U,V="dataProperties"+l,S=v.opts.ownProperties,j=v.baseId;if(S)r+=" var "+V+" = undefined; ";if(S)r+=" "+V+" = "+V+" || Object.keys("+D+"); for (var "+z+"=0; "+z+"<"+V+".length; "+z+"++) { var "+B+" = "+V+"["+z+"]; ";else r+=" for (var "+B+" in "+D+") { ";r+=" var startErrs"+l+" = errors; ";var A=B,b=v.compositeRule;v.compositeRule=Q.compositeRule=!0;var x=v.validate(Q);if(Q.baseId=j,v.util.varOccurences(x,g)<2)r+=" "+v.util.varReplace(x,g,A)+" ";else r+=" var "+g+" = "+A+"; "+x+" ";if(v.compositeRule=Q.compositeRule=b,r+=" if (!"+G+") { for (var "+N+"=startErrs"+l+"; "+N+"<errors; "+N+"++) { vErrors["+N+"].propertyName = "+B+"; }   var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { propertyName: '"+O+"' } ",v.opts.messages!==!1)r+=" , message: 'property name \\'"+O+"\\' is invalid' ";if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; return false; ";if(X)r+=" break; ";r+=" } }"}if(X)r+=" "+J+" if ("+F+" == errors) {";return r}});var Nl=T((zQ,Ol)=>{Ol.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q=v.opts.$data&&u&&u.$data,J;if(Q)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",J="schema"+l;else J=u;var G="schema"+l;if(!Q)if(u.length<v.opts.loopRequired&&v.schema.properties&&Object.keys(v.schema.properties).length){var B=[],z=u;if(z){var N,O=-1,U=z.length-1;while(O<U){N=z[O+=1];var g=v.schema.properties[N];if(!(g&&(v.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:v.util.schemaHasRules(g,v.RULES.all))))B[B.length]=N}}}else var B=u;if(Q||B.length){var V=v.errorPath,S=Q||B.length>=v.opts.loopRequired,j=v.opts.ownProperties;if(X)if(r+=" var missing"+l+"; ",S){if(!Q)r+=" var "+G+" = validate.schema"+w+"; ";var A="i"+l,b="schema"+l+"["+A+"]",x="' + "+b+" + '";if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPathExpr(V,b,v.opts.jsonPointers);if(r+=" var "+F+" = true; ",Q)r+=" if (schema"+l+" === undefined) "+F+" = true; else if (!Array.isArray(schema"+l+")) "+F+" = false; else {";if(r+=" for (var "+A+" = 0; "+A+" < "+G+".length; "+A+"++) { "+F+" = "+D+"["+G+"["+A+"]] !== undefined ",j)r+=" &&   Object.prototype.hasOwnProperty.call("+D+", "+G+"["+A+"]) ";if(r+="; if (!"+F+") break; } ",Q)r+="  }  ";r+="  if (!"+F+") {   ";var $=$||[];if($.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+x+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+x+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var q=r;if(r=$.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+q+"]); ";else r+=" validate.errors = ["+q+"]; return false; ";else r+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";r+=" } else { "}else{r+=" if ( ";var H=B;if(H){var k,A=-1,vv=H.length-1;while(A<vv){if(k=H[A+=1],A)r+=" || ";var c=v.util.getProperty(k),p=D+c;if(r+=" ( ( "+p+" === undefined ",j)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(k)+"') ";r+=") && (missing"+l+" = "+v.util.toQuotedString(v.opts.jsonPointers?k:c)+") ) "}}r+=") {  ";var b="missing"+l,x="' + "+b+" + '";if(v.opts._errorDataPathProperty)v.errorPath=v.opts.jsonPointers?v.util.getPathExpr(V,b,!0):V+" + "+b;var $=$||[];if($.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+x+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+x+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";var q=r;if(r=$.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+q+"]); ";else r+=" validate.errors = ["+q+"]; return false; ";else r+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";r+=" } else { "}else if(S){if(!Q)r+=" var "+G+" = validate.schema"+w+"; ";var A="i"+l,b="schema"+l+"["+A+"]",x="' + "+b+" + '";if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPathExpr(V,b,v.opts.jsonPointers);if(Q){if(r+=" if ("+G+" && !Array.isArray("+G+")) {  var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+x+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+x+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+G+" !== undefined) { "}if(r+=" for (var "+A+" = 0; "+A+" < "+G+".length; "+A+"++) { if ("+D+"["+G+"["+A+"]] === undefined ",j)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", "+G+"["+A+"]) ";if(r+=") {  var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+x+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+x+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",Q)r+="  }  "}else{var n=B;if(n){var k,I=-1,Qv=n.length-1;while(I<Qv){k=n[I+=1];var c=v.util.getProperty(k),x=v.util.escapeQuotes(k),p=D+c;if(v.opts._errorDataPathProperty)v.errorPath=v.util.getPath(V,k,v.opts.jsonPointers);if(r+=" if ( "+p+" === undefined ",j)r+=" || ! Object.prototype.hasOwnProperty.call("+D+", '"+v.util.escapeQuotes(k)+"') ";if(r+=") {  var err =   ",v.createErrors!==!1){if(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { missingProperty: '"+x+"' } ",v.opts.messages!==!1){if(r+=" , message: '",v.opts._errorDataPathProperty)r+="is a required property";else r+="should have required property \\'"+x+"\\'";r+="' "}if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" ";r+=" } "}else r+=" {} ";r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}}v.errorPath=V}else if(X)r+=" if (true) {";return r}});var ql=T((OQ,Ul)=>{Ul.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D="data"+(y||""),F="valid"+l,Q=v.opts.$data&&u&&u.$data,J;if(Q)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",J="schema"+l;else J=u;if((u||Q)&&v.opts.uniqueItems!==!1){if(Q)r+=" var "+F+"; if ("+J+" === false || "+J+" === undefined) "+F+" = true; else if (typeof "+J+" != 'boolean') "+F+" = false; else { ";r+=" var i = "+D+".length , "+F+" = true , j; if (i > 1) { ";var G=v.schema.items&&v.schema.items.type,B=Array.isArray(G);if(!G||G=="object"||G=="array"||B&&(G.indexOf("object")>=0||G.indexOf("array")>=0))r+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+D+"[i], "+D+"[j])) { "+F+" = false; break outer; } } } ";else{r+=" var itemIndices = {}, item; for (;i--;) { var item = "+D+"[i]; ";var z="checkDataType"+(B?"s":"");if(r+=" if ("+v.util[z](G,"item",v.opts.strictNumbers,!0)+") continue; ",B)r+=` if (typeof item == 'string') item = '"' + item; `;r+=" if (typeof itemIndices[item] == 'number') { "+F+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}if(r+=" } ",Q)r+="  }  ";r+=" if (!"+F+") {   ";var N=N||[];if(N.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { i: i, j: j } ",v.opts.messages!==!1)r+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' ";if(v.opts.verbose){if(r+=" , schema:  ",Q)r+="validate.schema"+w;else r+=""+u;r+="         , parentSchema: validate.schema"+v.schemaPath+" , data: "+D+" "}r+=" } "}else r+=" {} ";var O=r;if(r=N.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+O+"]); ";else r+=" validate.errors = ["+O+"]; return false; ";else r+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";if(r+=" } ",X)r+=" else { "}else if(X)r+=" if (true) { ";return r}});var Vl=T((NQ,gl)=>{gl.exports={$ref:Th(),allOf:Ch(),anyOf:ch(),$comment:ph(),const:ih(),contains:th(),dependencies:oh(),enum:rl(),format:fl(),if:ll(),items:yl(),maximum:ff(),minimum:ff(),maxItems:hf(),minItems:hf(),maxLength:lf(),minLength:lf(),maxProperties:Pf(),minProperties:Pf(),multipleOf:Jl(),not:Kl(),oneOf:Xl(),pattern:Fl(),properties:El(),propertyNames:zl(),required:Nl(),uniqueItems:ql(),validate:rf()}});var Ml=T((UQ,Hl)=>{var Al=Vl(),yf=Pr().toHash;Hl.exports=function(){var v=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],f=["type","$comment"],h=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],r=["number","integer","string","array","object","boolean","null"];return v.all=yf(f),v.types=yf(r),v.forEach(function(l){if(l.rules=l.rules.map(function(y){var u;if(typeof y=="object"){var w=Object.keys(y)[0];u=y[w],y=w,u.forEach(function(X){f.push(X),v.all[X]=!0})}f.push(y);var K=v.all[y]={keyword:y,code:Al[y],implements:u};return K}),v.all.$comment={keyword:"$comment",code:Al.$comment},l.type)v.types[l.type]=l}),v.keywords=yf(f.concat(h)),v.custom={},v}});var kl=T((qQ,$l)=>{var jl=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];$l.exports=function(a,v){for(var f=0;f<v.length;f++){a=JSON.parse(JSON.stringify(a));var h=v[f].split("/"),r=a,l;for(l=1;l<h.length;l++)r=r[h[l]];for(l=0;l<jl.length;l++){var y=jl[l],u=r[y];if(u)r[y]={anyOf:[u,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}}}return a}});var Sl=T((gQ,bl)=>{var h1=Pa().MissingRef;bl.exports=xl;function xl(a,v,f){var h=this;if(typeof this._opts.loadSchema!="function")throw Error("options.loadSchema should be a function");if(typeof v=="function")f=v,v=void 0;var r=l(a).then(function(){var u=h._addSchema(a,void 0,v);return u.validate||y(u)});if(f)r.then(function(u){f(null,u)},f);return r;function l(u){var w=u.$schema;return w&&!h.getSchema(w)?xl.call(h,{$ref:w},!0):Promise.resolve()}function y(u){try{return h._compile(u)}catch(K){if(K instanceof h1)return w(K);throw K}function w(K){var X=K.missingSchema;if(Q(X))throw Error("Schema "+X+" is loaded but "+K.missingRef+" cannot be resolved");var D=h._loadingSchemas[X];if(!D)D=h._loadingSchemas[X]=h._opts.loadSchema(X),D.then(F,F);return D.then(function(J){if(!Q(X))return l(J).then(function(){if(!Q(X))h.addSchema(J,X,void 0,v)})}).then(function(){return y(u)});function F(){delete h._loadingSchemas[X]}function Q(J){return h._refs[J]||h._schemas[J]}}}}});var Rl=T((VQ,Il)=>{Il.exports=function(v,f,h){var r=" ",l=v.level,y=v.dataLevel,u=v.schema[f],w=v.schemaPath+v.util.getProperty(f),K=v.errSchemaPath+"/"+f,X=!v.opts.allErrors,D,F="data"+(y||""),Q="valid"+l,J="errs__"+l,G=v.opts.$data&&u&&u.$data,B;if(G)r+=" var schema"+l+" = "+v.util.getData(u.$data,y,v.dataPathArr)+"; ",B="schema"+l;else B=u;var z=this,N="definition"+l,O=z.definition,U="",g,V,S,j,A;if(G&&O.$data){A="keywordValidate"+l;var b=O.validateSchema;r+=" var "+N+" = RULES.custom['"+f+"'].definition; var "+A+" = "+N+".validate;"}else{if(j=v.useCustomRule(z,u,v.schema,v),!j)return;B="validate.schema"+w,A=j.code,g=O.compile,V=O.inline,S=O.macro}var x=A+".errors",$="i"+l,q="ruleErr"+l,H=O.async;if(H&&!v.async)throw Error("async keyword in sync schema");if(!(V||S))r+=""+x+" = null;";if(r+="var "+J+" = errors;var "+Q+";",G&&O.$data){if(U+="}",r+=" if ("+B+" === undefined) { "+Q+" = true; } else { ",b)U+="}",r+=" "+Q+" = "+N+".validateSchema("+B+"); if ("+Q+") { "}if(V)if(O.statements)r+=" "+j.validate+" ";else r+=" "+Q+" = "+j.validate+"; ";else if(S){var k=v.util.copy(v),U="";k.level++;var vv="valid"+k.level;k.schema=j.validate,k.schemaPath="";var c=v.compositeRule;v.compositeRule=k.compositeRule=!0;var p=v.validate(k).replace(/validate\.schema/g,A);v.compositeRule=k.compositeRule=c,r+=" "+p}else{var n=n||[];if(n.push(r),r="",r+="  "+A+".call( ",v.opts.passContext)r+="this";else r+="self";if(g||O.schema===!1)r+=" , "+F+" ";else r+=" , "+B+" , "+F+" , validate.schema"+v.schemaPath+" ";if(r+=" , (dataPath || '')",v.errorPath!='""')r+=" + "+v.errorPath;var I=y?"data"+(y-1||""):"parentData",Qv=y?v.dataPathArr[y]:"parentDataProperty";r+=" , "+I+" , "+Qv+" , rootData )  ";var Dv=r;if(r=n.pop(),O.errors===!1){if(r+=" "+Q+" = ",H)r+="await ";r+=""+Dv+"; "}else if(H)x="customErrors"+l,r+=" var "+x+" = null; try { "+Q+" = await "+Dv+"; } catch (e) { "+Q+" = false; if (e instanceof ValidationError) "+x+" = e.errors; else throw e; } ";else r+=" "+x+" = null; "+Q+" = "+Dv+"; "}if(O.modifying)r+=" if ("+I+") "+F+" = "+I+"["+Qv+"];";if(r+=""+U,O.valid){if(X)r+=" if (true) { "}else{if(r+=" if ( ",O.valid===void 0)if(r+=" !",S)r+=""+vv;else r+=""+Q;else r+=" "+!O.valid+" ";r+=") { ",D=z.keyword;var n=n||[];n.push(r),r="";var n=n||[];if(n.push(r),r="",v.createErrors!==!1){if(r+=" { keyword: '"+(D||"custom")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { keyword: '"+z.keyword+"' } ",v.opts.messages!==!1)r+=` , message: 'should pass "`+z.keyword+`" keyword validation' `;if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+F+" ";r+=" } "}else r+=" {} ";var Gv=r;if(r=n.pop(),!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(["+Gv+"]); ";else r+=" validate.errors = ["+Gv+"]; return false; ";else r+=" var err = "+Gv+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var s=r;if(r=n.pop(),V)if(O.errors){if(O.errors!="full"){if(r+="  for (var "+$+"="+J+"; "+$+"<errors; "+$+"++) { var "+q+" = vErrors["+$+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+v.errorPath+"; if ("+q+".schemaPath === undefined) { "+q+'.schemaPath = "'+K+'"; } ',v.opts.verbose)r+=" "+q+".schema = "+B+"; "+q+".data = "+F+"; ";r+=" } "}}else if(O.errors===!1)r+=" "+s+" ";else{if(r+=" if ("+J+" == errors) { "+s+" } else {  for (var "+$+"="+J+"; "+$+"<errors; "+$+"++) { var "+q+" = vErrors["+$+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+v.errorPath+"; if ("+q+".schemaPath === undefined) { "+q+'.schemaPath = "'+K+'"; } ',v.opts.verbose)r+=" "+q+".schema = "+B+"; "+q+".data = "+F+"; ";r+=" } } "}else if(S){if(r+="   var err =   ",v.createErrors!==!1){if(r+=" { keyword: '"+(D||"custom")+"' , dataPath: (dataPath || '') + "+v.errorPath+" , schemaPath: "+v.util.toQuotedString(K)+" , params: { keyword: '"+z.keyword+"' } ",v.opts.messages!==!1)r+=` , message: 'should pass "`+z.keyword+`" keyword validation' `;if(v.opts.verbose)r+=" , schema: validate.schema"+w+" , parentSchema: validate.schema"+v.schemaPath+" , data: "+F+" ";r+=" } "}else r+=" {} ";if(r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!v.compositeRule&&X)if(v.async)r+=" throw new ValidationError(vErrors); ";else r+=" validate.errors = vErrors; return false; "}else if(O.errors===!1)r+=" "+s+" ";else{if(r+=" if (Array.isArray("+x+")) { if (vErrors === null) vErrors = "+x+"; else vErrors = vErrors.concat("+x+"); errors = vErrors.length;  for (var "+$+"="+J+"; "+$+"<errors; "+$+"++) { var "+q+" = vErrors["+$+"]; if ("+q+".dataPath === undefined) "+q+".dataPath = (dataPath || '') + "+v.errorPath+";  "+q+'.schemaPath = "'+K+'";  ',v.opts.verbose)r+=" "+q+".schema = "+B+"; "+q+".data = "+F+"; ";r+=" } } else { "+s+" } "}if(r+=" } ",X)r+=" else { "}return r}});var uf=T((AQ,l1)=>{l1.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Cl=T((HQ,_l)=>{var Tl=uf();_l.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Tl.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Tl.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var cl=T((MQ,nl)=>{var P1=/^[a-z_$][a-z0-9_$-]*$/i,y1=Rl(),u1=Cl();nl.exports={add:Q1,get:Z1,remove:w1,validate:Qf};function Q1(a,v){var f=this.RULES;if(f.keywords[a])throw Error("Keyword "+a+" is already defined");if(!P1.test(a))throw Error("Keyword "+a+" is not a valid identifier");if(v){this.validateKeyword(v,!0);var h=v.type;if(Array.isArray(h))for(var r=0;r<h.length;r++)y(a,h[r],v);else y(a,h,v);var l=v.metaSchema;if(l){if(v.$data&&this._opts.$data)l={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]};v.validateSchema=this.compile(l,!0)}}f.keywords[a]=f.all[a]=!0;function y(u,w,K){var X;for(var D=0;D<f.length;D++){var F=f[D];if(F.type==w){X=F;break}}if(!X)X={type:w,rules:[]},f.push(X);var Q={keyword:u,definition:K,custom:!0,code:y1,implements:K.implements};X.rules.push(Q),f.custom[u]=Q}return this}function Z1(a){var v=this.RULES.custom[a];return v?v.definition:this.RULES.keywords[a]||!1}function w1(a){var v=this.RULES;delete v.keywords[a],delete v.all[a],delete v.custom[a];for(var f=0;f<v.length;f++){var h=v[f].rules;for(var r=0;r<h.length;r++)if(h[r].keyword==a){h.splice(r,1);break}}return this}function Qf(a,v){Qf.errors=null;var f=this._validateKeyword=this._validateKeyword||this.compile(u1,!0);if(f(a))return!0;if(Qf.errors=f.errors,v)throw Error("custom keyword definition is invalid: "+this.errorsText(f.errors));else return!1}});var dl=T((jQ,W1)=>{W1.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var aP=T(($Q,rP)=>{var ml=Nh(),yr=la(),J1=qh(),il=ma(),B1=vf(),K1=Ih(),Y1=Ml(),sl=kl(),tl=Pr();rP.exports=wv;wv.prototype.validate=D1;wv.prototype.compile=F1;wv.prototype.addSchema=G1;wv.prototype.addMetaSchema=E1;wv.prototype.validateSchema=L1;wv.prototype.getSchema=O1;wv.prototype.removeSchema=U1;wv.prototype.addFormat=$1;wv.prototype.errorsText=j1;wv.prototype._addSchema=q1;wv.prototype._compile=g1;wv.prototype.compileAsync=Sl();var Ba=cl();wv.prototype.addKeyword=Ba.add;wv.prototype.getKeyword=Ba.get;wv.prototype.removeKeyword=Ba.remove;wv.prototype.validateKeyword=Ba.validate;var el=Pa();wv.ValidationError=el.Validation;wv.MissingRefError=el.MissingRef;wv.$dataMetaSchema=sl;var Ja="http://json-schema.org/draft-07/schema",pl=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],X1=["/properties"];function wv(a){if(!(this instanceof wv))return new wv(a);if(a=this._opts=tl.copy(a)||{},R1(this),this._schemas={},this._refs={},this._fragments={},this._formats=K1(a.format),this._cache=a.cache||new J1,this._loadingSchemas={},this._compilations=[],this.RULES=Y1(),this._getId=V1(a),a.loopRequired=a.loopRequired||1/0,a.errorDataPath=="property")a._errorDataPathProperty=!0;if(a.serialize===void 0)a.serialize=B1;if(this._metaOpts=I1(this),a.formats)b1(this);if(a.keywords)S1(this);if(k1(this),typeof a.meta=="object")this.addMetaSchema(a.meta);if(a.nullable)this.addKeyword("nullable",{metaSchema:{type:"boolean"}});x1(this)}function D1(a,v){var f;if(typeof a=="string"){if(f=this.getSchema(a),!f)throw Error('no schema with key or ref "'+a+'"')}else{var h=this._addSchema(a);f=h.validate||this._compile(h)}var r=f(v);if(f.$async!==!0)this.errors=f.errors;return r}function F1(a,v){var f=this._addSchema(a,void 0,v);return f.validate||this._compile(f)}function G1(a,v,f,h){if(Array.isArray(a)){for(var r=0;r<a.length;r++)this.addSchema(a[r],void 0,f,h);return this}var l=this._getId(a);if(l!==void 0&&typeof l!="string")throw Error("schema id must be string");return v=yr.normalizeId(v||l),vP(this,v),this._schemas[v]=this._addSchema(a,f,h,!0),this}function E1(a,v,f){return this.addSchema(a,v,f,!0),this}function L1(a,v){var f=a.$schema;if(f!==void 0&&typeof f!="string")throw Error("$schema must be a string");if(f=f||this._opts.defaultMeta||z1(this),!f)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var h=this.validate(f,a);if(!h&&v){var r="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(r);else throw Error(r)}return h}function z1(a){var v=a._opts.meta;return a._opts.defaultMeta=typeof v=="object"?a._getId(v)||v:a.getSchema(Ja)?Ja:void 0,a._opts.defaultMeta}function O1(a){var v=ol(this,a);switch(typeof v){case"object":return v.validate||this._compile(v);case"string":return this.getSchema(v);case"undefined":return N1(this,a)}}function N1(a,v){var f=yr.schema.call(a,{schema:{}},v);if(f){var{schema:h,root:r,baseId:l}=f,y=ml.call(a,h,r,void 0,l);return a._fragments[v]=new il({ref:v,fragment:!0,schema:h,root:r,baseId:l,validate:y}),y}}function ol(a,v){return v=yr.normalizeId(v),a._schemas[v]||a._refs[v]||a._fragments[v]}function U1(a){if(a instanceof RegExp)return Wa(this,this._schemas,a),Wa(this,this._refs,a),this;switch(typeof a){case"undefined":return Wa(this,this._schemas),Wa(this,this._refs),this._cache.clear(),this;case"string":var v=ol(this,a);if(v)this._cache.del(v.cacheKey);return delete this._schemas[a],delete this._refs[a],this;case"object":var f=this._opts.serialize,h=f?f(a):a;this._cache.del(h);var r=this._getId(a);if(r)r=yr.normalizeId(r),delete this._schemas[r],delete this._refs[r]}return this}function Wa(a,v,f){for(var h in v){var r=v[h];if(!r.meta&&(!f||f.test(h)))a._cache.del(r.cacheKey),delete v[h]}}function q1(a,v,f,h){if(typeof a!="object"&&typeof a!="boolean")throw Error("schema should be object or boolean");var r=this._opts.serialize,l=r?r(a):a,y=this._cache.get(l);if(y)return y;h=h||this._opts.addUsedSchema!==!1;var u=yr.normalizeId(this._getId(a));if(u&&h)vP(this,u);var w=this._opts.validateSchema!==!1&&!v,K;if(w&&!(K=u&&u==yr.normalizeId(a.$schema)))this.validateSchema(a,!0);var X=yr.ids.call(this,a),D=new il({id:u,schema:a,localRefs:X,cacheKey:l,meta:f});if(u[0]!="#"&&h)this._refs[u]=D;if(this._cache.put(l,D),w&&K)this.validateSchema(a,!0);return D}function g1(a,v){if(a.compiling){if(a.validate=r,r.schema=a.schema,r.errors=null,r.root=v?v:r,a.schema.$async===!0)r.$async=!0;return r}a.compiling=!0;var f;if(a.meta)f=this._opts,this._opts=this._metaOpts;var h;try{h=ml.call(this,a.schema,v,a.localRefs)}catch(l){throw delete a.validate,l}finally{if(a.compiling=!1,a.meta)this._opts=f}return a.validate=h,a.refs=h.refs,a.refVal=h.refVal,a.root=h.root,h;function r(){var l=a.validate,y=l.apply(this,arguments);return r.errors=l.errors,y}}function V1(a){switch(a.schemaId){case"auto":return M1;case"id":return A1;default:return H1}}function A1(a){if(a.$id)this.logger.warn("schema $id ignored",a.$id);return a.id}function H1(a){if(a.id)this.logger.warn("schema id ignored",a.id);return a.$id}function M1(a){if(a.$id&&a.id&&a.$id!=a.id)throw Error("schema $id is different from id");return a.$id||a.id}function j1(a,v){if(a=a||this.errors,!a)return"No errors";v=v||{};var f=v.separator===void 0?", ":v.separator,h=v.dataVar===void 0?"data":v.dataVar,r="";for(var l=0;l<a.length;l++){var y=a[l];if(y)r+=h+y.dataPath+" "+y.message+f}return r.slice(0,-f.length)}function $1(a,v){if(typeof v=="string")v=new RegExp(v);return this._formats[a]=v,this}function k1(a){var v;if(a._opts.$data)v=dl(),a.addMetaSchema(v,v.$id,!0);if(a._opts.meta===!1)return;var f=uf();if(a._opts.$data)f=sl(f,X1);a.addMetaSchema(f,Ja,!0),a._refs["http://json-schema.org/schema"]=Ja}function x1(a){var v=a._opts.schemas;if(!v)return;if(Array.isArray(v))a.addSchema(v);else for(var f in v)a.addSchema(v[f],f)}function b1(a){for(var v in a._opts.formats){var f=a._opts.formats[v];a.addFormat(v,f)}}function S1(a){for(var v in a._opts.keywords){var f=a._opts.keywords[v];a.addKeyword(v,f)}}function vP(a,v){if(a._schemas[v]||a._refs[v])throw Error('schema with key or id "'+v+'" already exists')}function I1(a){var v=tl.copy(a._opts);for(var f=0;f<pl.length;f++)delete v[pl[f]];return v}function R1(a){var v=a._opts.logger;if(v===!1)a.logger={log:Zf,warn:Zf,error:Zf};else{if(v===void 0)v=console;if(!(typeof v=="object"&&v.log&&v.warn&&v.error))throw Error("logger must implement log, warn and error methods");a.logger=v}}function Zf(){}});var ga="2025-06-18";var xf=[ga,"2025-03-26","2024-11-05","2024-10-07"],kr="2.0",bf=P.union([P.string(),P.number().int()]),Sf=P.string(),Fy=P.object({progressToken:P.optional(bf)}).passthrough(),$v=P.object({_meta:P.optional(Fy)}).passthrough(),Nv=P.object({method:P.string(),params:P.optional($v)}),Or=P.object({_meta:P.optional(P.object({}).passthrough())}).passthrough(),_v=P.object({method:P.string(),params:P.optional(Or)}),kv=P.object({_meta:P.optional(P.object({}).passthrough())}).passthrough(),xr=P.union([P.string(),P.number().int()]),If=P.object({jsonrpc:P.literal(kr),id:xr}).merge(Nv).strict(),Rf=(a)=>If.safeParse(a).success,Tf=P.object({jsonrpc:P.literal(kr)}).merge(_v).strict(),_f=(a)=>Tf.safeParse(a).success,Cf=P.object({jsonrpc:P.literal(kr),id:xr,result:kv}).strict(),Va=(a)=>Cf.safeParse(a).success,fv;(function(a){a[a.ConnectionClosed=-32000]="ConnectionClosed",a[a.RequestTimeout=-32001]="RequestTimeout",a[a.ParseError=-32700]="ParseError",a[a.InvalidRequest=-32600]="InvalidRequest",a[a.MethodNotFound=-32601]="MethodNotFound",a[a.InvalidParams=-32602]="InvalidParams",a[a.InternalError=-32603]="InternalError"})(fv||(fv={}));var nf=P.object({jsonrpc:P.literal(kr),id:xr,error:P.object({code:P.number().int(),message:P.string(),data:P.optional(P.unknown())})}).strict(),cf=(a)=>nf.safeParse(a).success,df=P.union([If,Tf,Cf,nf]),br=kv.strict(),Sr=_v.extend({method:P.literal("notifications/cancelled"),params:Or.extend({requestId:xr,reason:P.string().optional()})}),Gy=P.object({src:P.string(),mimeType:P.optional(P.string()),sizes:P.optional(P.array(P.string()))}).passthrough(),Nr=P.object({icons:P.array(Gy).optional()}).passthrough(),Ur=P.object({name:P.string(),title:P.optional(P.string())}).passthrough(),pf=Ur.extend({version:P.string(),websiteUrl:P.optional(P.string())}).merge(Nr),Ey=P.object({experimental:P.optional(P.object({}).passthrough()),sampling:P.optional(P.object({}).passthrough()),elicitation:P.optional(P.object({}).passthrough()),roots:P.optional(P.object({listChanged:P.optional(P.boolean())}).passthrough())}).passthrough(),Aa=Nv.extend({method:P.literal("initialize"),params:$v.extend({protocolVersion:P.string(),capabilities:Ey,clientInfo:pf})});var Ly=P.object({experimental:P.optional(P.object({}).passthrough()),logging:P.optional(P.object({}).passthrough()),completions:P.optional(P.object({}).passthrough()),prompts:P.optional(P.object({listChanged:P.optional(P.boolean())}).passthrough()),resources:P.optional(P.object({subscribe:P.optional(P.boolean()),listChanged:P.optional(P.boolean())}).passthrough()),tools:P.optional(P.object({listChanged:P.optional(P.boolean())}).passthrough())}).passthrough(),zy=kv.extend({protocolVersion:P.string(),capabilities:Ly,serverInfo:pf,instructions:P.optional(P.string())}),Ha=_v.extend({method:P.literal("notifications/initialized")});var Ir=Nv.extend({method:P.literal("ping")}),Oy=P.object({progress:P.number(),total:P.optional(P.number()),message:P.optional(P.string())}).passthrough(),Rr=_v.extend({method:P.literal("notifications/progress"),params:Or.merge(Oy).extend({progressToken:bf})}),Tr=Nv.extend({params:$v.extend({cursor:P.optional(Sf)}).optional()}),_r=kv.extend({nextCursor:P.optional(Sf)}),mf=P.object({uri:P.string(),mimeType:P.optional(P.string()),_meta:P.optional(P.object({}).passthrough())}).passthrough(),sf=mf.extend({text:P.string()}),Ma=P.string().refine((a)=>{try{return atob(a),!0}catch(v){return!1}},{message:"Invalid Base64 string"}),tf=mf.extend({blob:Ma}),ef=Ur.extend({uri:P.string(),description:P.optional(P.string()),mimeType:P.optional(P.string()),_meta:P.optional(P.object({}).passthrough())}).merge(Nr),Ny=Ur.extend({uriTemplate:P.string(),description:P.optional(P.string()),mimeType:P.optional(P.string()),_meta:P.optional(P.object({}).passthrough())}).merge(Nr),Cr=Tr.extend({method:P.literal("resources/list")}),Uy=_r.extend({resources:P.array(ef)}),nr=Tr.extend({method:P.literal("resources/templates/list")}),qy=_r.extend({resourceTemplates:P.array(Ny)}),cr=Nv.extend({method:P.literal("resources/read"),params:$v.extend({uri:P.string()})}),gy=kv.extend({contents:P.array(P.union([sf,tf]))}),Vy=_v.extend({method:P.literal("notifications/resources/list_changed")}),Ay=Nv.extend({method:P.literal("resources/subscribe"),params:$v.extend({uri:P.string()})}),Hy=Nv.extend({method:P.literal("resources/unsubscribe"),params:$v.extend({uri:P.string()})}),My=_v.extend({method:P.literal("notifications/resources/updated"),params:Or.extend({uri:P.string()})}),jy=P.object({name:P.string(),description:P.optional(P.string()),required:P.optional(P.boolean())}).passthrough(),$y=Ur.extend({description:P.optional(P.string()),arguments:P.optional(P.array(jy)),_meta:P.optional(P.object({}).passthrough())}).merge(Nr),dr=Tr.extend({method:P.literal("prompts/list")}),ky=_r.extend({prompts:P.array($y)}),pr=Nv.extend({method:P.literal("prompts/get"),params:$v.extend({name:P.string(),arguments:P.optional(P.record(P.string()))})}),ja=P.object({type:P.literal("text"),text:P.string(),_meta:P.optional(P.object({}).passthrough())}).passthrough(),$a=P.object({type:P.literal("image"),data:Ma,mimeType:P.string(),_meta:P.optional(P.object({}).passthrough())}).passthrough(),ka=P.object({type:P.literal("audio"),data:Ma,mimeType:P.string(),_meta:P.optional(P.object({}).passthrough())}).passthrough(),xy=P.object({type:P.literal("resource"),resource:P.union([sf,tf]),_meta:P.optional(P.object({}).passthrough())}).passthrough(),by=ef.extend({type:P.literal("resource_link")}),of=P.union([ja,$a,ka,by,xy]),Sy=P.object({role:P.enum(["user","assistant"]),content:of}).passthrough(),Iy=kv.extend({description:P.optional(P.string()),messages:P.array(Sy)}),Ry=_v.extend({method:P.literal("notifications/prompts/list_changed")}),Ty=P.object({title:P.optional(P.string()),readOnlyHint:P.optional(P.boolean()),destructiveHint:P.optional(P.boolean()),idempotentHint:P.optional(P.boolean()),openWorldHint:P.optional(P.boolean())}).passthrough(),_y=Ur.extend({description:P.optional(P.string()),inputSchema:P.object({type:P.literal("object"),properties:P.optional(P.object({}).passthrough()),required:P.optional(P.array(P.string()))}).passthrough(),outputSchema:P.optional(P.object({type:P.literal("object"),properties:P.optional(P.object({}).passthrough()),required:P.optional(P.array(P.string()))}).passthrough()),annotations:P.optional(Ty),_meta:P.optional(P.object({}).passthrough())}).merge(Nr),mr=Tr.extend({method:P.literal("tools/list")}),Cy=_r.extend({tools:P.array(_y)}),vh=kv.extend({content:P.array(of).default([]),structuredContent:P.object({}).passthrough().optional(),isError:P.optional(P.boolean())}),$0=vh.or(kv.extend({toolResult:P.unknown()})),ir=Nv.extend({method:P.literal("tools/call"),params:$v.extend({name:P.string(),arguments:P.optional(P.record(P.unknown()))})}),ny=_v.extend({method:P.literal("notifications/tools/list_changed")}),qr=P.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),xa=Nv.extend({method:P.literal("logging/setLevel"),params:$v.extend({level:qr})}),cy=_v.extend({method:P.literal("notifications/message"),params:Or.extend({level:qr,logger:P.optional(P.string()),data:P.unknown()})}),dy=P.object({name:P.string().optional()}).passthrough(),py=P.object({hints:P.optional(P.array(dy)),costPriority:P.optional(P.number().min(0).max(1)),speedPriority:P.optional(P.number().min(0).max(1)),intelligencePriority:P.optional(P.number().min(0).max(1))}).passthrough(),my=P.object({role:P.enum(["user","assistant"]),content:P.union([ja,$a,ka])}).passthrough(),iy=Nv.extend({method:P.literal("sampling/createMessage"),params:$v.extend({messages:P.array(my),systemPrompt:P.optional(P.string()),includeContext:P.optional(P.enum(["none","thisServer","allServers"])),temperature:P.optional(P.number()),maxTokens:P.number().int(),stopSequences:P.optional(P.array(P.string())),metadata:P.optional(P.object({}).passthrough()),modelPreferences:P.optional(py)})}),ba=kv.extend({model:P.string(),stopReason:P.optional(P.enum(["endTurn","stopSequence","maxTokens"]).or(P.string())),role:P.enum(["user","assistant"]),content:P.discriminatedUnion("type",[ja,$a,ka])}),sy=P.object({type:P.literal("boolean"),title:P.optional(P.string()),description:P.optional(P.string()),default:P.optional(P.boolean())}).passthrough(),ty=P.object({type:P.literal("string"),title:P.optional(P.string()),description:P.optional(P.string()),minLength:P.optional(P.number()),maxLength:P.optional(P.number()),format:P.optional(P.enum(["email","uri","date","date-time"]))}).passthrough(),ey=P.object({type:P.enum(["number","integer"]),title:P.optional(P.string()),description:P.optional(P.string()),minimum:P.optional(P.number()),maximum:P.optional(P.number())}).passthrough(),oy=P.object({type:P.literal("string"),title:P.optional(P.string()),description:P.optional(P.string()),enum:P.array(P.string()),enumNames:P.optional(P.array(P.string()))}).passthrough(),vu=P.union([sy,ty,ey,oy]),ru=Nv.extend({method:P.literal("elicitation/create"),params:$v.extend({message:P.string(),requestedSchema:P.object({type:P.literal("object"),properties:P.record(P.string(),vu),required:P.optional(P.array(P.string()))}).passthrough()})}),Sa=kv.extend({action:P.enum(["accept","decline","cancel"]),content:P.optional(P.record(P.string(),P.unknown()))}),au=P.object({type:P.literal("ref/resource"),uri:P.string()}).passthrough();var fu=P.object({type:P.literal("ref/prompt"),name:P.string()}).passthrough(),sr=Nv.extend({method:P.literal("completion/complete"),params:$v.extend({ref:P.union([fu,au]),argument:P.object({name:P.string(),value:P.string()}).passthrough(),context:P.optional(P.object({arguments:P.optional(P.record(P.string(),P.string()))}))})}),hu=kv.extend({completion:P.object({values:P.array(P.string()).max(100),total:P.optional(P.number().int()),hasMore:P.optional(P.boolean())}).passthrough()}),lu=P.object({uri:P.string().startsWith("file://"),name:P.optional(P.string()),_meta:P.optional(P.object({}).passthrough())}).passthrough(),Pu=Nv.extend({method:P.literal("roots/list")}),Ia=kv.extend({roots:P.array(lu)}),yu=_v.extend({method:P.literal("notifications/roots/list_changed")}),k0=P.union([Ir,Aa,sr,xa,pr,dr,Cr,nr,cr,Ay,Hy,ir,mr]),x0=P.union([Sr,Rr,Ha,yu]),b0=P.union([br,ba,Sa,Ia]),S0=P.union([Ir,iy,ru,Pu]),I0=P.union([Sr,Rr,cy,My,Vy,ny,Ry]),R0=P.union([br,zy,hu,Iy,ky,Uy,qy,gy,vh,Cy]);class hv extends Error{constructor(a,v,f){super(`MCP error ${a}: ${v}`);this.code=a,this.data=f,this.name="McpError"}}var uu=60000;class Ra{constructor(a){this._options=a,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(Sr,(v)=>{let f=this._requestHandlerAbortControllers.get(v.params.requestId);f===null||f===void 0||f.abort(v.params.reason)}),this.setNotificationHandler(Rr,(v)=>{this._onprogress(v)}),this.setRequestHandler(Ir,(v)=>({}))}_setupTimeout(a,v,f,h,r=!1){this._timeoutInfo.set(a,{timeoutId:setTimeout(h,v),startTime:Date.now(),timeout:v,maxTotalTimeout:f,resetTimeoutOnProgress:r,onTimeout:h})}_resetTimeout(a){let v=this._timeoutInfo.get(a);if(!v)return!1;let f=Date.now()-v.startTime;if(v.maxTotalTimeout&&f>=v.maxTotalTimeout)throw this._timeoutInfo.delete(a),new hv(fv.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:v.maxTotalTimeout,totalElapsed:f});return clearTimeout(v.timeoutId),v.timeoutId=setTimeout(v.onTimeout,v.timeout),!0}_cleanupTimeout(a){let v=this._timeoutInfo.get(a);if(v)clearTimeout(v.timeoutId),this._timeoutInfo.delete(a)}async connect(a){var v,f,h;this._transport=a;let r=(v=this.transport)===null||v===void 0?void 0:v.onclose;this._transport.onclose=()=>{r===null||r===void 0||r(),this._onclose()};let l=(f=this.transport)===null||f===void 0?void 0:f.onerror;this._transport.onerror=(u)=>{l===null||l===void 0||l(u),this._onerror(u)};let y=(h=this._transport)===null||h===void 0?void 0:h.onmessage;this._transport.onmessage=(u,w)=>{if(y===null||y===void 0||y(u,w),Va(u)||cf(u))this._onresponse(u);else if(Rf(u))this._onrequest(u,w);else if(_f(u))this._onnotification(u);else this._onerror(Error(`Unknown message type: ${JSON.stringify(u)}`))},await this._transport.start()}_onclose(){var a;let v=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(a=this.onclose)===null||a===void 0||a.call(this);let f=new hv(fv.ConnectionClosed,"Connection closed");for(let h of v.values())h(f)}_onerror(a){var v;(v=this.onerror)===null||v===void 0||v.call(this,a)}_onnotification(a){var v;let f=(v=this._notificationHandlers.get(a.method))!==null&&v!==void 0?v:this.fallbackNotificationHandler;if(f===void 0)return;Promise.resolve().then(()=>f(a)).catch((h)=>this._onerror(Error(`Uncaught error in notification handler: ${h}`)))}_onrequest(a,v){var f,h;let r=(f=this._requestHandlers.get(a.method))!==null&&f!==void 0?f:this.fallbackRequestHandler,l=this._transport;if(r===void 0){l===null||l===void 0||l.send({jsonrpc:"2.0",id:a.id,error:{code:fv.MethodNotFound,message:"Method not found"}}).catch((w)=>this._onerror(Error(`Failed to send an error response: ${w}`)));return}let y=new AbortController;this._requestHandlerAbortControllers.set(a.id,y);let u={signal:y.signal,sessionId:l===null||l===void 0?void 0:l.sessionId,_meta:(h=a.params)===null||h===void 0?void 0:h._meta,sendNotification:(w)=>this.notification(w,{relatedRequestId:a.id}),sendRequest:(w,K,X)=>this.request(w,K,{...X,relatedRequestId:a.id}),authInfo:v===null||v===void 0?void 0:v.authInfo,requestId:a.id,requestInfo:v===null||v===void 0?void 0:v.requestInfo};Promise.resolve().then(()=>r(a,u)).then((w)=>{if(y.signal.aborted)return;return l===null||l===void 0?void 0:l.send({result:w,jsonrpc:"2.0",id:a.id})},(w)=>{var K;if(y.signal.aborted)return;return l===null||l===void 0?void 0:l.send({jsonrpc:"2.0",id:a.id,error:{code:Number.isSafeInteger(w.code)?w.code:fv.InternalError,message:(K=w.message)!==null&&K!==void 0?K:"Internal error"}})}).catch((w)=>this._onerror(Error(`Failed to send response: ${w}`))).finally(()=>{this._requestHandlerAbortControllers.delete(a.id)})}_onprogress(a){let{progressToken:v,...f}=a.params,h=Number(v),r=this._progressHandlers.get(h);if(!r){this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(a)}`));return}let l=this._responseHandlers.get(h),y=this._timeoutInfo.get(h);if(y&&l&&y.resetTimeoutOnProgress)try{this._resetTimeout(h)}catch(u){l(u);return}r(f)}_onresponse(a){let v=Number(a.id),f=this._responseHandlers.get(v);if(f===void 0){this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(a)}`));return}if(this._responseHandlers.delete(v),this._progressHandlers.delete(v),this._cleanupTimeout(v),Va(a))f(a);else{let h=new hv(a.error.code,a.error.message,a.error.data);f(h)}}get transport(){return this._transport}async close(){var a;await((a=this._transport)===null||a===void 0?void 0:a.close())}request(a,v,f){let{relatedRequestId:h,resumptionToken:r,onresumptiontoken:l}=f!==null&&f!==void 0?f:{};return new Promise((y,u)=>{var w,K,X,D,F,Q;if(!this._transport){u(Error("Not connected"));return}if(((w=this._options)===null||w===void 0?void 0:w.enforceStrictCapabilities)===!0)this.assertCapabilityForMethod(a.method);(K=f===null||f===void 0?void 0:f.signal)===null||K===void 0||K.throwIfAborted();let J=this._requestMessageId++,G={...a,jsonrpc:"2.0",id:J};if(f===null||f===void 0?void 0:f.onprogress)this._progressHandlers.set(J,f.onprogress),G.params={...a.params,_meta:{...((X=a.params)===null||X===void 0?void 0:X._meta)||{},progressToken:J}};let B=(O)=>{var U;this._responseHandlers.delete(J),this._progressHandlers.delete(J),this._cleanupTimeout(J),(U=this._transport)===null||U===void 0||U.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:J,reason:String(O)}},{relatedRequestId:h,resumptionToken:r,onresumptiontoken:l}).catch((g)=>this._onerror(Error(`Failed to send cancellation: ${g}`))),u(O)};this._responseHandlers.set(J,(O)=>{var U;if((U=f===null||f===void 0?void 0:f.signal)===null||U===void 0?void 0:U.aborted)return;if(O instanceof Error)return u(O);try{let g=v.parse(O.result);y(g)}catch(g){u(g)}}),(D=f===null||f===void 0?void 0:f.signal)===null||D===void 0||D.addEventListener("abort",()=>{var O;B((O=f===null||f===void 0?void 0:f.signal)===null||O===void 0?void 0:O.reason)});let z=(F=f===null||f===void 0?void 0:f.timeout)!==null&&F!==void 0?F:uu,N=()=>B(new hv(fv.RequestTimeout,"Request timed out",{timeout:z}));this._setupTimeout(J,z,f===null||f===void 0?void 0:f.maxTotalTimeout,N,(Q=f===null||f===void 0?void 0:f.resetTimeoutOnProgress)!==null&&Q!==void 0?Q:!1),this._transport.send(G,{relatedRequestId:h,resumptionToken:r,onresumptiontoken:l}).catch((O)=>{this._cleanupTimeout(J),u(O)})})}async notification(a,v){var f,h;if(!this._transport)throw Error("Not connected");if(this.assertNotificationCapability(a.method),((h=(f=this._options)===null||f===void 0?void 0:f.debouncedNotificationMethods)!==null&&h!==void 0?h:[]).includes(a.method)&&!a.params&&!(v===null||v===void 0?void 0:v.relatedRequestId)){if(this._pendingDebouncedNotifications.has(a.method))return;this._pendingDebouncedNotifications.add(a.method),Promise.resolve().then(()=>{var u;if(this._pendingDebouncedNotifications.delete(a.method),!this._transport)return;let w={...a,jsonrpc:"2.0"};(u=this._transport)===null||u===void 0||u.send(w,v).catch((K)=>this._onerror(K))});return}let y={...a,jsonrpc:"2.0"};await this._transport.send(y,v)}setRequestHandler(a,v){let f=a.shape.method.value;this.assertRequestHandlerCapability(f),this._requestHandlers.set(f,(h,r)=>{return Promise.resolve(v(a.parse(h),r))})}removeRequestHandler(a){this._requestHandlers.delete(a)}assertCanSetRequestHandler(a){if(this._requestHandlers.has(a))throw Error(`A request handler for ${a} already exists, which would be overridden`)}setNotificationHandler(a,v){this._notificationHandlers.set(a.shape.method.value,(f)=>Promise.resolve(v(a.parse(f))))}removeNotificationHandler(a){this._notificationHandlers.delete(a)}}function rh(a,v){return Object.entries(v).reduce((f,[h,r])=>{if(r&&typeof r==="object")f[h]=f[h]?{...f[h],...r}:r;else f[h]=r;return f},{...a})}var hP=fP(aP(),1);class wf extends Ra{constructor(a,v){var f;super(v);if(this._serverInfo=a,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(qr.options.map((h,r)=>[h,r])),this.isMessageIgnored=(h,r)=>{let l=this._loggingLevels.get(r);return l?this.LOG_LEVEL_SEVERITY.get(h)<this.LOG_LEVEL_SEVERITY.get(l):!1},this._capabilities=(f=v===null||v===void 0?void 0:v.capabilities)!==null&&f!==void 0?f:{},this._instructions=v===null||v===void 0?void 0:v.instructions,this.setRequestHandler(Aa,(h)=>this._oninitialize(h)),this.setNotificationHandler(Ha,()=>{var h;return(h=this.oninitialized)===null||h===void 0?void 0:h.call(this)}),this._capabilities.logging)this.setRequestHandler(xa,async(h,r)=>{var l;let y=r.sessionId||((l=r.requestInfo)===null||l===void 0?void 0:l.headers["mcp-session-id"])||void 0,{level:u}=h.params,w=qr.safeParse(u);if(w.success)this._loggingLevels.set(y,w.data);return{}})}registerCapabilities(a){if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=rh(this._capabilities,a)}assertCapabilityForMethod(a){var v,f,h;switch(a){case"sampling/createMessage":if(!((v=this._clientCapabilities)===null||v===void 0?void 0:v.sampling))throw Error(`Client does not support sampling (required for ${a})`);break;case"elicitation/create":if(!((f=this._clientCapabilities)===null||f===void 0?void 0:f.elicitation))throw Error(`Client does not support elicitation (required for ${a})`);break;case"roots/list":if(!((h=this._clientCapabilities)===null||h===void 0?void 0:h.roots))throw Error(`Client does not support listing roots (required for ${a})`);break;case"ping":break}}assertNotificationCapability(a){switch(a){case"notifications/message":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${a})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw Error(`Server does not support notifying about resources (required for ${a})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw Error(`Server does not support notifying of tool list changes (required for ${a})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw Error(`Server does not support notifying of prompt list changes (required for ${a})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(a){switch(a){case"sampling/createMessage":if(!this._capabilities.sampling)throw Error(`Server does not support sampling (required for ${a})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${a})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw Error(`Server does not support prompts (required for ${a})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw Error(`Server does not support resources (required for ${a})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw Error(`Server does not support tools (required for ${a})`);break;case"ping":case"initialize":break}}async _oninitialize(a){let v=a.params.protocolVersion;return this._clientCapabilities=a.params.capabilities,this._clientVersion=a.params.clientInfo,{protocolVersion:xf.includes(v)?v:ga,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},br)}async createMessage(a,v){return this.request({method:"sampling/createMessage",params:a},ba,v)}async elicitInput(a,v){let f=await this.request({method:"elicitation/create",params:a},Sa,v);if(f.action==="accept"&&f.content)try{let h=new hP.default,r=h.compile(a.requestedSchema);if(!r(f.content))throw new hv(fv.InvalidParams,`Elicitation response content does not match requested schema: ${h.errorsText(r.errors)}`)}catch(h){if(h instanceof hv)throw h;throw new hv(fv.InternalError,`Error validating elicitation response: ${h}`)}return f}async listRoots(a,v){return this.request({method:"roots/list",params:a},Ia,v)}async sendLoggingMessage(a,v){if(this._capabilities.logging){if(!this.isMessageIgnored(a.level,v))return this.notification({method:"notifications/message",params:a})}}async sendResourceUpdated(a){return this.notification({method:"notifications/resources/updated",params:a})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}var PP=Symbol("Let zodToJsonSchema decide on which parser to use");var lP={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},yP=(a)=>typeof a==="string"?{...lP,name:a}:{...lP,...a};var uP=(a)=>{let v=yP(a),f=v.name!==void 0?[...v.basePath,v.definitionPath,v.name]:v.basePath;return{...v,flags:{hasReferencedOpenAiAnyType:!1},currentPath:f,propertyPath:void 0,seen:new Map(Object.entries(v.definitions).map(([h,r])=>[r._def,{def:r._def,path:[...v.basePath,v.definitionPath,h],jsonSchema:void 0}]))}};function Wf(a,v,f,h){if(!h?.errorMessages)return;if(f)a.errorMessage={...a.errorMessage,[v]:f}}function d(a,v,f,h,r){a[v]=f,Wf(a,v,h,r)}var Ka=(a,v)=>{let f=0;for(;f<a.length&&f<v.length;f++)if(a[f]!==v[f])break;return[(a.length-f).toString(),...v.slice(f)].join("/")};function Pv(a){if(a.target!=="openAi")return{};let v=[...a.basePath,a.definitionPath,a.openAiAnyTypeName];return a.flags.hasReferencedOpenAiAnyType=!0,{$ref:a.$refStrategy==="relative"?Ka(v,a.currentPath):v.join("/")}}function QP(a,v){let f={type:"array"};if(a.type?._def&&a.type?._def?.typeName!==_.ZodAny)f.items=R(a.type._def,{...v,currentPath:[...v.currentPath,"items"]});if(a.minLength)d(f,"minItems",a.minLength.value,a.minLength.message,v);if(a.maxLength)d(f,"maxItems",a.maxLength.value,a.maxLength.message,v);if(a.exactLength)d(f,"minItems",a.exactLength.value,a.exactLength.message,v),d(f,"maxItems",a.exactLength.value,a.exactLength.message,v);return f}function ZP(a,v){let f={type:"integer",format:"int64"};if(!a.checks)return f;for(let h of a.checks)switch(h.kind){case"min":if(v.target==="jsonSchema7")if(h.inclusive)d(f,"minimum",h.value,h.message,v);else d(f,"exclusiveMinimum",h.value,h.message,v);else{if(!h.inclusive)f.exclusiveMinimum=!0;d(f,"minimum",h.value,h.message,v)}break;case"max":if(v.target==="jsonSchema7")if(h.inclusive)d(f,"maximum",h.value,h.message,v);else d(f,"exclusiveMaximum",h.value,h.message,v);else{if(!h.inclusive)f.exclusiveMaximum=!0;d(f,"maximum",h.value,h.message,v)}break;case"multipleOf":d(f,"multipleOf",h.value,h.message,v);break}return f}function wP(){return{type:"boolean"}}function Ya(a,v){return R(a.type._def,v)}var WP=(a,v)=>{return R(a.innerType._def,v)};function Jf(a,v,f){let h=f??v.dateStrategy;if(Array.isArray(h))return{anyOf:h.map((r,l)=>Jf(a,v,r))};switch(h){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return T1(a,v)}}var T1=(a,v)=>{let f={type:"integer",format:"unix-time"};if(v.target==="openApi3")return f;for(let h of a.checks)switch(h.kind){case"min":d(f,"minimum",h.value,h.message,v);break;case"max":d(f,"maximum",h.value,h.message,v);break}return f};function JP(a,v){return{...R(a.innerType._def,v),default:a.defaultValue()}}function BP(a,v){return v.effectStrategy==="input"?R(a.schema._def,v):Pv(v)}function KP(a){return{type:"string",enum:Array.from(a.values)}}var _1=(a)=>{if("type"in a&&a.type==="string")return!1;return"allOf"in a};function YP(a,v){let f=[R(a.left._def,{...v,currentPath:[...v.currentPath,"allOf","0"]}),R(a.right._def,{...v,currentPath:[...v.currentPath,"allOf","1"]})].filter((l)=>!!l),h=v.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,r=[];return f.forEach((l)=>{if(_1(l)){if(r.push(...l.allOf),l.unevaluatedProperties===void 0)h=void 0}else{let y=l;if("additionalProperties"in l&&l.additionalProperties===!1){let{additionalProperties:u,...w}=l;y=w}else h=void 0;r.push(y)}}),r.length?{allOf:r,...h}:void 0}function XP(a,v){let f=typeof a.value;if(f!=="bigint"&&f!=="number"&&f!=="boolean"&&f!=="string")return{type:Array.isArray(a.value)?"array":"object"};if(v.target==="openApi3")return{type:f==="bigint"?"integer":f,enum:[a.value]};return{type:f==="bigint"?"integer":f,const:a.value}}var Bf=void 0,bv={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>{if(Bf===void 0)Bf=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u");return Bf},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Xa(a,v){let f={type:"string"};if(a.checks)for(let h of a.checks)switch(h.kind){case"min":d(f,"minLength",typeof f.minLength==="number"?Math.max(f.minLength,h.value):h.value,h.message,v);break;case"max":d(f,"maxLength",typeof f.maxLength==="number"?Math.min(f.maxLength,h.value):h.value,h.message,v);break;case"email":switch(v.emailStrategy){case"format:email":Sv(f,"email",h.message,v);break;case"format:idn-email":Sv(f,"idn-email",h.message,v);break;case"pattern:zod":zv(f,bv.email,h.message,v);break}break;case"url":Sv(f,"uri",h.message,v);break;case"uuid":Sv(f,"uuid",h.message,v);break;case"regex":zv(f,h.regex,h.message,v);break;case"cuid":zv(f,bv.cuid,h.message,v);break;case"cuid2":zv(f,bv.cuid2,h.message,v);break;case"startsWith":zv(f,RegExp(`^${Kf(h.value,v)}`),h.message,v);break;case"endsWith":zv(f,RegExp(`${Kf(h.value,v)}$`),h.message,v);break;case"datetime":Sv(f,"date-time",h.message,v);break;case"date":Sv(f,"date",h.message,v);break;case"time":Sv(f,"time",h.message,v);break;case"duration":Sv(f,"duration",h.message,v);break;case"length":d(f,"minLength",typeof f.minLength==="number"?Math.max(f.minLength,h.value):h.value,h.message,v),d(f,"maxLength",typeof f.maxLength==="number"?Math.min(f.maxLength,h.value):h.value,h.message,v);break;case"includes":{zv(f,RegExp(Kf(h.value,v)),h.message,v);break}case"ip":{if(h.version!=="v6")Sv(f,"ipv4",h.message,v);if(h.version!=="v4")Sv(f,"ipv6",h.message,v);break}case"base64url":zv(f,bv.base64url,h.message,v);break;case"jwt":zv(f,bv.jwt,h.message,v);break;case"cidr":{if(h.version!=="v6")zv(f,bv.ipv4Cidr,h.message,v);if(h.version!=="v4")zv(f,bv.ipv6Cidr,h.message,v);break}case"emoji":zv(f,bv.emoji(),h.message,v);break;case"ulid":{zv(f,bv.ulid,h.message,v);break}case"base64":{switch(v.base64Strategy){case"format:binary":{Sv(f,"binary",h.message,v);break}case"contentEncoding:base64":{d(f,"contentEncoding","base64",h.message,v);break}case"pattern:zod":{zv(f,bv.base64,h.message,v);break}}break}case"nanoid":zv(f,bv.nanoid,h.message,v);case"toLowerCase":case"toUpperCase":case"trim":break;default:((r)=>{})(h)}return f}function Kf(a,v){return v.patternStrategy==="escape"?n1(a):a}var C1=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function n1(a){let v="";for(let f=0;f<a.length;f++){if(!C1.has(a[f]))v+="\\";v+=a[f]}return v}function Sv(a,v,f,h){if(a.format||a.anyOf?.some((r)=>r.format)){if(!a.anyOf)a.anyOf=[];if(a.format){if(a.anyOf.push({format:a.format,...a.errorMessage&&h.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage){if(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0)delete a.errorMessage}}a.anyOf.push({format:v,...f&&h.errorMessages&&{errorMessage:{format:f}}})}else d(a,"format",v,f,h)}function zv(a,v,f,h){if(a.pattern||a.allOf?.some((r)=>r.pattern)){if(!a.allOf)a.allOf=[];if(a.pattern){if(a.allOf.push({pattern:a.pattern,...a.errorMessage&&h.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage){if(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0)delete a.errorMessage}}a.allOf.push({pattern:DP(v,h),...f&&h.errorMessages&&{errorMessage:{pattern:f}}})}else d(a,"pattern",DP(v,h),f,h)}function DP(a,v){if(!v.applyRegexFlags||!a.flags)return a.source;let f={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},h=f.i?a.source.toLowerCase():a.source,r="",l=!1,y=!1,u=!1;for(let w=0;w<h.length;w++){if(l){r+=h[w],l=!1;continue}if(f.i){if(y){if(h[w].match(/[a-z]/)){if(u)r+=h[w],r+=`${h[w-2]}-${h[w]}`.toUpperCase(),u=!1;else if(h[w+1]==="-"&&h[w+2]?.match(/[a-z]/))r+=h[w],u=!0;else r+=`${h[w]}${h[w].toUpperCase()}`;continue}}else if(h[w].match(/[a-z]/)){r+=`[${h[w]}${h[w].toUpperCase()}]`;continue}}if(f.m){if(h[w]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(h[w]==="$"){r+=`($|(?=[\r
]))`;continue}}if(f.s&&h[w]==="."){r+=y?`${h[w]}\r
`:`[${h[w]}\r
]`;continue}if(r+=h[w],h[w]==="\\")l=!0;else if(y&&h[w]==="]")y=!1;else if(!y&&h[w]==="[")y=!0}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${v.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return r}function Da(a,v){if(v.target==="openAi")console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.");if(v.target==="openApi3"&&a.keyType?._def.typeName===_.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((h,r)=>({...h,[r]:R(a.valueType._def,{...v,currentPath:[...v.currentPath,"properties",r]})??Pv(v)}),{}),additionalProperties:v.rejectedAdditionalProperties};let f={type:"object",additionalProperties:R(a.valueType._def,{...v,currentPath:[...v.currentPath,"additionalProperties"]})??v.allowedAdditionalProperties};if(v.target==="openApi3")return f;if(a.keyType?._def.typeName===_.ZodString&&a.keyType._def.checks?.length){let{type:h,...r}=Xa(a.keyType._def,v);return{...f,propertyNames:r}}else if(a.keyType?._def.typeName===_.ZodEnum)return{...f,propertyNames:{enum:a.keyType._def.values}};else if(a.keyType?._def.typeName===_.ZodBranded&&a.keyType._def.type._def.typeName===_.ZodString&&a.keyType._def.type._def.checks?.length){let{type:h,...r}=Ya(a.keyType._def,v);return{...f,propertyNames:r}}return f}function FP(a,v){if(v.mapStrategy==="record")return Da(a,v);let f=R(a.keyType._def,{...v,currentPath:[...v.currentPath,"items","items","0"]})||Pv(v),h=R(a.valueType._def,{...v,currentPath:[...v.currentPath,"items","items","1"]})||Pv(v);return{type:"array",maxItems:125,items:{type:"array",items:[f,h],minItems:2,maxItems:2}}}function GP(a){let v=a.values,h=Object.keys(a.values).filter((l)=>{return typeof v[v[l]]!=="number"}).map((l)=>v[l]),r=Array.from(new Set(h.map((l)=>typeof l)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:h}}function EP(a){return a.target==="openAi"?void 0:{not:Pv({...a,currentPath:[...a.currentPath,"not"]})}}function LP(a){return a.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Vr={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function OP(a,v){if(v.target==="openApi3")return zP(a,v);let f=a.options instanceof Map?Array.from(a.options.values()):a.options;if(f.every((h)=>(h._def.typeName in Vr)&&(!h._def.checks||!h._def.checks.length))){let h=f.reduce((r,l)=>{let y=Vr[l._def.typeName];return y&&!r.includes(y)?[...r,y]:r},[]);return{type:h.length>1?h:h[0]}}else if(f.every((h)=>h._def.typeName==="ZodLiteral"&&!h.description)){let h=f.reduce((r,l)=>{let y=typeof l._def.value;switch(y){case"string":case"number":case"boolean":return[...r,y];case"bigint":return[...r,"integer"];case"object":if(l._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(h.length===f.length){let r=h.filter((l,y,u)=>u.indexOf(l)===y);return{type:r.length>1?r:r[0],enum:f.reduce((l,y)=>{return l.includes(y._def.value)?l:[...l,y._def.value]},[])}}}else if(f.every((h)=>h._def.typeName==="ZodEnum"))return{type:"string",enum:f.reduce((h,r)=>[...h,...r._def.values.filter((l)=>!h.includes(l))],[])};return zP(a,v)}var zP=(a,v)=>{let f=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((h,r)=>R(h._def,{...v,currentPath:[...v.currentPath,"anyOf",`${r}`]})).filter((h)=>!!h&&(!v.strictUnions||typeof h==="object"&&Object.keys(h).length>0));return f.length?{anyOf:f}:void 0};function NP(a,v){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(a.innerType._def.typeName)&&(!a.innerType._def.checks||!a.innerType._def.checks.length)){if(v.target==="openApi3")return{type:Vr[a.innerType._def.typeName],nullable:!0};return{type:[Vr[a.innerType._def.typeName],"null"]}}if(v.target==="openApi3"){let h=R(a.innerType._def,{...v,currentPath:[...v.currentPath]});if(h&&"$ref"in h)return{allOf:[h],nullable:!0};return h&&{...h,nullable:!0}}let f=R(a.innerType._def,{...v,currentPath:[...v.currentPath,"anyOf","0"]});return f&&{anyOf:[f,{type:"null"}]}}function UP(a,v){let f={type:"number"};if(!a.checks)return f;for(let h of a.checks)switch(h.kind){case"int":f.type="integer",Wf(f,"type",h.message,v);break;case"min":if(v.target==="jsonSchema7")if(h.inclusive)d(f,"minimum",h.value,h.message,v);else d(f,"exclusiveMinimum",h.value,h.message,v);else{if(!h.inclusive)f.exclusiveMinimum=!0;d(f,"minimum",h.value,h.message,v)}break;case"max":if(v.target==="jsonSchema7")if(h.inclusive)d(f,"maximum",h.value,h.message,v);else d(f,"exclusiveMaximum",h.value,h.message,v);else{if(!h.inclusive)f.exclusiveMaximum=!0;d(f,"maximum",h.value,h.message,v)}break;case"multipleOf":d(f,"multipleOf",h.value,h.message,v);break}return f}function qP(a,v){let f=v.target==="openAi",h={type:"object",properties:{}},r=[],l=a.shape();for(let u in l){let w=l[u];if(w===void 0||w._def===void 0)continue;let K=d1(w);if(K&&f){if(w._def.typeName==="ZodOptional")w=w._def.innerType;if(!w.isNullable())w=w.nullable();K=!1}let X=R(w._def,{...v,currentPath:[...v.currentPath,"properties",u],propertyPath:[...v.currentPath,"properties",u]});if(X===void 0)continue;if(h.properties[u]=X,!K)r.push(u)}if(r.length)h.required=r;let y=c1(a,v);if(y!==void 0)h.additionalProperties=y;return h}function c1(a,v){if(a.catchall._def.typeName!=="ZodNever")return R(a.catchall._def,{...v,currentPath:[...v.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return v.allowedAdditionalProperties;case"strict":return v.rejectedAdditionalProperties;case"strip":return v.removeAdditionalStrategy==="strict"?v.allowedAdditionalProperties:v.rejectedAdditionalProperties}}function d1(a){try{return a.isOptional()}catch{return!0}}var gP=(a,v)=>{if(v.currentPath.toString()===v.propertyPath?.toString())return R(a.innerType._def,v);let f=R(a.innerType._def,{...v,currentPath:[...v.currentPath,"anyOf","1"]});return f?{anyOf:[{not:Pv(v)},f]}:Pv(v)};var VP=(a,v)=>{if(v.pipeStrategy==="input")return R(a.in._def,v);else if(v.pipeStrategy==="output")return R(a.out._def,v);let f=R(a.in._def,{...v,currentPath:[...v.currentPath,"allOf","0"]}),h=R(a.out._def,{...v,currentPath:[...v.currentPath,"allOf",f?"1":"0"]});return{allOf:[f,h].filter((r)=>r!==void 0)}};function AP(a,v){return R(a.type._def,v)}function HP(a,v){let h={type:"array",uniqueItems:!0,items:R(a.valueType._def,{...v,currentPath:[...v.currentPath,"items"]})};if(a.minSize)d(h,"minItems",a.minSize.value,a.minSize.message,v);if(a.maxSize)d(h,"maxItems",a.maxSize.value,a.maxSize.message,v);return h}function MP(a,v){if(a.rest)return{type:"array",minItems:a.items.length,items:a.items.map((f,h)=>R(f._def,{...v,currentPath:[...v.currentPath,"items",`${h}`]})).reduce((f,h)=>h===void 0?f:[...f,h],[]),additionalItems:R(a.rest._def,{...v,currentPath:[...v.currentPath,"additionalItems"]})};else return{type:"array",minItems:a.items.length,maxItems:a.items.length,items:a.items.map((f,h)=>R(f._def,{...v,currentPath:[...v.currentPath,"items",`${h}`]})).reduce((f,h)=>h===void 0?f:[...f,h],[])}}function jP(a){return{not:Pv(a)}}function $P(a){return Pv(a)}var kP=(a,v)=>{return R(a.innerType._def,v)};var xP=(a,v,f)=>{switch(v){case _.ZodString:return Xa(a,f);case _.ZodNumber:return UP(a,f);case _.ZodObject:return qP(a,f);case _.ZodBigInt:return ZP(a,f);case _.ZodBoolean:return wP();case _.ZodDate:return Jf(a,f);case _.ZodUndefined:return jP(f);case _.ZodNull:return LP(f);case _.ZodArray:return QP(a,f);case _.ZodUnion:case _.ZodDiscriminatedUnion:return OP(a,f);case _.ZodIntersection:return YP(a,f);case _.ZodTuple:return MP(a,f);case _.ZodRecord:return Da(a,f);case _.ZodLiteral:return XP(a,f);case _.ZodEnum:return KP(a);case _.ZodNativeEnum:return GP(a);case _.ZodNullable:return NP(a,f);case _.ZodOptional:return gP(a,f);case _.ZodMap:return FP(a,f);case _.ZodSet:return HP(a,f);case _.ZodLazy:return()=>a.getter()._def;case _.ZodPromise:return AP(a,f);case _.ZodNaN:case _.ZodNever:return EP(f);case _.ZodEffects:return BP(a,f);case _.ZodAny:return Pv(f);case _.ZodUnknown:return $P(f);case _.ZodDefault:return JP(a,f);case _.ZodBranded:return Ya(a,f);case _.ZodReadonly:return kP(a,f);case _.ZodCatch:return WP(a,f);case _.ZodPipeline:return VP(a,f);case _.ZodFunction:case _.ZodVoid:case _.ZodSymbol:return;default:return((h)=>{return})(v)}};function R(a,v,f=!1){let h=v.seen.get(a);if(v.override){let u=v.override?.(a,v,h,f);if(u!==PP)return u}if(h&&!f){let u=p1(h,v);if(u!==void 0)return u}let r={def:a,path:v.currentPath,jsonSchema:void 0};v.seen.set(a,r);let l=xP(a,a.typeName,v),y=typeof l==="function"?R(l(),v):l;if(y)m1(a,v,y);if(v.postProcess){let u=v.postProcess(y,a,v);return r.jsonSchema=y,u}return r.jsonSchema=y,y}var p1=(a,v)=>{switch(v.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:Ka(v.currentPath,a.path)};case"none":case"seen":{if(a.path.length<v.currentPath.length&&a.path.every((f,h)=>v.currentPath[h]===f))return console.warn(`Recursive reference detected at ${v.currentPath.join("/")}! Defaulting to any`),Pv(v);return v.$refStrategy==="seen"?Pv(v):void 0}}},m1=(a,v,f)=>{if(a.description){if(f.description=a.description,v.markdownDescription)f.markdownDescription=a.description}return f};var Fa=(a,v)=>{let f=uP(v),h=typeof v==="object"&&v.definitions?Object.entries(v.definitions).reduce((w,[K,X])=>({...w,[K]:R(X._def,{...f,currentPath:[...f.basePath,f.definitionPath,K]},!0)??Pv(f)}),{}):void 0,r=typeof v==="string"?v:v?.nameStrategy==="title"?void 0:v?.name,l=R(a._def,r===void 0?f:{...f,currentPath:[...f.basePath,f.definitionPath,r]},!1)??Pv(f),y=typeof v==="object"&&v.name!==void 0&&v.nameStrategy==="title"?v.name:void 0;if(y!==void 0)l.title=y;if(f.flags.hasReferencedOpenAiAnyType){if(!h)h={};if(!h[f.openAiAnyTypeName])h[f.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:f.$refStrategy==="relative"?"1":[...f.basePath,f.definitionPath,f.openAiAnyTypeName].join("/")}}}let u=r===void 0?h?{...l,[f.definitionPath]:h}:l:{$ref:[...f.$refStrategy==="relative"?[]:f.basePath,f.definitionPath,r].join("/"),[f.definitionPath]:{...h,[r]:l}};if(f.target==="jsonSchema7")u.$schema="http://json-schema.org/draft-07/schema#";else if(f.target==="jsonSchema2019-09"||f.target==="openAi")u.$schema="https://json-schema.org/draft/2019-09/schema#";if(f.target==="openAi"&&(("anyOf"in u)||("oneOf"in u)||("allOf"in u)||("type"in u)&&Array.isArray(u.type)))console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.");return u};var Yf;(function(a){a.Completable="McpCompletable"})(Yf||(Yf={}));class Ar extends bP{_parse(a){let{ctx:v}=this._processInputParams(a),f=v.data;return this._def.type._parse({data:f,path:v.path,parent:v})}unwrap(){return this._def.type}}Ar.create=(a,v)=>{return new Ar({type:a,typeName:Yf.Completable,complete:v.complete,...i1(v)})};function i1(a){if(!a)return{};let{errorMap:v,invalid_type_error:f,required_error:h,description:r}=a;if(v&&(f||h))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(v)return{errorMap:v,description:r};return{errorMap:(y,u)=>{var w,K;let{message:X}=a;if(y.code==="invalid_enum_value")return{message:X!==null&&X!==void 0?X:u.defaultError};if(typeof u.data>"u")return{message:(w=X!==null&&X!==void 0?X:h)!==null&&w!==void 0?w:u.defaultError};if(y.code!=="invalid_type")return{message:u.defaultError};return{message:(K=X!==null&&X!==void 0?X:f)!==null&&K!==void 0?K:u.defaultError}},description:r}}class Xf{constructor(a,v){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new wf(a,v)}async connect(a){return await this.server.connect(a)}async close(){await this.server.close()}setToolRequestHandlers(){if(this._toolHandlersInitialized)return;this.server.assertCanSetRequestHandler(mr.shape.method.value),this.server.assertCanSetRequestHandler(ir.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(mr,()=>({tools:Object.entries(this._registeredTools).filter(([,a])=>a.enabled).map(([a,v])=>{let f={name:a,title:v.title,description:v.description,inputSchema:v.inputSchema?Fa(v.inputSchema,{strictUnions:!0,pipeStrategy:"input"}):s1,annotations:v.annotations,_meta:v._meta};if(v.outputSchema)f.outputSchema=Fa(v.outputSchema,{strictUnions:!0,pipeStrategy:"output"});return f})})),this.server.setRequestHandler(ir,async(a,v)=>{let f=this._registeredTools[a.params.name];if(!f)throw new hv(fv.InvalidParams,`Tool ${a.params.name} not found`);if(!f.enabled)throw new hv(fv.InvalidParams,`Tool ${a.params.name} disabled`);let h;if(f.inputSchema){let r=await f.inputSchema.safeParseAsync(a.params.arguments);if(!r.success)throw new hv(fv.InvalidParams,`Invalid arguments for tool ${a.params.name}: ${r.error.message}`);let l=r.data,y=f.callback;try{h=await Promise.resolve(y(l,v))}catch(u){h={content:[{type:"text",text:u instanceof Error?u.message:String(u)}],isError:!0}}}else{let r=f.callback;try{h=await Promise.resolve(r(v))}catch(l){h={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:!0}}}if(f.outputSchema&&!h.isError){if(!h.structuredContent)throw new hv(fv.InvalidParams,`Tool ${a.params.name} has an output schema but no structured content was provided`);let r=await f.outputSchema.safeParseAsync(h.structuredContent);if(!r.success)throw new hv(fv.InvalidParams,`Invalid structured content for tool ${a.params.name}: ${r.error.message}`)}return h}),this._toolHandlersInitialized=!0}setCompletionRequestHandler(){if(this._completionHandlerInitialized)return;this.server.assertCanSetRequestHandler(sr.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(sr,async(a)=>{switch(a.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(a,a.params.ref);case"ref/resource":return this.handleResourceCompletion(a,a.params.ref);default:throw new hv(fv.InvalidParams,`Invalid completion reference: ${a.params.ref}`)}}),this._completionHandlerInitialized=!0}async handlePromptCompletion(a,v){let f=this._registeredPrompts[v.name];if(!f)throw new hv(fv.InvalidParams,`Prompt ${v.name} not found`);if(!f.enabled)throw new hv(fv.InvalidParams,`Prompt ${v.name} disabled`);if(!f.argsSchema)return Ga;let h=f.argsSchema.shape[a.params.argument.name];if(!(h instanceof Ar))return Ga;let l=await h._def.complete(a.params.argument.value,a.params.context);return IP(l)}async handleResourceCompletion(a,v){let f=Object.values(this._registeredResourceTemplates).find((l)=>l.resourceTemplate.uriTemplate.toString()===v.uri);if(!f){if(this._registeredResources[v.uri])return Ga;throw new hv(fv.InvalidParams,`Resource template ${a.params.ref.uri} not found`)}let h=f.resourceTemplate.completeCallback(a.params.argument.name);if(!h)return Ga;let r=await h(a.params.argument.value,a.params.context);return IP(r)}setResourceRequestHandlers(){if(this._resourceHandlersInitialized)return;this.server.assertCanSetRequestHandler(Cr.shape.method.value),this.server.assertCanSetRequestHandler(nr.shape.method.value),this.server.assertCanSetRequestHandler(cr.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(Cr,async(a,v)=>{let f=Object.entries(this._registeredResources).filter(([r,l])=>l.enabled).map(([r,l])=>({uri:r,name:l.name,...l.metadata})),h=[];for(let r of Object.values(this._registeredResourceTemplates)){if(!r.resourceTemplate.listCallback)continue;let l=await r.resourceTemplate.listCallback(v);for(let y of l.resources)h.push({...r.metadata,...y})}return{resources:[...f,...h]}}),this.server.setRequestHandler(nr,async()=>{return{resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([v,f])=>({name:v,uriTemplate:f.resourceTemplate.uriTemplate.toString(),...f.metadata}))}}),this.server.setRequestHandler(cr,async(a,v)=>{let f=new URL(a.params.uri),h=this._registeredResources[f.toString()];if(h){if(!h.enabled)throw new hv(fv.InvalidParams,`Resource ${f} disabled`);return h.readCallback(f,v)}for(let r of Object.values(this._registeredResourceTemplates)){let l=r.resourceTemplate.uriTemplate.match(f.toString());if(l)return r.readCallback(f,l,v)}throw new hv(fv.InvalidParams,`Resource ${f} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0}setPromptRequestHandlers(){if(this._promptHandlersInitialized)return;this.server.assertCanSetRequestHandler(dr.shape.method.value),this.server.assertCanSetRequestHandler(pr.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(dr,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,a])=>a.enabled).map(([a,v])=>{return{name:a,title:v.title,description:v.description,arguments:v.argsSchema?e1(v.argsSchema):void 0}})})),this.server.setRequestHandler(pr,async(a,v)=>{let f=this._registeredPrompts[a.params.name];if(!f)throw new hv(fv.InvalidParams,`Prompt ${a.params.name} not found`);if(!f.enabled)throw new hv(fv.InvalidParams,`Prompt ${a.params.name} disabled`);if(f.argsSchema){let h=await f.argsSchema.safeParseAsync(a.params.arguments);if(!h.success)throw new hv(fv.InvalidParams,`Invalid arguments for prompt ${a.params.name}: ${h.error.message}`);let r=h.data,l=f.callback;return await Promise.resolve(l(r,v))}else{let h=f.callback;return await Promise.resolve(h(v))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0}resource(a,v,...f){let h;if(typeof f[0]==="object")h=f.shift();let r=f[0];if(typeof v==="string"){if(this._registeredResources[v])throw Error(`Resource ${v} is already registered`);let l=this._createRegisteredResource(a,void 0,v,h,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),l}else{if(this._registeredResourceTemplates[a])throw Error(`Resource template ${a} is already registered`);let l=this._createRegisteredResourceTemplate(a,void 0,v,h,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),l}}registerResource(a,v,f,h){if(typeof v==="string"){if(this._registeredResources[v])throw Error(`Resource ${v} is already registered`);let r=this._createRegisteredResource(a,f.title,v,f,h);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),r}else{if(this._registeredResourceTemplates[a])throw Error(`Resource template ${a} is already registered`);let r=this._createRegisteredResourceTemplate(a,f.title,v,f,h);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),r}}_createRegisteredResource(a,v,f,h,r){let l={name:a,title:v,metadata:h,readCallback:r,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({uri:null}),update:(y)=>{if(typeof y.uri<"u"&&y.uri!==f){if(delete this._registeredResources[f],y.uri)this._registeredResources[y.uri]=l}if(typeof y.name<"u")l.name=y.name;if(typeof y.title<"u")l.title=y.title;if(typeof y.metadata<"u")l.metadata=y.metadata;if(typeof y.callback<"u")l.readCallback=y.callback;if(typeof y.enabled<"u")l.enabled=y.enabled;this.sendResourceListChanged()}};return this._registeredResources[f]=l,l}_createRegisteredResourceTemplate(a,v,f,h,r){let l={resourceTemplate:f,title:v,metadata:h,readCallback:r,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:(y)=>{if(typeof y.name<"u"&&y.name!==a){if(delete this._registeredResourceTemplates[a],y.name)this._registeredResourceTemplates[y.name]=l}if(typeof y.title<"u")l.title=y.title;if(typeof y.template<"u")l.resourceTemplate=y.template;if(typeof y.metadata<"u")l.metadata=y.metadata;if(typeof y.callback<"u")l.readCallback=y.callback;if(typeof y.enabled<"u")l.enabled=y.enabled;this.sendResourceListChanged()}};return this._registeredResourceTemplates[a]=l,l}_createRegisteredPrompt(a,v,f,h,r){let l={title:v,description:f,argsSchema:h===void 0?void 0:P.object(h),callback:r,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:(y)=>{if(typeof y.name<"u"&&y.name!==a){if(delete this._registeredPrompts[a],y.name)this._registeredPrompts[y.name]=l}if(typeof y.title<"u")l.title=y.title;if(typeof y.description<"u")l.description=y.description;if(typeof y.argsSchema<"u")l.argsSchema=P.object(y.argsSchema);if(typeof y.callback<"u")l.callback=y.callback;if(typeof y.enabled<"u")l.enabled=y.enabled;this.sendPromptListChanged()}};return this._registeredPrompts[a]=l,l}_createRegisteredTool(a,v,f,h,r,l,y,u){let w={title:v,description:f,inputSchema:h===void 0?void 0:P.object(h),outputSchema:r===void 0?void 0:P.object(r),annotations:l,_meta:y,callback:u,enabled:!0,disable:()=>w.update({enabled:!1}),enable:()=>w.update({enabled:!0}),remove:()=>w.update({name:null}),update:(K)=>{if(typeof K.name<"u"&&K.name!==a){if(delete this._registeredTools[a],K.name)this._registeredTools[K.name]=w}if(typeof K.title<"u")w.title=K.title;if(typeof K.description<"u")w.description=K.description;if(typeof K.paramsSchema<"u")w.inputSchema=P.object(K.paramsSchema);if(typeof K.callback<"u")w.callback=K.callback;if(typeof K.annotations<"u")w.annotations=K.annotations;if(typeof K._meta<"u")w._meta=K._meta;if(typeof K.enabled<"u")w.enabled=K.enabled;this.sendToolListChanged()}};return this._registeredTools[a]=w,this.setToolRequestHandlers(),this.sendToolListChanged(),w}tool(a,...v){if(this._registeredTools[a])throw Error(`Tool ${a} is already registered`);let f,h,r,l;if(typeof v[0]==="string")f=v.shift();if(v.length>1){let u=v[0];if(SP(u)){if(h=v.shift(),v.length>1&&typeof v[0]==="object"&&v[0]!==null&&!SP(v[0]))l=v.shift()}else if(typeof u==="object"&&u!==null)l=v.shift()}let y=v[0];return this._createRegisteredTool(a,void 0,f,h,r,l,void 0,y)}registerTool(a,v,f){if(this._registeredTools[a])throw Error(`Tool ${a} is already registered`);let{title:h,description:r,inputSchema:l,outputSchema:y,annotations:u,_meta:w}=v;return this._createRegisteredTool(a,h,r,l,y,u,w,f)}prompt(a,...v){if(this._registeredPrompts[a])throw Error(`Prompt ${a} is already registered`);let f;if(typeof v[0]==="string")f=v.shift();let h;if(v.length>1)h=v.shift();let r=v[0],l=this._createRegisteredPrompt(a,void 0,f,h,r);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),l}registerPrompt(a,v,f){if(this._registeredPrompts[a])throw Error(`Prompt ${a} is already registered`);let{title:h,description:r,argsSchema:l}=v,y=this._createRegisteredPrompt(a,h,r,l,f);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),y}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(a,v){return this.server.sendLoggingMessage(a,v)}sendResourceListChanged(){if(this.isConnected())this.server.sendResourceListChanged()}sendToolListChanged(){if(this.isConnected())this.server.sendToolListChanged()}sendPromptListChanged(){if(this.isConnected())this.server.sendPromptListChanged()}}var s1={type:"object",properties:{}};function SP(a){if(typeof a!=="object"||a===null)return!1;return Object.keys(a).length===0||Object.values(a).some(t1)}function t1(a){return a!==null&&typeof a==="object"&&"parse"in a&&typeof a.parse==="function"&&"safeParse"in a&&typeof a.safeParse==="function"}function e1(a){return Object.entries(a.shape).map(([v,f])=>({name:v,description:f.description,required:!f.isOptional()}))}function IP(a){return{completion:{values:a.slice(0,100),total:a.length,hasMore:a.length>100}}}var Ga={completion:{values:[],hasMore:!1}};import TP from"node:process";class Df{append(a){this._buffer=this._buffer?Buffer.concat([this._buffer,a]):a}readMessage(){if(!this._buffer)return null;let a=this._buffer.indexOf(`
`);if(a===-1)return null;let v=this._buffer.toString("utf8",0,a).replace(/\r$/,"");return this._buffer=this._buffer.subarray(a+1),o1(v)}clear(){this._buffer=void 0}}function o1(a){return df.parse(JSON.parse(a))}function RP(a){return JSON.stringify(a)+`
`}class Ff{constructor(a=TP.stdin,v=TP.stdout){this._stdin=a,this._stdout=v,this._readBuffer=new Df,this._started=!1,this._ondata=(f)=>{this._readBuffer.append(f),this.processReadBuffer()},this._onerror=(f)=>{var h;(h=this.onerror)===null||h===void 0||h.call(this,f)}}async start(){if(this._started)throw Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){var a,v;while(!0)try{let f=this._readBuffer.readMessage();if(f===null)break;(a=this.onmessage)===null||a===void 0||a.call(this,f)}catch(f){(v=this.onerror)===null||v===void 0||v.call(this,f)}}async close(){var a;if(this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0)this._stdin.pause();this._readBuffer.clear(),(a=this.onclose)===null||a===void 0||a.call(this)}send(a){return new Promise((v)=>{let f=RP(a);if(this._stdout.write(f))v();else this._stdout.once("drain",v)})}}function v0(a){a.registerTool("codebase_search",{description:`Search project source files, documentation, and code. Use this to find implementations, functions, classes, or any code-related content.

**IMPORTANT: Use this tool PROACTIVELY before starting work, not reactively when stuck.**

This tool searches across all codebase files and returns the most relevant matches with content snippets.

When to use this tool (BEFORE starting work):
- **Before implementation**: Find existing patterns, similar functions, or reusable components
- **Before refactoring**: Understand current implementation and dependencies
- **Before adding features**: Check for existing similar functionality or conflicting code
- **Before debugging**: Search for error messages, function names, or related code
- **Before writing tests**: Find existing test patterns and test utilities

The search includes:
- Source code files (.ts, .js, .tsx, .jsx, etc.)
- Configuration files (.json, .yaml, .toml, etc.)
- Documentation files (.md, .txt, etc.)
- Build and deployment files

**Best Practice**: Search the codebase BEFORE writing new code to avoid duplication and follow existing patterns.`,inputSchema:{query:P.string().describe("Search query - use natural language, function names, or technical terms"),limit:P.number().default(10).optional().describe("Maximum number of results to return (default: 10)"),include_content:P.boolean().default(!0).optional().describe("Include file content snippets in results (default: true)"),file_extensions:P.array(P.string()).optional().describe('Filter by file extensions (e.g., [".ts", ".tsx", ".js"])'),path_filter:P.string().optional().describe('Filter by path pattern (e.g., "src/components", "tests", "docs")'),exclude_paths:P.array(P.string()).optional().describe('Exclude paths containing these patterns (e.g., ["node_modules", ".git", "dist"])')}},async({query:v,limit:f=10,include_content:h=!0,file_extensions:r,path_filter:l,exclude_paths:y})=>{try{await Av.initialize();let u=await Av.searchCodebase(v,{limit:f,include_content:h,file_extensions:r,path_filter:l,exclude_paths:y});return Av.formatResultsForMCP(u.results,v,u.totalIndexed)}catch(u){return{content:[{type:"text",text:`✗ Codebase search error: ${u.message}`}]}}})}function _P(a){v0(a)}function a0(a){a.registerTool("knowledge_search",{description:`Search knowledge base, documentation, guides, and reference materials. Use this for domain knowledge, best practices, setup instructions, and conceptual information.

**IMPORTANT: Use this tool PROACTIVELY before starting work, not reactively when stuck.**

This tool searches across all knowledge resources and returns the most relevant matches. Use include_content=false to reduce context usage, then use knowledge_get for specific documents.

When to use this tool (BEFORE starting work):
- **Before research/clarification**: Check relevant stack/universal knowledge to understand domain constraints
- **Before design/architecture**: Review architecture patterns, security, and performance best practices
- **Before implementation**: Consult framework-specific patterns, common pitfalls, and best practices
- **Before testing/QA**: Review testing strategies, coverage requirements, and quality standards
- **Before deployment**: Check deployment patterns, infrastructure, and monitoring guidance

Available knowledge categories:
- **stacks**: Framework-specific patterns (React, Next.js, Node.js)
- **data**: Database patterns (SQL, indexing, migrations)
- **guides**: Architecture guidance (SaaS, tech stack, UI/UX)
- **universal**: Cross-cutting concerns (security, performance, testing, deployment)

The knowledge is curated for LLM code generation - includes decision trees, common bugs, and practical patterns.

**Best Practice**: Check relevant knowledge BEFORE making decisions or writing code, not after encountering issues.`,inputSchema:{query:P.string().describe("Search query - use natural language, technology names, or topic keywords"),limit:P.number().default(10).optional().describe("Maximum number of results to return (default: 10)"),include_content:P.boolean().default(!0).optional().describe("Include full content in results (default: true). Use false to reduce context, then knowledge_get for specific docs")}},async({query:v,limit:f=10,include_content:h=!0})=>{try{await Av.initialize();let r=await Av.getStatus();if(r.knowledge.isIndexing)return{content:[{type:"text",text:`⏳ **Knowledge Indexing in Progress**

- Progress: ${r.knowledge.progress||0}%
- Status: Building search index

*This typically takes <1 second for knowledge base.*

**Please wait a moment and try again.**`}]};if(!r.knowledge.indexed)return{content:[{type:"text",text:`\uD83D\uDCED **No Knowledge Documents Available**

The knowledge base appears to be empty or not properly initialized.

**To fix:**
- Check if knowledge files exist in assets/knowledge/
- Try restarting the MCP server to trigger indexing
- Use CLI: \`sylphx search status\` for diagnostics

**Expected knowledge files:**
- stacks/ (framework-specific patterns)
- guides/ (architecture guidance)
- universal/ (cross-cutting concerns)
- data/ (database patterns)`}]};let l=await Av.searchKnowledge(v,{limit:f,include_content:h});return Av.formatResultsForMCP(l.results,v,l.totalIndexed)}catch(r){return{content:[{type:"text",text:`✗ Knowledge search error: ${r.message}`}]}}})}function f0(a){a.registerTool("knowledge_get",{description:`Get knowledge resource by exact URI.

**NOTE: Prefer using 'knowledge_search' with include_content=false first, then use this tool for specific documents.**

This tool retrieves a specific knowledge resource when you already know its exact URI from search results.

The available URIs are dynamically generated from the indexed knowledge base. Use 'knowledge_search' to discover relevant URIs first.`,inputSchema:{uri:P.string().describe('Knowledge URI to access (e.g., "knowledge://stacks/react-app")')}},async({uri:v})=>{try{let{getKnowledgeContent:f}=await import("./knowledge-resources-6r52bem7.js");return{content:[{type:"text",text:f(v)}]}}catch(f){let h=f instanceof Error?f.message:String(f),r=await Av.getAvailableKnowledgeURIs(),l=r.length>0?r.map((y)=>`• ${y}`).join(`
`):"No knowledge documents available";return{content:[{type:"text",text:`✗ Error: ${h}

Available knowledge URIs:
${l}`}],isError:!0}}})}function CP(a){a0(a),f0(a)}var ur=new nP,Uv={info:(a)=>console.error(`[INFO] ${a}`),success:(a)=>console.error(`[SUCCESS] ${a}`),error:(a,v)=>{if(console.error(`[ERROR] ${a}`),v)console.error(v)}};async function h0(a){try{let{key:v,value:f,namespace:h="default"}=a,r=JSON.parse(f);return await ur.set(v,r,h),Uv.info(`Stored memory: ${h}:${v}`),{content:[{type:"text",text:`✓ Stored memory: ${h}:${v}`}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error storing memory",v),{content:[{type:"text",text:`✗ Error storing memory: ${f}`}],isError:!0}}}async function l0(a){try{let{key:v,namespace:f="default"}=a,h=await ur.get(v,f);if(!h)return{content:[{type:"text",text:`✗ Memory not found: ${f}:${v}`}],isError:!0};let r=Date.now()-h.timestamp;return Uv.info(`Retrieved memory: ${f}:${v}`),{content:[{type:"text",text:JSON.stringify({key:`${f}:${v}`,value:h.value,namespace:h.namespace,timestamp:h.timestamp,created_at:h.created_at,updated_at:h.updated_at,age_seconds:Math.floor(r/1000)},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error retrieving memory",v),{content:[{type:"text",text:`✗ Error retrieving memory: ${f}`}],isError:!0}}}async function P0(a){try{let{pattern:v,namespace:f}=a,r=(await ur.getAll()).filter((l)=>{let y=l.key.toLowerCase().includes(v.toLowerCase())||l.namespace.toLowerCase().includes(v.toLowerCase())||JSON.stringify(l.value).toLowerCase().includes(v.toLowerCase()),u=!f||l.namespace===f;return y&&u});return Uv.info(`Searched memory: "${v}" (${r.length} results)`),{content:[{type:"text",text:JSON.stringify({pattern:v,namespace:f||"all",count:r.length,results:r.map((l)=>({key:l.key,namespace:l.namespace,value:l.value,timestamp:l.timestamp,updated_at:l.updated_at}))},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error searching memory",v),{content:[{type:"text",text:`✗ Error searching memory: ${f}`}],isError:!0}}}async function y0(a){try{let{namespace:v}=a,f=await ur.getAll();return Uv.info(`Listed memory: ${f.length} entries`),{content:[{type:"text",text:JSON.stringify({namespace:v||"all",count:f.length,entries:f.map((h)=>({key:h.key,namespace:h.namespace,value:h.value,timestamp:h.timestamp,updated_at:h.updated_at}))},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error listing memory",v),{content:[{type:"text",text:`✗ Error listing memory: ${f}`}],isError:!0}}}async function u0(a){try{let{key:v,namespace:f="default"}=a;if(!await ur.delete(v,f))return{content:[{type:"text",text:`✗ Memory not found: ${f}:${v}`}],isError:!0};return Uv.info(`Deleted memory: ${f}:${v}`),{content:[{type:"text",text:`✓ Deleted memory: ${f}:${v}`}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error deleting memory",v),{content:[{type:"text",text:`✗ Error deleting memory: ${f}`}],isError:!0}}}async function Q0(a){try{let{namespace:v}=a;return await ur.clear(v),Uv.info(`Cleared memory: ${v||"all"}`),{content:[{type:"text",text:`✓ Cleared memory: ${v||"all namespaces"}`}]}}catch(v){let f=v instanceof Error?v.message:String(v);return Uv.error("Error clearing memory",v),{content:[{type:"text",text:`✗ Error clearing memory: ${f}`}],isError:!0}}}async function Z0(){try{let a=await ur.getStats();return Uv.info("Retrieved memory stats"),{content:[{type:"text",text:JSON.stringify({total_entries:a.totalEntries,namespaces:a.namespaces,oldest_entry:a.oldestEntry,newest_entry:a.newestEntry,database_path:".sylphx-flow/memory.db"},null,2)}]}}catch(a){let v=a instanceof Error?a.message:String(a);return Uv.error("Error getting memory stats",a),{content:[{type:"text",text:`✗ Error getting memory stats: ${v}`}],isError:!0}}}function cP(a){a.registerTool("memory_set",{description:"Store a value in persistent memory for agent coordination",inputSchema:{key:P.string().describe("Memory key (e.g., 'swarm/coder/status')"),value:P.string().describe("Value to store (will be JSON stringified)"),namespace:P.string().optional().describe("Optional namespace for organization")}},h0),a.registerTool("memory_get",{description:"Retrieve a value from persistent memory",inputSchema:{key:P.string().describe("Memory key to retrieve"),namespace:P.string().optional().describe("Optional namespace")}},l0),a.registerTool("memory_search",{description:"Search memory entries by pattern",inputSchema:{pattern:P.string().describe("Search pattern (matches keys, namespaces, and values)"),namespace:P.string().optional().describe("Optional namespace to limit search")}},P0),a.registerTool("memory_list",{description:"List all memory entries",inputSchema:{namespace:P.string().optional().describe("Optional namespace to filter by")}},y0),a.registerTool("memory_delete",{description:"Delete a memory entry",inputSchema:{key:P.string().describe("Memory key to delete"),namespace:P.string().optional().describe("Optional namespace")}},u0),a.registerTool("memory_clear",{description:"Clear memory entries",inputSchema:{namespace:P.string().optional().describe("Optional namespace to clear (omits to clear all)")}},Q0),a.registerTool("memory_stats",{description:"Get memory storage statistics",inputSchema:{}},Z0)}import{existsSync as W0,mkdirSync as J0,writeFileSync as B0}from"node:fs";import{join as mP}from"node:path";import{readFileSync as dP,writeFileSync as w0}from"node:fs";import{join as pP}from"node:path";class Gf{templatesDir;mode;constructor(a,v="coordinator"){this.templatesDir=a,this.mode=v}loadTemplate(a){if(["spec","plan","validation","reviews"].includes(a)){let h=pP(this.templatesDir,"shared",`${a}-template.md`);return dP(h,"utf8")}let f=pP(this.templatesDir,this.mode,`${a}-template.md`);return dP(f,"utf8")}replaceVariables(a,v){let f=a;for(let[h,r]of Object.entries(v)){let l=new RegExp(`{{${h}}}`,"g");f=f.replace(l,String(r))}return f=f.replace(/{{#if (\w+)}}([\s\S]*?){{\/if}}/g,(h,r,l)=>{let y=v[r];return y&&y!=="false"&&y!=="0"&&y!==""?l:""}),f=f.replace(/{{#each (\w+)}}([\s\S]*?){{\/each}}/g,(h,r,l)=>{let y=v[r];if(!Array.isArray(y))return"";return y.map((u,w)=>{let K=l;return K=K.replace(/{{this}}/g,String(u)),K=K.replace(/{{@index}}/g,String(w)),K}).join(`
`)}),f}generateTemplate(a,v){let f=this.loadTemplate(a);return this.replaceVariables(f,v)}createFile(a,v,f){let h=this.generateTemplate(a,v);w0(f,h,"utf8")}generateAllProjectTemplates(a){let v={},f=["spec","progress","plan","tasks","validation","reviews"];for(let h of f)v[h]=this.generateTemplate(h,a);return v}}var mv={info:(a)=>console.error(`[INFO] ${a}`),success:(a)=>console.error(`[SUCCESS] ${a}`),error:(a,v)=>{if(console.error(`[ERROR] ${a}`),v)console.error(v)}};function K0(){return iP.generateSecureRandom(4).substring(0,8)}function Y0(a,v){return`${{feature:"feat",bugfix:"fix",hotfix:"fix",refactor:"refactor",migration:"feat"}[a]||"feat"}(${a}): initialize ${v} workspace and comprehensive templates`}function X0(a,v){let f={feature:`New feature implementation for ${v}`,bugfix:`Bug fix for ${v} issue`,hotfix:`Critical hotfix for ${v}`,refactor:`Code refactoring for ${v}`,migration:`Migration project for ${v}`},h={feature:["Define feature specifications","Implement core functionality","Write comprehensive tests","Update documentation","Code review and validation"],bugfix:["Identify root cause","Implement fix","Add regression tests","Verify fix resolves issue","Update documentation if needed"],hotfix:["Implement immediate fix","Test critical path","Deploy hotfix","Schedule proper fix follow-up"],refactor:["Analyze current code structure","Plan refactoring approach","Implement refactored code","Ensure all tests pass","Update documentation"],migration:["Analyze current system","Plan migration strategy","Implement migration code","Test migration process","Deploy and verify"]},r={feature:`Successfully implement the ${v} feature with full functionality and testing`,bugfix:`Resolve the ${v} issue completely and prevent recurrence`,hotfix:`Quickly address critical ${v} issue to restore system stability`,refactor:`Improve code quality and maintainability for ${v}`,migration:`Successfully migrate ${v} to new system with minimal disruption`},l={feature:"Implementation of new feature including frontend, backend, tests, and documentation",bugfix:"Fix for specific issue including root cause analysis and prevention measures",hotfix:"Minimal change to address critical issue with immediate deployment",refactor:"Code structure improvements without changing external behavior",migration:"Complete migration of existing functionality to new system or platform"};return{description:f[a]||`Project for ${v}`,requirements:h[a]||["Define requirements","Implement solution","Test and validate"],objective:r[a]||`Complete ${v} project successfully`,scope:l[a]||"Project scope to be defined"}}async function Ea(a,v=[]){try{if(a!=="git")throw Error(`Only git commands are allowed, got: ${a}`);let f=Lf.validateCommandArgs(v),{stdout:h,stderr:r}=await Lf.safeExecFile("git",f,{cwd:process.cwd(),timeout:30000});return{success:!0,output:h.trim(),error:r.trim()}}catch(f){let h=f instanceof Error?f.message:"Unknown error";return mv.error(`Git command failed: ${a} ${v.join(" ")}`,f),{success:!1,output:"",error:h}}}function D0(a){if(!W0(a))J0(a,{recursive:!0}),mv.info(`Created directory: ${a}`)}function F0(a,v){B0(a,v,"utf8"),mv.info(`Created file: ${a}`)}function tP(a){a.registerTool("project_startup",{description:"Initialize a new project with comprehensive templates and workspace structure",inputSchema:{project_type:P.enum(["feature","bugfix","hotfix","refactor","migration"]).describe("Type of project"),project_name:P.string().describe("Name of the project (use letters, numbers, hyphens, underscores only)"),create_branch:P.boolean().optional().describe("Whether to create a git branch (default: true)"),mode:P.enum(["coordinator","implementer"]).optional().describe("Execution mode: coordinator (delegation-based) or implementer (direct execution). Default: coordinator")}},G0)}async function G0(a){try{let{project_type:v,project_name:f,create_branch:h=!0,mode:r="coordinator"}=a,l=P.enum(["feature","bugfix","hotfix","refactor","migration"]).parse(v),y=Ef.projectName.parse(f),u=X0(l,y),{description:w,requirements:K,objective:X,scope:D}=u,F=K0(),Q=`${l}/${y}${F}`;Ef.branchName.parse(Q);let J=mP("specs",l,`${y}${F}`),G=new Date().toISOString().split("T")[0];mv.info(`\uD83D\uDE80 Starting project initialization: ${Q}`);let B={success:!0,output:"",error:""};if(h){let V=await Ea("git",["rev-parse","--abbrev-ref","HEAD"]);if(V.success&&V.output!=="main")return{content:[{type:"text",text:`✗ Not on main branch. Current branch: ${V.output}. Please switch to main first.`}],isError:!0};if(B=await Ea("git",["checkout","-b",Q]),!B.success)return{content:[{type:"text",text:`✗ Failed to create branch "${Q}": ${B.error}`}],isError:!0};mv.success(`✓ Created and checked out branch: ${Q}`)}D0(J);let z={PROJECT_NAME:f,PROJECT_TYPE:v,DESCRIPTION:w,REQUIREMENTS:K,TIMESTAMP:G,BRANCH_NAME:Q,PROJECT_ID:`${f}${F}`,CURRENT_PHASE:"Phase 1: Requirements Analysis",LAST_UPDATED:new Date().toISOString(),NEXT_ACTION:"Complete requirements specification and proceed to Phase 2",STATUS:"Not Started",PHASE_1_STATUS:"In Progress",PHASE_1_COMPLETE:"0",PHASE_1_UPDATED:new Date().toISOString(),PHASE_1_NOTES:"Starting requirements analysis (0% complete)",PHASE_2_STATUS:"Not Started",PHASE_2_COMPLETE:"0",PHASE_2_UPDATED:new Date().toISOString(),PHASE_2_NOTES:"Awaiting research and clarification",PHASE_3_STATUS:"Not Started",PHASE_3_COMPLETE:"0",PHASE_3_UPDATED:new Date().toISOString(),PHASE_3_NOTES:"Awaiting design phase",PHASE_4_STATUS:"Not Started",PHASE_4_COMPLETE:"0",PHASE_4_UPDATED:new Date().toISOString(),PHASE_4_NOTES:"Awaiting task breakdown",PHASE_5_STATUS:"Not Started",PHASE_5_COMPLETE:"0",PHASE_5_UPDATED:new Date().toISOString(),PHASE_5_NOTES:"Awaiting validation",PHASE_6_STATUS:"Not Started",PHASE_6_COMPLETE:"0",PHASE_6_UPDATED:new Date().toISOString(),PHASE_6_NOTES:"Awaiting implementation",PHASE_7_STATUS:"Not Started",PHASE_7_COMPLETE:"0",PHASE_7_UPDATED:new Date().toISOString(),PHASE_7_NOTES:"Awaiting testing and review",PHASE_8_STATUS:"Not Started",PHASE_8_COMPLETE:"0",PHASE_8_UPDATED:new Date().toISOString(),PHASE_8_NOTES:"Awaiting final merge",OBJECTIVE:X||`Implement ${f}`,SCOPE:D||"To be defined",CRITICAL_PATH:"To be defined during task breakdown",PARALLEL_OPPORTUNITIES:"To be identified during planning",RESOURCE_CONFLICTS:"To be resolved during planning",INTEGRATION_POINTS:"To be identified during design",VALIDATED_BY:"To be assigned",VALIDATION_DATE:G,OVERALL_STATUS:"Pending",REVIEW_PERIOD:`${G} onwards`,TOTAL_REVIEWS:"0",QUALITY_SCORE:"0",REVIEW_DATE:G,REVIEWER:"To be assigned",REVIEW_SCOPE:"Full implementation review",IMPLEMENTATION_STATUS:"Not Started",VALIDATOR:"To be assigned",VALIDATION_SCOPE:"Full project validation",REQUIREMENTS_COVERAGE_STATUS:"Pending",ACCEPTANCE_CRITERIA_MAPPED:"Pending",SUCCESS_CRITERIA_MEASURABLE:"Pending",SCOPE_CREEP_PREVENTION:"Pending",ARCHITECTURE_ALIGNMENT:"Pending",INTEGRATION_POINTS_VERIFIED:"Pending",DESIGN_CONFLICTS_RESOLVED:"Pending",TECHNICAL_FEASIBILITY:"Pending",TASK_COMPLETENESS:"Pending",DEPENDENCY_MAPPING_ACCURACY:"Pending",RESOURCE_ALLOCATION_ADEQUATE:"Pending",CRITICAL_PATH_IDENTIFIED:"Pending",TDD_STRATEGY_DEFINED:"Pending",TASK_1_ID:"TASK-001",TASK_1_DESC:"To be defined",TASK_1_STATUS:"Not Started",TASK_1_COMPLETION:"0",TASK_1_DELIVERABLE:"To be defined",TASK_1_QUALITY:"Pending",TASK_2_ID:"TASK-002",TASK_2_DESC:"To be defined",TASK_2_STATUS:"Not Started",TASK_2_COMPLETION:"0",TASK_2_DELIVERABLE:"To be defined",TASK_2_QUALITY:"Pending",TASK_3_ID:"TASK-003",TASK_3_DESC:"To be defined",TASK_3_STATUS:"Not Started",TASK_3_COMPLETION:"0",TASK_3_DELIVERABLE:"To be defined",TASK_3_QUALITY:"Pending",OVERALL_TASK_COMPLETION:"0",ALL_TASKS_COMPLETED:"No",TOTAL_COMMITS:"0",COMMITS_PER_TASK:"0",COMMIT_QUALITY:"Pending",BRANCH_STRATEGY_COMPLIANCE:"Pending"},N=sP(),U=new Gf(N,r).generateAllProjectTemplates(z),g=[];for(let[V,S]of Object.entries(U)){let j=mP(J,`${V}.md`);F0(j,S),g.push(`${V}.md`)}if(h){let V=await Ea("git",["add","."]),S=Y0(l,y),j=await Ea("git",["commit","-m",S]);if(!V.success||!j.success)mv.error("Warning: Failed to create initial commit");else mv.success("✓ Created initial commit with project templates")}return mv.success(`✓ Project "${y}" initialized successfully!`),{content:[{type:"text",text:JSON.stringify({success:!0,project:{type:l,name:y,branch:Q,workspace:J,description:w,requirements:K,objective:X,scope:D},setup:{branch_created:h&&B.success,workspace_created:!0,templates_created:g,initial_commit:h},next_steps:[`1. Review and update specs/${l}/${y}/spec.md with detailed requirements`,"2. Fill in project-specific data in all template files","3. Proceed with Phase 1: SPECIFY & CLARIFY","4. Follow the workflow in progress.md"]},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return mv.error("Error in project startup",v),{content:[{type:"text",text:`✗ Error initializing project: ${f}`}],isError:!0}}}var La={info:(a)=>console.error(`[INFO] ${a}`),success:(a)=>console.error(`[SUCCESS] ${a}`),error:(a,v)=>{if(console.error(`[ERROR] ${a}`),v)console.error(v)}};function zf(a){try{return Intl.DateTimeFormat(void 0,{timeZone:a}),!0}catch{return!1}}function E0(a){return/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(a)}function L0(a){try{let{timezone:v}=a;if(!zf(v))return{content:[{type:"text",text:`✗ Invalid timezone: ${v}. Please use a valid IANA timezone name (e.g., 'America/New_York', 'Europe/London', 'Asia/Tokyo').`}],isError:!0};let f=new Date,h=new Intl.DateTimeFormat("en-US",{timeZone:v,year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"long",hour12:!1}),r=h.formatToParts(f),l={};for(let w of r)l[w.type]=w.value;let y=new Intl.DateTimeFormat("en-US",{timeZone:v,hour:"2-digit",minute:"2-digit",hour12:!1}).format(f),u=f.toLocaleString("sv-SE",{timeZone:v});return La.info(`Retrieved current time for timezone: ${v}`),{content:[{type:"text",text:JSON.stringify({timezone:v,current_time:{date:`${l.month} ${l.day}, ${l.year}`,time_24h:y,time_with_seconds:h.format(f),timezone_name:l.timeZoneName,iso_format:`${u.replace(" ","T")}Z`,unix_timestamp:Math.floor(f.getTime()/1000)}},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return La.error("Error getting current time",v),{content:[{type:"text",text:`✗ Error getting current time: ${f}`}],isError:!0}}}function z0(a){try{let{source_timezone:v,time:f,target_timezone:h}=a;if(!zf(v))return{content:[{type:"text",text:`✗ Invalid source timezone: ${v}. Please use a valid IANA timezone name.`}],isError:!0};if(!zf(h))return{content:[{type:"text",text:`✗ Invalid target timezone: ${h}. Please use a valid IANA timezone name.`}],isError:!0};if(!E0(f))return{content:[{type:"text",text:`✗ Invalid time format: ${f}. Please use 24-hour format (HH:MM).`}],isError:!0};let[r,l]=f.split(":").map(Number),y=new Date,u=new Date(y.getFullYear(),y.getMonth(),y.getDate(),r,l),w=new Intl.DateTimeFormat("en-US",{timeZone:v,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),K=w.formatToParts(u),X={};for(let N of K)X[N.type]=N.value;let D=new Intl.DateTimeFormat("en-US",{timeZone:h,year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"long",hour12:!1}),F=new Intl.DateTimeFormat("en-US",{timeZone:h,hour:"2-digit",minute:"2-digit",hour12:!1}).format(u),Q=D.formatToParts(u),J={};for(let N of Q)J[N.type]=N.value;let B=new Date(u.toLocaleString("en-US",{timeZone:h})).getTime()-u.getTime(),z=Math.round(B/3600000);return La.info(`Converted time from ${v} to ${h}`),{content:[{type:"text",text:JSON.stringify({conversion:{source:{timezone:v,time:f,formatted:w.format(u)},target:{timezone:h,time_24h:F,formatted:D.format(u),date:`${J.month} ${J.day}, ${J.year}`,timezone_name:J.timeZoneName},time_difference_hours:z}},null,2)}]}}catch(v){let f=v instanceof Error?v.message:String(v);return La.error("Error converting time",v),{content:[{type:"text",text:`✗ Error converting time: ${f}`}],isError:!0}}}function eP(a){a.registerTool("get_current_time",{description:"Get current time in a specific timezone or system timezone",inputSchema:{timezone:P.string().describe("IANA timezone name (e.g., 'America/New_York', 'Europe/London')")}},L0),a.registerTool("convert_time",{description:"Convert time between timezones",inputSchema:{source_timezone:P.string().describe("Source IANA timezone name"),time:P.string().describe("Time in 24-hour format (HH:MM)"),target_timezone:P.string().describe("Target IANA timezone name")}},z0)}var za={name:"sylphx-flow",version:"1.0.0",description:"Sylphx Flow MCP server providing coordination tools for AI agents. Persistent SQLite-based storage with namespace support for agent coordination and state management."},Qr={info:(a)=>console.error(`[INFO] ${a}`),success:(a)=>console.error(`[SUCCESS] ${a}`),error:(a,v)=>{if(console.error(`[ERROR] ${a}`),v)console.error(v)}};function O0(){let a=process.argv.slice(2),v={};if(a.includes("--disable-memory"))v.disableMemory=!0;if(a.includes("--disable-time"))v.disableTime=!0;if(a.includes("--disable-project-startup"))v.disableProjectStartup=!0;if(a.includes("--disable-knowledge"))v.disableKnowledge=!0;if(a.includes("--disable-codebase"))v.disableCodebase=!0;if(a.includes("--enable-memory"))v.disableMemory=!1;if(a.includes("--enable-time"))v.disableTime=!1;if(a.includes("--enable-project-startup"))v.disableProjectStartup=!1;if(a.includes("--enable-knowledge"))v.disableKnowledge=!1;return v}async function EW(a={}){if(Object.keys(a).length===0)a=O0();console.error("Debug: Final config =",a),console.log("\uD83D\uDE80 Starting Sylphx Flow MCP Server..."),console.log("\uD83D\uDCCD Database: .sylphx-flow/memory.db"),console.log("\uD83D\uDD0D Initializing embedding provider...");try{let h=await oP();console.log(`✓ Embedding provider initialized: ${h.name}`),await Av.initialize(),console.log("✓ Search service initialized with embeddings")}catch(h){console.log("⚠️  Failed to initialize embeddings, using TF-IDF only:",h),await Av.initialize()}Qr.info(`\uD83D\uDCCB Description: ${za.description.substring(0,100)}...`);let v=new Xf({name:za.name,version:za.version,description:za.description}),f=[];if(!a.disableMemory)cP(v),f.push("memory_set, memory_get, memory_search, memory_list, memory_delete, memory_clear, memory_stats");if(!a.disableTime)eP(v),f.push("time_get_current, time_format, time_parse");if(!a.disableProjectStartup)tP(v),f.push("project_startup");if(!a.disableCodebase)Qr.info("\uD83D\uDD0D Registering codebase tools"),_P(v),f.push("codebase_search"),console.log("\uD83D\uDD0D Codebase Tools: Enabled");if(!a.disableKnowledge)Qr.info("\uD83D\uDCDA Registering knowledge tools"),CP(v),f.push("knowledge_search","knowledge_get"),console.log("\uD83D\uDCDA Knowledge Tools: Enabled");if(f.length>0)console.log(`\uD83D\uDD27 Enabled tools: ${f.join(", ")}`);else console.log("\uD83D\uDD27 All tools disabled");try{let h=new Ff;return await v.connect(h),Qr.success("✓ MCP Server connected and ready"),console.log("\uD83D\uDCA1 Press Ctrl+C to stop the server"),v}catch(h){throw Qr.error("Failed to start MCP server",h),h}}process.on("SIGINT",()=>{Qr.info("\uD83D\uDED1 Shutting down MCP server..."),process.exit(0)});process.on("SIGTERM",()=>{Qr.info("\uD83D\uDED1 Shutting down MCP server..."),process.exit(0)});export{EW as startSylphxFlowMCPServer};
